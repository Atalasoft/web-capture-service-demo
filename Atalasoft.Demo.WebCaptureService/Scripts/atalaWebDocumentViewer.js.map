{"version":3,"sources":["atalaWebDocumentViewer.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__31__","__WEBPACK_EXTERNAL_MODULE__67__","__WEBPACK_EXTERNAL_MODULE__68__","__WEBPACK_EXTERNAL_MODULE__69__","modules","installedModules","__webpack_require__","moduleId","i","l","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","global","getOwnPropertyDescriptor","f","hide","redefine","setGlobal","copyConstructorProperties","isForced","options","source","target","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","forced","undefined","sham","exec","error","Math","self","Function","store","uid","NATIVE_SYMBOL","isObject","it","TypeError","String","a","DESCRIPTORS","IE8_DOM_DEFINE","anObject","toPrimitive","nativeDefineProperty","O","P","Attributes","toInteger","min","argument","toAbsoluteIndex","toLength","toObject","arraySpeciesCreate","createProperty","max","SPECIES_SUPPORT","proto","splice","start","deleteCount","insertCount","actualDeleteCount","A","k","from","to","this","len","length","actualStart","argumentsLength","arguments","DOMIterables","forEach","COLLECTION_NAME","Collection","CollectionPrototype","isRegExp","requireObjectCoercible","speciesConstructor","advanceStringIndex","callRegExpExec","regexpExec","fails","arrayPush","push","MAX_UINT32","SUPPORTS_Y","RegExp","SPLIT","nativeSplit","maybeCallNative","internalSplit","split","separator","limit","string","lim","match","lastIndex","lastLength","output","flags","ignoreCase","multiline","unicode","sticky","lastLastIndex","separatorCopy","slice","index","apply","test","splitter","regexp","res","done","rx","S","C","unicodeMatching","q","e","z","IndexedObject","definePropertyModule","createPropertyDescriptor","regExpExec","floor","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","REPLACE","nativeReplace","searchValue","replaceValue","replacer","functionalReplace","fullUnicode","results","result","accumulatedResult","nextSourcePosition","matched","position","captures","j","namedCaptures","groups","replacerArgs","concat","replacement","getSubstitution","str","tailPos","symbols","ch","capture","charAt","isArray","toIndexedObject","SPECIES","nativeSlice","end","Constructor","fin","constructor","Array","toString","has","nativeFunctionToString","InternalStateModule","getInternalState","enforceInternalState","enforce","TEMPLATE","unsafe","simple","join","ceil","isNaN","internalFilter","filter","callbackfn","FunctionPrototype","FunctionPrototypeToString","nameRE","configurable","propertyIsEnumerableModule","nativeGetOwnPropertyDescriptor","fn","val","valueOf","SHARED","version","copyright","internalObjectKeys","hiddenKeys","getOwnPropertyNames","METHOD_NAME","array","foo","Boolean","nativeJoin","ES3_STRINGS","SLOPPY_METHOD","internalMap","map","bitmap","writable","integer","enumBugKeys","keys","classof","arg","TYPE","specificCreate","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","$this","that","boundFunction","R","wellKnownSymbol","REPLACE_SUPPORTS_NAMED_GROUPS","re","replace","SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","KEY","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","nativeRegExpMethod","methods","nativeMethod","arg2","forceStringMethod","stringMethod","regexMethod","internalFind","FIND","SKIPS_HOLES","find","internalStringTrim","FORCED","trim","nativePropertyIsEnumerable","propertyIsEnumerable","NASHORN_BUG","1","V","shared","id","postfix","random","getOwnPropertySymbols","feature","detection","data","normalize","POLYFILL","NATIVE","toLowerCase","defineProperties","html","documentCreateElement","IE_PROTO","PROTOTYPE","Empty","createDict","iframeDocument","iframe","script","style","display","appendChild","src","contentWindow","document","open","write","lt","close","F","Properties","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","isConcatSpreadable","spreadable","E","propertyKey","originalArray","codePointAt","re1","re2","regexpFlags","nativeExec","patchedExec","UPDATES_LAST_INDEX_WRONG","NPCG_INCLUDED","reCopy","searchString","NAME","MATCH","UNSCOPABLES","ArrayPrototype","thisNumberValue","repeat","nativeToFixed","toFixed","multiply","c2","divide","numToString","pow","x","acc","fractionDigits","RangeError","x2","log","TO_STRING","nativeToString","NOT_GENERIC","INCORRECT_NAME","createHTML","bold","quot","tag","attribute","p1","italics","exist","createElement","set","NATIVE_WEAK_MAP","objectHas","sharedKey","WeakMap","wmget","wmhas","wmset","metadata","STATE","getterFor","state","type","arrayIndexOf","names","IS_INCLUDES","el","fromIndex","method","nativeMatch","matcher","matchStr","inheritIfRequired","NUMBER","NativeNumber","NumberPrototype","BROKEN_CLASSOF","NATIVE_TRIM","toNumber","first","third","radix","maxCode","digits","code","charCodeAt","NaN","parseInt","NumberWrapper","setPrototypeOf","whitespace","ltrim","rtrim","sameValue","SEARCH","nativeSearch","searcher","previousLastIndex","ObjectPrototype","IS_PURE","$export","setToStringTag","wrappedWellKnownSymbolModule","defineWellKnownSymbol","enumKeys","nativeObjectCreate","getOwnPropertyNamesExternal","getOwnPropertyDescriptorModule","objectKeys","HIDDEN","setInternalState","nativeGetOwnPropertyNames","$Symbol","JSON","nativeJSONStringify","stringify","TO_PRIMITIVE","SymbolRegistry","AllSymbols","ObjectPrototypeSymbols","WellKnownSymbolsStore","QObject","USE_SETTER","findChild","setSymbolDescriptor","D","ObjectPrototypeDescriptor","wrap","description","symbol","isSymbol","iterator","$defineProperty","$defineProperties","$propertyIsEnumerable","$getOwnPropertyDescriptor","$getOwnPropertyNames","$getOwnPropertySymbols","IS_OP","setter","wellKnownSymbols","for","keyFor","sym","useSetter","useSimple","$replacer","args","ownKeys","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","Reflect","TO_STRING_TAG","TAG","path","documentElement","windowNames","getWindowNames","aFunction","b","FAILS_ON_PRIMITIVES","nativeKeys","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","nativeForEach","internalForEach","pos","CONVERT_TO_STRING","second","size","validateArguments","STARTS_WITH","CORRECT_IS_REGEXP_LOGIC","nativeStartsWith","startsWith","search","validateSetPrototypeOfArguments","correctSetter","__proto__","is","y","defaultConstructor","whitespaces","count","Infinity","classofRaw","CORRECT_ARGUMENTS","tryGet","callee","fill","endPos","strike","internalIncludes","includes","getFlags","NativeRegExp","RegExpPrototype","CORRECT_NEW","RegExpWrapper","pattern","thisIsRegExp","patternIsRegExp","flagsAreUndefined","proxy","getBuiltIn","CONSTRUCTOR_NAME","variable","namespace","INCLUDES","indexOf","ENDS_WITH","nativeEndsWith","endsWith","endPosition","__webpack_amd_options__","__webpack_exports__","BrowserPlatform","external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_","external_amd_raphael_commonjs_raphael_commonjs2_raphael_root_Raphael_","external_amd_jquery_ui_commonjs_jquery_ui_commonjs2_jquery_ui_root_jQuery_ui_","external_amd_clipboard_commonjs_clipboard_commonjs2_clipboard_root_ClipboardJS_","atalaJquery","atalaRaphael","atalaClipboard","_assertThisInitialized","ReferenceError","_defineProperty","obj","_defineProperties","props","_createClass","protoProps","staticProps","ViewerDependencyName","BrowserMobile","Any","iOS","Android","IEMobile","navigator","userAgent","BrowserLayout","browserLayoutVersion","BrowserImpl_BrowserFeatures","BrowserFeatures","supportsVML","hasVML","div","appendTo","shape","css","adj","remove","implementation","hasFeature","supportsVml","BrowserImpl","mobile","Edge","browserVersion","BrowserEx","_BrowserImpl","subClass","superClass","_this","features","layout","platform","DetectPlatform","Mac","Windows","Unknown","BrowserPublic","Browser","Enums_Browser","MouseToolType","None","Pan","ZoomIn","ZoomOut","ContextMenu","PassThrough","Selection","ZoomArea","Text","MouseToolCursor","Auto","Arrow","Crosshair","Grab","Firefox","Hand","Move","Explorer","VerticalText","Wait","Custom","ScrollDirection","Horizontal","Vertical","Fitting","Best","Width","Height","PageSelection","TopLeft","MiddleLeft","BottomLeft","Center","ScrollArea","Normal","Large","SelectionMode","SingleSelect","MultiSelect","SelectedItemsOrder","ItemIndexOrder","SelectedOrder","FileUploadRejectReason","Size","Type","Name","Enums","annotations_AnnotationTypes","image","highlight","rectangle","fillrect","text","stamp","ellipse","line","lines","freehand","polygon","domclasses","atala_page_div","atala_page_loading","atala_page_image_anchor","atala_page_image","atala_page_number","atala_active_page","atala_active_thumb","atala_thumb_caption","atala_toolbar","atala_annotation_toolbar","atala_toolbar_button","atala_main_container","atala_scroller","atala_viewport","atala_content","atala_thumb_draggable","atala_drag_placeholder","atala_dom_edge_first","atala_dom_edge_last","atala_scroll_horizontal","atala_scroll_vertical","atala_page_label","atala_context_menu","atala_statusbar","atala_tool_button_save","atala_tool_button_page_prev","atala_tool_button_page_next","atala_tool_button_zoom_out","atala_tool_button_zoom_in","atala_tool_button_fit_none","atala_tool_button_fit_best","atala_tool_button_fit_width","atala_tool_button_zoom_area","atala_tool_button_rotate_left","atala_tool_button_rotate_right","atala_tool_button_text_tool","atala_tool_button_pan_tool","atala_tool_button_ellipse_anno","atala_tool_button_highlight_anno","atala_tool_button_line_anno","atala_tool_button_lines_anno","atala_tool_button_freehand_anno","atala_tool_button_polygon_anno","atala_tool_button_rect_anno","atala_tool_button_fillrect_anno","atala_tool_button_text_anno","atala_tool_button_stamp_anno","atala_tool_button_note_anno","atala_tool_button_comment_anno","atala_tool_selection_band","atala_tool_selection_grip","atala_tool_selection_mask","atala_tool_selection_tooltip","atala_search_container","atala_search_input","atala_search_next","atala_search_prev","atala_tool_button_upload","atala_upload_control","atala_upload_file","atala_upload_flex_area","atala_upload_single_file","atala_upload_multiple_files","atala_upload_flex_buttons","atala_upload_buttons","atala_upload_cancel_button","atala_upload_ok_button","atala_upload_add_button","atala_upload_files_header_name","atala_upload_files_header_size","atala_upload_files_header_status","atala_tile_column","atala_tiled_page_image","atala_tool_button_bookmarks","atala_bookmark_content","atala_bookmark_header","domattributes","atala_page_index","_newArrowCheck","innerThis","boundThis","DependencyChecker","_proto","checkDependency","dependency","requiredDep","requiredDependencies","dep","success","reason","depVersion","jquery","Clipboard","Jquery","JqueryUI","RaphaelJS","hasNewerVersion","dependencyVersion","requiredVersion","_this2","versionRegExp","parseVersionString","versionStr","_this3","depVersionNums","reqVersionNums","depVersionTail","checker","onFail","onSuccess","checkResult","checkDependencies","params","_this4","depChecker","logError","depName","console","logInfoOnSuccess","checkjQueryOnly","ui","checkRaphael","checkClipboard","LocalizationAnnotationStrings","menuDeleteButton","menuPropertiesButton","dialogButtonOk","dialogButtonReset","dialogButtonCancel","rectangleDialogTitle","textDialogTitle","ellipseDialogTitle","lineDialogTitle","linesDialogTitle","freehandDialogTitle","polygonDialogTitle","labelFillColor","labelFillOpacity","labelRotation","labelOutlineColor","labelOutlineOpacity","labelOutlineWidth","labelOutlineStartcapWidth","labelOutlineStartcapHeight","labelOutlineStartcapStyle","labelOutlineEndcapWidth","labelOutlineEndcapHeight","labelOutlineEndcapStyle","labelFontBold","labelFontItalic","labelFontColor","labelFontFamily","labelFontSize","radioButtonTrue","radioButtonFalse","valueStyleNone","valueStyleOpen","valueStyleBlock","valueStyleOval","valueStyleDiamond","valueWidthMedium","valueWidthWide","valueWidthNarrow","valueHeightMedium","valueHeightLong","valueHeightShort","LocalizationStrings","annotations","getMousePosition","ev","point","domObj","HTMLElement","event","MouseEvent","clientX","clientY","touches","offsetLeft","offsetTop","scrollLeft","scrollTop","offsetParent","getMousePositionJquery","ignoreWrongTarget","origEvent","originalEvent","offsetX","offsetY","pOffset","raphaelParent","parents","offset","parentNode","pageX","left","pageY","top","currentTarget","ownerSVGElement","bbox","getBBox","round","TouchEvent","elementFromPoint","touch","Features","Touch","jqTarget","eventPage","raphael","getSVGOffset","objSVG","parent","sOffset","CalcDistance","x1","y1","y2","old","highX","lowX","highY","lowY","dx","dy","right","bottom","rotateRect","rect","page","angle","w","h","height","width","rotatePoint","__rf","__ef","__sp","stopPropagation","__htmlTransformStyle","transform"," transform","-moz-transform","-webkit-transform","-o-transform","-ms-transform","__calcPathBounds","points","matrix","Utils_newArrowCheck","ParseInt","number","trimmedNumberStr","parsedNumber","IsInteger","num","isFinite","IsNumber","Statics","instanceCounter","DocumentStateManager_defineProperty","DocumentStateManager","viewer","currentThumb","isViewerActive","isThumbnailerActive","thumbnailer","activateThumbnailer","docInfo","link","config","force","isActiveThumb","detachViewer","isInitialized","switchDocument","activateViewer","closeDocument","MemoryTracker_defineProperties","MemoryTracker_defineProperty","MemoryTracker_MemoryTracker","MemoryTracker","settings","colorDepth","compression","highWaterMark","pageSize","extend","dispose","clearEntries","jqe","on","unbind","off","trigger","eventName","allocate","img","memoryEntries","bytesInUse","calcBytes","deallocateOldestEntry","dealloc","shift","deallocate","depth","watermark","Version","text_AnnotationTextRenderer","annData","fontUI","viewerPage","_self","_data","_font","_canvas","_span","_rtl","_separators"," ","-","?","\n","\t","annotationOwningPage","_lastRenderData","init","v","body","currentStyle","direction","getComputedStyle","defaultView","getPropertyValue","append","renderToDataUrl","applyTo","ctx","getContext","textToWrap","maxWidth","autoscale","words","prev","lastPos","substr","splitWords","prevWord","currWord","currLine","measureText","chars","pop","splitLines","lineHeight","lineCount","outline","offsetHeight","calculateLineHeight","fontSize","font","ctxfont","italic","family","fillStyle","color","textBaseline","longestLine","align","textAlign","scale","fillText","toDataURL","renderToDataURL","renderToSVGImage","svg","ld","setAttributeNS","AnnotationFontUI","txtObj","textAreaDom","fontData","underline","currentZoom","viewerZoom","minSize","Mobile","setData","cfg","repaint","jqTextObj","zoom","noAdjust","getAdjustedZoom","jqObj","txtDec","font-family","font-style","font-weight","font-size","text-decoration","getZoom","setZoom","text_TextAnnotationUI","wdv","ann","paper","cdata","textannomobilezoom","_Tself","_wdv","_Cdata","_Teve","getEventObject","_Tarea","_Ttext","_Tfont","_Thtml","_Tdata","_TprevValue","_editMode","_Tmargin","_TminBox","_TpageEvents","_TAnnoEvents","moving","__TannotationChanged","resized","moved","rotated","__TrepaintHtml","attrs","innerDom","background-color","border","overflow-x","overflow-y","-moz-user-select","-khtml-user-select","-webkit-user-select","user-select","resize","cursor","attr","focus","blur","ow","taw","tah","max-width","max-height","padding","text-align","tooltip","cornerradius","aobj","getObject","ry","__getResultTransform","toTransformString","__TrepaintHtmlImage","title","renderer","viewerTransform","getViewerTransform","_pageindex","annoTransform","getTransform","add","__Trepaint","__transformPoint","__Tconstruct","removed","showeditor","__Tshoweditor","hideeditor","__Thide","isEdit","atalaImage","isHtml","_page","vml","node","overflow","classList","contains","__ThtmlChanged","deselected","annObj","z-index","canvas","Chrome","Safari","readonly","prop","__TcreateEditor","show","setSelectionRange","textAnnotationEditorIgnoredKeyCodes","inArr","which","clonedData","getClonedData","prevanno","update","getPageIndex","annobefore","__TupdateView","backgroundColor","__Tchangepaper","box","getBox","tl","br","loc","mz","owz","mzo","rotation","getPageRotation","getFont","inEditMode","updateView","changepaper","AnnotationPointerHandler","_jqe","_touch","drawing","hold","pinching","tapped","touching","delta","origin","moves","__triggerEvent","__interactStart","__interactEnd","__onTouchStart","__touchingOneAnno","__clearHold","preventDefault","setTimeout","__detectHold","__detectDoubleTap","abs","clearTimeout","events","click","dblclick","mousedown","shiftKey","ctrlKey","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","AnnotationEventHelper","pObject","_Ejqe","_Eparent","_Ehandler","_Edp","mx","my","px","py","__EgetPagePosition","targetTouches","__EgetScreenPosition","screenX","screenY","__Etrigger","__EstartInteract","__EendInteract","__EdragMove","__EdragStart","__EdragEnd","__EhoverIn","__EhoverOut","__EpinchStart","__EpinchMove","__EpinchEnd","__EselectChange","__EcontextMenu","__Eshoweditor","__EonClick","__EonDblclick","__EonMouseDown","__EonMouseMove","__EonMouseOut","__EonMouseOver","__EonMouseUp","__EonTouchMove","__Eresized","__EonTouchStart","interactstart","interactend","pinchstart","pinchmove","pinchend","selectchange","contextmenu","annoresized","robj","st","drag","hover","undrag","unhover","annotations_AnnotationCustomRenderer","evtHelper","_constructor","_renderer","__serverConstructor","__serverRenderer","annObject","customurl","complete","__serverImageQueryReturned","construct","render","AnnotationDrawHandler","aData","cData","aEve","aSelf","aCustom","_Adata","_Aeve","_Aobj","_Atxt","_Acustom","_Aself","_draw","_sop","_mtx","_pinch","_initAnno","__drawMove","__updateClient","__getPosition","__getDocumentPoint","invert","newx","__onDrawStart","aObj","tObj","visible","__plotAnnotation","__updateClientPath","__sizeAnnotation","__updateClientEllipse","__updateClientRect","__repaint","__onDrawEnd","__onDrawMove","srcElement","main","__onUnbindEvents","zp","__plotEllipse","__plotPoints","_","dirty","nx","ny","nw","nh","aspectratio","cancelled","activepage","_index","button","__getResultTransformCommand","selfTransform","VML","drawstart","drawmove","drawend","dragstart","dragmove","base","translate","dragend","rect1","rect2","pbox","__pointInRect","viewchanged","annview","textview","t1","t2","srect","dist","deltaScaleX","deltaScaleY","newX","newY","newWidth","newHeight","_grips","drawStart","unbindEvents","KAPPA","kx","ky","cx","cy","ps","insertBefore","__fixLineCapsIE","commitTransform","scalex","scaley","_pathMtx","transformUI","__matrixFromData","annotations_Annotation","_Aboundeve","_Aglw","_Adraw","_Aclone","_bbox","multiview","movable","rotatable","resizable","selected","selectable","burn","username","opacity","startcap","endcap","verifyFontFamily","replies","extra","_Adefaults","_AuiEvents","__AbindEvents","__AtriggerEvent","__recalculateTransform","tmpMatrix","__AgetBox","rotate","__AresizeFinished","newL","__AgetTransform","__Atranslate","__AsetData","deep","oldRotation","__AsetDataInternal","diff","transformMatrix","newy","__onChangeRotation","__AmakeClonedData","viewOnly","__AtoggleSelected","triggerevent","_Aprev","anno","__AcompareDataImpl","clone","original","fieldsToCallRecurse","propName","__ADataFieldsForRecurse","__AupdateView","__Arepaint","isBound","bound","unbound","__Astringify","evt","pageindex","__AcreateAnnotation","_annos","__AbindUiEvents","evts","__AbufferRepaint","aType","drawn","boundEvents","notifyChanges","getJSON","toggleSelected","isCloneSource","sx","sy","_Arpnt","_Atic","__AunBufferRepaint","kvp","fill-opacity","stroke","stroke-width","stroke-opacity","_linewidth","addArrow","__AtranslateLineCap","href","baseVal","__AupdateTooltipView","cap","startDraw","annotations_AnnotationSelector","annos","pages","_pages","_selected","__select","select","fIndex","arr","__resolvePage","__deselectAllPage","inArray","__selectPage","__getClonedAnnotations","cloned","pgsrch","grep","pg","__selectAllPage","deselect","setAnnos","sAnnos","setPages","sPages","resolvePage","deselectAll","pi","deselectPage","getAnnotations","getSelected","selectAll","selectPage","LocalizationManager_defineProperty","LocalizationManager","SetLocalizationStrings","strings","_strings","LocalizationAvailable","GetAnnotationLocalizedString","_englishStrings","annotations_AnnotationPropertyDialog","divHostElement","contentElement","annotation","properties","capProperties","showProperties","dialog","cancel","reset","empty","walkData","resetGrips","okhide","actualprops","propChanged","pfx","shown","editorChanged","dataField","getAttribute","propertyValue","parseFloat","capitalize","dialogTitle","input","propertyEditor","addClass","labelStr","fnc","valType","editor","each","txt","change","inputValue","cvs","fillRect","rgba","getImageData","idx","ColorToHex","_focused","setName","createRadio","datafield","controlgroup","item","removeClass","float","checked","toUpperCase","isVisible","dialogButtons","minWidth","classes","ui-dialog","autoOpen","buttons","closeText","elements","maxHeight","btnHeight","_idx","updateControlsHeight","calc","__getTitleWidth","btnSetWidth","outerWidth","addition","__getButtonSetWidth","AnnotationPropertyDialog_newArrowCheck","beforeClose","keyCode","ESCAPE","keypress","ENTER","initialize","AnnotationGrips","_GhR","GripSide","RotationGripOffset","GripCursorSectorOffset","_Gd","ne","sw","se","_GLoc","_GSectors","_Ggrips","_paper","_Gselected","_Gannos","_GRotateGrip","_Gop","_GvR","_Grect","_initAnnos","_annoBeforeRotation","_Gevts","__Gupdate","__Ggrip","g","dir","grip","center","xcrisp","ycrisp","setAttribute","__GendBox","__GsizeBox","__GstartBox","__contains","__Gclear","__Gunbind","clear","__GupdateBounds","__GUpdateCursor","gd","__GsetCursor","xmid","ymid","__GplaceGrips","isSingleAnno","__GgetMousePos","po","so","__GRotateBox","atan2","PI","__GEndRotate","srcMatrix","docPt","__GpointToAnnoSpace","__GfitAnnos","__GisInsideSector","sectorStart","sectorEnd","areClockwise","v1","v2","circle","__GStartRotate","makeGripSector","dirStart","dirEnd","sector","gdirections","__GinitCursorSectors","__GInit","toFront","exclude","updateCursor","AnnotationController_newArrowCheck","controller_AnnotationController","AnnotationController","internals","_wdvInternals","_selector","_exposedApi","annotationclicked","annotationcreated","annotationdoubleclicked","annotationloaded","annotationsloaded","annotationmousedown","annotationmousedownleft","annotationmousedownright","annotationmousemove","annotationmouseout","annotationmouseover","annotationmouseup","annotationmoved","annotationrotated","annotationpinchresize","annotationrepainted","annotationresized","annotationrightclicked","annotationtouchend","annotationtouchmove","annotationtouchstart","annotationtextchanged","annotationchanged","layerinserted","layermoved","layerremoved","layerschanged","annotationscleared","annotationdeleted","annotationdrawstart","annotationdrawend","annotationdragstart","annotationdragend","raphaelloaded","selectAllOnPage","deselectAllOnPage","cancelDraw","__cancelAnnotationDraw","drawAnnotation","aConfig","callback","_controllers","mouseTool","setTool","__drawAnnotation","getFromPage","__getAnnosFromPagePublic","createOnPage","__createAnnotationPublic","deleteFromPage","__deleteAnnoOnPage","showEditor","__showTextAnnoEditor","hideEditor","setDefaults","__setAnnotationDefaults","setImages","__setImages","setStamps","__setStamps","insertLayer","sourceUrl","sourceIndex","__insertLayer","_publicEvents","srcurl","srcindex","removeLayer","layer","__removeLayer","moveLayer","destIndex","__moveLayer","destindex","scrollTo","callbackFunc","pageNum","__findFromClone","annoZoom","annTypes","annCenter","pointsX","pointsY","showPagePoint","createAnnotationOnPage","getAnnotationsFromPage","deleteAnnotationOnPageAtIndex","setAnnotationDefaults","__exposedApi","_wdvConfig","_config","_wdvReady","_vp","_menu","_menuConfig","_props","_matrix","activeanno","getPageScale","_defaults","_drawing","_drawReady","rightclick","mousedownleft","mousedownright","annocreate","annoload","__wdvInitialized","__initMenu","defaults","stamps","images","custom","__setCustom","__scroll","__zoomChanged","oldLength","__raphaelThrasher","raphObj","_trash","__pageShown","__showLayer","__clearPage","__setActivePage","__recyclePaper","__pageRotated","__repaintPage","__generateMenu","__menuHide","menuCopy","isEmptyObject","__wrapMenuMethod","propertiesMenuItem","deleteMenuItem","children","propDiv","__menuAnnoProperties","closest","prepend","menuLoc","__menuShow","menuConfig","menu","createMenu","mouseleave","func","__menuAnnoDelete","findex","__deleteAnnoAtIndex","__clearAnnotations","__createAnnotation","pgNum","annConfig","newAnno","redrawPageFromIndex","__bindAnnoEvents","clonedAnno","annIndex","delanno","annArray","pageIndex","_i","sConfig","__validateStampConfig","bConfig","_id","icon","span","createDropDownButton","onclick","createDropDownMenu","iConfig","cConfig","isPageInView","__doShowEditor","showPage","__clearAllSelection","configPrecedesDefault","__cancelAnnotation","__startAnnotationDraw","__prepareForDraw","__finishAnnotation","__annotationCreatedCallback","__annotationCancelledCallback","markers","markerCounter","$","ieSVG","foreignObject","__ERaddHtmlSVGInternal","forceImage","fobj","__ERcreateSVG","createElementNS","xmlNS","innerHTML","rsvg","skew","__ERvmlScalePos","location","__tsfm","bg","toFilter","__attr","block","classic","diamond","oval","substring","_g","doc","webkitTapHighlightColor","isEnd","refX","values","WDVarrows","endPath","endMarker","startPath","startMarker","randSuffix","pathId","markerId","getElementById","defs","stroke-linecap","use","marker","getElementsByTagName","markerHeight","markerWidth","orient","refY","xlink:href","startdx","getTotalLength","enddx","getSubpath","removeChild","__extendRaphael","scroll","pagerecycled","pageshown","zoomchanged","pagerotated","_state","initialized","typeOf","addDrawingSurface","zIndex","pageborderwidth","clearAllSelection","pageresize","setSize","pagezoom","clip","removeDrawingSurface","showLayer","createAnnotation","deleteAnnoOnPage","getAnnosFromPage","setCustom","__getDebugInfo","info","drawready","menuconfig","viewport","__linkAnnotations","linker","setViewPort","__cleanupDraw","__finishDrawing","__annotationCreated","__triggerPublicEvent","__selectAnnotation","reselected","serverrenderurlrequested","__serverRenderUrlRequested","annotationtextchangefailed","msg","pageDiv","url","__stringifyAnnotationData","__convertColorProps","col","getRGB","hex","__createHandlerRequest","serverUrl","annUrl","docurl","hRequest","serverurl","query","atala_annurl","atala_docurl","documenturl","atala_a_ofs","atala_a_len","layers","__makeHandlerRequestAsync","preserveExisting","__complete","docIndex","__onAnnotationsLoaded","makeHandlerRequest","annsLoadedEvt","customData","items","stringifyChanges","pageRotation","persistrotation","reverseZoom","halfWidth","halfHeight","dataAnnoTransform","targetCenter","stringifyAnnotationData","createHandlerRequest","loadAnnotationsUrl","docUrl","loadAnnotations","FormField_transformPoint","UploadControlCssClasses","FormField","fdata","fType","_Fdata","_jqebound","_obj","_clone","backgroundcolor","fieldname","hidden","isfieldrequired","locked","norotate","noview","nozoom","required","radius","vertical","horizontal","paddingtop","linespacing","ismultiline","ispassword","isrichtext","scrollable","maxlength","maximumfieldheight","preserveoverflow","checkbox","group","radio","textbox","leftPadding","rightPadding","signature","choice","_uiEvents","__setData","__makeClonedData","__updateView","__stringify","__offsetToRangeCharacterMove","element","__setTextSelection","selection","selectionStart","selectionEnd","range","createTextRange","startCharMove","collapse","move","moveEnd","moveStart","__createField","form","isPasted","scrollHeight","normalizedValue","textInputRange","endRange","isMaxLength","isMaxHeight","createRange","parentElement","moveToBookmark","getBookmark","compareEndPoints","currValue","pastedLength","remainder","multiple","itemkey","opt","manualTrigger","paddingTop","paddingBottom","margin","-webkit-box-sizing","-moz-box-sizing","box-sizing","__onFieldChanged","uncheck","__onFieldUnchecked","focusin","__onFieldFocusIn","focusout","__onFieldFocusOut","_fields","__getParentName","lastIndexOf","parentName","selectedOptions","multiviewFields","multiviewField","selectedIndex","itemIndex","optionIndex","__updateDefaultValue","field","__zoomField","fieldview","fieldTransform","visibility","underlined","borderStyle","borderBottomStyle","borderColor","fontFamily","fontStyle","oblique","fontWeight","highlighted","removeAttr","focused","defaultvalue","dpi","borderWidth","paddingLeft","paddingRight","setPageIndex","getParentName","getName","controller_FormController","FormController","forms","fieldclicked","fieldcreated","fielddoubleclicked","fieldloaded","fieldmousedown","fieldmousedownleft","fieldmousedownright","fieldmousemove","fieldmouseout","fieldmouseover","fieldmouseup","fieldmoved","fieldpinchresize","fieldrepainted","fieldresized","fieldrightclicked","fieldtouchend","fieldtouchmove","fieldtouchstart","fConfig","clonedField","fieldcreate","__deleteFieldPublic","__getFieldsFromPagePublic","insertForm","__insertForm","forminserted","formschanged","moveForm","__moveForm","formmoved","removeForm","__removeForm","formremoved","fields","activefield","_lastFieldFocusInEvent","load","genNamesPrefix","__multiPageFields","_form","__forceUnfocus","__recycleForm","__rotateForm","__updatePageFields","fieldIndex","delField","fieldArray","__clearForms","fieldConfig","newField","redrawVisiblePages","__bindFieldEvents","addFormLayer","createDiv","setActivePage","__zoomForm","removeFormLayer","__linkForms","createField","deleteFieldOnPage","getFieldsFromPage","drawField","__cancelField","__startFieldDraw","__finishField","__fieldCreatedCallback","pindex","fieldfocusin","fieldfocusout","__getMultiPageFieldNames","every","isLinkedToPage","fieldName","formUrl","atala_formurl","__onFieldsLoaded","fieldsLoadedEvt","pIndex","hasData","counter","fieldData","loadFormUrl","loadForms","FileUploadProgressHandler_defineProperty","FileUploadProgressHandlerImpl","filename","statusText","handler","isUploadStartEventData","fileinfo","uploadinfo","progressCounter","uploadedbytes","totalbytes","DragAndDropHandler_defineProperty","DragAndDropHandler_DragAndDropHandler","DragAndDropHandler","control","allowMultipleFiles","dragEffect","onDragEnter","enterLeaveLevel","calcDragEffect","dataTransfer","isDataTransferPresented","dropEffect","onDrop","processFiles","getFilesFromDataTransfer","resetState","onDragLeave","onDragOver","uploadRequested","types","some","DragAndDropHandler_newArrowCheck","processDragAndDropEvent","dragEvent","files","DragAndDropHandlerIE","_DragAndDropHandler","_proto2","UploadBaseControl_newArrowCheck","UploadBaseControl_defineProperties","UploadBaseControl_defineProperty","UploadBaseControl_UploadBaseControl","UploadBaseControl","controller","openFileDlgBtn","convertFileListToFilesArray","openFileForm","uiShouldBeClosedAfterUpload","finish","CancelButton","CloseButton","progressHandlers","container","Control","workArea","AreaContainer","uploadButtons","ButtonsContainer","openFileDlgChangeHandler","allowedDragAndDrop","allowedFileTypes","initArea","initButtons","allowDragDrop","closeUiAfterUpload","dragAndDropHandler","area","activate","callbackToManipulateParentUi","getControlDom","buttonsControl","Buttons","addButton","Button","AddButton","label","closeButton","cancelButton","abort","initAreaImpl","areaId","progress","caption","TextElement","initAreaContents","FileProgressImage","DragAndDropImage","FileProgress","DragAndDrop","reinitArea","passedFiles","filterFiles","addFilesToUi","alreadyAddedFiles","failedFileNames","bindEvents","fileuploadstarted","processProgressHandlers","fileuploadfinished","processFileFinishedUpload","fileuploaderror","fileuploading","uploadfinished","handleUploadFinished","controlParent","_this5","reinitNeeded","switchButtonEnabledState","convertSize","sizeInBytes","sizeModIdx","addProgressHandler","jqTextElem","removeProgressHandler","_this6","ph","cancelUpload","_this7","filesArr","buttonClass","enable","command","isFileSuccessEventData","filepath","UploadMultilpeFilesControl_newArrowCheck","UploadMultilpeFilesControl_assertThisInitialized","UploadMultilpeFilesControl_defineProperties","UploadMultilpeFilesControl_defineProperty","UploadMultilpeFilesControl_UploadMultipleFilesControl","_UploadBaseControl","UploadMultipleFilesControl","markStatusFinished","errorinfo","canceled","rowTemplateField","getFileRowTemplate","AreaMultipleFile","AreaMultipleFileDragDrop","AreaNonTable","initFilesTable","headersRow","MultipleFilesHeaderRow","headerName","MultipleFilesHeaderName","MultipleFilesHeader","headerSize","MultipleFilesHeaderSize","headerStatus","MultipleFilesHeaderStatus","table","okButton","OkButton","uploadFiles","after","fl","_this$files","_this$table","fileRows","addRowToFilesTable","file","fileName","tableRow","rowTemplate","MultipleFilesCellName","MultipleFilesCellSize","removeFileUpload","MultipleFilesCellCancelButton","addFinishHandler","uploadElems","removeFileButton","statusTextElem","cancelUploadBtn","upCtrl","ctrl","MultipleFilesRow","MultipleFilesCell","MultipleFilesCellStatus","showLabel","UploadSingleFileControl_assertThisInitialized","UploadSingleFileControl_defineProperty","UploadControllerState","UploadSingleFileControl_UploadSingleFileControl","UploadSingleFileControl","UploadSingleFileControl_newArrowCheck","uploadProgressSpan","uploadProgressImage","AreaSingleFile","AreaSingleFileNoDragDrop","uploadFile","UploadController_newArrowCheck","UploadController_defineProperties","UploadController_defineProperty","UploadController_UploadController","UploadController","wdvInternals","Idle","enabled","Uploading","hasErrors","wasCanceled","Canceling","abortActiveRequests","uploadControl","eventData","_eventData","tryToFinishUpload","status","message","uploaded","total","uploadingFilesWithFilename","uploadingFiles","uf","uploadingFile","sendRequest","wdvUploadConfig","upload","allowmultiplefiles","allowedfiletypes","allowdragdrop","allowedMaxFileSize","allowedmaxfilesize","uploadPath","uploadpath","uiParent","filesUploadConcurrency","filesuploadconcurrency","closeuiafterupload","uploadWithUi","checkControllerState","checkIfUploadDisabled","checkFilesToUpload","checkUploadPath","checkCallback","fireUploadStartedEvent","uploadFileOnServer","filesToUpload","startFileUpload","uploadCallback","uploadParams","atala_upath","atala_subpath","fileUploadParams","atala_filename","atala_filetype","onFileUploadStarted","jqxhr","onFileUploadFinished","onFileUploadFailed","onFileUploading","onUploadStarted","throwError","File","checkAlreadyAddedFiles","onUploadFinished","filterFilesPublic","failedFiles","failedFn","filenames","filesLength","rejectReason","fileIsAlreadyAdded","fileNamesLength","lastFilenamePart","fileExt","fileType","fileTypeFound","_j","ft","ftParts","fileTypeParts","onFileAddedToUpload","_this8","getUploadControl","createUploadControl","uploadControlField","DocumentController_newArrowCheck","DocumentController","ManipulationController","viewerId","_viewerId","pageinserted","pageremoved","pagemoved","documentchanged","insertPage","__insertPagePublic","insertPages","__insertPagesPublic","removePage","__removePagePublic","removePages","__removePagesPublic","movePage","__movePagePublic","movePages","__movePagesPublic","rotatePage","__rotatePagePublic","rotatePages","__rotatePagesPublic","__getPageRotation","getPageReference","__getPageReferencePublic","getBookmarks","__getBookmarksPublic","getChildBookmarks","__getChildBookmarksPublic","scrollToBookmark","__scrollToBookmarkPublic","removeAllBookmarks","bookmarks","disableBookmarkButton","changes","mapping","inserted","vector","changed","__onDocumentInfoChanged","delayedError","__throwError","delay","__checkPageMapping","__createEmptyMapping","__initPageMapping","__ensureViewState","viewerstate","fitmultiplier","pageref","__getPageFitMultiplier","__insertPage","sourceUri","sourceMapping","sourceRef","uri","mapsto","__removePage","__onPageShown","__onPageRecycled","ref","srcuri","srcUri","srcIndices","checkedIndices","uriFromParameter","__checkIndices","Number","MAX_VALUE","pageRefs","notAReference","refsFromIndices","numbers","_this10","notANumber","__validateNumbers","checkedPageRefNumber","checkPageReferences","destIdx","__checkDestIndex","destIndxB","batchoperation","srcIdx","dest","Page","__updateBookmarksOnInsert","indices","__checkSrcIndices","sort","__removeChildBookmarks","__removeBookmarksToPage","checkedSrcIndices","checkedDestIndex","destShiftDirection","_loop","arrIdx","srcIdxShift","destIdxShift","elem","__updateBookmarksOnMove","shiftedsrcindex","angles","angleIsNumberOrString","checkedAngles","anglesToCheck","isNumberOrString","__checkNumbers","checkAnglesFunc","pageIdx","pageAngle","_img","startDomManipulation","adjustVisiblePages","endDomManipulation","__rotatePage","bookmark","Parent","__pushBookmarkToArray","__addToParent","last_element","Children","Top","Left","initRotation","PageRotation","parentId","newId","__addChildBookToArray","book","bPoint","forcepagefit","__getPageSize","topDpi","leftDpi","pagesizes","moveOperation","checkForRepeat","maxIndex","delayErr","outOfRange","repeated","errName","indicesArr","_this9","getPageDefinition","cacheIndex","setPageCacheIndex","getPageFitMultiplier","setPageFitMultiplier","getPageSize","setPageSize","updatePageText","pageData","getPageText","initDocumentText","getPageIndexByImageIndex","canBeTiled","threshold","realIndex","pagesize","__linkChanges","_changes","getPageCount","pagecount","pagescount","documentinfochanged","TextController_newArrowCheck","controller_TextController","TextController","_internalEvents","pagetextloaded","textselected","__getSelectedText","copySelected","__copySelectedText","selectPageText","__selectPageText","fail","deferred","Deferred","__ensurePageTextLoaded","__getPageData","regions","regionText","__getRegionText","resolve","reject","promise","clearSelection","__clearSelection","resetPageText","__resetPageText","reloadPageText","isPageTextLoaded","loading","__search","searchOnPages","__searchOnPages","Tolerance","__makePoint","originPage","rectangular","selectionCache","searchQuery","_text","__getDrawContext","searchResult","__highlightPageSearchResults","sel","word","__highlightRegion","bounds","__recyclePage","__clearSelectionUI","__resizeTextLayer","__onDocumentChanged","__clearSearchResults","region","__getMinimalSelectingRectangle","__selectSingleRegionText","mousetool","hookcopy","_dom","findPageFromIndex","__clearText","preserveSearch","getSourcePageSize","clearRect","__onSelectionStart","__createEmptySelection","interval","selectLine","selectWord","isWithinRect","__selectExactMatch","__selectHitObject","viewerPoint","handled","textselectstart","textselectmove","__onSelectionMove","textselectend","__onSelectionEnd","removeTextLayer","addTextLayer","createDOM","__linkText","ensurePageTextLoaded","wait","context","timeout","lastExecuted","continuation","throttledSelect","throttlingtreshold","Date","getTime","now","remaining","pt","rotatedRegions","selecting","__onSelectionCopy","dummyEl","cb","destroy","onClick","__getLineText","lineText","__wordsSeparated","glyphs","__findPage","selectionLine","selectionRegion","endWord","hasGlyphs","glyph","__makePartialWord","endGlyph","__insertSelectionRegion","regionIndex","__selectRegionText","startPage","startPoint","endPage","endPoint","pageFrom","pageTo","topLeft","bottomRight","__selectPageRectangularArea","__selectSinglePageText","startRegion","endRegion","__isSelectionChanged","regionsSelection","point1","point2","__ensureRect","pageLine","firstRegion","lastRegion","isIntersects","__isRegionBefore","__isRegionAfter","tmp","fakeRegion","__makeFakeRegion","__getRegionTextStart","__getRegionTextEnd","__findSelectionRegions","pageBounds","greater","lineBounds","__getNormalizedBounds","midLine","less","topLine","isBetween","bottomLine","prevLineNormalBounds","nextLineNormalBounds","wordBounds","included","part","__selectPartialWord","startGlyph","glyphBounds","normalizedBounds","omitSpace","last","docSpaceStart","docSpaceEnd","__intersect","normalizedRect","startWithin","endWithin","verticalCenter","colorSettings","globalAlpha","alpha","__pointsEqual","testRegion","isContained","intersection","list","activePage","pageCount","errorThrown","pageIdxCheck","idxName","idxIsString","checkedStartPage","checkedEndPage","checkedActivePage","sourceQuery","toLocaleLowerCase","active","__CSearchIterator","_iterator","isValid","awaitedPromise","maxSearchAhead","currentPage","pageMatch","pageTotal","unloadedPagesCache","requestsQueue","_current","__makeMatchInfo","__next","action","__advancePosition","__makeStateShiftCallback","__executeNextRequest","request","forward","__isValid","textRotation","pagePoint","__findNextMatchPage","isActive","__disposeIterator","wrapped","haveUnloaded","__searchPage","__makeContinuationForLoadingPage","__searchUnloadedPage","then","searchInterval","searchLimit","startPageindex","docTextUrl","textUrl","pageDef","queryItem","di","__getServerSearchInterval","atala_query","atala_maxcount","atala_pages","response","foundPage","searchResults","__onPageTextLoaded","pageText","pageRef","foundPageData","queryLength","charPosition","rectangles","startIdx","startRect","endIdx","endRect","__onNewPageLoaded","__searchPageShown","next","getQuery","isSearching","getCurrentLineText","matchPages","ocr","__onTextLoaded","__validateTextPage","texturl","atala_index","__triggerInternalEvent","setTransform","__validateTextObject","__validateTextRegion","r1","r2","linesCount","__validateLine","regionRotation","__validateWord","os","boundsData","pageObject","pageRect","p2","loadText","loadPageText","textselectcopy","mousetools_PointerTool","_pointer","zooming","textselection","prpt","_priTool","_secTool","_boundTarget","__onAnnotationDrawStart","__onAnnotationDrawEnd","__onPinchBuffer","__startPan","prmt","addEventListener","__movePan","__stopPan","removeEventListener","__startTextSelection","toolEvent","__stopTextSelection","__onDocMouseMove","__moveTextSelection","charCode","__copyTextSelection","__startSelect","_binds","__moveSelect","__stopSelect","ondrag","__onClick","__onClickEvent","__onDblClick","__onContextMenu","__onContextMenuEvent","__onMouseDown","__onMouseDownRight","__onMouseDownLeft","__onMouseDownEvent","__onMouseMove","__onMouseMoveEvent","__onKeyDown","__onKeyDownEvent","__resetMouseEvents","__onMouseOut","__onMouseOver","__onMouseUp","__onMouseWheel","mousewheel","keydown","__onTouchMove","__onTouchEnd","tPri","tSec","__clickZoomIn","__clickZoomOut","getTool","primary","secondary","pauseTool","resumeTool","__clickZoom","zoomOut","zoomout","__touchingSameObject","__onPinchStart","__onPinchMove","tPoint","controller_ToolController","eObject","sObject","_jqeInternal","SelectScrollTimeout","_scroller","_primaryToolBackup","_secondaryToolBackup","_tool","_zoom","_rp","_cursor","_custom","_flickPoints","_scd","_activePage","_uses","_scrollTimeout","allowflick","scrolltriggerarea","innerscrolldelta","outerscrolldelta","_events","__onViewPortClick","__setTool","priTool","secTool","newPrimaryTool","newSecondaryTool","resetDrawLayer","__setCursor","showselecttools","raiseDrawLayer","mtc","__onFit","fit","__onClickZoom","zoomIn","__onPanStart","stop","__onPanMove","time","__onPanEnd","dt","animate","__onSelectStart","getActivePage","_rubberband","startSelect","__onSelectMove","moveSelect","__onSelectEnd","endSelect","zoomToSelection","__onZoomStart","zoomStart","__onZoomMove","__onZoomEnd","zoomEnd","__onTextSelectStart","__getMouseTextEventArgs","altKey","clicks","detail","__onTextSelectEnd","__onTextSelectMove","__clearScrollTimeout","__onSelectionScrollTimeout","__onTextSelectScroll","__onTextSelectCopy","viewportOffset","positionContainer","viewportWidth","viewportHeight","topDelta","leftDelta","__getMouseEventPageIndex","__getMousePosition","clickzoom","panstart","panmove","panend","zoomstart","zoommove","zoomend","selectstart","selectmove","selectend","zoomareastart","zoomareamove","zoomareaend","textselectscroll","viewportclick","flick","resourcepath","flickdelay","scroller","tool","toolcursors","tooltypes","setCursor","setCustomCursor","mousetools_RubberBandTool","_toolTip","fg","RubberBandZindex","animated","backcolor","forecolor","multicolor","showgrips","showmask","showtooltip","rectback","mask","animating","boundevents","changing","colorswap","pageoffset","vert","horiz","_clipper","__onPageSizeChanged","__updateState","__updateRectangle","__onPageZoomChanged","__Grips","_c","_gva","_gsw","_gsh","__Grip","__Gshow","_i5","__GshowGrips","_i6","__GsetEvents","__getMovable","onmousedown","__move","_i7","__getResizable","onResize","_gr","_gs","_$grip","_Gself","_di","_gv","__GsetColors","__getMultiColor","__getBackColor","__getForeColor","__GsetGripSize","setPos","__getShowGrips","resetColors","resetGripSize","__stopPropagation","np","resizebinds","__resizeRubberBand","__finish","__resize","onselectstart","onselect","oncontextmenu","setRectangle","_i2","_i3","_i4","showGrips","resetEvents","__createDOM","did","ihtml","dom","__createBand","band","__createMask","background","__getAnimated","__hideMask","__drawTooltip","__show","__animate","__hide","iw","ih","rw","rh","__getScaledPageWidth","__getScaledPageHeight","__sizeRubberBand","ep","movebinds","__moving","mp","cancelBubble","getSize","getFitZoom","getAnimated","getAspectRatio","getBackColor","getForeColor","getHeight","getMovable","getMultiColor","getPosition","getRectangle","getResizable","getShowGrips","getShowMask","getShowTooltip","getVisible","getWidth","synchronize","maxZoom","getMaxZoom","newZoom","vps","getViewportSize","fitzoom","getFitMultiplier","fullzoom","npx","npy","getPageOffsets","WebDocumentViewer_newArrowCheck","WebDocumentViewer_WebDocumentViewer","openCallback","allowAnnotations","allowText","_isThumbnailer","_isSinglePageMode","singlepage","_zmd","_iconClass","_garbage","maxTilesPerEdge","tilingThreshold","_stateManager","__isReady","__switchDocument","__closeDocument","toolbar","content","scrollH","scrollV","edges","loadedImgs","pageDivs","pageLabel","uploadCtrl","memory","sizes","smallest","numberoutof","buffer","prpr","newpagedivsize","newpagedivfullzoom","scrollPos","scrollBuffer","scrollTimeout","nextImageCacheIndex","scrollTarget","itch","_bookmarkState","expanded","beforehandlerrequest","documentloaded","activedocumentchanged","documentsaved","documentunloaded","pagenumberchanged","pagesizechanged","scriptsloaded","statusmessage","zoomstarted","uploadstarted","fileaddedtoupload","allowannotations","allowforms","allowtext","saveusername","columns","annotationsurl","formurl","fitting","forcepagesize","jpeg","maxwidth","memorythreshold","minwidth","pagebuffersize","maxpagebuffersize","pagespacing","pageselectlocation","rows","savefileformat","savepath","savepreviouslysigneddocument","scripturl","showbookmarks","showbuttontext","showpageborder","showpagenumber","showpagenumbertooltip","showerrors","showstatus","showscrollbars","tabular","toolbarparent","showthumbcaption","thumbcaptionformat","showrotatetools","allowsearch","wrapsearch","searchdelay","toolbarbuttons","localization","tiling","__validateNumber","__validateMouseToolConfig","__validateUploadConfig","__validateConfig","__onMemoryUsageExceeded","__garbageCollectObject","_cacheIndex","__onPageDivsResized","sizechanged","__resizeScrollBars","refPage","newSH","__getPageOffsets","__adjustEdgeHeights","__setScrollPositionAsync","newSW","__adjustEdgeWidths","__recalculateMaxDocumentSize","propagationPaused","_ratio","pauseEventPropagation","__calculatePageDivCount","__getMinZoom","__onSharedPageSizeChanged","documentController","fitSize","oldSize","oldFit","newSize","__onReady","__onResize","__onScroll","__createPageDivs","nodeName","attributes","__toolbarTriggerWrapper","ex","__status","__throwErrorChild","__createDiv","__createDrawLayer","draw","reflow","__createToolbar","tConfig","tray","trayid","__createButtonFromConfig","cls","__createMenu","mConfig","ul","li","__createDialog","__createDropDownButton","annoToolbar","__createButton","btnAbove","min-width","at","of","__createDropDownMenu","elm","btncfg","btn","menuList","__createMenuClickFunc","clickEvent","__bindEvents","bid","bc","btt","btxt","evtTrigger","toolbarEventTrigger","__CSearchBox","inputBox","styles","clearable","onclear","inputEmpty","searchTimeout","__onInputChange","__updateMatchIndicator","__getCurrIndex","__onNextMatch","__suspendUI","__onClearSearch","__onInputKeyUp","__onSearchPrev","__onSearchNext","__ClearSearch","__onClearClick","suspended","__toggleStyle","__makeButtonHandler","__togglePointer","offsetWidth","getBoundingClientRect","input propertychange","buttonsSpan","__initDom","ClearSearch","__enableZoomAreaTool","__createRotateHandler","selectedPages","__getSelectedPagesIndices","pageRotations","currentValue","__getPageScale","__isLocationEquals","anchor","__showPagePoint","tmpId","__generateID","__createEdge","eid","cont","minBuffer","pgSetActivePage","__getViewportSize","__getMaxZoom","__raiseDrawLayer","__resetDrawLayer","__deletePage","__createPageImageAsync","_CPimg","_CPcallback","Image","reZoomThreshold","_loadParams","atala_cb","_domEl","_CPbinds","__CPimgLoaded","__CPcompleted","__getPageIndex","_loaded","__CPimgUpdateSize","__CPimgGetDom","__CPgetFitMultiplier","__CPgetFitZoom","__CPgetSize","__CPgetSourceSize","_viewrotation","__CPimgSwapSizeSides","__CPgetScaledSize","__CPimgNaturalHeight","_tiled","naturalHeight","__CPimgNaturalWidth","__CPimgLoad","reqZoom","reqAngle","_rotation","_params","atala_doczoom","atala_thumbpadding","atala_angle","atala_jpeg","__pageCanBeTiled","reqZoom1","sourceSize","__closeToEqual","reducedThreshold","srs","__shouldBeTiled","reqSize","_vps","numOfTilesV","numOfTilesH","tileSize","_tilesV","_tilesH","__interruptFurtherTiling","_domAnchor","_oldCPimg","replaceWith","__CPcopyPropsFrom","column","tileplace","tileimg","_needToInsert","__tileRequests","__tilesArray","startTile","sqDist","pointa","pointb","tile","tilestartx","tilestarty","tilewidth","tileheight","X","Y","newparams","atala_tilestart","atala_pagesize","_reqzoom","_reqangle","__loadTiledImage","tileindex","tilesize","tileRequest","hIndex","vIndex","param","onload","scaledSize","domAnchor","oldCPimg","__makeHandlerRequest","__zoomFinished","__CPimgRotateView","fitZoom","__CPimgNeedsZoom","__CPimgZoomAsync","oldCP","_prevzoom","_scaledzoom","_size","__CPimgDispose","needsZoom","getScaledSize","needsRotate","__CPimgNeedsRotate","__CPimgRotateAsync","getDomElement","invalidate","__CPimgInvalidate","naturalWidth","__CPimgResetDomSize","oldZoom","__CPimgFit","__CPimgScale","ani","isEmpty","duration","easing","__CPimgZoomed","queue","alreadyScaled","dw","dh","prevzoom","physicalSize","viewSize","widthPreserved","heightPreserved","iheight","iwidth","__CPimgRotateTiledView","__findPageFromIndex","_num","destSize","__CPimgCalculateFit","__callFunctionArray","reqangle","__CPimgTiledUpdateSize","oldImg","isize","ni","srcSize","bSize","margins","border-bottom","border-right","border-top","border-left","margin-bottom","margin-right","__CPimgInit","__createScrollbar","sd","scrollTip","scrollbar","explicitSize","__SBhideToolTip","_tooltip","_pagenum","__isPageInView","__showPage","__redrawVisiblePages","__SBpageNumberFromPos","__getUIIndexFromPos","_max","_tray","idiv","rv","clientWidth","__getScrollbarWidth","_explicitSize","__extendScroller","_scrollSize","scrollbarHeight","clientHeight","scrollSize","ratio","_timeout","tooltipCss","outerHeight","scrollWidth","__resetScrollbarTimeout","sEvent","resumeEventPropagation","_pauseEP","resumeAfterScroll","psz","__getClientPageDivSize","_this12","observerTimeout","setInterval","clearInterval","observer","ResizeObserver","unobserve","observe","__startObserver","pdc","hdc","vdc","n1","n2","cps","__getClientPageSize","__getIndexFromPos","maxSize","__getMaxDocumentSize","vs","__getDomOffsets","ret","_maxDocSize","zero","offsets","__getPageRangeOffsets","startOffset","__getTabularPageOffsets","endOffset","__getTabularPageRangeOffsets","pgcount","retSize","tmpH","tmpW","cols","__getTabularIndexOffset","row","pageSpacing","__getServerPageSize","extraRotation","__failStartAsync","failed","started","__isObjectInRect","le","te","be","__moveArrayIndexTo","__trackEventBinds","bindargs","evtDictionary","fcn","evtParent","dur","fillSize","mSize","fSize","when","__scrollNextPrevAsync","inc","__adjustScrollBars","__adjustSecondaryScrollbar","pnarg","newH","__adjustScrollbarVisibility","_pnarg","newW","__setPageNumber","cs","plength","scrollShifted","dn","startIndex","endIndex","pagesOutOfSync","__showNext","__showPrevious","__showPageAsync","__adjustVisiblePages","ox","oy","sbX","sbY","scrollComplete","__scrollBuffer","thumbpadding","sIndex","eIndex","tabularOffset","startEdgeOffset","lastVisibleDivSize","clientPageDivSizeArg","lastDocumentPageSize","visiblePagesOffset","endEdgeOffset","docWidth","__getActivePage","__showPageAtIndex","__pausePageRequests","newIndex","__getRecycledPage","__removePageContents","__insertPageContents","__requestPageAsync","__resumePageRequests","_next","trailing","pageNumber","pagenum","scrollNeeded","resumecallback","sH","sW","__emptyPages","_sH","_sW","si","_j2","incH","activeElement","detach","delayInsert","nullinserted","__ariaLabel","pageAnchor","destWidth","destHeight","__initializeObjectToPageSize","suppressScroll","__silentReloadPage","pageDefinition","pageDeferred","pageInfo","cimg","retPage","showPagePointImpl","locationOffset","__bkm_index","resizeTimeout","__startDomManipulation","__endDomManipulation","pgInViewIndex","__zoomStart","__zoomInstant","cpo","cpoz","rpx","rpy","__zoomOffsetEdgeAsync","__zoomEnd","__setZoomAsync","pn","_this11","__zoomAsync","__edgeZoomed","_z","arrElem","nv","aniCfg","__updateEdgeBackgroundPlaceholders","isVertical","cellSize","lineWidth","strokeRect","backgroundMargin","backgroundSize","backgroundRepeat","adjusts","needToCallback","adjustsCompleted","spacer","__fitAsync","docFit","__calculateDocumentFitting","nZ","nox","noy","stripeSize","viewportStripeSize","__getViewerTransform","viewAngle","inver","dxSrc","dySrc","btnConfig","defaultAnno","__onAnnotationDrawn","__onAnnotationCancelled","__annotationsAllowed","pagewidth","pageheight","multiprocessing","formsurl","__disableBookmarkButton","__invalidateDocument","pagenumber","thumbLink","closeView","__clearUI","__loadDocumentInfoAsync","atala_pagebuffer","atala_minwidth","atala_tiling","atala_bookmarks","atala_thumb","atala_capt_format","__onDocumentInfoLoaded","xhr","txtStatus","err","responseText","__onDocumentLoadError","errorType","licensed","colordepth","visiblePage","__saveDocumentAsync","atala_spath","__onDocumentSaved","jqXHR","__processRequestUrl","rurl","__beforeAnnotationsDataRequest","__beforeFormsDataRequest","formsloaded","__onFormsLoaded","__redrawPage","__redrawPageFromIndex","__unbindEvents","_success","_error","anon","_this13","handlerHook","handlerreturned","ajax","dataType","crossDomain","requestData","formData","FormData","contentType","processData","parse","_this14","XMLHttpRequest","lengthComputable","loaded","__emptyAsync","preserveCache","__emptyImages","backgroundImage","__scrollNextAsync","__scrollPreviousAsync","__zoomInAsync","__zoomOutAsync","__openUrlAsync","requests","infoRequested","annRequest","formRequest","formsRequest","requestCompleted","__saveChanges","subpath","saveformat","saveParams","atala_sformat","atala_iuname","atala_annos","atala_forms","atala_document","atala_savesigned","parameters","__outsideClickListener","selector","__collectBookControlState","__removeClickListener","__viewPortClickListener","debug","controllers","__getViewerLink","lnk","stateManager","__updatePageSize","isReady","scrollBy","previous","openUrl","OpenUrl","save","filterFilesForUpload","filteredFiles","getCurrentPageIndex","getDocumentInfo","setMouseTool","isPageLoaded","reloadPage","annotationDeferred","formsDeferred","annotationsUrl","formsUrl","showPageNumber","_document","createDialog","throwerror","pagedivsresized","mainToolbar","tconfig","unshift","_this15","__showUploadUi","_this16","bookmark_list_id","bookmarklist","main_ul","appendBookmarkItem","_this17","_generateID","nestedul","querySelector","toggle","childBookmark","_li","_anchor","_id2","ulElem","toggleClass","one","__showBookmarksUI","reverse","tlbBtn","__createMainToolbar","touch-action","-ms-touch-action","Compatibility","exceededhighwatermark","white-space","__preInit","Thumbnailer_newArrowCheck","_objectSpread","EntryPoint_defineProperty","Utils","Annotations","Controls","Logger","wdvControls","WebDocumentThumbnailer","__reloadPageViewer","__reloadPageBase","_viewer","_cin","_cinDragDropTemp","_thumbEvents","_viewerLink","_thumbLink","dragdataKey","sortableWidgetFullName","sortableWidgetDeprecatedName","draggableScrollParentWrapperKey","scrolling","dragdropping","api","selfapi","_thumb","divsize","zoomfull","dragdelay","selectedindex","hovercolor","selectedcolor","selectedhovercolor","selectionmode","selecteditemsorder","_thumbCfg","thumbselected","thumbdeselected","thumbdragstart","thumbdragend","thumbdragcomplete","__getStateManagerApi","__detachViewer","__activateViewer","__bindViewer","reverseSelfAction","__onViewerRequest","__onViewerLoaded","__onViewerScroll","__onViewerPageRotated","__onViewerPageInserted","__onViewerPageRemoved","__onViewerPageMoved","__onViewerDocumentChanged","__subscribeEventsRetrigger","__onViewerAnnotationUpdated","__onViewerAnnotationCreated","__onViewerAnnotationDeleted","bindConfig","__retriggerEvent","__isControllingViewer","needRebindViewer","docStateInfo","__copyJsonDataToArray","__replaceApi","linkedApi","thumb","vdw","__reloadPageWrapper","repaintSelectionState","formsData","__extractObjectPropertyKeys","linkDescription","targetApiCache","thumbsize","__setThumbSize","__onThumbsLoaded","__validateColor","__getDebugInfoBase","cin","links","__scrollToThumb","__emptyBase","getSelectedPageIndex","getSelectedPagesIndices","selectThumb","__selectThumb","deselectThumb","__deselectThumb","__dispose","__disposeBase","surl","aurl","furl","jqo","thumbInitialized","__openUrlBase","isControllingViewer","jqoPrev","__repaintThumbSelect","__updateUIOnSelectOrDeselectThumb","vpin","cpin","__onViewerScrolled","thumbargs","viewerArgs","__preparePageDivs","__fitContentToGrid","portrait","imgHeight","imgWidth","imgSide","pagedivsize","minHeight","halfSize","sortable","containment","connectWith","placeholder","cursorAt","distance","helper","__thumbDragHelperFactory","scrollSensitivity","scrollSpeed","__onThumbDragStart","receive","__onThumbExternalReceive","__onThumbDragEnd","over","__onThumbDragOver","__onThumbDragChange","tolerance","__onThumbsReordered","__scaleThumb","imgSize","sSize","sWidth","sHeight","nz","marginLeft","marginTop","__changeThumbColor","scolor","bcolor","__JQueryObjectWrapper","initialParent","me","_initial","_actual","setObject","draggedItems","hasClass","__getDraggedPageDivs","stackSize","draggedItem","imageAnchor","scrollParent","widgetInstance","pageIndices","jqdiv","__findPagesIndices","dragData","updateHandled","thumbId","externalDropIndex","insertAfterSelf","dragindex","dragindices","scrollableWrapper","placeholderPredecessor","dropZone","itemPositionCenter","droppedInside","__getDropIndex","eventArgs","dropindex","sourcedocument","external","pagerefs","__ensureDragCompleteUI","sender","startDivIndex","copyannotations","startNum","dragState","preDropPage","divBeforeDrop","firstPage","firstVisiblePage","mainArr","validDefault","dColor","dummy","__onThumbUnHide","__reorderPageIndexes","thumbTargetPage","__isThumbShown","thumbAnns","adata","__onThumbAnnosLoaded","__onThumbFormsLoaded","__onThumbContextMenu","menuCfg","__onDocumentLoaded","viewerCallback","__onThumbHoverIn","__onThumbHoverOut","__onThumbClicked","clicked","clickedIdx","shiftPressed","ctrlPressed","Platform","metaKey","lastClicked","__updateThumbnailSelection","__fakeMouseEvent","eType","eButton","changedTouches","mouse","createEvent","initMouseEvent","dispatchEvent","__onThumbTouchStart","__onThumbTouchMove","__onThumbTouchEnd","__onThumbScroll","__onThumbShown","_caption","textOverflow","whiteSpace","__onThumbResize","__onThumbsStatusMessage","__onThumbZoomChanged","thumbscale","__onThumbZoomStarted","__onThumbZoomFinished","__onThumbPageSizeChanged","viewportunhide","zoomfinished","scrollToThumb","mouseenter","WebDocumentViewer","isCommonJS","isAMD","isAtalasoftGlobalExist","Atalasoft","AnnotationTypes"],"mappings":"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","file":"atalaWebDocumentViewer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"raphael\"), require(\"jquery-ui\"), require(\"clipboard\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\", \"raphael\", \"jquery-ui\", \"clipboard\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Atalasoft\"] = factory(require(\"jquery\"), require(\"raphael\"), require(\"jquery-ui\"), require(\"clipboard\"));\n\telse\n\t\troot[\"Atalasoft\"] = factory(root[\"jQuery\"], root[\"Raphael\"], root[\"jQuery\"][\"ui\"], root[\"ClipboardJS\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__31__, __WEBPACK_EXTERNAL_MODULE__67__, __WEBPACK_EXTERNAL_MODULE__68__, __WEBPACK_EXTERNAL_MODULE__69__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 125);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(2);\nvar getOwnPropertyDescriptor = __webpack_require__(24).f;\nvar hide = __webpack_require__(15);\nvar redefine = __webpack_require__(19);\nvar setGlobal = __webpack_require__(44);\nvar copyConstructorProperties = __webpack_require__(91);\nvar isForced = __webpack_require__(49);\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      hide(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports = typeof window == 'object' && window && window.Math == Math ? window\n  : typeof self == 'object' && self && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar store = __webpack_require__(26)('wks');\nvar uid = __webpack_require__(46);\nvar Symbol = __webpack_require__(2).Symbol;\nvar NATIVE_SYMBOL = __webpack_require__(77);\n\nmodule.exports = function (name) {\n  return store[name] || (store[name] = NATIVE_SYMBOL && Symbol[name]\n    || (NATIVE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !__webpack_require__(1)(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nmodule.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DESCRIPTORS = __webpack_require__(5);\nvar IE8_DOM_DEFINE = __webpack_require__(71);\nvar anObject = __webpack_require__(4);\nvar toPrimitive = __webpack_require__(25);\nvar nativeDefineProperty = Object.defineProperty;\n\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toInteger = __webpack_require__(20);\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toAbsoluteIndex = __webpack_require__(34);\nvar toInteger = __webpack_require__(20);\nvar toLength = __webpack_require__(9);\nvar toObject = __webpack_require__(23);\nvar arraySpeciesCreate = __webpack_require__(53);\nvar createProperty = __webpack_require__(52);\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\nvar SPECIES_SUPPORT = __webpack_require__(28)('splice');\n\n// `Array.prototype.splice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n__webpack_require__(0)({ target: 'Array', proto: true, forced: !SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DOMIterables = __webpack_require__(102);\nvar forEach = __webpack_require__(103);\nvar hide = __webpack_require__(15);\nvar global = __webpack_require__(2);\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    hide(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nvar hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar isRegExp = __webpack_require__(58);\nvar anObject = __webpack_require__(4);\nvar requireObjectCoercible = __webpack_require__(6);\nvar speciesConstructor = __webpack_require__(109);\nvar advanceStringIndex = __webpack_require__(54);\nvar toLength = __webpack_require__(9);\nvar callRegExpExec = __webpack_require__(38);\nvar regexpExec = __webpack_require__(55);\nvar fails = __webpack_require__(1);\nvar arrayPush = [].push;\nvar min = Math.min;\nvar MAX_UINT32 = 0xFFFFFFFF;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { return !RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\n__webpack_require__(39)(\n  'split',\n  2,\n  function (SPLIT, nativeSplit, maybeCallNative) {\n    var internalSplit;\n    if (\n      'abbc'.split(/(b)*/)[1] == 'c' ||\n      'test'.split(/(?:)/, -1).length != 4 ||\n      'ab'.split(/(?:ab)*/).length != 2 ||\n      '.'.split(/(.?)(.?)/).length != 4 ||\n      '.'.split(/()()/).length > 1 ||\n      ''.split(/.?/).length\n    ) {\n      // based on es5-shim implementation, need to rework it\n      internalSplit = function (separator, limit) {\n        var string = String(requireObjectCoercible(this));\n        var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n        if (lim === 0) return [];\n        if (separator === undefined) return [string];\n        // If `separator` is not a regex, use native split\n        if (!isRegExp(separator)) {\n          return nativeSplit.call(string, separator, lim);\n        }\n        var output = [];\n        var flags = (separator.ignoreCase ? 'i' : '') +\n                    (separator.multiline ? 'm' : '') +\n                    (separator.unicode ? 'u' : '') +\n                    (separator.sticky ? 'y' : '');\n        var lastLastIndex = 0;\n        // Make `global` and avoid `lastIndex` issues by working with a copy\n        var separatorCopy = new RegExp(separator.source, flags + 'g');\n        var match, lastIndex, lastLength;\n        while (match = regexpExec.call(separatorCopy, string)) {\n          lastIndex = separatorCopy.lastIndex;\n          if (lastIndex > lastLastIndex) {\n            output.push(string.slice(lastLastIndex, match.index));\n            if (match.length > 1 && match.index < string.length) arrayPush.apply(output, match.slice(1));\n            lastLength = match[0].length;\n            lastLastIndex = lastIndex;\n            if (output.length >= lim) break;\n          }\n          if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n        }\n        if (lastLastIndex === string.length) {\n          if (lastLength || !separatorCopy.test('')) output.push('');\n        } else output.push(string.slice(lastLastIndex));\n        return output.length > lim ? output.slice(0, lim) : output;\n      };\n    // Chakra, V8\n    } else if ('0'.split(undefined, 0).length) {\n      internalSplit = function (separator, limit) {\n        return separator === undefined && limit === 0 ? [] : nativeSplit.call(this, separator, limit);\n      };\n    } else internalSplit = nativeSplit;\n\n    return [\n      // `String.prototype.split` method\n      // https://tc39.github.io/ecma262/#sec-string.prototype.split\n      function split(separator, limit) {\n        var O = requireObjectCoercible(this);\n        var splitter = separator == undefined ? undefined : separator[SPLIT];\n        return splitter !== undefined\n          ? splitter.call(separator, O, limit)\n          : internalSplit.call(String(O), separator, limit);\n      },\n      // `RegExp.prototype[@@split]` method\n      // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n      //\n      // NOTE: This cannot be properly polyfilled in engines that don't support\n      // the 'y' flag.\n      function (regexp, limit) {\n        var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== nativeSplit);\n        if (res.done) return res.value;\n\n        var rx = anObject(regexp);\n        var S = String(this);\n        var C = speciesConstructor(rx, RegExp);\n\n        var unicodeMatching = rx.unicode;\n        var flags = (rx.ignoreCase ? 'i' : '') +\n                    (rx.multiline ? 'm' : '') +\n                    (rx.unicode ? 'u' : '') +\n                    (SUPPORTS_Y ? 'y' : 'g');\n\n        // ^(? + rx + ) is needed, in combination with some S slicing, to\n        // simulate the 'y' flag.\n        var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n        var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n        if (lim === 0) return [];\n        if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n        var p = 0;\n        var q = 0;\n        var A = [];\n        while (q < S.length) {\n          splitter.lastIndex = SUPPORTS_Y ? q : 0;\n          var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n          var e;\n          if (\n            z === null ||\n            (e = min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n          ) {\n            q = advanceStringIndex(S, q, unicodeMatching);\n          } else {\n            A.push(S.slice(p, q));\n            if (A.length === lim) return A;\n            for (var i = 1; i <= z.length - 1; i++) {\n              A.push(z[i]);\n              if (A.length === lim) return A;\n            }\n            q = p = e;\n          }\n        }\n        A.push(S.slice(p));\n        return A;\n      }\n    ];\n  },\n  !SUPPORTS_Y\n);\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(43);\nvar requireObjectCoercible = __webpack_require__(6);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar definePropertyModule = __webpack_require__(8);\nvar createPropertyDescriptor = __webpack_require__(32);\n\nmodule.exports = __webpack_require__(5) ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar anObject = __webpack_require__(4);\nvar toObject = __webpack_require__(23);\nvar toLength = __webpack_require__(9);\nvar toInteger = __webpack_require__(20);\nvar requireObjectCoercible = __webpack_require__(6);\nvar advanceStringIndex = __webpack_require__(54);\nvar regExpExec = __webpack_require__(38);\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\n__webpack_require__(39)(\n  'replace',\n  2,\n  function (REPLACE, nativeReplace, maybeCallNative) {\n    return [\n      // `String.prototype.replace` method\n      // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n      function replace(searchValue, replaceValue) {\n        var O = requireObjectCoercible(this);\n        var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n        return replacer !== undefined\n          ? replacer.call(searchValue, O, replaceValue)\n          : nativeReplace.call(String(O), searchValue, replaceValue);\n      },\n      // `RegExp.prototype[@@replace]` method\n      // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n      function (regexp, replaceValue) {\n        var res = maybeCallNative(nativeReplace, regexp, this, replaceValue);\n        if (res.done) return res.value;\n\n        var rx = anObject(regexp);\n        var S = String(this);\n\n        var functionalReplace = typeof replaceValue === 'function';\n        if (!functionalReplace) replaceValue = String(replaceValue);\n\n        var global = rx.global;\n        if (global) {\n          var fullUnicode = rx.unicode;\n          rx.lastIndex = 0;\n        }\n        var results = [];\n        while (true) {\n          var result = regExpExec(rx, S);\n          if (result === null) break;\n\n          results.push(result);\n          if (!global) break;\n\n          var matchStr = String(result[0]);\n          if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        }\n\n        var accumulatedResult = '';\n        var nextSourcePosition = 0;\n        for (var i = 0; i < results.length; i++) {\n          result = results[i];\n\n          var matched = String(result[0]);\n          var position = max(min(toInteger(result.index), S.length), 0);\n          var captures = [];\n          // NOTE: This is equivalent to\n          //   captures = result.slice(1).map(maybeToString)\n          // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n          // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n          // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n          for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n          var namedCaptures = result.groups;\n          if (functionalReplace) {\n            var replacerArgs = [matched].concat(captures, position, S);\n            if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n            var replacement = String(replaceValue.apply(undefined, replacerArgs));\n          } else {\n            replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n          }\n          if (position >= nextSourcePosition) {\n            accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n            nextSourcePosition = position + matched.length;\n          }\n        }\n        return accumulatedResult + S.slice(nextSourcePosition);\n      }\n    ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n    function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n      var tailPos = position + matched.length;\n      var m = captures.length;\n      var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n      if (namedCaptures !== undefined) {\n        namedCaptures = toObject(namedCaptures);\n        symbols = SUBSTITUTION_SYMBOLS;\n      }\n      return nativeReplace.call(replacement, symbols, function (match, ch) {\n        var capture;\n        switch (ch.charAt(0)) {\n          case '$': return '$';\n          case '&': return matched;\n          case '`': return str.slice(0, position);\n          case \"'\": return str.slice(tailPos);\n          case '<':\n            capture = namedCaptures[ch.slice(1, -1)];\n            break;\n          default: // \\d\\d?\n            var n = +ch;\n            if (n === 0) return match;\n            if (n > m) {\n              var f = floor(n / 10);\n              if (f === 0) return match;\n              if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n              return match;\n            }\n            capture = captures[n - 1];\n        }\n        return capture === undefined ? '' : capture;\n      });\n    }\n  }\n);\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar isObject = __webpack_require__(7);\nvar isArray = __webpack_require__(36);\nvar toAbsoluteIndex = __webpack_require__(34);\nvar toLength = __webpack_require__(9);\nvar toIndexedObject = __webpack_require__(14);\nvar createProperty = __webpack_require__(52);\nvar SPECIES = __webpack_require__(3)('species');\nvar nativeSlice = [].slice;\nvar max = Math.max;\n\nvar SPECIES_SUPPORT = __webpack_require__(28)('slice');\n\n// `Array.prototype.slice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n__webpack_require__(0)({ target: 'Array', proto: true, forced: !SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = toLength(O.length);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (typeof Constructor == 'function' && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return nativeSlice.call(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\nvar toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(2);\nvar hide = __webpack_require__(15);\nvar has = __webpack_require__(12);\nvar setGlobal = __webpack_require__(44);\nvar nativeFunctionToString = __webpack_require__(73);\nvar InternalStateModule = __webpack_require__(74);\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(nativeFunctionToString).split('toString');\n\n__webpack_require__(26)('inspectSource', function (it) {\n  return nativeFunctionToString.call(it);\n});\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) hide(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else hide(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || nativeFunctionToString.call(this);\n});\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar internalFilter = __webpack_require__(37)(2);\n\nvar SPECIES_SUPPORT = __webpack_require__(28)('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n__webpack_require__(0)({ target: 'Array', proto: true, forced: !SPECIES_SUPPORT }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return internalFilter(this, callbackfn, arguments[1]);\n  }\n});\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DESCRIPTORS = __webpack_require__(5);\nvar defineProperty = __webpack_require__(8).f;\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar requireObjectCoercible = __webpack_require__(6);\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DESCRIPTORS = __webpack_require__(5);\nvar propertyIsEnumerableModule = __webpack_require__(42);\nvar createPropertyDescriptor = __webpack_require__(32);\nvar toIndexedObject = __webpack_require__(14);\nvar toPrimitive = __webpack_require__(25);\nvar has = __webpack_require__(12);\nvar IE8_DOM_DEFINE = __webpack_require__(71);\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = __webpack_require__(7);\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(2);\nvar setGlobal = __webpack_require__(44);\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.0.1',\n  mode: __webpack_require__(70) ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar internalObjectKeys = __webpack_require__(75);\nvar hiddenKeys = __webpack_require__(47).concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar fails = __webpack_require__(1);\nvar SPECIES = __webpack_require__(3)('species');\n\nmodule.exports = function (METHOD_NAME) {\n  return !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toIndexedObject = __webpack_require__(14);\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = __webpack_require__(43) != Object;\nvar SLOPPY_METHOD = __webpack_require__(81)('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.join\n__webpack_require__(0)({ target: 'Array', proto: true, forced: ES3_STRINGS || SLOPPY_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar internalMap = __webpack_require__(37)(1);\n\nvar SPECIES_SUPPORT = __webpack_require__(28)('map');\n\n// `Array.prototype.map` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n__webpack_require__(0)({ target: 'Array', proto: true, forced: !SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return internalMap(this, callbackfn, arguments[1]);\n  }\n});\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE__31__;\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports) {\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\nmodule.exports = {};\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toInteger = __webpack_require__(20);\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(length, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar internalObjectKeys = __webpack_require__(75);\nvar enumBugKeys = __webpack_require__(47);\n\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar classof = __webpack_require__(18);\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar bind = __webpack_require__(99);\nvar IndexedObject = __webpack_require__(43);\nvar toObject = __webpack_require__(23);\nvar toLength = __webpack_require__(9);\nvar arraySpeciesCreate = __webpack_require__(53);\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\n// 0 -> Array#forEach\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n// 1 -> Array#map\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// 2 -> Array#filter\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// 3 -> Array#some\n// https://tc39.github.io/ecma262/#sec-array.prototype.some\n// 4 -> Array#every\n// https://tc39.github.io/ecma262/#sec-array.prototype.every\n// 5 -> Array#find\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n// 6 -> Array#findIndex\n// https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\nmodule.exports = function (TYPE, specificCreate) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = specificCreate || arraySpeciesCreate;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: target.push(value);       // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar classof = __webpack_require__(18);\nvar regexpExec = __webpack_require__(55);\n\n// `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n\n  if (classof(R) !== 'RegExp') {\n    throw TypeError('RegExp#exec called on incompatible receiver');\n  }\n\n  return regexpExec.call(R, S);\n};\n\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar hide = __webpack_require__(15);\nvar redefine = __webpack_require__(19);\nvar fails = __webpack_require__(1);\nvar wellKnownSymbol = __webpack_require__(3);\nvar regexpExec = __webpack_require__(55);\n\nvar SPECIES = wellKnownSymbol('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\nmodule.exports = function (KEY, length, exec, sham) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n    re.exec = function () { execCalled = true; return null; };\n\n    if (KEY === 'split') {\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n    }\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      if (regexp.exec === regexpExec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n        }\n        return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n    var stringMethod = methods[0];\n    var regexMethod = methods[1];\n\n    redefine(String.prototype, KEY, stringMethod);\n    redefine(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return regexMethod.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return regexMethod.call(string, this); }\n    );\n    if (sham) hide(RegExp.prototype[SYMBOL], 'sham', true);\n  }\n};\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar internalFind = __webpack_require__(37)(5);\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n__webpack_require__(0)({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return internalFind(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\n__webpack_require__(60)(FIND);\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar internalStringTrim = __webpack_require__(85);\nvar FORCED = __webpack_require__(110)('trim');\n\n// `String.prototype.trim` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.trim\n__webpack_require__(0)({ target: 'String', proto: true, forced: FORCED }, {\n  trim: function trim() {\n    return internalStringTrim(this, 3);\n  }\n});\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = nativeGetOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = nativeGetOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar fails = __webpack_require__(1);\nvar classof = __webpack_require__(18);\nvar split = ''.split;\n\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(2);\nvar hide = __webpack_require__(15);\n\nmodule.exports = function (key, value) {\n  try {\n    hide(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar shared = __webpack_require__(26)('keys');\nvar uid = __webpack_require__(46);\n\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports) {\n\nvar id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + postfix).toString(36));\n};\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports) {\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports) {\n\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar fails = __webpack_require__(1);\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = __webpack_require__(4);\nvar defineProperties = __webpack_require__(96);\nvar enumBugKeys = __webpack_require__(47);\nvar html = __webpack_require__(97);\nvar documentCreateElement = __webpack_require__(72);\nvar IE_PROTO = __webpack_require__(45)('IE_PROTO');\nvar PROTOTYPE = 'prototype';\nvar Empty = function () { /* empty */ };\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var length = enumBugKeys.length;\n  var lt = '<';\n  var script = 'script';\n  var gt = '>';\n  var js = 'java' + script + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  iframe.src = String(js);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + script + gt + 'document.F=Object' + lt + '/' + script + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (length--) delete createDict[PROTOTYPE][enumBugKeys[length]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n\n__webpack_require__(33)[IE_PROTO] = true;\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar isArray = __webpack_require__(36);\nvar isObject = __webpack_require__(7);\nvar toObject = __webpack_require__(23);\nvar toLength = __webpack_require__(9);\nvar createProperty = __webpack_require__(52);\nvar arraySpeciesCreate = __webpack_require__(53);\nvar IS_CONCAT_SPREADABLE = __webpack_require__(3)('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\nvar IS_CONCAT_SPREADABLE_SUPPORT = !__webpack_require__(1)(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = __webpack_require__(28)('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n__webpack_require__(0)({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toPrimitive = __webpack_require__(25);\nvar definePropertyModule = __webpack_require__(8);\nvar createPropertyDescriptor = __webpack_require__(32);\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\nvar isArray = __webpack_require__(36);\nvar SPECIES = __webpack_require__(3)('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar codePointAt = __webpack_require__(104);\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? codePointAt(S, index, true).length : 1);\n};\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar regexpFlags = __webpack_require__(56);\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + re.source + '$(?!\\\\s)', regexpFlags.call(re));\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = nativeExec.call(re, str);\n\n    if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar anObject = __webpack_require__(4);\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.github.io/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = __webpack_require__(58);\nvar requireObjectCoercible = __webpack_require__(6);\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) {\n    throw TypeError('String.prototype.' + NAME + \" doesn't accept regex\");\n  } return String(requireObjectCoercible(that));\n};\n\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\nvar classof = __webpack_require__(18);\nvar MATCH = __webpack_require__(3)('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar MATCH = __webpack_require__(3)('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (e) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (f) { /* empty */ }\n  } return false;\n};\n\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar UNSCOPABLES = __webpack_require__(3)('unscopables');\nvar create = __webpack_require__(50);\nvar hide = __webpack_require__(15);\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  hide(ArrayPrototype, UNSCOPABLES, create(null));\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toInteger = __webpack_require__(20);\nvar thisNumberValue = __webpack_require__(111);\nvar repeat = __webpack_require__(112);\nvar nativeToFixed = 1.0.toFixed;\nvar floor = Math.floor;\nvar data = [0, 0, 0, 0, 0, 0];\n\nvar multiply = function (n, c) {\n  var i = -1;\n  var c2 = c;\n  while (++i < 6) {\n    c2 += n * data[i];\n    data[i] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\n\nvar divide = function (n) {\n  var i = 6;\n  var c = 0;\n  while (--i >= 0) {\n    c += data[i];\n    data[i] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\n\nvar numToString = function () {\n  var i = 6;\n  var s = '';\n  while (--i >= 0) {\n    if (s !== '' || i === 0 || data[i] !== 0) {\n      var t = String(data[i]);\n      s = s === '' ? t : s + repeat.call('0', 7 - t.length) + t;\n    }\n  } return s;\n};\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\n// `Number.prototype.toFixed` method\n// https://tc39.github.io/ecma262/#sec-number.prototype.tofixed\n__webpack_require__(0)({ target: 'Number', proto: true, forced: nativeToFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !__webpack_require__(1)(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed.call({});\n}) }, {\n  toFixed: function toFixed(fractionDigits) {\n    var x = thisNumberValue(this);\n    var f = toInteger(fractionDigits);\n    var s = '';\n    var m = '0';\n    var e, z, j, k;\n    if (f < 0 || f > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare\n    if (x != x) return 'NaN';\n    if (x <= -1e21 || x >= 1e21) return String(x);\n    if (x < 0) {\n      s = '-';\n      x = -x;\n    }\n    if (x > 1e-21) {\n      e = log(x * pow(2, 69, 1)) - 69;\n      z = e < 0 ? x * pow(2, -e, 1) : x / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = f;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        m = numToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        m = numToString() + repeat.call('0', f);\n      }\n    }\n    if (f > 0) {\n      k = m.length;\n      m = s + (k <= f ? '0.' + repeat.call('0', f - k) + m : m.slice(0, k - f) + '.' + m.slice(k - f));\n    } else {\n      m = s + m;\n    } return m;\n  }\n});\n\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar anObject = __webpack_require__(4);\nvar fails = __webpack_require__(1);\nvar flags = __webpack_require__(56);\nvar DESCRIPTORS = __webpack_require__(5);\nvar TO_STRING = 'toString';\nvar nativeToString = /./[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  __webpack_require__(19)(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? flags.call(R) : undefined);\n  }, { unsafe: true });\n}\n\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar createHTML = __webpack_require__(64);\nvar FORCED = __webpack_require__(65)('bold');\n\n// `String.prototype.bold` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.bold\n__webpack_require__(0)({ target: 'String', proto: true, forced: FORCED }, {\n  bold: function bold() {\n    return createHTML(this, 'b', '', '');\n  }\n});\n\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar requireObjectCoercible = __webpack_require__(6);\nvar quot = /\"/g;\n\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\n// https://tc39.github.io/ecma262/#sec-createhtml\nmodule.exports = function (string, tag, attribute, value) {\n  var S = String(requireObjectCoercible(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\n\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar fails = __webpack_require__(1);\n\n// check the existence of a method, lowercase\n// of a tag and escaping quotes in arguments\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    var test = ''[METHOD_NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  });\n};\n\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar createHTML = __webpack_require__(64);\nvar FORCED = __webpack_require__(65)('italics');\n\n// `String.prototype.italics` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.italics\n__webpack_require__(0)({ target: 'String', proto: true, forced: FORCED }, {\n  italics: function italics() {\n    return createHTML(this, 'i', '', '');\n  }\n});\n\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE__67__;\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE__68__;\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE__69__;\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports) {\n\nmodule.exports = false;\n\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !__webpack_require__(5) && !__webpack_require__(1)(function () {\n  return Object.defineProperty(__webpack_require__(72)('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\nvar document = __webpack_require__(2).document;\n// typeof document.createElement is 'object' in old IE\nvar exist = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return exist ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(26)('native-function-to-string', Function.toString);\n\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar NATIVE_WEAK_MAP = __webpack_require__(90);\nvar isObject = __webpack_require__(7);\nvar hide = __webpack_require__(15);\nvar objectHas = __webpack_require__(12);\nvar sharedKey = __webpack_require__(45);\nvar hiddenKeys = __webpack_require__(33);\nvar WeakMap = __webpack_require__(2).WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    hide(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar has = __webpack_require__(12);\nvar toIndexedObject = __webpack_require__(14);\nvar arrayIndexOf = __webpack_require__(76)(false);\nvar hiddenKeys = __webpack_require__(33);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toIndexedObject = __webpack_require__(14);\nvar toLength = __webpack_require__(9);\nvar toAbsoluteIndex = __webpack_require__(34);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\n// false -> Array#indexOf\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n// true  -> Array#includes\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Chrome 38 Symbol has incorrect toString conversion\nmodule.exports = !__webpack_require__(1)(function () {\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\nexports.f = __webpack_require__(3);\n\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(2);\n\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports) {\n\nmodule.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar fails = __webpack_require__(1);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !method || !fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar anObject = __webpack_require__(4);\nvar toLength = __webpack_require__(9);\nvar requireObjectCoercible = __webpack_require__(6);\nvar advanceStringIndex = __webpack_require__(54);\nvar regExpExec = __webpack_require__(38);\n\n// @@match logic\n__webpack_require__(39)(\n  'match',\n  1,\n  function (MATCH, nativeMatch, maybeCallNative) {\n    return [\n      // `String.prototype.match` method\n      // https://tc39.github.io/ecma262/#sec-string.prototype.match\n      function match(regexp) {\n        var O = requireObjectCoercible(this);\n        var matcher = regexp == undefined ? undefined : regexp[MATCH];\n        return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n      },\n      // `RegExp.prototype[@@match]` method\n      // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n      function (regexp) {\n        var res = maybeCallNative(nativeMatch, regexp, this);\n        if (res.done) return res.value;\n\n        var rx = anObject(regexp);\n        var S = String(this);\n\n        if (!rx.global) return regExpExec(rx, S);\n\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n        var A = [];\n        var n = 0;\n        var result;\n        while ((result = regExpExec(rx, S)) !== null) {\n          var matchStr = String(result[0]);\n          A[n] = matchStr;\n          if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n          n++;\n        }\n        return n === 0 ? null : A;\n      }\n    ];\n  }\n);\n\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar global = __webpack_require__(2);\nvar isForced = __webpack_require__(49);\nvar has = __webpack_require__(12);\nvar classof = __webpack_require__(18);\nvar inheritIfRequired = __webpack_require__(84);\nvar toPrimitive = __webpack_require__(25);\nvar fails = __webpack_require__(1);\nvar getOwnPropertyNames = __webpack_require__(27).f;\nvar getOwnPropertyDescriptor = __webpack_require__(24).f;\nvar defineProperty = __webpack_require__(8).f;\nvar internalStringTrim = __webpack_require__(85);\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\n\n// Opera ~12 has broken Object#toString\nvar BROKEN_CLASSOF = classof(__webpack_require__(50)(NumberPrototype)) == NUMBER;\nvar NATIVE_TRIM = 'trim' in String.prototype;\n\n// `ToNumber` abstract operation\n// https://tc39.github.io/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  var first, third, radix, maxCode, digits, length, i, code;\n  if (typeof it == 'string' && it.length > 2) {\n    it = NATIVE_TRIM ? it.trim() : internalStringTrim(it, 3);\n    first = it.charCodeAt(0);\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = it.slice(2);\n      length = digits.length;\n      for (i = 0; i < length; i++) {\n        code = digits.charCodeAt(i);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.github.io/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var that = this;\n    return that instanceof NumberWrapper\n      // check on 1..constructor(foo) case\n      && (BROKEN_CLASSOF ? fails(function () { NumberPrototype.valueOf.call(that); }) : classof(that) != NUMBER)\n        ? inheritIfRequired(new NativeNumber(toNumber(it)), that, NumberWrapper) : toNumber(it);\n  };\n  for (var keys = __webpack_require__(5) ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(NativeNumber, key = keys[j]) && !has(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  __webpack_require__(19)(global, NUMBER, NumberWrapper);\n}\n\n\n/***/ }),\n/* 84 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\nvar setPrototypeOf = __webpack_require__(106);\n\nmodule.exports = function (that, target, C) {\n  var S = target.constructor;\n  var P;\n  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {\n    setPrototypeOf(that, P);\n  } return that;\n};\n\n\n/***/ }),\n/* 85 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar requireObjectCoercible = __webpack_require__(6);\nvar whitespace = '[' + __webpack_require__(86) + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// 1 -> String#trimStart\n// 2 -> String#trimEnd\n// 3 -> String#trim\nmodule.exports = function (string, TYPE) {\n  string = String(requireObjectCoercible(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\n\n/***/ }),\n/* 86 */\n/***/ (function(module, exports) {\n\n// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n\n\n/***/ }),\n/* 87 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar anObject = __webpack_require__(4);\nvar requireObjectCoercible = __webpack_require__(6);\nvar sameValue = __webpack_require__(108);\nvar regExpExec = __webpack_require__(38);\n\n// @@search logic\n__webpack_require__(39)(\n  'search',\n  1,\n  function (SEARCH, nativeSearch, maybeCallNative) {\n    return [\n      // `String.prototype.search` method\n      // https://tc39.github.io/ecma262/#sec-string.prototype.search\n      function search(regexp) {\n        var O = requireObjectCoercible(this);\n        var searcher = regexp == undefined ? undefined : regexp[SEARCH];\n        return searcher !== undefined ? searcher.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n      },\n      // `RegExp.prototype[@@search]` method\n      // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n      function (regexp) {\n        var res = maybeCallNative(nativeSearch, regexp, this);\n        if (res.done) return res.value;\n\n        var rx = anObject(regexp);\n        var S = String(this);\n\n        var previousLastIndex = rx.lastIndex;\n        if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n        var result = regExpExec(rx, S);\n        if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n        return result === null ? -1 : result.index;\n      }\n    ];\n  }\n);\n\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toString = __webpack_require__(113);\nvar ObjectPrototype = Object.prototype;\n\n// `Object.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nif (toString !== ObjectPrototype.toString) {\n  __webpack_require__(19)(ObjectPrototype, 'toString', toString, { unsafe: true });\n}\n\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// ECMAScript 6 symbols shim\nvar global = __webpack_require__(2);\nvar has = __webpack_require__(12);\nvar DESCRIPTORS = __webpack_require__(5);\nvar IS_PURE = __webpack_require__(70);\nvar $export = __webpack_require__(0);\nvar redefine = __webpack_require__(19);\nvar hiddenKeys = __webpack_require__(33);\nvar fails = __webpack_require__(1);\nvar shared = __webpack_require__(26);\nvar setToStringTag = __webpack_require__(93);\nvar uid = __webpack_require__(46);\nvar wellKnownSymbol = __webpack_require__(3);\nvar wrappedWellKnownSymbolModule = __webpack_require__(78);\nvar defineWellKnownSymbol = __webpack_require__(94);\nvar enumKeys = __webpack_require__(95);\nvar isArray = __webpack_require__(36);\nvar anObject = __webpack_require__(4);\nvar isObject = __webpack_require__(7);\nvar toIndexedObject = __webpack_require__(14);\nvar toPrimitive = __webpack_require__(25);\nvar createPropertyDescriptor = __webpack_require__(32);\nvar nativeObjectCreate = __webpack_require__(50);\nvar getOwnPropertyNamesExternal = __webpack_require__(98);\nvar getOwnPropertyDescriptorModule = __webpack_require__(24);\nvar definePropertyModule = __webpack_require__(8);\nvar propertyIsEnumerableModule = __webpack_require__(42);\nvar hide = __webpack_require__(15);\nvar objectKeys = __webpack_require__(35);\nvar HIDDEN = __webpack_require__(45)('hidden');\nvar InternalStateModule = __webpack_require__(74);\nvar SYMBOL = 'Symbol';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(SYMBOL);\nvar nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\nvar nativeDefineProperty = definePropertyModule.f;\nvar nativeGetOwnPropertyNames = getOwnPropertyNamesExternal.f;\nvar $Symbol = global.Symbol;\nvar JSON = global.JSON;\nvar nativeJSONStringify = JSON && JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\nvar nativePropertyIsEnumerable = propertyIsEnumerableModule.f;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar ObjectPrototypeSymbols = shared('op-symbols');\nvar WellKnownSymbolsStore = shared('wks');\nvar ObjectPrototype = Object[PROTOTYPE];\nvar QObject = global.QObject;\nvar NATIVE_SYMBOL = __webpack_require__(77);\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar USE_SETTER = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDescriptor = DESCRIPTORS && fails(function () {\n  return nativeObjectCreate(nativeDefineProperty({}, 'a', {\n    get: function () { return nativeDefineProperty(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var ObjectPrototypeDescriptor = nativeGetOwnPropertyDescriptor(ObjectPrototype, key);\n  if (ObjectPrototypeDescriptor) delete ObjectPrototype[key];\n  nativeDefineProperty(it, key, D);\n  if (ObjectPrototypeDescriptor && it !== ObjectPrototype) {\n    nativeDefineProperty(ObjectPrototype, key, ObjectPrototypeDescriptor);\n  }\n} : nativeDefineProperty;\n\nvar wrap = function (tag, description) {\n  var symbol = AllSymbols[tag] = nativeObjectCreate($Symbol[PROTOTYPE]);\n  setInternalState(symbol, {\n    type: SYMBOL,\n    tag: tag,\n    description: description\n  });\n  if (!DESCRIPTORS) symbol.description = description;\n  return symbol;\n};\n\nvar isSymbol = NATIVE_SYMBOL && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return Object(it) instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectPrototype) $defineProperty(ObjectPrototypeSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) nativeDefineProperty(it, HIDDEN, createPropertyDescriptor(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = nativeObjectCreate(D, { enumerable: createPropertyDescriptor(0, false) });\n    } return setSymbolDescriptor(it, key, D);\n  } return nativeDefineProperty(it, key, D);\n};\n\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIndexedObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\n\nvar $create = function create(it, P) {\n  return P === undefined ? nativeObjectCreate(it) : $defineProperties(nativeObjectCreate(it), P);\n};\n\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = nativePropertyIsEnumerable.call(this, key = toPrimitive(key, true));\n  if (this === ObjectPrototype && has(AllSymbols, key) && !has(ObjectPrototypeSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\n\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIndexedObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectPrototype && has(AllSymbols, key) && !has(ObjectPrototypeSymbols, key)) return;\n  var D = nativeGetOwnPropertyDescriptor(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\n\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = nativeGetOwnPropertyNames(toIndexedObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && !has(hiddenKeys, key)) result.push(key);\n  } return result;\n};\n\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectPrototype;\n  var names = nativeGetOwnPropertyNames(IS_OP ? ObjectPrototypeSymbols : toIndexedObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectPrototype, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// `Symbol` constructor\n// https://tc39.github.io/ecma262/#sec-symbol-constructor\nif (!NATIVE_SYMBOL) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor');\n    var description = arguments[0] === undefined ? undefined : String(arguments[0]);\n    var tag = uid(description);\n    var setter = function (value) {\n      if (this === ObjectPrototype) setter.call(ObjectPrototypeSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDescriptor(this, tag, createPropertyDescriptor(1, value));\n    };\n    if (DESCRIPTORS && USE_SETTER) setSymbolDescriptor(ObjectPrototype, tag, { configurable: true, set: setter });\n    return wrap(tag, description);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return getInternalState(this).tag;\n  });\n\n  propertyIsEnumerableModule.f = $propertyIsEnumerable;\n  definePropertyModule.f = $defineProperty;\n  getOwnPropertyDescriptorModule.f = $getOwnPropertyDescriptor;\n  __webpack_require__(27).f = getOwnPropertyNamesExternal.f = $getOwnPropertyNames;\n  __webpack_require__(48).f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS) {\n    // https://github.com/tc39/proposal-Symbol-description\n    nativeDefineProperty($Symbol[PROTOTYPE], 'description', {\n      configurable: true,\n      get: function description() {\n        return getInternalState(this).description;\n      }\n    });\n    if (!IS_PURE) {\n      redefine(ObjectPrototype, 'propertyIsEnumerable', $propertyIsEnumerable, { unsafe: true });\n    }\n  }\n\n  wrappedWellKnownSymbolModule.f = function (name) {\n    return wrap(wellKnownSymbol(name), name);\n  };\n}\n\n$export({ global: true, wrap: true, forced: !NATIVE_SYMBOL, sham: !NATIVE_SYMBOL }, { Symbol: $Symbol });\n\nfor (var wellKnownSymbols = objectKeys(WellKnownSymbolsStore), k = 0; wellKnownSymbols.length > k;) {\n  defineWellKnownSymbol(wellKnownSymbols[k++]);\n}\n\n$export({ target: SYMBOL, stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Symbol.for` method\n  // https://tc39.github.io/ecma262/#sec-symbol.for\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // `Symbol.keyFor` method\n  // https://tc39.github.io/ecma262/#sec-symbol.keyfor\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { USE_SETTER = true; },\n  useSimple: function () { USE_SETTER = false; }\n});\n\n$export({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL, sham: !DESCRIPTORS }, {\n  // `Object.create` method\n  // https://tc39.github.io/ecma262/#sec-object.create\n  create: $create,\n  // `Object.defineProperty` method\n  // https://tc39.github.io/ecma262/#sec-object.defineproperty\n  defineProperty: $defineProperty,\n  // `Object.defineProperties` method\n  // https://tc39.github.io/ecma262/#sec-object.defineproperties\n  defineProperties: $defineProperties,\n  // `Object.getOwnPropertyDescriptor` method\n  // https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptors\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor\n});\n\n$export({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL }, {\n  // `Object.getOwnPropertyNames` method\n  // https://tc39.github.io/ecma262/#sec-object.getownpropertynames\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // `Object.getOwnPropertySymbols` method\n  // https://tc39.github.io/ecma262/#sec-object.getownpropertysymbols\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// `JSON.stringify` method behavior with symbols\n// https://tc39.github.io/ecma262/#sec-json.stringify\nJSON && $export({ target: 'JSON', stat: true, forced: !NATIVE_SYMBOL || fails(function () {\n  var symbol = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  return nativeJSONStringify([symbol]) != '[null]'\n    // WebKit converts symbol values to JSON as null\n    || nativeJSONStringify({ a: symbol }) != '{}'\n    // V8 throws on boxed symbols\n    || nativeJSONStringify(Object(symbol)) != '{}';\n}) }, {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return nativeJSONStringify.apply(JSON, args);\n  }\n});\n\n// `Symbol.prototype[@@toPrimitive]` method\n// https://tc39.github.io/ecma262/#sec-symbol.prototype-@@toprimitive\nif (!$Symbol[PROTOTYPE][TO_PRIMITIVE]) hide($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// `Symbol.prototype[@@toStringTag]` property\n// https://tc39.github.io/ecma262/#sec-symbol.prototype-@@tostringtag\nsetToStringTag($Symbol, SYMBOL);\n\nhiddenKeys[HIDDEN] = true;\n\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar nativeFunctionToString = __webpack_require__(73);\nvar WeakMap = __webpack_require__(2).WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(nativeFunctionToString.call(WeakMap));\n\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar has = __webpack_require__(12);\nvar ownKeys = __webpack_require__(92);\nvar getOwnPropertyDescriptorModule = __webpack_require__(24);\nvar definePropertyModule = __webpack_require__(8);\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar getOwnPropertyNamesModule = __webpack_require__(27);\nvar getOwnPropertySymbolsModule = __webpack_require__(48);\nvar anObject = __webpack_require__(4);\nvar Reflect = __webpack_require__(2).Reflect;\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar defineProperty = __webpack_require__(8).f;\nvar has = __webpack_require__(12);\nvar TO_STRING_TAG = __webpack_require__(3)('toStringTag');\n\nmodule.exports = function (it, TAG, STATIC) {\n  if (it && !has(it = STATIC ? it : it.prototype, TO_STRING_TAG)) {\n    defineProperty(it, TO_STRING_TAG, { configurable: true, value: TAG });\n  }\n};\n\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar path = __webpack_require__(79);\nvar has = __webpack_require__(12);\nvar wrappedWellKnownSymbolModule = __webpack_require__(78);\nvar defineProperty = __webpack_require__(8).f;\n\nmodule.exports = function (NAME) {\n  var Symbol = path.Symbol || (path.Symbol = {});\n  if (!has(Symbol, NAME)) defineProperty(Symbol, NAME, {\n    value: wrappedWellKnownSymbolModule.f(NAME)\n  });\n};\n\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar objectKeys = __webpack_require__(35);\nvar getOwnPropertySymbolsModule = __webpack_require__(48);\nvar propertyIsEnumerableModule = __webpack_require__(42);\n\n// all enumerable object keys, includes symbols\nmodule.exports = function (it) {\n  var result = objectKeys(it);\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  if (getOwnPropertySymbols) {\n    var symbols = getOwnPropertySymbols(it);\n    var propertyIsEnumerable = propertyIsEnumerableModule.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (propertyIsEnumerable.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DESCRIPTORS = __webpack_require__(5);\nvar definePropertyModule = __webpack_require__(8);\nvar anObject = __webpack_require__(4);\nvar objectKeys = __webpack_require__(35);\n\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var key;\n  while (length > i) definePropertyModule.f(O, key = keys[i++], Properties[key]);\n  return O;\n};\n\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar document = __webpack_require__(2).document;\n\nmodule.exports = document && document.documentElement;\n\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIndexedObject = __webpack_require__(14);\nvar nativeGetOwnPropertyNames = __webpack_require__(27).f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return nativeGetOwnPropertyNames(it);\n  } catch (error) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]'\n    ? getWindowNames(it)\n    : nativeGetOwnPropertyNames(toIndexedObject(it));\n};\n\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar aFunction = __webpack_require__(80);\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toIndexedObject = __webpack_require__(14);\nvar nativeGetOwnPropertyDescriptor = __webpack_require__(24).f;\nvar DESCRIPTORS = __webpack_require__(5);\nvar FAILS_ON_PRIMITIVES = __webpack_require__(1)(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\n__webpack_require__(0)({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toObject = __webpack_require__(23);\nvar nativeKeys = __webpack_require__(35);\nvar FAILS_ON_PRIMITIVES = __webpack_require__(1)(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\n__webpack_require__(0)({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports) {\n\n// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar nativeForEach = [].forEach;\nvar internalForEach = __webpack_require__(37)(0);\n\nvar SLOPPY_METHOD = __webpack_require__(81)('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = SLOPPY_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return internalForEach(this, callbackfn, arguments[1]);\n} : nativeForEach;\n\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toInteger = __webpack_require__(20);\nvar requireObjectCoercible = __webpack_require__(6);\n// CONVERT_TO_STRING: true  -> String#at\n// CONVERT_TO_STRING: false -> String#codePointAt\nmodule.exports = function (that, pos, CONVERT_TO_STRING) {\n  var S = String(requireObjectCoercible(that));\n  var position = toInteger(pos);\n  var size = S.length;\n  var first, second;\n  if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n  first = S.charCodeAt(position);\n  return first < 0xD800 || first > 0xDBFF || position + 1 === size\n    || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n      ? CONVERT_TO_STRING ? S.charAt(position) : first\n      : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n};\n\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toLength = __webpack_require__(9);\nvar validateArguments = __webpack_require__(57);\nvar STARTS_WITH = 'startsWith';\nvar CORRECT_IS_REGEXP_LOGIC = __webpack_require__(59)(STARTS_WITH);\nvar nativeStartsWith = ''[STARTS_WITH];\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n__webpack_require__(0)({ target: 'String', proto: true, forced: !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = validateArguments(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n\n\n/***/ }),\n/* 106 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar validateSetPrototypeOfArguments = __webpack_require__(107);\n\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var correctSetter = false;\n  var test = {};\n  var setter;\n  try {\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    correctSetter = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    validateSetPrototypeOfArguments(O, proto);\n    if (correctSetter) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(7);\nvar anObject = __webpack_require__(4);\n\nmodule.exports = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) {\n    throw TypeError(\"Can't set \" + String(proto) + ' as a prototype');\n  }\n};\n\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports) {\n\n// `SameValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-samevalue\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar anObject = __webpack_require__(4);\nvar aFunction = __webpack_require__(80);\nvar SPECIES = __webpack_require__(3)('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.github.io/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar fails = __webpack_require__(1);\nvar whitespaces = __webpack_require__(86);\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar classof = __webpack_require__(18);\n\n// `thisNumberValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-thisnumbervalue\nmodule.exports = function (value) {\n  if (typeof value != 'number' && classof(value) != 'Number') {\n    throw TypeError('Incorrect invocation');\n  }\n  return +value;\n};\n\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toInteger = __webpack_require__(20);\nvar requireObjectCoercible = __webpack_require__(6);\n\n// `String.prototype.repeat` method implementation\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar classof = __webpack_require__(114);\nvar TO_STRING_TAG = __webpack_require__(3)('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\n// `Object.prototype.toString` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nmodule.exports = String(test) !== '[object z]' ? function toString() {\n  return '[object ' + classof(this) + ']';\n} : test.toString;\n\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar classofRaw = __webpack_require__(18);\nvar TO_STRING_TAG = __webpack_require__(3)('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports, __webpack_require__) {\n\n// `Array.prototype.fill` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\n__webpack_require__(0)({ target: 'Array', proto: true }, { fill: __webpack_require__(116) });\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\n__webpack_require__(60)('fill');\n\n\n/***/ }),\n/* 116 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toObject = __webpack_require__(23);\nvar toAbsoluteIndex = __webpack_require__(34);\nvar toLength = __webpack_require__(9);\n\n// `Array.prototype.fill` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar createHTML = __webpack_require__(64);\nvar FORCED = __webpack_require__(65)('strike');\n\n// `String.prototype.strike` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.strike\n__webpack_require__(0)({ target: 'String', proto: true, forced: FORCED }, {\n  strike: function strike() {\n    return createHTML(this, 'strike', '', '');\n  }\n});\n\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar internalIncludes = __webpack_require__(76)(true);\n\n// `Array.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n__webpack_require__(0)({ target: 'Array', proto: true }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return internalIncludes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\n__webpack_require__(60)('includes');\n\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar DESCRIPTORS = __webpack_require__(5);\nvar MATCH = __webpack_require__(3)('match');\nvar global = __webpack_require__(2);\nvar isForced = __webpack_require__(49);\nvar inheritIfRequired = __webpack_require__(84);\nvar defineProperty = __webpack_require__(8).f;\nvar getOwnPropertyNames = __webpack_require__(27).f;\nvar isRegExp = __webpack_require__(58);\nvar getFlags = __webpack_require__(56);\nvar redefine = __webpack_require__(19);\nvar fails = __webpack_require__(1);\nvar NativeRegExp = global.RegExp;\nvar RegExpPrototype = NativeRegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n\n// \"new\" should create a new object, old webkit bug\nvar CORRECT_NEW = new NativeRegExp(re1) !== re1;\n\nvar FORCED = isForced('RegExp', DESCRIPTORS && (!CORRECT_NEW || fails(function () {\n  re2[MATCH] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';\n})));\n\n// `RegExp` constructor\n// https://tc39.github.io/ecma262/#sec-regexp-constructor\nif (FORCED) {\n  var RegExpWrapper = function RegExp(pattern, flags) {\n    var thisIsRegExp = this instanceof RegExpWrapper;\n    var patternIsRegExp = isRegExp(pattern);\n    var flagsAreUndefined = flags === undefined;\n    return !thisIsRegExp && patternIsRegExp && pattern.constructor === RegExpWrapper && flagsAreUndefined ? pattern\n      : inheritIfRequired(CORRECT_NEW\n        ? new NativeRegExp(patternIsRegExp && !flagsAreUndefined ? pattern.source : pattern, flags)\n        : NativeRegExp((patternIsRegExp = pattern instanceof RegExpWrapper)\n          ? pattern.source\n          : pattern, patternIsRegExp && flagsAreUndefined ? getFlags.call(pattern) : flags)\n      , thisIsRegExp ? this : RegExpPrototype, RegExpWrapper);\n  };\n  var proxy = function (key) {\n    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {\n      configurable: true,\n      get: function () { return NativeRegExp[key]; },\n      set: function (it) { NativeRegExp[key] = it; }\n    });\n  };\n  var keys = getOwnPropertyNames(NativeRegExp);\n  var i = 0;\n  while (i < keys.length) proxy(keys[i++]);\n  RegExpPrototype.constructor = RegExpWrapper;\n  RegExpWrapper.prototype = RegExpPrototype;\n  redefine(global, 'RegExp', RegExpWrapper);\n}\n\n// https://tc39.github.io/ecma262/#sec-get-regexp-@@species\n__webpack_require__(120)('RegExp');\n\n\n/***/ }),\n/* 120 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar getBuiltIn = __webpack_require__(121);\nvar definePropertyModule = __webpack_require__(8);\nvar DESCRIPTORS = __webpack_require__(5);\nvar SPECIES = __webpack_require__(3)('species');\n\nmodule.exports = function (CONSTRUCTOR_NAME) {\n  var C = getBuiltIn(CONSTRUCTOR_NAME);\n  var defineProperty = definePropertyModule.f;\n  if (DESCRIPTORS && C && !C[SPECIES]) defineProperty(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n\n\n/***/ }),\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar path = __webpack_require__(79);\nvar global = __webpack_require__(2);\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar validateArguments = __webpack_require__(57);\nvar INCLUDES = 'includes';\n\nvar CORRECT_IS_REGEXP_LOGIC = __webpack_require__(59)(INCLUDES);\n\n// `String.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.includes\n__webpack_require__(0)({ target: 'String', proto: true, forced: !CORRECT_IS_REGEXP_LOGIC }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~validateArguments(this, searchString, INCLUDES)\n      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n\n/***/ }),\n/* 123 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar toLength = __webpack_require__(9);\nvar validateArguments = __webpack_require__(57);\nvar ENDS_WITH = 'endsWith';\nvar nativeEndsWith = ''[ENDS_WITH];\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = __webpack_require__(59)(ENDS_WITH);\n\n// `String.prototype.endsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.endswith\n__webpack_require__(0)({ target: 'String', proto: true, forced: !CORRECT_IS_REGEXP_LOGIC }, {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = validateArguments(this, searchString, ENDS_WITH);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : min(toLength(endPosition), len);\n    var search = String(searchString);\n    return nativeEndsWith\n      ? nativeEndsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n\n\n/***/ }),\n/* 124 */\n/***/ (function(module, exports) {\n\n/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n\n/* WEBPACK VAR INJECTION */}.call(this, {}))\n\n/***/ }),\n/* 125 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.js\nvar es_symbol = __webpack_require__(89);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.concat.js\nvar es_array_concat = __webpack_require__(51);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.filter.js\nvar es_array_filter = __webpack_require__(21);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.get-own-property-descriptor.js\nvar es_object_get_own_property_descriptor = __webpack_require__(100);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.keys.js\nvar es_object_keys = __webpack_require__(101);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/web.dom-collections.for-each.js\nvar web_dom_collections_for_each = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.match.js\nvar es_string_match = __webpack_require__(82);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.replace.js\nvar es_string_replace = __webpack_require__(16);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.starts-with.js\nvar es_string_starts_with = __webpack_require__(105);\n\n// EXTERNAL MODULE: external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"jQuery\"}\nvar external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_ = __webpack_require__(31);\n\n// EXTERNAL MODULE: external {\"amd\":\"raphael\",\"commonjs\":\"raphael\",\"commonjs2\":\"raphael\",\"root\":\"Raphael\"}\nvar external_amd_raphael_commonjs_raphael_commonjs2_raphael_root_Raphael_ = __webpack_require__(67);\n\n// EXTERNAL MODULE: external {\"amd\":\"jquery-ui\",\"commonjs\":\"jquery-ui\",\"commonjs2\":\"jquery-ui\",\"root\":[\"jQuery\",\"ui\"]}\nvar external_amd_jquery_ui_commonjs_jquery_ui_commonjs2_jquery_ui_root_jQuery_ui_ = __webpack_require__(68);\n\n// EXTERNAL MODULE: external {\"amd\":\"clipboard\",\"commonjs\":\"clipboard\",\"commonjs2\":\"clipboard\",\"root\":\"ClipboardJS\"}\nvar external_amd_clipboard_commonjs_clipboard_commonjs2_clipboard_root_ClipboardJS_ = __webpack_require__(69);\n\n// CONCATENATED MODULE: ./src/Consts.ts\n//-------------------------------------------------------------------------------------------------\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n\n\nvar atalaJquery = external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_ === undefined ? null : external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_;\nvar atalaJqueryUi = external_amd_jquery_ui_commonjs_jquery_ui_commonjs2_jquery_ui_root_jQuery_ui_ === undefined ? external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_[\"ui\"] === undefined ? null : external_commonjs_jquery_commonjs2_jquery_amd_jquery_root_jQuery_[\"ui\"] : external_amd_jquery_ui_commonjs_jquery_ui_commonjs2_jquery_ui_root_jQuery_ui_;\nvar atalaRaphael = external_amd_raphael_commonjs_raphael_commonjs2_raphael_root_Raphael_ === undefined ? null : external_amd_raphael_commonjs_raphael_commonjs2_raphael_root_Raphael_;\nvar atalaClipboard = external_amd_clipboard_commonjs_clipboard_commonjs2_clipboard_root_ClipboardJS_ === undefined ? null : external_amd_clipboard_commonjs_clipboard_commonjs2_clipboard_root_ClipboardJS_;\n\n// CONCATENATED MODULE: ./src/utils/BrowserImpl.ts\n\n\n\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\nvar BrowserPlatform;\n\n(function (BrowserPlatform) {\n  BrowserPlatform[BrowserPlatform[\"Windows\"] = 0] = \"Windows\";\n  BrowserPlatform[BrowserPlatform[\"Mac\"] = 1] = \"Mac\";\n  BrowserPlatform[BrowserPlatform[\"Unknown\"] = 2] = \"Unknown\";\n})(BrowserPlatform || (BrowserPlatform = {}));\n\nvar BrowserMobile =\n/*#__PURE__*/\nfunction () {\n  function BrowserMobile() {}\n\n  var _proto = BrowserMobile.prototype;\n\n  _proto.Any = function Any() {\n    return this.iOS || this.Android || this.IEMobile;\n  };\n\n  _createClass(BrowserMobile, [{\n    key: \"iOS\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(iPad|iPhone|iPod)/i);\n    }\n  }, {\n    key: \"Android\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(Android)/i);\n    }\n  }, {\n    key: \"IEMobile\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(IEMobile)/i);\n    }\n  }]);\n\n  return BrowserMobile;\n}();\n\nvar BrowserLayout =\n/*#__PURE__*/\nfunction () {\n  function BrowserLayout() {\n    _defineProperty(this, \"browserLayoutVersion\", navigator.userAgent.match(/(?:Gecko|Presto|Trident|WebKit).[\\d.]*/));\n  }\n\n  _createClass(BrowserLayout, [{\n    key: \"Gecko\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(Gecko)/i);\n    }\n  }, {\n    key: \"Presto\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(Presto)/i);\n    }\n  }, {\n    key: \"Trident\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(Trident)/i);\n    }\n  }, {\n    key: \"Webkit\",\n    get: function get() {\n      return !!navigator.userAgent.match(/(WebKit)/i);\n    }\n  }, {\n    key: \"Version\",\n    get: function get() {\n      return this.browserLayoutVersion ? this.browserLayoutVersion[0].replace(/\\D*/, '') : null;\n    }\n  }]);\n\n  return BrowserLayout;\n}();\n\nvar BrowserImpl_BrowserFeatures =\n/*#__PURE__*/\nfunction () {\n  function BrowserFeatures() {\n    _defineProperty(this, \"supportsVml\", BrowserFeatures.supportsVML());\n  }\n\n  BrowserFeatures.supportsVML = function supportsVML() {\n    var hasVML;\n\n    if (hasVML === undefined) {\n      var div = atalaJquery('<div/>').appendTo('body');\n      var shape = atalaJquery('<v:shape id=\"vml_flag1\" adj=\"1\" />').appendTo(div);\n      shape.css('behavior', 'url(#default#VML)');\n      hasVML = shape[0] ? typeof shape[0].adj === 'object' : true;\n      div.remove();\n    }\n\n    return hasVML;\n  };\n\n  _createClass(BrowserFeatures, [{\n    key: \"SVG\",\n    get: function get() {\n      return !!(window['SVGAngle'] || document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1'));\n    }\n  }, {\n    key: \"Touch\",\n    get: function get() {\n      return !!('ontouchstart' in window);\n    }\n  }, {\n    key: \"VML\",\n    get: function get() {\n      return this.supportsVml;\n    }\n  }, {\n    key: \"foreignObject\",\n    get: function get() {\n      return document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#Extensibility', '1.1');\n    }\n  }, {\n    key: \"Compatibility\",\n    get: function get() {\n      return document['documentMode'] !== undefined && document['documentMode'] === 7;\n    }\n  }, {\n    key: \"FlexBox\",\n    get: function get() {\n      return 'flex' in document.documentElement.style || 'WebkitFlex' in document.documentElement.style || 'msFlex' in document.documentElement.style;\n    }\n  }]);\n\n  return BrowserFeatures;\n}();\n\nvar BrowserImpl =\n/*#__PURE__*/\nfunction () {\n  function BrowserImpl() {\n    _defineProperty(this, \"mobile\", void 0);\n\n    _defineProperty(this, \"browserVersion\", void 0);\n\n    this.mobile = new BrowserMobile();\n\n    if (this.Edge) {\n      this.browserVersion = navigator.userAgent.match(/(?:Edge).[\\d.]*/);\n    } else {\n      this.browserVersion = null;\n    }\n\n    if (!this.browserVersion) {\n      this.browserVersion = navigator.userAgent.match(/(?:MSIE|Firefox|Chrome|Safari|Opera| rv|Edge).[\\d.]*/);\n    }\n  }\n\n  _createClass(BrowserImpl, [{\n    key: \"Explorer\",\n    get: function get() {\n      return navigator.userAgent.indexOf('MSIE') >= 0 || navigator.userAgent.indexOf('Trident') >= 0;\n    }\n  }, {\n    key: \"Firefox\",\n    get: function get() {\n      return navigator.userAgent.indexOf('Firefox') >= 0 || navigator.userAgent.indexOf('Minefield') >= 0;\n    }\n  }, {\n    key: \"Safari\",\n    get: function get() {\n      return navigator.userAgent.indexOf('Safari') >= 0 && navigator.userAgent.indexOf('Chrome') < 0 && navigator.userAgent.indexOf('Edge') < 0;\n    }\n  }, {\n    key: \"Opera\",\n    get: function get() {\n      return navigator.userAgent.indexOf('Opera') >= 0;\n    }\n  }, {\n    key: \"Chrome\",\n    get: function get() {\n      return navigator.userAgent.indexOf('Safari') >= 0 && navigator.userAgent.indexOf('Chrome') >= 0 && navigator.userAgent.indexOf('Edge') < 0;\n    }\n  }, {\n    key: \"Edge\",\n    get: function get() {\n      return navigator.userAgent.indexOf('Safari') >= 0 && navigator.userAgent.indexOf('Chrome') >= 0 && navigator.userAgent.indexOf('Edge') >= 0;\n    }\n  }, {\n    key: \"Mobile\",\n    get: function get() {\n      return this.mobile;\n    }\n  }, {\n    key: \"Version\",\n    get: function get() {\n      return this.browserVersion ? this.browserVersion[0].replace(/\\D*/, '') : null;\n    }\n  }]);\n\n  return BrowserImpl;\n}();\n\nvar BrowserEx =\n/*#__PURE__*/\nfunction (_BrowserImpl) {\n  _inheritsLoose(BrowserEx, _BrowserImpl);\n\n  function BrowserEx() {\n    var _this;\n\n    _this = _BrowserImpl.call(this) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"features\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"layout\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"platform\", void 0);\n\n    _this.features = new BrowserImpl_BrowserFeatures();\n    _this.layout = new BrowserLayout();\n    _this.platform = _this.DetectPlatform();\n    return _this;\n  }\n  /**\r\n   * @private\r\n   */\n\n\n  var _proto2 = BrowserEx.prototype;\n\n  _proto2.DetectPlatform = function DetectPlatform() {\n    if (navigator.platform.startsWith('Mac')) {\n      return BrowserPlatform.Mac;\n    }\n\n    if (navigator.platform.startsWith('Win')) {\n      return BrowserPlatform.Windows;\n    }\n\n    return BrowserPlatform.Unknown;\n  };\n\n  _createClass(BrowserEx, [{\n    key: \"Features\",\n    get: function get() {\n      return this.features;\n    }\n    /**\r\n     * @private\r\n     */\n\n  }, {\n    key: \"Layout\",\n    get: function get() {\n      return this.layout;\n    }\n    /**\r\n     * @private\r\n     */\n\n  }, {\n    key: \"Platform\",\n    get: function get() {\n      return this.platform;\n    }\n  }]);\n\n  return BrowserEx;\n}(BrowserImpl);\n\nvar BrowserPublic = new BrowserImpl();\nvar Browser = new BrowserEx();\n\n// CONCATENATED MODULE: ./src/utils/Enums.js\n/**\r\n * Represents the current browser metadata.\r\n * @typedef {Object} BrowserMetadata\r\n * @memberOf Atalasoft.Utils\r\n * @property {boolean} Explorer - Indicates whether current browser is Internet Explorer.\r\n * @property {boolean} Firefox - Indicates whether current browser is Firefox.\r\n * @property {boolean} Safari -  Indicates whether current browser is Safari.\r\n * @property {boolean} Opera -  Indicates whether current browser is Opera.\r\n * @property {boolean} Chrome -  Indicates whether current browser is Google Chrome.\r\n * @property {Object} Mobile - Represents mobile browser indicators.\r\n * @property {boolean} Mobile.iOS - Indicates that current device runs on iOS device.\r\n * @property {boolean} Mobile.Android - Indicates that current device runs on Android device.\r\n * @property {boolean} Mobile.IEMobile - Indicates that current device runs on mobile internet explorer.\r\n * @property {function} Mobile.Any - Checks whether current platform is mobile device.\r\n * @returns {boolean}\r\n */\n\n/**\r\n * Notification callback signature. The callback function that is called without parameters.\r\n * @callback NotificationCallback\r\n */\n\n/**\r\n * Represents point structure.\r\n * @typedef {Object} Point\r\n * @property {number} x - X axis coordinate.\r\n * @property {number} y - Y axis coordinate.\r\n */\n\n/**\r\n * The current browser metadata.\r\n * @type {Atalasoft.Utils.BrowserMetadata}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar Enums_Browser = BrowserPublic;\n/**\r\n *  Specifies the behavior of the mouse from within the WebDocumentViewer.\r\n *  @enum {number}\r\n *  @memberOf Atalasoft.Utils\r\n */\n\nvar MouseToolType = {\n  /** Specify no mouse behavior at all. */\n  None: 0,\n\n  /** Clicking and dragging the mouse will scroll the image. */\n  Pan: 1,\n\n  /** Clicking will zoom in. */\n  ZoomIn: 2,\n\n  /** Clicking will zoom out. */\n  ZoomOut: 3,\n\n  /** Shows a context menu for the clicked object (where applicable). */\n  ContextMenu: 4,\n\n  /** Allows mouse events to pass through the DOM without any handling. */\n  PassThrough: 5,\n\n  /** Mouse will be set to crosshairs and can be used to drag and modify a selection rectangle on the image.\r\n   * This tool requires that the {@link WebDocumentViewerConfig.showselecttools} flag was set.\r\n   */\n  Selection: 6,\n\n  /** Zoom in on a specified area defined by dragging a rectangle onto the image.\r\n   * This tool requires that the {@link WebDocumentViewerConfig.showselecttools} flag was set.\r\n   */\n  ZoomArea: 7,\n\n  /** Input actions are interpreted as text selection\r\n   * This tool requires that the {@link WebDocumentViewerConfig.showselecttools} flag was set.\r\n   */\n  Text: 8\n};\n/** Specifies the cursor used with the mouse tool.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar MouseToolCursor = {\n  /** Automatically determined by the browser. */\n  Auto: '',\n\n  /** An arrow pointer. */\n  Arrow: 'default',\n\n  /** A crosshair usually used in drawing a box. */\n  Crosshair: 'crosshair',\n\n  /** A grabbing cursor. Usually changes to gabbed while the mouse button is down. */\n  Grab: Enums_Browser.Firefox ? '-moz-grab' : 'hand',\n\n  /** A hand with a finger pointing. Usually what the browser uses for clicking hyperlinks. */\n  Hand: 'pointer',\n\n  /** A crosshair pointer with arrowheads on the ends indicating movement. */\n  Move: 'move',\n\n  /** A magnifying glass with a plus sign in it. */\n  ZoomIn: !Enums_Browser.Explorer ? 'zoom-in' : 'pointer',\n\n  /** A magnifying glass with a minus sign in it. */\n  ZoomOut: !Enums_Browser.Explorer ? 'zoom-out' : 'pointer',\n\n  /** A selection editing cursor. */\n  Text: 'text',\n\n  /** A vertical text editing cursor. */\n  VerticalText: 'vertical-text',\n\n  /** A wait cursor. */\n  Wait: 'wait',\n\n  /** A custom CSS cursor string provided by the user. */\n  Custom: '%2'\n};\n/** Specifies the direction of the scrolling.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar ScrollDirection = {\n  /** Scrolls horizontally. */\n  Horizontal: 'horizontal',\n\n  /** Scrolls vertically. */\n  Vertical: 'vertical'\n};\n/** Specifies the fitting options.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar Fitting = {\n  /** No fitting will be applied to the image */\n  None: 0,\n\n  /** Finds the best option between width or height based fitting. */\n  Best: 1,\n\n  /** Fits the image to the available width. */\n  Width: 2,\n\n  /** Fits the image to the available height. */\n  Height: 3\n};\n/** Specifies the page selection method.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar PageSelection = {\n  /** Selects the page under the top left corner of the viewer  */\n  TopLeft: {\n    x: 0,\n    y: 0\n  },\n\n  /** Selects the page under the middle left of the viewer  */\n  MiddleLeft: {\n    x: 0,\n    y: 0.5\n  },\n\n  /** Selects the page under the bottom left corner of the viewer  */\n  BottomLeft: {\n    x: 0,\n    y: 1\n  },\n\n  /** Selects the page under the center location of viewer  */\n  Center: {\n    x: 0.5,\n    y: 0.5\n  }\n};\n/** Specifies the size of the viewport area that triggers document scroll when text selection enters it.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar ScrollArea = {\n  /** Text selection scrolling is disabled */\n  None: 0,\n\n  /** Normal scroll area. Around 10% of the corresponding viewport dimension */\n  Normal: 0.1,\n\n  /** Normal scroll area. Around 20% of the corresponding viewport dimension */\n  Large: 0.2\n};\n/**\r\n * Defines Web Document Thumbnailer selection mode.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n * @readonly \r\n */\n\nvar SelectionMode = {\n  /**\r\n   * Only one thumbnail can be selected \r\n   */\n  SingleSelect: 0,\n\n  /**\r\n   * Multiple thumbnails can be selected\r\n   */\n  MultiSelect: 1\n};\n/**\r\n * Defines the order in which selected thumbnails are ordered\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n * @readonly \r\n */\n\nvar SelectedItemsOrder = {\n  /**\r\n   * Items are sorted in their index order.\r\n   */\n  ItemIndexOrder: 0,\n\n  /**\r\n   * Items are sorted in the order they were selected.\r\n   */\n  SelectedOrder: 1\n};\n/**\r\n * Represents a reason why a file has been rejected by WDV from upload.\r\n * @enum {number}\r\n * @memberOf Atalasoft.Utils\r\n * @readonly \r\n */\n\nvar FileUploadRejectReason = {\n  /**\r\n   * File is not rejected from upload\r\n   */\n  None: 0,\n\n  /**\r\n   * File is bigger than allowed by {@link WebDocumentViewerConfig.upload.allowedmaxfilesize | allowedmaxfilesize} property.\r\n   */\n  Size: 1,\n\n  /**\r\n   * File type or extensions is not allowed by {@link WebDocumentViewerConfig.upload.allowedfiletypes | allowedfiletypes} property.\r\n   */\n  Type: 2,\n\n  /**\r\n   * File with the same name has already added to the upload queue.\r\n   */\n  Name: 3\n};\n\n/* harmony default export */ var Enums = ({\n  FileUploadRejectReason: FileUploadRejectReason,\n  SelectedItemsOrder: SelectedItemsOrder,\n  SelectionMode: SelectionMode,\n  ScrollArea: ScrollArea,\n  PageSelection: PageSelection,\n  Fitting: Fitting,\n  ScrollDirection: ScrollDirection,\n  MouseToolCursor: MouseToolCursor,\n  MouseToolType: MouseToolType,\n  Browser: Enums_Browser\n});\n// CONCATENATED MODULE: ./src/annotations/AnnotationTypes.js\n/**\r\n * Represents supported annotation types.\r\n * @enum {string} AnnotationTypes\r\n * @memberOf Atalasoft.Annotations\r\n */\nvar AnnotationTypes = {\n  /**\r\n   * Image annotation.\r\n   */\n  image: 'image',\n\n  /**\r\n   * Highlight annotation.\r\n   */\n  highlight: 'highlight',\n\n  /**\r\n   * Rectangle annotation.\r\n   */\n  rectangle: 'rectangle',\n\n  /**\r\n   * Filled rectangle annotation.\r\n   */\n  fillrect: 'fillrect',\n\n  /**\r\n   * Text annotation.\r\n   */\n  text: 'text',\n\n  /**\r\n   * Stamp annotation.\r\n   */\n  stamp: 'stamp',\n\n  /**\r\n   * Ellipse annotation.\r\n   */\n  ellipse: 'ellipse',\n\n  /**\r\n   * Single line annotation.\r\n   */\n  line: 'line',\n\n  /**\r\n   * Multiline annotation. Similar to `polygon` but represents not enclosed shape, first and last points are not joined.\r\n   */\n  lines: 'lines',\n\n  /**\r\n   * Freehand annotation.\r\n   */\n  freehand: 'freehand',\n\n  /**\r\n   * Polygon annotation. Similar to `lines` but represents enclosed shape.\r\n   */\n  polygon: 'polygon' // /**\n  //  * Custom annotation type. Behavior is defined by the application.\n  //  */\n  // custom: 'custom'\n\n};\n/* harmony default export */ var annotations_AnnotationTypes = (AnnotationTypes);\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.find.js\nvar es_array_find = __webpack_require__(40);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.join.js\nvar es_array_join = __webpack_require__(29);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.slice.js\nvar es_array_slice = __webpack_require__(17);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.splice.js\nvar es_array_splice = __webpack_require__(10);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.function.name.js\nvar es_function_name = __webpack_require__(22);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.constructor.js\nvar es_number_constructor = __webpack_require__(83);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.search.js\nvar es_string_search = __webpack_require__(87);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.split.js\nvar es_string_split = __webpack_require__(13);\n\n// CONCATENATED MODULE: ./src/controls/Enums.js\n/**\r\n * Exposes the list of internal DOM elements classes that could be used to query and customize UI behavior.\r\n * @enum {string}\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n * @readonly\r\n */\nvar domclasses = {\n  /** Page element class. Container for all page elements - image, annotations, forms, text, etc layers. */\n  atala_page_div: 'atala_page_div',\n\n  /** Page image container that is in initial image load state */\n  atala_page_loading: 'atala_page_loading',\n\n  /** Page image anchor container element class*/\n  atala_page_image_anchor: 'atala_page_image_anchor',\n\n  /** Page image element class*/\n  atala_page_image: 'atala_page_image',\n\n  /** Page index element class. see {@link WebDocumentViewerConfig.showpagenumber | showpagenumber} config option */\n  atala_page_number: 'atala_page_number',\n\n  /** Active page class */\n  atala_active_page: 'atala_active_page',\n\n  /** Active thumbnail class */\n  atala_active_thumb: 'atala_active_thumb',\n\n  /** Thumbnail caption class */\n  atala_thumb_caption: 'atala_thumb_caption',\n\n  /** Document toolbar element class */\n  atala_toolbar: 'atala_toolbar',\n\n  /** Annotations toolbar element class */\n  atala_annotation_toolbar: 'atala_annotation_toolbar',\n\n  /** Toolbar button element class */\n  atala_toolbar_button: 'atala_toolbar_button',\n\n  /** Class of the main outer object that holds the scrollbars */\n  atala_main_container: 'atala_main_container',\n\n  /** Class of the inner object that controls scrolling */\n  atala_scroller: 'atala_scroller',\n\n  /** Class of the inner object that defines the viewable area */\n  atala_viewport: 'atala_viewport',\n\n  /** Inner content container object class */\n  atala_content: 'atala_content',\n\n  /** Thumbnailer draggable area */\n  atala_thumb_draggable: 'atala_thumb_draggable',\n\n  /** Placeholder element that is inserted into Thumbnailer to highlight drop location */\n  atala_drag_placeholder: 'atala_drag_placeholder',\n\n  /** Placeholder inserted before page dom object that is used in virtual scrolling */\n  atala_dom_edge_first: 'atala_dom_edge_first',\n\n  /** Placeholder inserted after page dom object that is used in virtual scrolling */\n  atala_dom_edge_last: 'atala_dom_edge_last',\n\n  /** Inner horizontal scroll bar object class */\n  atala_scroll_horizontal: 'atala_scroll_horizontal',\n\n  /** Inner vertical scroll bar object */\n  atala_scroll_vertical: 'atala_scroll_vertical',\n\n  /** Toolbar span element containing the page number */\n  atala_page_label: 'atala_page_label',\n\n  /** Context or dropdown menu element. Could be multiple instances within same viewer DOM sub tree */\n  atala_context_menu: 'atala_context_menu',\n\n  /** Status div */\n  atala_statusbar: 'atala_statusbar',\n\n  /** \"Save Changes\" toolbar button */\n  atala_tool_button_save: 'atala_tool_button_save',\n\n  /** \"Previous Page\" toolbar button */\n  atala_tool_button_page_prev: 'atala_tool_button_page_prev',\n\n  /** \"Next Page\" toolbar button */\n  atala_tool_button_page_next: 'atala_tool_button_page_next',\n\n  /** \"Zoom Out\" toolbar button */\n  atala_tool_button_zoom_out: 'atala_tool_button_zoom_out',\n\n  /** \"Zoom In\" toolbar button */\n  atala_tool_button_zoom_in: 'atala_tool_button_zoom_in',\n\n  /** \"Full Size\" toolbar button */\n  atala_tool_button_fit_none: 'atala_tool_button_fit_none',\n\n  /** \"Best Fit\" toolbar button */\n  atala_tool_button_fit_best: 'atala_tool_button_fit_best',\n\n  /** \"Fit To Width\" toolbar button */\n  atala_tool_button_fit_width: 'atala_tool_button_fit_width',\n\n  /** \"Zoom Area\" toolbar button */\n  atala_tool_button_zoom_area: 'atala_tool_button_zoom_area',\n\n  /** \"Rotate Left\" tooltip button */\n  atala_tool_button_rotate_left: 'atala_tool_button_rotate_left',\n\n  /** \"Rotate Right\" tooltip button */\n  atala_tool_button_rotate_right: 'atala_tool_button_rotate_right',\n\n  /** \"Text selection\" toolbar button */\n  atala_tool_button_text_tool: 'atala_tool_button_text_tool',\n\n  /** \"Pan\" toolbar button */\n  atala_tool_button_pan_tool: 'atala_tool_button_pan_tool',\n\n  /** \"Draw Ellipse\" annotation toolbar button */\n  atala_tool_button_ellipse_anno: 'atala_tool_button_ellipse_anno',\n\n  /** \"Draw Highlight\" annotation toolbar button */\n  atala_tool_button_highlight_anno: 'atala_tool_button_highlight_anno',\n\n  /** \"Draw Line\" annotation toolbar button */\n  atala_tool_button_line_anno: 'atala_tool_button_line_anno',\n\n  /** \"Draw Poly Lines\" annotation toolbar button */\n  atala_tool_button_lines_anno: 'atala_tool_button_lines_anno',\n\n  /** \"Draw Freehand\" annotation toolbar button */\n  atala_tool_button_freehand_anno: 'atala_tool_button_freehand_anno',\n\n  /** \"Draw Polygon\" annotation toolbar button */\n  atala_tool_button_polygon_anno: 'atala_tool_button_polygon_anno',\n\n  /** \"Draw Rectangle\" annotation toolbar button */\n  atala_tool_button_rect_anno: 'atala_tool_button_rect_anno',\n\n  /** \"Filled Rectangle\" annotation toolbar button */\n  atala_tool_button_fillrect_anno: 'atala_tool_button_fillrect_anno',\n\n  /** \"Draw Text\" annotation toolbar button */\n  atala_tool_button_text_anno: 'atala_tool_button_text_anno',\n\n  /** \"Add a Stamp\" annotation toolbar button */\n  atala_tool_button_stamp_anno: 'atala_tool_button_stamp_anno',\n\n  /** \"Add a Sticky Note\" annotation toolbar button */\n  atala_tool_button_note_anno: 'atala_tool_button_note_anno',\n\n  /** \"Add a Comment\" annotation toolbar button */\n  atala_tool_button_comment_anno: 'atala_tool_button_comment_anno',\n\n  /** Selection Rubberband div object */\n  atala_tool_selection_band: 'atala_tool_selection_band',\n\n  /** Selection Rubberband grip div object */\n  atala_tool_selection_grip: 'atala_tool_selection_grip',\n\n  /** Selection Rubberband mask div object */\n  atala_tool_selection_mask: 'atala_tool_selection_mask',\n\n  /** Selection Rubberband tooltip div object */\n  atala_tool_selection_tooltip: 'atala_tool_selection_tooltip',\n\n  /** Text search containing div object */\n  atala_search_container: 'atala_search_container',\n\n  /** Text search input box */\n  atala_search_input: 'atala_search_input',\n\n  /** Text search next match button */\n  atala_search_next: 'atala_search_next',\n\n  /** Text search previous match button */\n  atala_search_prev: 'atala_search_prev',\n\n  /** \"Upload document\" toolbar button */\n  atala_tool_button_upload: 'atala_tool_button_upload',\n\n  /** Upload control root container */\n  atala_upload_control: 'atala-upload-control',\n\n  /** Upload input control */\n  atala_upload_file: 'atala-upload-file',\n\n  /** Upload control working area container */\n  atala_upload_flex_area: 'atala-upload-flex-area',\n\n  /** Upload control single file status control */\n  atala_upload_single_file: 'atala-upload-single-file',\n\n  /** Upload control multiple files status control */\n  atala_upload_multiple_files: 'atala-upload-multiple-files',\n\n  /** Upload control buttons area container */\n  atala_upload_flex_buttons: 'atala-upload-flex-buttons',\n\n  /** Upload control buttons container */\n  atala_upload_buttons: 'atala-upload-buttons',\n\n  /** Upload control Cancel button */\n  atala_upload_cancel_button: 'atala-upload-cancel-button',\n\n  /** Upload control Ok button */\n  atala_upload_ok_button: 'atala-upload-ok-button',\n\n  /** Upload control Add button */\n  atala_upload_add_button: 'atala-upload-add-button',\n\n  /** Upload control multiple files Name column header */\n  atala_upload_files_header_name: 'atala-upload-files-header-name',\n\n  /** Upload control multiple files Size column header */\n  atala_upload_files_header_size: 'atala-upload-files-header-size',\n\n  /** Upload control multiple files Status column header */\n  atala_upload_files_header_status: 'atala-upload-files-header-status',\n\n  /** Tile column */\n  atala_tile_column: 'atala_tile_column',\n\n  /** Tiled page */\n  atala_tiled_page_image: 'atala_tiled_page_image',\n\n  /** Show bookmarks' toolbar button */\n  atala_tool_button_bookmarks: 'atala_tool_button_bookmarks',\n\n  /** Bookmark control */\n  atala_bookmark_content: 'atala_bookmark_content',\n\n  /** Header of bookmark control */\n  atala_bookmark_header: 'atala_bookmark_header'\n};\n/**\r\n * Exposes list of well-known attributes that are used to provide additional information for DOM elements\r\n * @enum {string}\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n */\n\nvar domattributes = {\n  /** Index of the page currently displayed within the element. applies to elements having `.atala_page_div` class */\n  atala_page_index: 'atala_page_index'\n};\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.map.js\nvar es_array_map = __webpack_require__(30);\n\n// CONCATENATED MODULE: ./src/utils/DependencyChecker.ts\n\n\n\n\n\n\nfunction _newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction DependencyChecker_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\nvar ViewerDependencyName;\n\n(function (ViewerDependencyName) {\n  ViewerDependencyName[\"Jquery\"] = \"jQuery\";\n  ViewerDependencyName[\"JqueryUI\"] = \"jQuery UI\";\n  ViewerDependencyName[\"RaphaelJS\"] = \"Rapha\\xEBl\";\n  ViewerDependencyName[\"Clipboard\"] = \"clipboard.js\";\n})(ViewerDependencyName || (ViewerDependencyName = {}));\n\nvar DependencyChecker =\n/*#__PURE__*/\nfunction () {\n  function DependencyChecker() {}\n\n  var _proto = DependencyChecker.prototype;\n\n  _proto.checkDependency = function checkDependency(dependency, name) {\n    var _this = this;\n\n    var requiredDep = DependencyChecker.requiredDependencies.filter(function (dep) {\n      _newArrowCheck(this, _this);\n\n      return dep.name === name;\n    }.bind(this))[0];\n    var result = {\n      dependency: requiredDep,\n      success: false,\n      reason: 'Dependency is not loaded or not found.'\n    };\n\n    if (dependency) {\n      var depVersion = '';\n\n      if (!!dependency.fn && !!dependency.fn.jquery) {\n        depVersion = dependency.fn.jquery;\n      } else if (dependency.version) {\n        depVersion = dependency.version;\n      }\n\n      switch (name) {\n        case ViewerDependencyName.Clipboard:\n          result.success = true;\n          result.reason = 'WDV can\\'t verify the version of the dependency.';\n          break;\n\n        case ViewerDependencyName.Jquery:\n        case ViewerDependencyName.JqueryUI:\n        case ViewerDependencyName.RaphaelJS:\n          if (this.hasNewerVersion(depVersion, requiredDep.version)) {\n            result.success = true;\n            result.reason = '';\n          } else {\n            result.reason = \"Dependency has a lower version (\" + depVersion + \") than required.\";\n          }\n\n      }\n    }\n\n    if (result.reason.length > 0) {\n      result.reason += \" The minimal required version is '\" + requiredDep.version + \"'.\";\n    }\n\n    return result;\n  };\n\n  _proto.hasNewerVersion = function hasNewerVersion(dependencyVersion, requiredVersion) {\n    var _this2 = this;\n\n    var isSemVerStrRegExp = /^[0-9]+\\.[0-9]+\\.[0-9]+(-([A-Za-z0-9-]+\\.?)+)?(\\+([A-Za-z0-9-]+\\.?)+)?$/;\n\n    if (isSemVerStrRegExp.test(dependencyVersion)) {\n      var versionRegExp = /^[0-9]+\\.[0-9]+\\.[0-9]+/;\n\n      var parseVersionString = function parseVersionString(versionStr) {\n        var _this3 = this;\n\n        _newArrowCheck(this, _this2);\n\n        if (versionRegExp !== null) {\n          var results = versionRegExp.exec(versionStr);\n          if (results != null && results.length > 0) return results[0].split('.').map(function (ns) {\n            _newArrowCheck(this, _this3);\n\n            return parseInt(ns);\n          }.bind(this));\n        }\n\n        return [];\n      }.bind(this);\n\n      var depVersionNums = parseVersionString(dependencyVersion);\n      var reqVersionNums = parseVersionString(requiredVersion);\n\n      for (var i = 0; i < 3; i++) {\n        if (depVersionNums[i] < reqVersionNums[i]) return false;\n        if (depVersionNums[i] > reqVersionNums[i]) return true;\n      } //If version numbers are equal, then check does it has build metadata or is it pre-release?\n\n\n      var depVersionTail = dependencyVersion.replace(versionRegExp, '');\n      return depVersionTail.length === 0 || depVersionTail[0] === '+';\n    }\n\n    return false;\n  };\n\n  return DependencyChecker;\n}();\n\nDependencyChecker_defineProperty(DependencyChecker, \"requiredDependencies\", [{\n  name: ViewerDependencyName.Jquery,\n  version: '1.12.4'\n}, {\n  name: ViewerDependencyName.JqueryUI,\n  version: '1.12.'\n}, {\n  name: ViewerDependencyName.RaphaelJS,\n  version: '2.1.0'\n}, {\n  name: ViewerDependencyName.Clipboard,\n  version: '2.0.0'\n}]);\n\nfunction checkDependency(checker, dependency, name, onFail, onSuccess) {\n  var checkResult = checker.checkDependency(dependency, name);\n\n  if (checkResult.success) {\n    if (onSuccess) onSuccess(name, checkResult.reason);\n    return true;\n  } else {\n    onFail(name, checkResult.reason);\n    return false;\n  }\n}\n\nfunction checkDependencies(params) {\n  var _this4 = this;\n\n  var depChecker = new DependencyChecker();\n\n  var logError = function logError(depName, reason) {\n    _newArrowCheck(this, _this4);\n\n    console.error(\"The dependency verification for '\" + depName + \"' has failed. \" + reason);\n  }.bind(this);\n\n  var logInfoOnSuccess = function logInfoOnSuccess(depName, reason) {//I still not sure should we show this message or not?\n    //console.info(`The dependency verification for '${depName}' has passed with notes. ${reason}`);\n\n    _newArrowCheck(this, _this4);\n  }.bind(this);\n\n  var result = checkDependency(depChecker, atalaJquery === undefined ? null : atalaJquery, ViewerDependencyName.Jquery, logError);\n  if (params.checkjQueryOnly) return result;\n  if (result) result = checkDependency(depChecker, atalaJquery.ui, ViewerDependencyName.JqueryUI, logError);\n\n  if (params.checkRaphael) {\n    result = checkDependency(depChecker, atalaRaphael === undefined ? null : atalaRaphael, ViewerDependencyName.RaphaelJS, logError) && result;\n  }\n\n  if (params.checkClipboard) {\n    result = checkDependency(depChecker, atalaClipboard === undefined ? null : atalaClipboard, ViewerDependencyName.Clipboard, logError, logInfoOnSuccess) && result;\n  }\n\n  return result;\n}\n\nfunction checkJQueryDependency() {\n  return checkDependencies({\n    checkjQueryOnly: true,\n    checkRaphael: false,\n    checkClipboard: false\n  });\n}\nfunction checkViewerDependencies(allowAnnotations, allowText) {\n  return checkDependencies({\n    checkjQueryOnly: false,\n    checkRaphael: allowAnnotations || allowText,\n    checkClipboard: allowText\n  });\n}\n// CONCATENATED MODULE: ./src/utils/LocalizationEnums.js\n/** Annotations related strings.\r\n * @enum {string}\r\n * @memberOf Atalasoft.Utils\r\n */\nvar LocalizationAnnotationStrings = {\n  // context menu items\n\n  /**\r\n   * Delete button title for annotation context menu.\r\n   */\n  menuDeleteButton: 'Delete',\n\n  /**\r\n   * Properties button title for annotation context menu.\r\n   */\n  menuPropertiesButton: 'Properties',\n  // properties dialog buttons\n\n  /**\r\n   * OK button title for annotation property dialog.\r\n   */\n  dialogButtonOk: 'OK',\n\n  /**\r\n   * Reset button title for annotation property dialog.\r\n   */\n  dialogButtonReset: 'Reset',\n\n  /**\r\n   * Cancel button title for annotation property dialog.\r\n   */\n  dialogButtonCancel: 'Cancel',\n  // properties dialogs titles\n\n  /**\r\n   * Rectangle annotation properties dialog title.\r\n   */\n  rectangleDialogTitle: 'Rectangle Annotation Properties',\n\n  /**\r\n   * Text annotation properties dialog title.\r\n   */\n  textDialogTitle: 'Text Annotation Properties',\n\n  /**\r\n   * Ellipse annotation properties dialog title.\r\n   */\n  ellipseDialogTitle: 'Ellipse Annotation Properties',\n\n  /**\r\n   * Line annotation properties dialog title.\r\n   */\n  lineDialogTitle: 'Line Annotation Properties',\n\n  /**\r\n   * Lines annotation properties dialog title.\r\n   */\n  linesDialogTitle: 'Lines Annotation Properties',\n\n  /**\r\n   * Freehand annotation properties dialog title.\r\n   */\n  freehandDialogTitle: 'Freehand Annotation Properties',\n\n  /**\r\n   * Polygon annotation properties dialog title.\r\n   */\n  polygonDialogTitle: 'Polygon Annotation Properties',\n  // properties dialogs labels\n\n  /**\r\n   * Title for Fill Color annotation property.\r\n   */\n  labelFillColor: 'Fill Color:',\n\n  /**\r\n   * Title for Fill Opacity annotation property.\r\n   */\n  labelFillOpacity: 'Fill Opacity:',\n\n  /**\r\n   * Title for Rotation annotation property.\r\n   */\n  labelRotation: 'Rotation:',\n\n  /**\r\n   * Title for Outline Color annotation property.\r\n   */\n  labelOutlineColor: 'Outline Color:',\n\n  /**\r\n   * Title for Outline Opacity annotation property.\r\n   */\n  labelOutlineOpacity: 'Outline Opacity:',\n\n  /**\r\n   * Title for Outline Width annotation property.\r\n   */\n  labelOutlineWidth: 'Outline Width:',\n\n  /**\r\n   * Title for Outline Startcap Width annotation property.\r\n   */\n  labelOutlineStartcapWidth: 'Outline Startcap Width:',\n\n  /**\r\n   * Title for Outline Startcap Height annotation property.\r\n   */\n  labelOutlineStartcapHeight: 'Outline Startcap Height:',\n\n  /**\r\n   * Title for Outline Startcap Style annotation property.\r\n   */\n  labelOutlineStartcapStyle: 'Outline Startcap Style:',\n\n  /**\r\n   * Title for Outline Endcap Width annotation property.\r\n   */\n  labelOutlineEndcapWidth: 'Outline Endcap Width:',\n\n  /**\r\n   * Title for Outline Endcap Height annotation property.\r\n   */\n  labelOutlineEndcapHeight: 'Outline Endcap Height:',\n\n  /**\r\n   * Title for Outline Endcap Style annotation property.\r\n   */\n  labelOutlineEndcapStyle: 'Outline Endcap Style:',\n\n  /**\r\n   * Title for Font Bold annotation property.\r\n   */\n  labelFontBold: 'Font Bold:',\n\n  /**\r\n   * Title for Font Italic annotation property.\r\n   */\n  labelFontItalic: 'Font Italic:',\n\n  /**\r\n   * Title for Font Color annotation property.\r\n   */\n  labelFontColor: 'Font Color:',\n\n  /**\r\n   * Title for Font Family annotation property.\r\n   */\n  labelFontFamily: 'Font Family:',\n\n  /**\r\n   * Title for Font Size annotation property.\r\n   */\n  labelFontSize: 'Font Size:',\n  // true/false radio buttons\n\n  /**\r\n   * Title for True radio button.\r\n   */\n  radioButtonTrue: 'True',\n\n  /**\r\n   * Title for False radio button.\r\n   */\n  radioButtonFalse: 'False',\n  // Startcap/Endcap style values\n\n  /**\r\n   * Startcap/Endcap style \"None\".\r\n   */\n  valueStyleNone: 'None',\n\n  /**\r\n   * Startcap/Endcap style \"None\".\r\n   */\n  valueStyleOpen: 'Arrow',\n\n  /**\r\n   * Startcap/Endcap style \"Filled Arrow\".\r\n   */\n  valueStyleBlock: 'Filled Arrow',\n\n  /**\r\n   * Startcap/Endcap style \"Filles Ellipse\".\r\n   */\n  valueStyleOval: 'Filled Ellipse',\n\n  /**\r\n   * Startcap/Endcap style \"Filled Diamond\".\r\n   */\n  valueStyleDiamond: 'Filled Diamond',\n  // Startcap/Endcap width values\n\n  /**\r\n   * Startcap/Endcap width \"medium\".\r\n   */\n  valueWidthMedium: 'medium',\n\n  /**\r\n   * Startcap/Endcap width \"wide\".\r\n   */\n  valueWidthWide: 'wide',\n\n  /**\r\n   * Startcap/Endcap width \"narrow\".\r\n   */\n  valueWidthNarrow: 'narrow',\n  // Startcap/Endcap height values\n\n  /**\r\n   * Startcap/Endcap height \"medium\".\r\n   */\n  valueHeightMedium: 'medium',\n\n  /**\r\n   * Startcap/Endcap height \"long\".\r\n   */\n  valueHeightLong: 'long',\n\n  /**\r\n   * Startcap/Endcap height \"short\".\r\n   */\n  valueHeightShort: 'short'\n};\n/**\r\n * Represents strings for {@link Atalasoft.Controls.WebDocumentViewer|WebDocumentViewer} localization.\r\n * @property {Atalasoft.Utils.LocalizationAnnotationStrings} annotations - Contains a translation table for annotations specific strings.\r\n * @memberOf Atalasoft.Utils\r\n */\n\nvar LocalizationStrings = {\n  annotations: LocalizationAnnotationStrings\n};\n\n/* harmony default export */ var LocalizationEnums = ({\n  LocalizationAnnotationStrings: LocalizationAnnotationStrings,\n  LocalizationStrings: LocalizationStrings\n});\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.trim.js\nvar es_string_trim = __webpack_require__(41);\n\n// CONCATENATED MODULE: ./src/utils/Utils.ts\n\n\n\n\nfunction Utils_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n// gets the mouse position from a mouse event\n// e: browser's mouse event object\n// p: 'point' object to set values of\n// o: dom object to calculate relative position\n\n/**\r\n * @private\r\n */\nfunction getMousePosition(ev, point, domObj) {\n  if (!point) {\n    point = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  if (!domObj) {\n    domObj = ev.target instanceof HTMLElement ? ev.target : null;\n  }\n\n  if (Browser.Explorer) {\n    if (ev === null) {\n      ev = event;\n    }\n  }\n\n  if (ev instanceof MouseEvent) {\n    point.x = ev.clientX;\n    point.y = ev.clientY;\n  } else {\n    point.x = ev.touches[0].clientX;\n    point.y = ev.touches[0].clientY;\n  }\n\n  while (domObj && !isNaN(domObj.offsetLeft) && !isNaN(domObj.offsetTop)) {\n    point.x -= domObj.offsetLeft - domObj.scrollLeft;\n    point.y -= domObj.offsetTop - domObj.scrollTop;\n    domObj = domObj.offsetParent instanceof HTMLElement ? domObj.offsetParent : null;\n  }\n\n  return point;\n} // gets the mouse position from a jQuery mouse event\n// e: jQuery mouse event object\n// p: 'point' object to set values of\n// ignoreWrongTarget: bool to indicate whether to ignore the target being different from currentTarget\n\n/**\r\n * @private\r\n */\n\nfunction getMousePositionJquery(e, p, ignoreWrongTarget) {\n  if (!p) {\n    p = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var origEvent = e.originalEvent;\n\n  if (!(e.offsetX || e.offsetY)) {\n    if (Browser.Explorer) {\n      if (origEvent instanceof MouseEvent) {\n        p.x = origEvent.x;\n        p.y = origEvent.y;\n      } else {\n        p.x = 0;\n        p.y = 0;\n      }\n    } else {\n      var offset = null;\n      var target = e.target;\n\n      if (origEvent instanceof TouchEvent && origEvent.touches.length === 1) {\n        target = document.elementFromPoint(origEvent.touches[0].clientX, origEvent.touches[0].clientY);\n      }\n\n      var touch = Browser.Features.Touch && origEvent instanceof TouchEvent ? origEvent.touches[0] : null;\n      var jqTarget = atalaJquery(target);\n      var eventPage = {\n        pageX: 0,\n        pageY: 0\n      };\n\n      if (touch !== null) {\n        eventPage.pageX = touch.pageX;\n        eventPage.pageY = touch.pageY;\n      } else if (origEvent instanceof MouseEvent) {\n        eventPage.pageX = origEvent.pageX;\n        eventPage.pageY = origEvent.pageY;\n      }\n\n      if (!(eventPage.pageX || eventPage.pageY)) {\n        eventPage.pageX = e.pageX;\n        eventPage.pageY = e.pageY;\n      } // :eq is deprecated in jQuery 3.4.0 and will be removed in jQuery 4.0!!!\n\n\n      if (e.target.raphael) {\n        // SVG target, jquery bug calculates offsets wrong \n        offset = jqTarget.parents('div:eq(0)').offset();\n      } else if (e.target.raphaelParent || jqTarget.parents('svg').length > 0) {\n        // html inside svg\n        offset = jqTarget.parents('svg').parents('div:eq(0)').offset();\n      }\n\n      if (!offset) {\n        offset = jqTarget.offset();\n      }\n\n      if (offset) {\n        p.x = eventPage.pageX - offset.left;\n        p.y = eventPage.pageY - offset.top;\n      } else {\n        p.x = eventPage.pageX;\n        p.y = eventPage.pageY;\n      }\n    }\n  } else {\n    if (Browser.Firefox) {\n      // e.offsetX and e.offsetY are not supported well in Firefox\n      // so we have to calculate them using normalized jQuery values\n      var pOffset = e.target.raphaelParent ? // html inside svg\n      atalaJquery(e.target).parents('svg').offset() : atalaJquery(e.target.offsetParent || e.target.parentNode).offset();\n\n      if (pOffset) {\n        p.x = e.pageX - pOffset.left;\n        p.y = e.pageY - pOffset.top;\n      } else {\n        p.x = e.pageX;\n        p.y = e.pageY;\n      }\n    } else if (origEvent !== undefined && origEvent.currentTarget !== origEvent.target && !ignoreWrongTarget) {\n      if (!(origEvent.currentTarget.offsetLeft || origEvent.currentTarget.offsetTop) && origEvent.currentTarget.ownerSVGElement) {\n        // there doesn't seem to be a way to get the relative position of a nested svg element in IE9\n        var bbox = Browser.Explorer ? origEvent.currentTarget.ownerSVGElement.getBBox() : origEvent.currentTarget.getBBox();\n        p.x = Math.round(bbox.x);\n        p.y = Math.round(bbox.y);\n      } else {\n        p.x = origEvent.currentTarget.offsetLeft + e.offsetX;\n        p.y = origEvent.currentTarget.offsetTop + e.offsetY;\n      }\n    } else {\n      p.x = e.offsetX;\n      p.y = e.offsetY;\n    }\n  }\n\n  return p;\n}\n/**\r\n * Gets the normalized offsetLeft and offsetTop from an SVG element\r\n * with respect to its parent jQuery object\r\n * @private\r\n * @param objSVG: object, svg object from the dom\r\n * @param parent: object, jQuery object representing the parent DOM node\r\n */\n\nfunction getSVGOffset(objSVG, parent) {\n  var offset = {\n    left: 0,\n    top: 0\n  };\n\n  if (objSVG instanceof HTMLElement) {\n    offset.left = objSVG.offsetLeft;\n    offset.top = objSVG.offsetTop;\n  } else {\n    var sOffset = atalaJquery(objSVG).offset();\n    var pOffset = parent.offset();\n\n    if (sOffset && pOffset) {\n      offset.left = sOffset.left - pOffset.left;\n      offset.top = sOffset.top - pOffset.top;\n    }\n  }\n\n  return offset;\n}\n/**\r\n * @private\r\n */\n\nfunction getJSPath(s) {\n  // grabs all script tags that have a src tag that matches the given string\n  var jstag = atalaJquery('script[src*=\"' + s + '\"]');\n\n  if (jstag.length > 0) {\n    // the js folder path\n    var srcAttr = jstag.attr('src');\n    if (srcAttr) return srcAttr.replace(s, '');else return '';\n  } else {\n    // path not found\n    return '';\n  }\n}\n/**\r\n * @private\r\n */\n\nfunction CalcDistance(x1, y1, x2, y2, old) {\n  var highX = Math.max(x1, x2);\n  var lowX = Math.min(x1, x2);\n  var highY = Math.max(y1, y2);\n  var lowY = Math.min(y1, y2);\n  return {\n    x: highX - lowX,\n    y: highY - lowY,\n    dx: old ? old.left - lowX : 0,\n    dy: old ? old.top - lowY : 0,\n    left: lowX,\n    right: highX,\n    top: lowY,\n    bottom: highY\n  };\n}\n/**\r\n * Creates a rectangle object.\r\n * @private\r\n */\n\nfunction makeRect(x, y, w, h) {\n  return {\n    x: x,\n    y: y,\n    width: w,\n    height: h\n  };\n}\n/**\r\n * Calculates rectangle bounds for the clockwise page rotation to the specified angle.\r\n * @private\r\n * @param rect\r\n * @param page\r\n * @param angle positive number, must be exactly divisible by 90.\r\n */\n\nfunction rotateRect(rect, page, angle) {\n  if (angle === 0) {\n    return rect;\n  }\n\n  angle = (angle - angle % 90) % 360;\n  var left = rect.x;\n  var top = rect.y;\n\n  switch (angle) {\n    case 90:\n      left = page.height - rect.y - rect.height;\n      top = rect.x;\n      break;\n\n    case 180:\n      left = page.width - rect.x - rect.width;\n      top = page.height - rect.y - rect.height;\n      break;\n\n    case 270:\n      left = rect.y;\n      top = page.width - rect.x - rect.width;\n      break;\n  }\n\n  return makeRect(left, top, angle === 90 || angle === 270 ? rect.height : rect.width, angle === 90 || angle === 270 ? rect.width : rect.height);\n}\n/**\r\n * Calculates new point coordinates for the clockwise page rotation to the specified angle.\r\n * @private\r\n * @param point\r\n * @param page\r\n * @param angle positive number, must be exactly divisible by 90.\r\n */\n\nfunction rotatePoint(point, page, angle) {\n  return rotateRect({\n    x: point.x,\n    y: point.y,\n    width: 0,\n    height: 0\n  }, page, angle);\n}\n/**\r\n * just a simple function to return false without writing it repeatedly\r\n * @private\r\n */\n\nfunction __rf() {\n  return false;\n}\n/**\r\n * just a simple empty function\r\n * @private\r\n */\n\nfunction __ef() {}\n/**\r\n * just a simple event handler to stop the propagation of an event.\r\n * @private\r\n */\n\nfunction __sp(e) {\n  e.stopPropagation();\n}\n/**\r\n * Creates a function that wraps multiple functions into one\r\n * @private\r\n * @param arr: array of functions\r\n * @param arguments to pass to called functions\r\n */\n\nfunction __functionFromArray(arr) {\n  return function () {\n    while (arr.length) {\n      var arrElem = arr.shift();\n      if (arrElem) arrElem.apply(this, arguments);\n    }\n  };\n}\n/**\r\n * @private\r\n */\n\nfunction __htmlTransformStyle(transform) {\n  return {\n    ' transform': transform,\n    '-moz-transform': transform,\n    '-webkit-transform': transform,\n    '-o-transform': transform,\n    '-ms-transform': transform\n  };\n}\n/**\r\n * @private\r\n */\n\nfunction __calcPathBounds(points, m) {\n  var _this = this;\n\n  var bbox = {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  };\n\n  if (!points || !points.length) {\n    return bbox;\n  }\n\n  m = m || atalaRaphael.matrix();\n  bbox.x = m.x(points[0].x, points[0].y);\n  bbox.y = m.y(points[0].x, points[0].y);\n  points.forEach(function (point) {\n    Utils_newArrowCheck(this, _this);\n\n    var p = {\n      x: m.x(point.x, point.y),\n      y: m.y(point.x, point.y)\n    };\n    bbox.x = p.x < bbox.x ? p.x : bbox.x;\n    bbox.y = p.y < bbox.y ? p.y : bbox.y;\n    bbox.width = p.x > bbox.width ? p.x : bbox.width;\n    bbox.height = p.y > bbox.height ? p.y : bbox.height;\n  }.bind(this));\n  bbox.width -= bbox.x;\n  bbox.height -= bbox.y;\n  return bbox;\n}\n/**\r\n * @private\r\n */\n\nfunction ParseInt(number) {\n  if (typeof number === 'string') {\n    var trimmedNumberStr = number.trim();\n    var parsedNumber = parseInt(trimmedNumberStr);\n\n    if (/^([+|-]?[0-9]+)$/.test(trimmedNumberStr)) {\n      return parsedNumber;\n    }\n  }\n\n  if (typeof number !== 'number') return null;else return number;\n}\n/**\r\n * @private \r\n */\n\nfunction IsInteger(num) {\n  return isFinite(num) && !(num % 1);\n}\nfunction IsNumber(num) {\n  return !isNaN(num) && isFinite(num);\n}\nvar Statics = {\n  instanceCounter: 0\n};\n// CONCATENATED MODULE: ./src/utils/DocumentStateManager.ts\nfunction DocumentStateManager_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2015 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n// WDT internal functions to expose activation and registration API\nvar DocumentStateManager =\n/*#__PURE__*/\nfunction () {\n  function DocumentStateManager(viewer) {\n    DocumentStateManager_defineProperty(this, \"viewer\", void 0);\n\n    DocumentStateManager_defineProperty(this, \"currentThumb\", void 0);\n\n    this.viewer = viewer;\n    this.currentThumb = null;\n  }\n\n  var _proto = DocumentStateManager.prototype;\n\n  _proto.isViewerActive = function isViewerActive() {\n    return !!(this.viewer && this.currentThumb);\n  };\n\n  _proto.isThumbnailerActive = function isThumbnailerActive(thumbnailer) {\n    return thumbnailer && !!this.currentThumb && this.currentThumb.get() === thumbnailer.get();\n  };\n\n  _proto.activateThumbnailer = function activateThumbnailer(thumbnailer, docInfo, link, config, force) {\n    var isActiveThumb = this.isThumbnailerActive(thumbnailer);\n\n    if (isActiveThumb && !force) {\n      return;\n    }\n\n    if (this.currentThumb && !isActiveThumb) {\n      this.currentThumb.detachViewer();\n    }\n\n    this.currentThumb = thumbnailer;\n\n    if (this.viewer && this.viewer.isInitialized()) {\n      this.viewer.switchDocument(docInfo, link, config);\n      this.currentThumb.activateViewer();\n    }\n  };\n\n  _proto.closeDocument = function closeDocument(thumbnailer, link) {\n    thumbnailer = thumbnailer || this.currentThumb;\n    var isActiveThumb = this.isThumbnailerActive(thumbnailer);\n\n    if (isActiveThumb) {\n      thumbnailer.detachViewer();\n      this.currentThumb = null;\n    }\n\n    if (this.viewer && this.viewer.isInitialized() && link) {\n      this.viewer.closeDocument(link, isActiveThumb);\n    }\n  };\n\n  return DocumentStateManager;\n}();\n\n\n// CONCATENATED MODULE: ./src/utils/MemoryTracker.ts\nfunction MemoryTracker_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction MemoryTracker_createClass(Constructor, protoProps, staticProps) { if (protoProps) MemoryTracker_defineProperties(Constructor.prototype, protoProps); if (staticProps) MemoryTracker_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction MemoryTracker_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\nvar MemoryTracker_MemoryTracker =\n/*#__PURE__*/\nfunction () {\n  function MemoryTracker(settings) {\n    MemoryTracker_defineProperty(this, \"jqe\", atalaJquery({}));\n\n    MemoryTracker_defineProperty(this, \"memoryEntries\", []);\n\n    MemoryTracker_defineProperty(this, \"config\", {\n      colorDepth: 8,\n      // bit depth of the image\n      compression: 1,\n      //(Atalasoft.Utils.Browser.Explorer && Atalasoft.Utils.Browser.Version > 9) ? 0.055 : 1,\t\t// approximate compression factor\n      highWaterMark: 500000000,\n      // memory limit for reporting low-ish memory (500MB)\n      pageSize: {\n        // default image size to use when tags haven't loaded\n        width: 800,\n        height: 1132\n      }\n    });\n\n    MemoryTracker_defineProperty(this, \"bytesInUse\", 0);\n\n    // map settings onto config\n    if (settings) atalaJquery.extend(this.config, settings);\n  }\n\n  var _proto = MemoryTracker.prototype;\n\n  _proto.dispose = function dispose() {\n    this.clearEntries();\n  };\n\n  // jQuery bind shortcut\n  _proto.bind = function bind() {\n    this.jqe.on.apply(this.jqe, arguments);\n    return this;\n  } // jQuery unbind shortcut\n  ;\n\n  _proto.unbind = function unbind() {\n    this.jqe.off.apply(this.jqe, arguments);\n    return this;\n  } // jQuery trigger shortcut\n  ;\n\n  _proto.trigger = function trigger(eventName) {\n    this.jqe.trigger.apply(this.jqe, arguments);\n    return this;\n  } // calculates approximate memory allocation based on size and bit depth of img tag\n  ;\n\n  _proto.allocate = function allocate(img) {\n    this.memoryEntries.push(img);\n    this.bytesInUse += this.calcBytes(img);\n\n    if (this.bytesInUse > this.config.highWaterMark) {\n      this.trigger('exceededhighwatermark');\n    }\n\n    return this.bytesInUse;\n  } // removes the oldest entry from the memory entries, and returns it for disposal\n  ;\n\n  _proto.deallocateOldestEntry = function deallocateOldestEntry() {\n    // remove img tag from entries\n    var dealloc = this.memoryEntries.shift(); // update bytes in use\n\n    if (dealloc !== undefined) this.deallocate(dealloc); // return deallocated img tag so parent control can release it\n\n    return dealloc;\n  } // used to reset after a new image has loaded\n  ;\n\n  _proto.clearEntries = function clearEntries() {\n    this.memoryEntries.length = 0;\n    this.bytesInUse = 0;\n  } // calculates approximate memory deallocation based on size and bit depth of img tag\n  ;\n\n  _proto.deallocate = function deallocate(img) {\n    this.bytesInUse -= this.calcBytes(img);\n    if (this.bytesInUse < 0) this.bytesInUse = 0;\n    return this.bytesInUse;\n  };\n\n  _proto.calcBytes = function calcBytes(img) {\n    var w = img.width() || this.config.pageSize.width;\n    var h = img.height() || this.config.pageSize.height;\n    return w * h * this.config.colorDepth / 8 * this.config.compression;\n  };\n\n  MemoryTracker_createClass(MemoryTracker, [{\n    key: \"typeOf\",\n    get: function get() {\n      return 'Atalasoft.Document.MemoryTacker';\n    }\n  }, {\n    key: \"colorDepth\",\n    set: function set(depth) {\n      this.config.colorDepth = depth;\n    },\n    get: function get() {\n      return this.config.colorDepth;\n    }\n  }, {\n    key: \"highWatermark\",\n    set: function set(watermark) {\n      this.config.highWaterMark = watermark;\n    },\n    get: function get() {\n      return this.config.highWaterMark;\n    }\n  }, {\n    key: \"pageSize\",\n    set: function set(pageSize) {\n      this.config.pageSize = {\n        width: pageSize.width,\n        height: pageSize.height\n      };\n    },\n    get: function get() {\n      return this.config.pageSize;\n    }\n  }]);\n\n  return MemoryTracker;\n}();\n\n\n// CONCATENATED MODULE: ./src/Version.ts\n//-------------------------------------------------------------------------------------------------\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n/* harmony default export */ var Version = ([11, 4, 0, 446]);\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.to-fixed.js\nvar es_number_to_fixed = __webpack_require__(61);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js\nvar es_object_to_string = __webpack_require__(88);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.to-string.js\nvar es_regexp_to_string = __webpack_require__(62);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.fill.js\nvar es_array_fill = __webpack_require__(115);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.bold.js\nvar es_string_bold = __webpack_require__(63);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.italics.js\nvar es_string_italics = __webpack_require__(66);\n\n// CONCATENATED MODULE: ./src/annotations/text/AnnotationTextRenderer.js\n\n\n\n\n\n//\n//  Renders textarea tags to a base64 data string\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t03-01-13\tD. Cilley\t\tFile Created.\n//\t03-01-13\tD. Cilley\t\tFB 14066: Normalized TextAnnotations to use HTML rendering for all browsers.\n//\t01-22-14\tD. Cilley\t\tBug 307592: Fixed RTL text rendering in IE9+\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//-------------------------------------------------------------------------------------------------\n // creates an object that renders TextData to base64 dataUrl, using a canvas tag \n\nvar AnnotationTextRenderer_AnnotationTextRenderer = function AnnotationTextRenderer(annData, fontUI, viewerPage) {\n  var _self = this;\n\n  var _data = annData; // annotation data object (do not modify)\n\n  var _font = fontUI; // FontUI object from the TextAnnotationUI\n\n  var _canvas = null; // canvas for offscreen rendering\n\n  var _span = null; // span tag for line height calculation\n\n  var _rtl = false; // boolean set when text should be rendered right to left\n\n  var _separators = {\n    // separators to split text on (normalized on IE and Webkit behavior)\n    ' ': true,\n    '-': true,\n    '?': true,\n    '\\n': true,\n    '\\t': true\n  };\n  var annotationOwningPage = viewerPage;\n  var _lastRenderData = null; // cache to avoid unnecessary images generation on annotation drag\n\n  function init() {\n    detectRtl();\n    _canvas = atalaJquery('<canvas ' + (_rtl ? 'dir=\"rtl\"' : '') + '/>'); // negative left values move object off screen in a way that doesn't make scrollbars appear\n\n    _span = atalaJquery('<span class=\"atala_span\">{[|,0123456789Thqkbfjplyg</span>');\n    atalaJquery(annotationOwningPage).append(_span);\n  }\n\n  function detectRtl() {\n    var body = document.body;\n    var v;\n\n    if (body.currentStyle) {\n      v = body.currentStyle.direction;\n    } else if (window.getComputedStyle) {\n      v = document.defaultView.getComputedStyle(body, null).getPropertyValue('direction');\n    }\n\n    if (v.toLowerCase() === 'rtl') {\n      _rtl = true;\n    }\n  } // Dispose\n\n\n  _self.dispose = dispose;\n\n  function dispose() {\n    _self = null;\n    _data = null;\n    _font = null; // objects created by the renderer\n\n    if (_canvas && _canvas.remove) {\n      _canvas.remove();\n\n      _canvas = null;\n    }\n\n    if (_span && _span.remove) {\n      _span.remove();\n\n      _span = null;\n    }\n\n    annotationOwningPage = null;\n  }\n\n  _self.renderToDataURL = renderToDataUrl;\n\n  function renderToDataUrl(size) {\n    if (!_canvas || !_span) {\n      init();\n    }\n\n    _font.applyTo(_span);\n\n    _canvas[0].width = size.width; //(props.paddingLeft + props.paddingRight + txt.width());\n\n    _canvas[0].height = size.height; //(props.paddingTop + props.paddingTop + txt.height());\n    //need to accommodate for outline/2 + margin\n    // need new context for each render\n\n    var ctx = _canvas[0].getContext('2d');\n\n    var lines = splitLines(ctx, _data.text.value, size.width);\n    var lineHeight = calculateLineHeight(lines.length);\n    var fontSize = !_data.text.autoscale ? _data.text.font.size : lineHeight;\n    var ctxfont = [_data.text.font.italic ? 'italic' : 'normal', _data.text.font.bold ? 'bold' : 'normal', fontSize + 'px', _data.text.font.family];\n    ctx.font = ctxfont.join(' ');\n    ctx.fillStyle = _data.text.font.color;\n    ctx.textBaseline = 'top';\n    var y = 0; //props.paddingTop;\n\n    var longestLine = lines.length ? lines[0] : '';\n    var i;\n\n    for (i = 0; i < lines.length; i++) {\n      if (lines[i].length > longestLine.length) longestLine = lines[i];\n    }\n\n    var maxWidth = ctx.measureText(longestLine).width;\n    var start = _rtl ? maxWidth : 0;\n\n    if (_data.text.autoscale && _data.text.align !== 'left') {\n      switch (_data.text.align) {\n        case 'center':\n          ctx.textAlign = _data.text.align;\n          start = maxWidth / 2;\n          break;\n\n        case 'right':\n          ctx.textAlign = _data.text.align;\n          start = !_rtl ? maxWidth : 0;\n          break;\n\n        default:\n          ctx.textAlign = 'start';\n          start = !_rtl ? 0 : maxWidth;\n      }\n    }\n\n    if (_data.text.autoscale) {\n      var scale = size.width / maxWidth;\n      ctx.scale(scale, 1);\n    }\n\n    if (!_data.text.autoscale) {\n      switch (_data.text.align) {\n        case 'center':\n          ctx.textAlign = _data.text.align;\n          start = size.width / 2;\n          break;\n\n        case 'right':\n          ctx.textAlign = _data.text.align;\n          start = size.width;\n          break;\n      }\n    }\n\n    for (i = 0; i < lines.length; i++) {\n      ctx.fillText(lines[i], start, y, maxWidth);\n      y = y + lineHeight;\n    }\n\n    return _canvas[0].toDataURL();\n  }\n\n  _self.renderToSVGImage = renderToSvgImage;\n\n  function renderToSvgImage(svg, size) {\n    var ld = _lastRenderData;\n\n    if (!ld || ld.width !== size.width || ld.height !== size.height || ld.text !== annData.text.value || ld.align !== annData.text.align) {\n      _lastRenderData = {\n        width: size.width,\n        height: size.height,\n        text: annData.text.value,\n        align: annData.text.align\n      };\n      svg.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', renderToDataUrl(size));\n    }\n  } // uses the span tag to determine an approximate line height\n\n\n  function calculateLineHeight(lineCount) {\n    if (!_data.text.autoscale) {\n      _font.applyTo(_span, 1);\n\n      return _span[0].offsetHeight;\n    } else {\n      var height = Math.max(0, _data.height - _data.outline.width * 2);\n      return lineCount > 0 ? Math.floor(height / lineCount) : height;\n    }\n  } // splits the given text into lines wrapped to the maxWidth\n\n\n  function splitLines(ctx, textToWrap, maxWidth) {\n    var lines = [];\n\n    if (typeof textToWrap === 'string') {\n      var nl = '\\n';\n\n      if (_data.text.autoscale) {\n        return textToWrap.split(nl);\n      }\n\n      var text = textToWrap;\n      var width = maxWidth;\n      var words = splitWords(text);\n      var prevWord = '',\n          currWord = '';\n      var currLine = [];\n\n      for (var i = 0; i < words.length; i++) {\n        prevWord = currWord;\n        currWord = words[i]; // test to see if single word > width of bounding box\n\n        if (ctx.measureText(currWord).width > width) {\n          var chars = currWord.split('');\n\n          for (var j = 0; j < chars.length; j++) {\n            currLine.push(chars[j]);\n\n            if (ctx.measureText(currLine.join('')).width > width) {\n              // push pop push is faster than splice\n              currLine.pop();\n              lines.push(currLine.join(''));\n              currLine.length = 0;\n              currLine.push(chars[j]);\n            }\n          }\n        } else {\n          currLine.push(currWord);\n\n          if (ctx.measureText(currLine.join('').trim()).width > width || prevWord.indexOf(nl) >= 0) {\n            // push pop push is faster than splice\n            currLine.pop();\n            lines.push(currLine.join(''));\n            currLine.length = 0;\n            currLine.push(currWord);\n          }\n        }\n      }\n\n      if (currLine.length > 0) {\n        lines.push(currLine.join(''));\n        currLine.length = 0;\n      }\n    }\n\n    return lines;\n  }\n\n  function splitWords(s) {\n    var words = [];\n    var prev = '';\n    var lastPos = 0;\n\n    for (var i = 0; i < s.length; i++) {\n      var c = s[i];\n\n      if (_separators[prev]) {\n        words.push(s.substr(lastPos, i - lastPos));\n        lastPos = i;\n      }\n\n      prev = c;\n    }\n\n    if (lastPos < s.length) {\n      words.push(s.substr(lastPos, s.length - lastPos));\n    }\n\n    return words;\n  }\n};\n\n/* harmony default export */ var text_AnnotationTextRenderer = (AnnotationTextRenderer_AnnotationTextRenderer);\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.strike.js\nvar es_string_strike = __webpack_require__(117);\n\n// CONCATENATED MODULE: ./src/annotations/text/AnnotationFontUI.js\n\n\n\n//\n//  Font UI class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t02-09-12\tD. Cilley\t\tFile Created.\n//\t11-21-12\tD. Cilley\t\tFB 13804: Added a way to zoom the text so mobile browsers wouldn't.\n//\t12-21-12\tD. Cilley\t\tFB 13874: Added the ability to render to multiple textarea objects.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//-------------------------------------------------------------------------------------------------\n\n\n\nvar AnnotationFontUI_FontUI = function FontUI(settings, txtObj) {\n  var self = this;\n  var textAreaDom = txtObj; // textarea DOM object\n\n  var fontData = {\n    // JSON serializable data object for transport to server\n    bold: false,\n    italic: false,\n    strike: false,\n    underline: false,\n    color: '#000000',\n    family: 'Arial',\n    size: 12\n  };\n  var currentZoom = 1.0; // current zoom level\n\n  var viewerZoom = 1.0; // viewer zoom level\n  //let userZoom = 1.0; // user zoom level\n\n  var minSize = Browser.Mobile.Any() ? 18 : 8;\n  init();\n\n  function init() {\n    setData(settings);\n  } // Dispose\n\n\n  self.dispose = dispose;\n\n  function dispose() {\n    self = null;\n    textAreaDom = null;\n    fontData = null;\n  } // map settings onto data\n\n\n  self.set = setData;\n\n  function setData(cfg) {\n    if (cfg) {\n      atalaJquery.extend(fontData, cfg);\n    }\n\n    repaint();\n  }\n\n  self.get = getData;\n\n  function getData(s) {\n    if (s) {\n      return fontData[s];\n    } else {\n      // TODO: we may want to return a copy here so people can't mess with\n      // the internal variables while we're doing something with it\n      return fontData;\n    }\n  }\n\n  self.repaint = repaint;\n\n  function repaint(jqTextObj, zoom, noAdjust) {\n    jqTextObj = jqTextObj ? jqTextObj : textAreaDom;\n\n    if (jqTextObj) {\n      zoom = zoom !== undefined ? zoom : currentZoom;\n\n      if (!noAdjust) {\n        // auto adjusts the zoom if the font is too small to read\n        zoom = getAdjustedZoom();\n      }\n\n      applyTo(jqTextObj, zoom);\n    }\n  } // applies the current font properties to the given jQuery object(s)\n\n\n  self.applyTo = applyTo;\n\n  function applyTo(jqObj, zoom) {\n    var txtDec = 'none';\n\n    if (fontData.strike || fontData.underline) {\n      txtDec = fontData.strike ? 'line-through ' : '';\n      txtDec += fontData.underline ? 'underline' : '';\n    }\n\n    var fontSize = fontData.size * (zoom || 1);\n    jqObj.css({\n      'color': fontData.color,\n      'font-family': fontData.family,\n      'font-style': fontData.italic ? 'italic' : 'normal',\n      'font-weight': fontData.bold ? 'bold' : 'normal',\n      'font-size': fontSize + 'pt',\n      'text-decoration': txtDec\n    });\n  }\n\n  function adjustZoom() {\n    if (fontData.size * viewerZoom < minSize) {\n      currentZoom = minSize / fontData.size;\n    } else {\n      currentZoom = viewerZoom;\n    }\n  }\n\n  self.getAdjustedZoom = getAdjustedZoom;\n\n  function getAdjustedZoom() {\n    adjustZoom();\n    return currentZoom;\n  }\n\n  self.getZoom = getZoom;\n\n  function getZoom() {\n    return viewerZoom;\n  }\n\n  self.setZoom = setZoom;\n\n  function setZoom(f) {\n    viewerZoom = f;\n    repaint();\n  }\n};\n\n/* harmony default export */ var AnnotationFontUI = (AnnotationFontUI_FontUI);\n// CONCATENATED MODULE: ./src/annotations/text/TextAnnotationUI.js\n//\n//  TextAnnotation UI class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t02-09-12\tD. Cilley\t\tFile Created.\n//\t03-04-12\tD. Cilley\t\tFB 12922: Fixed text editor showing when another anno selected.\n//\t09-18-12\tD. Cilley\t\tFB 13597: Handled new showeditor event.\n//\t11-21-12\tD. Cilley\t\tFB 13804: Added min text box size so mobile browsers can edit text.\n//\t12-20-12\tD. Cilley\t\tFB 13874: Added HTML text renderer for supported browsers.\n//\t01-08-13\tD. Cilley\t\tFB 13898: Added raphaelParent property to objects nested in SVG.\n//\t01-17-13\tJ. Burch\t\tFB 13923: Fixing issues with text annos when upgrading to RaphaelJS 2.1.0\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t02-22-13\tD. Cilley\t\tFB 13984: Fixed event obstruction with text annos in IE7/8 from RaphaelJS 2.1.0 change.\n//\t02-25-13\tJ. Burch\t\tFB 13991: Fixing text anno repaint issues introduced by new version of raphael\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t04-05-13\tD. Cilley\t\tFB 14073: Fixed a bug in textanno that allowed editing in IE at the wrong time.\n//\t05-08-13\tD. Cilley\t\tFB 14139: Removed focus call for IE7 to prevent auto scroll.\n//\t11-13-13\tD. Cilley\t\tFB 14475: Fixed text showing while annotation hidden.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t06-20-14\tD. Cilley\t\tBug 293577: Fixed text anno editor font size on initial edit.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t07-09-15\tD. Cilley\t\tBug 607560: Fixed an offset bug related to pageborderwidth fix.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\n //import { createNoSubstitutionTemplateLiteral } from 'typescript';\n\nvar TextAnnotationUI_TextAnnotationUI = function TextAnnotationUI(wdv, ann, paper, cdata, textannomobilezoom) {\n  var _Tself = this;\n\n  var _wdv = wdv;\n  var _Cdata = cdata;\n\n  var _Teve = ann.getEventObject(); // Event Helper\n\n\n  var _Tarea = null; // jquery textarea editor object\n\n  var _Ttext = null; // jquery textarea view object\n\n  var _Tfont = null; // FontUI\n\n  var _Thtml = null; // Atalasoft Raphael html object\n\n  var _Tdata = ann.get('text'); // text data property of the annotation\n\n\n  var _TprevValue = _Tdata.value;\n  var _editMode = false;\n  var _Tmargin = 3;\n\n  var _TminBox = Browser.Mobile.Any() && textannomobilezoom === true ? {\n    // mobile minimum text area size\n    width: 200,\n    height: 200\n  } : {\n    // desktop minimum text area size\n    width: 1,\n    height: 1\n  }; // page level events added by this UI\n\n\n  var _TpageEvents = {};\n  var _TAnnoEvents = {\n    moving: __TannotationChanged,\n    resized: __TannotationChanged,\n    moved: __TannotationChanged,\n    rotated: __TannotationChanged\n  }; // #region Custom repaints\n  // repaints the custom Atalasoft Raphael HTML object\n\n  var __TrepaintHtml = function __TrepaintHtml() {\n    var attrs = ann.get();\n\n    if (!_Ttext) {\n      _Ttext = atalaJquery('<textarea selectable=\"false\"/>');\n      atalaJquery(_Thtml.innerDom).append(_Ttext);\n\n      _Ttext.css({\n        'background-color': 'transparent',\n        'border': '0px solid',\n        'overflow-x': 'hidden',\n        'overflow-y': 'hidden',\n        '-moz-user-select': 'none',\n        '-khtml-user-select': 'none',\n        '-webkit-user-select': 'none',\n        'user-select': 'none',\n        'resize': 'none',\n        'cursor': 'inherit'\n      }); // IE likes to put the cursor there even though we're catching mouse events\n\n\n      _Ttext.attr('readonly', 'readonly');\n\n      _Ttext.on({\n        focus: function focus() {\n          this.blur();\n          return false;\n        }\n      });\n\n      _Ttext[0].raphaelParent = true;\n    }\n\n    _Ttext.val(_Tdata.value); // outline width is actually half since it's placed on the midpoint \n\n\n    var ow = ann.get('outline').width / 2;\n    var taw = Math.max(Math.ceil(attrs.width - (ow + _Tmargin) * 2), 1);\n    var tah = Math.max(Math.ceil(attrs.height - (ow + _Tmargin) * 2), 1);\n\n    if (_Tfont) {\n      _Tfont.set(_Tdata.font);\n\n      _Tfont.repaint(_Ttext, 1, true);\n    }\n\n    _Ttext.css({\n      'width': taw + 'px',\n      'height': tah + 'px',\n      'max-width': taw + 'px',\n      'max-height': tah + 'px',\n      'padding': _Tmargin + 'px',\n      'text-align': _Tdata.align\n    });\n\n    _Ttext.attr('title', attrs.tooltip);\n\n    _Thtml.attr({\n      'x': Math.round(ow + attrs.x),\n      'y': Math.round(ow + attrs.y),\n      'width': attrs.width,\n      'height': attrs.height\n    });\n\n    if (attrs.cornerradius >= 0) {\n      var aobj = ann.getObject();\n      atalaJquery(aobj[0]).attr({\n        'rx': attrs.cornerradius || 0,\n        'ry': attrs.cornerradius || 0\n      });\n    }\n\n    _Thtml.transform(__getResultTransform().toTransformString(true));\n  };\n\n  function __TrepaintHtmlImage() {\n    // outline width is actually half since it's placed on the midpoint \n    var ow = ann.get('outline').width / 2;\n    var attrs = ann.get();\n    var taw = Math.max(Math.ceil(attrs.width - (ow + _Tmargin) * 2), 0);\n    var tah = Math.max(Math.ceil(attrs.height - (ow + _Tmargin) * 2), 0);\n\n    if (_Tfont) {\n      _Tfont.set(_Tdata.font);\n    }\n\n    _Thtml.attr({\n      'x': Math.round(ow + _Tmargin + attrs.x),\n      'y': Math.round(ow + _Tmargin + attrs.y),\n      'width': taw,\n      'height': tah,\n      'title': attrs.tooltip\n    });\n\n    if (attrs.cornerradius >= 0) {\n      var aobj = ann.getObject();\n      atalaJquery(aobj[0]).attr({\n        'rx': attrs.cornerradius || 0,\n        'ry': attrs.cornerradius || 0\n      });\n    } // renders the text to the SVG image using a canvas\n\n\n    if (_Thtml.renderer) {\n      _Thtml.renderer.renderToSVGImage(_Thtml[0], {\n        width: taw,\n        height: tah\n      });\n    }\n\n    _Thtml.transform(__getResultTransform().toTransformString(true));\n  }\n\n  function __getResultTransform() {\n    var m = atalaRaphael.matrix();\n\n    var viewerTransform = _Cdata.getViewerTransform(ann._pageindex);\n\n    var annoTransform = ann.getTransform();\n    m.add(viewerTransform.a, viewerTransform.b, viewerTransform.c, viewerTransform.d, viewerTransform.e, viewerTransform.f);\n    m.add(annoTransform.a, annoTransform.b, annoTransform.c, annoTransform.d, annoTransform.e, annoTransform.f);\n    return m;\n  }\n\n  function __TannotationChanged() {\n    if (_Thtml) {\n      __Trepaint();\n    }\n  }\n\n  function __transformPoint(matrix, x, y) {\n    return {\n      x: matrix.x(x, y),\n      y: matrix.y(x, y)\n    };\n  } // #endregion\n  // #region Control life cycle\n\n\n  __Tinit();\n\n  function __Tinit() {\n    __Tconstruct();\n\n    __Trepaint();\n\n    ann.bind(_TAnnoEvents);\n  }\n\n  function __Tconstruct() {\n    if (_Tfont == null) {\n      _Tfont = new AnnotationFontUI(_Tdata.font);\n    }\n\n    if (_Thtml) {\n      var obj = _Thtml.removed !== true ? _Thtml : null;\n\n      _Teve.unbind(obj, {\n        showeditor: __Tshoweditor,\n        hideeditor: __Thide\n      });\n    } // appending _Tarea to new page or similar doc manipulations could cause 'blur' which removes editor.\n\n\n    var isEdit = _editMode; // attempts to make an HTML object to embed in the SVG/VML, if it can't embed the\n    // html, then it will return an image tag, which we send a base64 encoded image of the output\n\n    var autoscale = _Tdata.autoscale;\n    _Thtml = !autoscale ? paper.html() : paper.atalaImage(); // need to render this with the canvas renderer if it doesn't accept HTML\n\n    if (!_Thtml.isHtml || autoscale) {\n      _Thtml.renderer = new text_AnnotationTextRenderer(ann.get(), _Tfont, paper._page);\n      __TrepaintHtml = __TrepaintHtmlImage;\n    } // might need to move the text editor\n\n\n    if (_Tarea != null) {\n      if (paper._page) {\n        paper._page.append(_Tarea);\n\n        paper._page.on(_TpageEvents);\n      }\n    }\n\n    if (atalaRaphael.vml) {\n      // hides cursor that shows up on rect while dragging\n      ann.getObject().node.style.overflow = 'hidden';\n    }\n\n    _Thtml.transform(__getResultTransform().toTransformString(true));\n\n    _Teve.bind(_Thtml, {\n      showeditor: __Tshoweditor,\n      hideeditor: __Thide\n    });\n\n    if (isEdit) {\n      __Tshoweditor();\n    }\n  }\n\n  _Tself.dispose = __Tdispose;\n\n  function __Tdispose() {\n    if (_Tarea) {\n      _Tarea.remove();\n    }\n\n    if (_Ttext) {\n      _Ttext.remove();\n    }\n\n    if (_Tfont) {\n      _Tfont.dispose();\n    }\n\n    if (_Thtml) {\n      _Thtml.remove();\n    }\n\n    if (paper && paper._page) {\n      paper._page.off(_TpageEvents);\n    }\n\n    ann.unbind(_TAnnoEvents);\n    _Tself = null;\n    _Teve = null;\n    _Tarea = null;\n    _Tfont = null;\n    _Ttext = null;\n    _Thtml = null;\n    _Tdata = null;\n  } // #endregion\n  // #region Properties\n  // map settings onto data\n\n\n  _Tself.set = __TsetData;\n\n  function __TsetData(cfg) {\n    if (cfg) {\n      atalaJquery.extend(_Tdata, cfg);\n    }\n  }\n\n  _Tself.get = __TgetData;\n\n  function __TgetData(s) {\n    if (s) {\n      return _Tdata[s];\n    } else {\n      // TODO: we may want to return a copy here so people can't mess with\n      // the internal variables while we're doing something with it\n      return _Tdata;\n    }\n  }\n\n  _Tself.getFont = __TgetFont;\n\n  function __TgetFont() {\n    return _Tfont;\n  }\n\n  _Tself.inEditMode = __TinEditMode;\n\n  function __TinEditMode() {\n    return _editMode;\n  } // #endregion\n  // #region Private methods\n\n\n  function __Tshoweditor() {\n    if (paper._page[0].classList.contains(domclasses.atala_active_thumb)) return;\n\n    if (!_Tarea) {\n      __TcreateEditor();\n    }\n\n    __Tshow();\n  }\n\n  function __ThtmlChanged(e) {\n    if (e.type === 'keydown' && _wdv.config.textAnnotationEditorIgnoredKeyCodes) {\n      var inArr = false;\n      var len = _wdv.config.textAnnotationEditorIgnoredKeyCodes.length;\n\n      for (var i = 0; i < len; i++) {\n        if (_wdv.config.textAnnotationEditorIgnoredKeyCodes[i] === e.which) {\n          inArr = true;\n          break;\n        }\n      }\n\n      if (inArr) {\n        return;\n      }\n    }\n\n    e.stopPropagation();\n\n    if (_Tdata.value !== _Tarea.val()) {\n      _Tdata.value = _Tarea.val();\n      ann.set({\n        text: _Tdata\n      });\n    }\n  }\n\n  function __TcreateEditor() {\n    _Tarea = atalaJquery('<textarea/>').hide();\n\n    if (paper._page) {\n      paper._page.append(_Tarea);\n\n      paper._page.on(_TpageEvents);\n    } // bind to events to handle all methods of text entry\n    // need mousedown to override page mousedown, or we won't be able to edit it\n\n\n    _Tarea.on('change keydown mouseup mousemove mousedown', __ThtmlChanged);\n\n    _Tarea.bind({\n      blur: __Thide\n    });\n\n    ann.bind({\n      deselected: __Thide\n    });\n    var annObj = ann.getObject();\n\n    _Tarea.css({\n      'position': 'absolute',\n      'overflow-x': 'auto',\n      'overflow-y': 'auto',\n      'z-index': 99999,\n      'border': '0px solid',\n      'padding': '0px',\n      'background-color': 'transparent',\n      'text-align': _Tdata.align\n    });\n\n    if (Browser.Mobile.Any()) {\n      var r = ann.get();\n      var offset = getSVGOffset(paper.canvas, paper._page);\n\n      _Tarea.css({\n        'left': r.x + offset.left + 'px',\n        'top': r.y + offset.top + 'px',\n        'width': r.width + 'px',\n        'max-width': r.width + 'px',\n        'height': r.height + 'px',\n        'max-height': r.height + 'px',\n        'border': annObj.attr('stroke') + ' ' + annObj.attr('strokewidth') + 'px',\n        'background-color': annObj.attr('fill')\n      });\n    }\n\n    _Tfont.setZoom(ann.getZoom()); // hides the webkit native resizing\n\n\n    if (Browser.Chrome || Browser.Safari) {\n      _Tarea.css({\n        resize: 'none'\n      });\n    }\n\n    if (_Tdata.value != null) {\n      _Tarea.val(_Tdata.value);\n    }\n\n    if (_Tdata.readonly) {\n      _Tarea.prop('readonly', 'readonly');\n    }\n\n    _Tfont.repaint(_Tarea, ann.getZoom());\n  } // shows the editable text box and hides the html text\n\n\n  function __Tshow() {\n    var visible = ann ? ann.get('visible') : true;\n\n    if (!visible) {\n      return;\n    }\n\n    if (_Tarea.is(':hidden') || !_editMode) {\n      _Thtml.hide();\n\n      _Tarea.prop('readonly', _Tdata.readonly ? 'readonly' : ''); //check if text has been changed from the outside.\n\n\n      if (_Tdata.value !== _Tarea.val()) {\n        _Tarea.val(_Tdata.value);\n      }\n\n      _Tarea.show();\n\n      __Trepaint();\n    }\n\n    if (Browser.Touch) {\n      _Tarea.focus(function () {\n        _Tarea[0].setSelectionRange(0, 9999);\n      });\n    } // jquery focus doesn't actually call dom focus\n\n\n    _Tarea[0].focus(); //Remember annotation text before editing\n\n\n    _TprevValue = _Tdata.value;\n    _editMode = true;\n  } // hides the editable text box and shows the html text\n\n\n  function __Thide() {\n    if (_Tarea) {\n      if (_Tarea.is(':visible') || _editMode) {\n        _Tarea.hide();\n\n        _Thtml.show();\n\n        __Trepaint();\n      } // __Thide is called twice - \"blur\" and \"deselected\" events\n      // \"blur\" event is used because if user quits edit mode by click out of the viewer bounds then only \"blur\" is called\n\n\n      if (arguments.length === 0 || arguments.length === 1 && arguments[0].type === 'blur') {\n        _Teve.trigger('annotationtextchanged'); //Also trigger annotation changed event\n\n\n        var clonedData = ann.getClonedData();\n        var prevanno = atalaJquery.extend(true, {}, clonedData);\n        delete prevanno.update;\n        delete prevanno.getPageIndex;\n        prevanno.text.value = _TprevValue;\n\n        _Teve.trigger({\n          type: 'annotationchanged',\n          ann: ann,\n          annobefore: prevanno\n        }); // tell the browser that we're done with the edit\n\n\n        _Tarea[0].blur();\n\n        _editMode = false;\n      }\n    }\n  } // #endregion\n  // #region Exposed methods\n\n\n  _Tself.updateView = __TupdateView;\n\n  function __TupdateView() {\n    var visible = ann ? ann.get('visible') : true;\n\n    if (visible) {\n      if (!_editMode) {\n        _Thtml.show();\n      } else {\n        __Tshoweditor();\n      }\n    } else {\n      _Thtml.hide();\n    } // this is used to make sure that the Microsoft Matrix (ie 7/8) has a bgcolor to anti-alias to\n\n\n    if (_Thtml.backgroundColor) {\n      _Thtml.backgroundColor(ann.get('fill').color);\n    }\n  }\n\n  _Tself.changepaper = __Tchangepaper;\n\n  function __Tchangepaper(p) {\n    if (p) {\n      if (paper !== p || _Thtml.removed) {\n        paper = p;\n\n        if (_Ttext != null) {\n          _Ttext.remove();\n\n          _Ttext = null;\n        }\n\n        __Tconstruct();\n\n        __TupdateView();\n      }\n    }\n  }\n\n  _Tself.repaint = __Trepaint;\n\n  function __Trepaint(p) {\n    __Tchangepaper(p); // repaints the HTML representation of the text annotation\n\n\n    __TrepaintHtml(); // repaints the editor textarea HTML object \n\n\n    if (_Tarea && (!_Tarea.is(':hidden') || _editMode)) {\n      // outline width is actually half since it's placed on the midpoint \n      var ow = ann.get('outline').width / 2;\n      var attrs = ann.get();\n      var z = ann.getZoom();\n      var box = ann.getBox();\n\n      var m = __getResultTransform();\n\n      var tl = __transformPoint(m, box.x, box.y),\n          br = __transformPoint(m, box.x + box.width, box.y + box.height);\n\n      var width = box.width * z;\n      var height = box.height * z;\n      var loc = {\n        x: (tl.x + br.x - width) / 2,\n        y: (tl.y + br.y - height) / 2\n      };\n      var mz = _Tmargin * z;\n      var owz = ow * z;\n      var mzo = (mz + owz) * 2;\n      var taw = Math.max(Math.ceil(width - mzo), _TminBox.width);\n      var tah = Math.max(Math.ceil(height - mzo), _TminBox.height);\n      var offset = getSVGOffset(paper.canvas, paper._page);\n\n      var angle = attrs.rotation + _Cdata.getPageRotation(ann._pageindex);\n\n      var transform = angle !== 0 ? 'rotate(' + angle + 'deg)' : '';\n      var css = {\n        'left': Math.round(loc.x + offset.left + owz) + 'px',\n        'top': Math.round(loc.y + offset.top + owz) + 'px',\n        'width': taw + 'px',\n        'height': tah + 'px',\n        'max-width': taw + 'px',\n        'max-height': tah + 'px',\n        'padding': Math.ceil(mz) + 'px'\n      };\n      atalaJquery.extend(css, __htmlTransformStyle(transform));\n\n      _Tarea.css(css);\n    }\n\n    if (_Tfont) {\n      _Tfont.set(_Tdata.font);\n\n      _Tfont.setZoom(ann.getZoom());\n\n      _Tfont.repaint(_Tarea, ann.getZoom());\n    }\n  } // #endregion\n\n};\n\n/* harmony default export */ var text_TextAnnotationUI = (TextAnnotationUI_TextAnnotationUI);\n// CONCATENATED MODULE: ./src/annotations/AnnotationPointerHandler.js\n//\n//  PointerHandler Class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t08-31-12\tD. Cilley\t\tFile Created.\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t09-18-12\tD. Cilley\t\tFB 13597: Implemented new MouseHandler and TouchHandler.\n//\t10-17-12\tD. Cilley\t\tFB 13671: Added accidental drag threshold for touch hold.\n//\t11-26-12\tD. Cilley\t\tFB 13808: Fixed pinch resizing in Android Chrome.\n//\t11-28-12\tD. Cilley\t\tFB 13813: Fixed click hold + double tap problem.\n//\t01-08-13\tD. Cilley\t\tFB 13899: Fixed grips showing during multi-touch.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t04-04-13\tD. Cilley\t\tFB 13993, 13996, 13997: Added AnnotationSelector for document level selecting.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t02-12-15\tD. Cilley\t\tBug 579500: Combined MouseTool and TouchTool for multi-input devices.\n//-------------------------------------------------------------------------------------------------\n\n\n\n/**\r\n * Mouse and Touch event handler for annotations\r\n * @private\r\n */\n\nvar AnnotationPointerHandler_PointerHandler = function PointerHandler() {\n  var _self = this;\n\n  var _jqe = atalaJquery({}); // jquery instance to bind events to\n\n\n  var _touch = {\n    // Touch data\n    drawing: false,\n    // annotation drawing\n    hold: null,\n    // timeout for hold\n    pinching: false,\n    // still pinching\n    tapped: false,\n    // double tap detected\n    touching: false,\n    // still touching\n    delta: {\n      x: 0,\n      y: 0\n    },\n    // scroll delta\n    origin: {\n      x: 0,\n      y: 0\n    },\n    // origin position of touch\n    point: {\n      x: 0,\n      y: 0\n    },\n    // touch point\n    moves: 0,\n    // number of moves between start and end\n    e: null // most recent touch event\n\n  }; // Mouse events bound to the Raphael annotation object by the AnnotationEventHelper \n\n  _self.events = {\n    click: __onClick,\n    dblclick: __onDblClick,\n    mousedown: __onMouseDown,\n    mousemove: __onMouseMove,\n    mouseout: __onMouseOut,\n    mouseover: __onMouseOver,\n    mouseup: __onMouseUp\n  }; // Touch event bound to the Rapheal annotation object by the AnnotationEventHelper \n\n  if (Browser.Features.Touch) {\n    atalaJquery.extend(true, _self.events, {\n      touchstart: __onTouchStart,\n      touchmove: __onTouchMove,\n      touchend: __onTouchEnd\n    });\n  } // #region Public functions\n\n\n  _self.bind = __bindEvents;\n\n  function __bindEvents() {\n    _jqe.on.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  _self.unbind = __unbindEvents;\n\n  function __unbindEvents() {\n    _jqe.off.apply(_jqe, arguments);\n\n    return _self;\n  } // triggers to event handlers bound with bind on this object only \n\n\n  _self.trigger = __triggerEvent;\n\n  function __triggerEvent() {\n    _jqe.trigger.apply(_jqe, arguments);\n  } // #endregion\n  // #region Interaction\n\n\n  function __interactStart() {\n    __triggerEvent({\n      type: 'interactstart'\n    });\n  }\n\n  function __interactEnd() {\n    __triggerEvent({\n      type: 'interactend'\n    });\n  } // #endregion\n  // #region Mouse Handlers \n\n\n  function __onClick(e) {\n    __triggerEvent(e);\n  }\n\n  function __onDblClick(e) {\n    __triggerEvent(e);\n\n    var p = getMousePositionJquery(e);\n\n    __triggerEvent({\n      type: 'showeditor',\n      x: p.x,\n      y: p.y\n    });\n  }\n\n  function __onMouseDown(e) {\n    __interactStart();\n\n    __triggerEvent(e);\n\n    __triggerEvent({\n      type: 'selectchange',\n      shiftKey: e.shiftKey,\n      ctrlKey: e.ctrlKey\n    });\n\n    if (e.which === 3) {\n      __triggerEvent({\n        type: 'contextmenu',\n        x: e.clientX,\n        y: e.clientY,\n        event: e\n      });\n    }\n\n    return false;\n  }\n\n  function __onMouseMove(e) {\n    __triggerEvent(e);\n  }\n\n  function __onMouseOut(e) {\n    __triggerEvent(e);\n  }\n\n  function __onMouseOver(e) {\n    __triggerEvent(e);\n  }\n\n  function __onMouseUp(e) {\n    __triggerEvent(e);\n\n    __interactEnd();\n  } // #endregion\n  // #region Touch Handlers\n\n\n  function __onPinchStart(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    _touch.pinching = true;\n\n    __triggerEvent({\n      type: 'pinchstart',\n      touches: e.originalEvent.touches\n    });\n  }\n\n  function __onPinchMove(e) {\n    e.stopPropagation();\n    e.preventDefault();\n\n    __triggerEvent({\n      type: 'pinchmove',\n      touches: e.originalEvent.touches\n    });\n  }\n\n  function __onPinchEnd(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    _touch.pinching = false;\n\n    __triggerEvent({\n      type: 'pinchend',\n      touches: e.originalEvent.touches\n    }); // still touching with one finger, need to start a new touch\n\n\n    if (e.originalEvent.touches.length === 1) {\n      __onTouchStart(e);\n    }\n  }\n\n  function __onTouchStart(e) {\n    _touch.e = e;\n\n    __interactStart();\n\n    __triggerEvent(e);\n\n    if (e.originalEvent.touches.length === 2 && __touchingOneAnno(e.originalEvent.touches)) {\n      // need to clear the hold because the first touch started it\n      __clearHold(); // no touching!\n\n\n      _touch.touching = false; // time to pinch\n\n      __onPinchStart(e);\n    } else if (e.originalEvent.touches.length === 1) {\n      __triggerEvent('selectchange');\n\n      _touch.touching = true; // TODO: need to distinguish between touches started by this target, not just e\n\n      var p = getMousePositionJquery(e);\n      _touch.point.x = p.x;\n      _touch.point.y = p.y;\n      _touch.hold = setTimeout(__detectHold, 1500);\n    }\n  }\n\n  function __onTouchMove(e) {\n    _touch.e = e;\n\n    __triggerEvent(e);\n\n    if (_touch.pinching) {\n      __onPinchMove(e);\n    } else {\n      _touch.moves++;\n    }\n  }\n\n  function __onTouchEnd(e) {\n    _touch.e = e;\n\n    __triggerEvent(e);\n\n    if (_touch.pinching) {\n      __onPinchEnd(e);\n    } else if (_touch.touching) {\n      _touch.touching = false; // stop holding\n\n      __clearHold(); // reset moves\n\n\n      _touch.moves = 0; // check if we've tapped once before\n\n      if (_touch.tapped) {\n        __onDoubleTap(e);\n      } else {\n        // tapped the first time\n        _touch.tapped = true; // time between taps detected as a double tap\n\n        setTimeout(__detectDoubleTap, 300);\n      }\n    }\n\n    __interactEnd();\n  }\n\n  function __detectDoubleTap() {\n    // reset double tap\n    _touch.tapped = false;\n  }\n\n  function __onDoubleTap(e) {\n    _touch.e = e;\n\n    __triggerEvent({\n      type: 'showeditor',\n      x: _touch.point.x,\n      y: _touch.point.y\n    });\n  }\n\n  function __detectHold() {\n    if (_touch.moves > 0 && _touch.e !== null) {\n      var p = getMousePositionJquery(_touch.e);\n\n      if (Math.abs(_touch.point.x - p.x) < 5 && Math.abs(_touch.point.y - p.y) < 5) {\n        // accidental drag\n        _touch.moves = 0;\n      }\n    }\n\n    if (_touch.moves === 0 && _touch.touching && _touch.e) {\n      _touch.touching = false;\n\n      __triggerEvent({\n        type: 'contextmenu',\n        x: _touch.e.originalEvent.touches[0].pageX,\n        y: _touch.e.originalEvent.touches[0].pageY\n      });\n    }\n  }\n\n  function __clearHold() {\n    if (_touch.hold !== null) {\n      clearTimeout(_touch.hold);\n      _touch.hold = null;\n    }\n  } // #endregion\n  // #region Helper functions\n  // returns true if the touches point to one annotation\n\n\n  function __touchingOneAnno(touches) {\n    var ann = null;\n\n    for (var i = 0; i < touches.length; i++) {\n      var obj = touches[i].target;\n\n      if (obj && (obj.raphael || obj.raphaelParent)) {\n        if (ann === null) {\n          ann = obj;\n        } else if (ann !== obj) {\n          return false;\n        }\n      } else {\n        // html target without raphael parent\n        return false;\n      }\n    }\n\n    return true;\n  } // #endregion\n\n};\n\n/* harmony default export */ var AnnotationPointerHandler = (AnnotationPointerHandler_PointerHandler);\n// CONCATENATED MODULE: ./src/annotations/AnnotationEventHelper.js\n\n\n//\n//  Annotation Event Helper class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t02-09-12\tD. Cilley\t\tFile Created.\n//\t03-03-12\tD. Cilley\t\tFB 12982, FB 13003: Used correct method to get mouse position from jQuery event\n//\t04-17-12\tD. Cilley\t\tFB 13173: Added interactstart event to fix a bug that would show grips on the wrong page\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t09-18-12\tD. Cilley\t\tFB 13597: Implemented new TouchHandler and MouseHandler.\n//\t10-16-12\tD. Cilley\t\tFB 13669, FB 13670: Moved away from using Raphael drag deltas. \n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t02-12-15\tD. Cilley\t\tBug 579500: Combined MouseTool and TouchTool for multi-input devices.\n//-------------------------------------------------------------------------------------------------\n\n\n // Wraps Raphael events in a jQuery like object\n// pObject: parent object that these events belong to\n\nvar AnnotationEventHelper_EventHelper = function EventHelper(pObject) {\n  var _Eself = this;\n\n  var _Ejqe = atalaJquery({}); // jquery instance to bind events to\n\n\n  var _Eparent = pObject; // parent object\n\n  var _Ehandler = null; // mouse/touch event handlers\n\n  var _Edp = {\n    target: null,\n    // drag target\n    mx: null,\n    // current mouse/touch x\n    my: null,\n    // current mouse/touch y\n    px: null,\n    // previous x\n    py: null,\n    // previous y\n    dx: null,\n    // delta x\n    dy: null // delta y\n\n  };\n\n  __init();\n\n  function __init() {\n    _Ehandler = new AnnotationPointerHandler();\n\n    _Ehandler.bind({\n      // mouse events to pass to the user\n      click: __EonClick,\n      dblclick: __EonDblclick,\n      mousedown: __EonMouseDown,\n      mousemove: __EonMouseMove,\n      mouseover: __EonMouseOver,\n      mouseout: __EonMouseOut,\n      mouseup: __EonMouseUp,\n      // mobile events to pass to the user\n      touchmove: __EonTouchMove,\n      touchstart: __EonTouchStart,\n      interactstart: __EstartInteract,\n      interactend: __EendInteract,\n      pinchstart: __EpinchStart,\n      pinchmove: __EpinchMove,\n      pinchend: __EpinchEnd,\n      // events for both\n      selectchange: __EselectChange,\n      contextmenu: __EcontextMenu,\n      showeditor: __Eshoweditor,\n      annoresized: __Eresized\n    });\n  }\n\n  function __EgetPagePosition(e) {\n    _Edp.px = _Edp.mx;\n    _Edp.py = _Edp.my;\n\n    if (e.originalEvent) {\n      _Edp.mx = e.originalEvent.targetTouches[0].pageX;\n      _Edp.my = e.originalEvent.targetTouches[0].pageY;\n    } else {\n      _Edp.mx = e.targetTouches[0].pageX;\n      _Edp.my = e.targetTouches[0].pageY;\n    }\n\n    _Edp.dx = _Edp.mx - _Edp.px;\n    _Edp.dy = _Edp.my - _Edp.py;\n  }\n\n  function __EgetScreenPosition(e) {\n    _Edp.px = _Edp.mx;\n    _Edp.py = _Edp.my;\n    _Edp.mx = e.screenX;\n    _Edp.my = e.screenY;\n    _Edp.dx = _Edp.mx - _Edp.px;\n    _Edp.dy = _Edp.my - _Edp.py;\n  }\n\n  _Eself.bind = __EbindEvents;\n\n  function __EbindEvents(robj) {\n    var args = arguments;\n\n    if (robj && (robj.constructor.prototype === atalaRaphael.el || robj.constructor.prototype === atalaRaphael.st)) {\n      robj.drag(__EdragMove, __EdragStart, __EdragEnd);\n      robj.hover(__EhoverIn, __EhoverOut); // binds _Ehandler DOM events to the Raphael object\n\n      if (robj.type !== 'set') {\n        atalaJquery(robj[0]).on(_Ehandler.events);\n      } else {\n        robj.forEach(function (el) {\n          atalaJquery(el[0]).on(_Ehandler.events);\n        });\n      } // create a new args array without the raphael object\n\n\n      args = Array.prototype.slice.call(args, 1);\n    }\n\n    if (args.length > 0) {\n      _Ejqe.on.apply(_Ejqe, args);\n    }\n  }\n\n  _Eself.unbind = __EunbindEvents;\n\n  function __EunbindEvents(robj) {\n    var args = arguments;\n\n    if (robj && (robj.constructor.prototype === atalaRaphael.el || robj.constructor.prototype === atalaRaphael.st)) {\n      robj.undrag();\n      robj.unhover(__EhoverIn, __EhoverOut); // removes _Ehandler DOM events binds from the Raphael object\n\n      if (robj.type !== 'set') {\n        atalaJquery(robj[0]).off(_Ehandler.events);\n      } else {\n        robj.forEach(function (el) {\n          atalaJquery(el[0]).off(_Ehandler.events);\n        });\n      } // create a new args array without the raphael object\n\n\n      args = Array.prototype.slice.call(args, 1);\n    } else if (robj === null && args.length > 1) {\n      args = Array.prototype.slice.call(args, 1);\n    }\n\n    _Ejqe.off.apply(_Ejqe, args);\n  }\n\n  _Eself.trigger = __Etrigger;\n\n  function __Etrigger() {\n    _Ejqe.trigger.apply(_Ejqe, arguments);\n  } // event that needs to fire before any interaction with the annotation \n\n\n  function __EstartInteract() {\n    __Etrigger({\n      type: 'interactstart',\n      target: _Eparent\n    });\n  }\n\n  function __EendInteract() {\n    __Etrigger({\n      type: 'interactend',\n      target: _Eparent\n    });\n  } // dx, dy: mouse delta from origin (not very useful)\n  // mx, my: mouse position (not corrected for scrolled or offset objects)\n  // we ignore the Raphael inputs here because they can be NaN at times\n\n\n  function __EdragMove(dx, dy, mx, my, e) {\n    // Raphael fires move event with dx=dy=0 when you just click on an object.\n    // Looks like it makes sense to filter this out.\n    if (dx || dy) {\n      // only fire dragmove for intended objects when using touch\n      if (!Browser.Features.Touch || e.target === _Edp.target) {\n        // if the previous point is not there, we need to start the drag\n        if (_Edp.px === null) {\n          __EdragStart(null, null, e);\n        }\n\n        if (e.touches) {\n          __EgetPagePosition(e);\n        } else {\n          __EgetScreenPosition(e);\n        }\n\n        __Etrigger({\n          type: 'dragmove',\n          dx: _Edp.dx,\n          dy: _Edp.dy,\n          mx: _Edp.mx,\n          my: _Edp.my,\n          originalEvent: e\n        });\n      }\n    }\n  } // mx, my: mouse position (not corrected for scrolled or offset objects)\n  // we ignore the Raphael inputs here because they can be NaN at times\n\n\n  function __EdragStart(mx, my, e) {\n    _Edp.target = e.target;\n\n    __EstartInteract();\n\n    if (e.touches) {\n      __EgetPagePosition(e);\n    } else {\n      __EgetScreenPosition(e);\n    }\n\n    __Etrigger({\n      type: 'dragstart',\n      mx: _Edp.mx,\n      my: _Edp.my,\n      originalEvent: e\n    });\n  }\n\n  function __EdragEnd(e) {\n    // only fire dragmove for intended objects when using touch\n    if (!Browser.Features.Touch || e.target === _Edp.target) {\n      _Edp.target = null;\n      _Edp.px = null;\n      _Edp.py = null;\n      _Edp.mx = null;\n      _Edp.my = null;\n\n      __Etrigger({\n        type: 'dragend',\n        originalEvent: e\n      });\n    }\n  }\n\n  function __EhoverIn() {\n    __Etrigger('hoverin');\n  }\n\n  function __EhoverOut() {\n    __Etrigger('hoverout');\n  }\n\n  function __EpinchStart(e) {\n    __Etrigger(e);\n  }\n\n  function __EpinchMove(e) {\n    __Etrigger(e);\n  }\n\n  function __EpinchEnd(e) {\n    _Edp.px = null;\n    _Edp.py = null;\n\n    __Etrigger(e);\n  }\n\n  function __EselectChange(e) {\n    __Etrigger(e);\n  }\n\n  function __EcontextMenu(e) {\n    __Etrigger(e);\n  }\n\n  function __Eshoweditor(e) {\n    __Etrigger(e);\n  }\n\n  function __EonClick(e) {\n    __Etrigger(e);\n  }\n\n  function __EonDblclick(e) {\n    __Etrigger(e);\n  }\n\n  function __EonMouseDown(e) {\n    __Etrigger(e);\n\n    if (e.which === 1) {\n      __Etrigger('mousedownleft');\n    } else if (e.which === 3) {\n      __Etrigger('mousedownright');\n    }\n  }\n\n  function __EonMouseMove(e) {\n    __Etrigger(e);\n  }\n\n  function __EonMouseOut(e) {\n    __Etrigger(e);\n  }\n\n  function __EonMouseOver(e) {\n    __Etrigger(e);\n  }\n\n  function __EonMouseUp(e) {\n    __Etrigger(e);\n\n    if (e.which === 3) {\n      __Etrigger('rightclick');\n    }\n  }\n\n  function __EonTouchMove(e) {\n    __Etrigger(e);\n  }\n\n  function __Eresized(e) {\n    __Etrigger(e);\n  }\n\n  function __EonTouchStart(e) {\n    __Etrigger(e);\n  }\n};\n\n/* harmony default export */ var AnnotationEventHelper = (AnnotationEventHelper_EventHelper);\n// CONCATENATED MODULE: ./src/annotations/AnnotationCustomRenderer.js\n//\n//  Provides events for custom annotation rendering\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t10-01-14\tD. Cilley\t\tFile Created.\n//-------------------------------------------------------------------------------------------------\n// creates an object that renders custom annotations, based on the available renderer\nvar AnnotationCustomRenderer = function AnnotationCustomRenderer(annData, evtHelper) {\n  var _self = this;\n\n  var _data = annData; // annotation data object (do not modify)\n\n  var _constructor = null; // method pointer to return a Raphael object\n\n  var _renderer = null; // method pointer to render the annotation\n\n  var _jqe = evtHelper; // jquery instance to bind events to\n  // #region Lifecycle\n\n  function __init() {\n    _constructor = _data.constructor ? _data.constructor : __serverConstructor;\n    _renderer = _data.renderer ? _data.renderer : __serverRenderer;\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    _self = null;\n    _data = null;\n    _constructor = null;\n    _renderer = null;\n  } // #endregion\n  // #region jQuery Event handling\n  // jQuery bind shortcut\n\n\n  _self.bind = __bindEvents;\n\n  function __bindEvents() {\n    _jqe.on.apply(_jqe, arguments);\n\n    return _self;\n  } // jQuery unbind shortcut\n\n\n  _self.unbind = __unbindEvents;\n\n  function __unbindEvents() {\n    _jqe.off.apply(_jqe, arguments);\n\n    return _self;\n  } // jQuery trigger shortcut\n\n\n  _self.trigger = __triggerEvent;\n\n  function __triggerEvent() {\n    _jqe.trigger.apply(_jqe, arguments);\n\n    return _self;\n  } // #endregion\n  // #region Public methods\n\n\n  _self.construct = __construct;\n\n  function __construct(paper) {\n    return _constructor(paper, _data);\n  }\n\n  _self.render = __render;\n\n  function __render(annObject) {\n    _renderer(annObject, _data);\n  } // #endregion\n  // #region Server rendering\n\n\n  function __serverConstructor(paper) {\n    return paper.image();\n  }\n\n  function __serverRenderer(annObject) {\n    if (_data.customurl) {\n      annObject.attr('src', _data.customurl);\n    } else {\n      __serverImageQueryRequest();\n    }\n  }\n\n  function __serverImageQueryRequest() {\n    __triggerEvent('serverrenderurlrequested', {\n      data: _data,\n      complete: __serverImageQueryReturned\n    });\n  }\n\n  function __serverImageQueryReturned(data) {\n    data.customurl = data;\n  } // #endregion\n  // #region Helper methods\n  // #endregion\n\n\n  __init();\n\n  return _self;\n};\n\n/* harmony default export */ var annotations_AnnotationCustomRenderer = (AnnotationCustomRenderer);\n// CONCATENATED MODULE: ./src/annotations/AnnotationDrawHandler.js\n\n\n//\n//  Annnotation DrawHandler Class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t08-31-12\tD. Cilley\t\tFile Created.\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t09-18-12\tD. Cilley\t\tFB 13597: Added matrix drawing groundwork.\n//\t10-16-12\tD. Cilley\t\tFB 13669, FB 13670: Moved away from using Raphael drag deltas.\n//\t10-18-12\tD. Cilley\t\tFB 13692: Fixed Android position.\n//\t10-19-12\tJ. Burch\t\tFB 13694: Fixing bug with recycled annotations\n//\t10-22-12\tD. Cilley\t\tFB 13694: Found a problem with original fix, added viewchanged event\n//\t11-28-12\tJ. Burch\t\tFB 13812: Fixed a problem where text annos would not rewrap after pinch-to-resize.\n//\t11-28-12\tD. Cilley\t\tFB 13814: Fixed poly/freehand pinch resizing.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t02-12-15\tD. Cilley\t\tBug 368688: Fixed line cap rendering in IE10 and IE11.\n//\t07-09-15\tD. Cilley\t\tBug 607560: Fixed an offset bug related to pageborderwidth fix.\n//-------------------------------------------------------------------------------------------------\n\n\n // aData: annotation data object\n// cData: controller data object\n// aEve: EventHelper instance to trigger events to\n// aCustom: custom drawing handled if present\n\nvar AnnotationDrawHandler_DrawHandler = function DrawHandler(aData, cData, aEve, aSelf, aCustom) {\n  var _self = this;\n\n  var _Adata = aData;\n  var _Cdata = cData;\n  var _Aeve = aEve;\n  var _Aobj = null; // Raphael obj\n\n  var _Atxt = null; // TextAnnotationUI obj\n\n  var _Acustom = aCustom; // custom renderer\n\n  var _Aself = aSelf;\n  var _draw = null; // drawing event properties \n\n  var _sop = null; // start point\n\n  var _mtx = null; // matrix for manipulation\n\n  var _pinch = null; // pinch data  \n\n  var _initAnno = {}; // assignable events, used for efficiency\n\n  var __drawMove = function __drawMove() {};\n\n  var __updateClient = function __updateClient() {}; // these events will be bound to the Annotation class \n\n\n  _self.events = {\n    drawstart: __onDrawStart,\n    drawmove: __onDrawMove,\n    drawend: __onDrawEnd,\n    dragstart: __onDragStart,\n    dragmove: __onDragMove,\n    dragend: __onDragEnd,\n    update: __onUpdate,\n    viewchanged: __onViewChanged,\n    pinchstart: __onPinchStart,\n    pinchmove: __onPinchMove,\n    pinchend: __onPinchEnd\n  };\n\n  __init();\n\n  function __init() {}\n\n  function __getPosition(e) {\n    var p = getMousePositionJquery(e);\n\n    if (_Aobj.paper) {\n      var offset = getSVGOffset(_Aobj.paper.canvas, _Aobj.paper._page);\n      p.x -= offset.left;\n      p.y -= offset.top;\n    }\n\n    return p;\n  } // gets the scaled position of the event\n\n\n  function __getDocumentPoint(p) {\n    var matrix = _Cdata.getViewerTransform(_Aself._pageindex).invert();\n\n    var newx = matrix.x(p.x, p.y);\n    p.y = matrix.y(p.x, p.y);\n    p.x = newx;\n    return p;\n  }\n\n  function __triggerEvent() {\n    _Aeve.trigger.apply(_Aeve, arguments);\n  }\n\n  _self.drawStart = __onDrawStart;\n\n  function __onDrawStart(e, aObj, tObj) {\n    _Aobj = aObj;\n    _Atxt = tObj;\n    e.stopPropagation();\n    e.preventDefault();\n\n    var p = __getDocumentPoint(__getPosition(e));\n\n    _Adata.visible = true;\n    _sop = {\n      x: p.x,\n      y: p.y\n    };\n    _Adata.x = Math.round(p.x);\n    _Adata.y = Math.round(p.y);\n    _Adata.width = 1;\n    _Adata.height = 1;\n\n    if (_Aobj.type === 'path' && _Adata.type !== 'custom') {\n      if (_Adata.type !== 'ellipse') {\n        _Adata.points = [{\n          x: _Adata.x,\n          y: _Adata.y\n        }];\n\n        if (_Adata.type === 'lines' || _Adata.type === 'polygon') {\n          // need a second point to start drawing\n          _Adata.points.push({\n            x: _Adata.x,\n            y: _Adata.y\n          });\n        } // path based annotations ignore location\n\n\n        _Adata.x = 0;\n        _Adata.y = 0; // path drawing\n\n        __drawMove = __plotAnnotation;\n        __updateClient = __updateClientPath;\n      } else {\n        // ellipse drawing\n        __drawMove = __sizeAnnotation;\n        __updateClient = __updateClientEllipse;\n      }\n    } else {\n      // rectangular drawing\n      __drawMove = __sizeAnnotation;\n      __updateClient = __updateClientRect;\n    }\n\n    __repaint();\n\n    _draw = {\n      events: Browser.Features.Touch ? {\n        touchend: __onDrawEnd,\n        touchmove: __onDrawMove,\n        mouseup: __onDrawEnd,\n        mousemove: __onDrawMove\n      } : {\n        mouseup: __onDrawEnd,\n        mousemove: __onDrawMove\n      },\n      src: atalaJquery(e.srcElement || e.target),\n      // src object that events were triggered on\n      main: atalaJquery(e.currentTarget) // main parent object that events bubble to \n\n    };\n\n    _draw.src.on(_draw.events);\n\n    _draw.main.on({\n      mouseup: __onDrawEnd\n    });\n  }\n\n  _self.unbindEvents = __onUnbindEvents;\n\n  function __onUnbindEvents() {\n    if (_draw) {\n      _draw.src.off(_draw.events);\n\n      _draw.main.off({\n        mouseup: __onDrawEnd\n      });\n    }\n  }\n\n  function __onDrawMove(e) {\n    e.stopPropagation();\n\n    __drawMove(e);\n\n    __repaint();\n  } // called by __drawMove\n\n\n  function __plotAnnotation(e) {\n    var zp = __getDocumentPoint(__getPosition(e));\n\n    switch (_Adata.type) {\n      case 'line':\n        _Adata.points[1] = zp;\n        break;\n\n      case 'freehand':\n        _Adata.points.push(zp);\n\n        break;\n\n      case 'lines':\n        _Adata.points[_Adata.points.length - 1] = zp;\n        break;\n\n      case 'polygon':\n        _Adata.points[_Adata.points.length - 1] = zp;\n        break;\n      //\t\t\tcase 'custom':\n      //\t\t\t\t_Adata. // need to make sure width and height get to renderer, or this whole thing doesn't work\n    }\n\n    if (_Aobj.type === 'path') {\n      if (_Adata.type === 'ellipse') {\n        __plotEllipse();\n      } else {\n        __plotPoints();\n      }\n\n      if (_Aobj._ && _Aobj._.dirty === 0) {\n        _Aobj._.dirty = 1;\n      }\n    }\n  } // called by __drawMove\n  // method for sizing bounding box based annotations with the mouse\n\n\n  function __sizeAnnotation(e) {\n    var p = __getDocumentPoint(__getPosition(e));\n\n    var nx = _sop.x;\n    var ny = _sop.y;\n    var nw = Math.max(Math.abs(p.x - _sop.x), 1);\n    var nh = Math.max(Math.abs(p.y - _sop.y), 1);\n\n    if (_Adata.aspectratio > 0) {\n      var r = Math.abs((p.y - _sop.y) / (p.x - _sop.x));\n\n      if (r > 1 / _Adata.aspectratio) {\n        // base the width off the height\n        nw = Math.round(nh / _Adata.aspectratio);\n      } else {\n        // base the height off the width\n        nh = Math.round(nw / _Adata.aspectratio);\n      }\n    }\n\n    if (p.x < _sop.x) {\n      nx = _sop.x - nw;\n    }\n\n    if (p.y < _sop.y) {\n      ny = _sop.y - nh;\n    }\n\n    _Adata.x = nx;\n    _Adata.y = ny;\n    _Adata.width = nw;\n    _Adata.height = nh;\n  }\n\n  function __onDrawEnd(e) {\n    e.stopPropagation();\n    var cancelled = false;\n\n    if (_Adata.type === 'lines' || _Adata.type === 'polygon') {\n      // if activepage is not the same as the page with annotation\n      if (_Cdata.activepage._index !== _Aself._pageindex) {\n        return;\n      }\n\n      _Adata.points.push(__getDocumentPoint(__getPosition(e)));\n\n      if (e.button !== 2) {\n        return;\n      }\n    } else if (!_Adata.points) {\n      if (_Adata.width < 4 && _Adata.height < 4) {\n        // rectangular annotation was most likely created with a click\n        _Adata.width = 100;\n        _Adata.height = 100;\n      }\n\n      __repaint();\n    } else if (_Adata.points && _Adata.points.length < 2 && _Adata.type !== 'custom') {\n      // line and freehand need more than 1 point to be drawn\n      cancelled = true;\n    }\n\n    __onUnbindEvents();\n\n    _draw = null;\n\n    if (cancelled) {\n      __triggerEvent('cancelled');\n    } else {\n      __triggerEvent('drawn');\n    }\n  }\n\n  function __onDragStart(e) {\n    if (_Cdata.readonly) {\n      return;\n    }\n\n    e.originalEvent.stopPropagation();\n    _initAnno = atalaJquery.extend(true, {}, _Aself.getClonedData());\n    delete _initAnno.update;\n    delete _initAnno.getPageIndex;\n\n    var box = _Aself.getBox(); //remember annotation object before move \n\n\n    _sop = {\n      x: box.x,\n      y: box.y\n    };\n  }\n\n  function __onDragMove(e) {\n    if (_Cdata.readonly) {\n      return;\n    }\n\n    e.originalEvent.stopPropagation();\n\n    var base = __getDocumentPoint({\n      x: 0,\n      y: 0\n    });\n\n    var offset = __getDocumentPoint({\n      x: e.dx,\n      y: e.dy\n    });\n\n    _Aself.translate(offset.x - base.x, offset.y - base.y);\n\n    __triggerEvent('moving');\n  }\n\n  function __onDragEnd(e) {\n    if (_Cdata.readonly) {\n      return;\n    }\n\n    e.originalEvent.stopPropagation();\n\n    var box = _Aself.getBox(); // check if annotation is inside page rect\n\n\n    if (_Aobj.paper && _Aobj.paper._page) {\n      var bbox = _Aobj.getBBox();\n\n      var pbox = {\n        x: 0,\n        y: 0,\n        width: _Aobj.paper._page.width(),\n        height: _Aobj.paper._page.height()\n      };\n\n      if (!__rectInRect(pbox, bbox)) {\n        // annotation is not in bounds, move it back\n        _Aself.translate(_sop.x - box.x, _sop.y - box.y); // annotation has not moved, so don't allow \"moved\" to trigger\n\n\n        return;\n      }\n    } // trigger 'moved' only if annotation position has been changed\n\n\n    if (_sop.x !== box.x || _sop.y !== box.y) {\n      __triggerEvent('moved');\n\n      __triggerEvent({\n        type: 'annotationchanged',\n        ann: _Aself,\n        annobefore: _initAnno\n      });\n    }\n  }\n\n  function __onPinchStart(e) {\n    // disables poly/freehand pinch resizing\n    if (_Adata.points || _Cdata.readonly) {\n      return;\n    }\n\n    var t1 = __getDocumentPoint({\n      x: e.touches[0].clientX,\n      y: e.touches[0].clientY\n    });\n\n    var t2 = __getDocumentPoint({\n      x: e.touches[1].clientX,\n      y: e.touches[1].clientY\n    });\n\n    var srect = _Aself.getBox();\n\n    _pinch = {\n      start: CalcDistance(t1.x, t1.y, t2.x, t2.y),\n      rect: srect\n    };\n  }\n\n  function __onPinchMove(e) {\n    if (!_pinch) {\n      return;\n    }\n\n    var t1 = __getDocumentPoint({\n      x: e.touches[0].clientX,\n      y: e.touches[0].clientY\n    });\n\n    var t2 = __getDocumentPoint({\n      x: e.touches[1].clientX,\n      y: e.touches[1].clientY\n    });\n\n    var dist = CalcDistance(t1.x, t1.y, t2.x, t2.y, _pinch.start);\n    var deltaScaleX = dist.x - _pinch.start.x;\n    var deltaScaleY = dist.y - _pinch.start.y;\n    var newX = _pinch.rect.x - dist.dx;\n    var newY = _pinch.rect.y - dist.dy;\n    var newWidth = _pinch.rect.width + deltaScaleX;\n    var newHeight = _pinch.rect.height + deltaScaleY;\n\n    if (!_Adata.points) {\n      _Adata.x = newX;\n      _Adata.y = newY;\n      _Adata.width = newWidth;\n      _Adata.height = newHeight;\n    } else {\n      _Aself.transform(newX, newY, newWidth, newHeight);\n    }\n\n    if (_Aobj.paper && _Aobj.paper._page && _Aobj.paper._page._grips) {\n      _Aobj.paper._page._grips.repaint();\n    }\n\n    __repaint();\n  }\n\n  function __onPinchEnd() {\n    __triggerEvent('resized');\n\n    __triggerEvent('annoresized');\n\n    _pinch = null;\n  }\n\n  function __onUpdate() {\n    __repaint();\n  }\n\n  function __onViewChanged(e) {\n    _Aobj = e.annview;\n    _Atxt = e.textview;\n\n    if (_Aobj.type === 'path' && _Adata.type !== 'custom') {\n      if (_Adata.type !== 'ellipse') {\n        // path drawing\n        __drawMove = __plotAnnotation;\n        __updateClient = __updateClientPath;\n      } else {\n        // ellipse drawing\n        __drawMove = __sizeAnnotation;\n        __updateClient = __updateClientEllipse;\n      }\n    } else {\n      // rectangular drawing\n      __drawMove = __sizeAnnotation;\n      __updateClient = __updateClientRect;\n    }\n  }\n\n  function __updateFromMatrix() {\n    _Aobj.transform(_mtx.toTransformString());\n\n    if (_Atxt) {\n      _Atxt.repaint();\n    }\n  }\n\n  function __commitRaphaelData() {\n    _Aobj.transform(__getResultTransformCommand());\n\n    __repaint();\n  }\n\n  _self.repaint = __repaint;\n\n  function __repaint() {\n    __updateClient();\n\n    if (_Aobj) {\n      _Aobj.transform(__getResultTransformCommand());\n    }\n\n    if (_Atxt) {\n      _Atxt.repaint();\n    }\n  }\n\n  _self.getTransform = __getResultTransformCommand;\n\n  function __getResultTransformCommand() {\n    var m = atalaRaphael.matrix();\n\n    var viewerTransform = _Cdata.getViewerTransform(_Aself._pageindex);\n\n    var selfTransform = _Aself.getTransform();\n\n    m.add(viewerTransform.a, viewerTransform.b, viewerTransform.c, viewerTransform.d, viewerTransform.e, viewerTransform.f);\n    m.add(selfTransform.a, selfTransform.b, selfTransform.c, selfTransform.d, selfTransform.e, selfTransform.f);\n    return m.toTransformString();\n  } // called by __updateClient\n\n\n  function __updateClientRect() {\n    _Aobj.attr({\n      x: _Adata.x,\n      y: _Adata.y,\n      width: _Adata.width,\n      height: _Adata.height\n    });\n\n    if (_Acustom) {\n      _Acustom.render(_Aobj, _Adata);\n    } // VML doesn't play well with setting attributes after the annotation is scaled\n\n\n    if (Browser.Features.VML) {\n      _Aobj.transform(__getResultTransformCommand());\n    }\n  } // called by __updateClient\n\n\n  function __updateClientEllipse() {\n    // uncomment if we switch back to using Raphael ellipses\n    //\t\t_Aobj.attr({\n    //\t\t\trx: (_Adata.width / 2),\n    //\t\t\try: (_Adata.height / 2),\n    //\t\t\tcx: _Adata.x + (_Adata.width / 2),\n    //\t\t\tcy: _Adata.y + (_Adata.height / 2)\n    //\t\t});\n    __plotEllipse();\n\n    if (_Aobj._ && _Aobj._.dirty === 0) {\n      _Aobj._.dirty = 1;\n    }\n  } // called by __updateClient\n\n\n  function __updateClientPath() {\n    __plotPoints();\n\n    if (_Aobj._) {\n      if (_Aobj._.dirty === 0) {\n        _Aobj._.dirty = 1;\n      }\n    }\n  } // magic number: 4 * ((Math.sqrt(2) -1) / 3)\n\n\n  var KAPPA = 0.5522847498307936; // plots an ellipse with a path, to work around a Raphael bug with paper.ellipse()\n\n  function __plotEllipse() {\n    var rx = _Adata.width / 2;\n    var ry = _Adata.height / 2;\n    var kx = KAPPA * rx;\n    var ky = KAPPA * ry;\n    var cx = _Adata.x + _Adata.width / 2;\n    var cy = _Adata.y + _Adata.height / 2;\n    var ps = ['M', cx, cy - ry, // moveto\n    'C', cx + kx, cy - ry, cx + rx, cy - ky, cx + rx, cy, 'C', cx + rx, cy + ky, cx + kx, cy + ry, cx, cy + ry, 'C', cx - kx, cy + ry, cx - rx, cy + ky, cx - rx, cy, 'C', cx - rx, cy - ky, cx - kx, cy - ry, cx, cy - ry, 'Z' // close ellipse\n    ];\n\n    _Aobj.attr({\n      'path': ps\n    });\n  } // plots the data or captured points into a Raphael path\n\n\n  function __plotPoints() {\n    // checking for data existing\n    if (!_Adata.points || _Adata.points.length === 0) return; // moveto\n\n    var ps = ['M', _Adata.points[0].x, _Adata.points[0].y]; // lineto\n\n    for (var i = 1; i < _Adata.points.length; i++) {\n      ps = ps.concat(['L', _Adata.points[i].x, _Adata.points[i].y]);\n    } // closes the path for fill\n\n\n    if (_Adata.type === 'polygon') {\n      ps.push('Z');\n    }\n\n    _Aobj.attr({\n      'path': ps\n    });\n\n    __fixLineCapsIE();\n  }\n  /**\r\n   * Work around outlined by this post:\r\n   * http://stackoverflow.com/questions/15693178/svg-line-markers-not-updating-when-line-moves-in-ie10\r\n   */\n\n\n  function __fixLineCapsIE() {\n    if (Browser.Explorer) {\n      var version = parseInt(Browser.Version, 10);\n\n      if (version >= 10 && version < 12 && _Aobj.node && _Aobj.node.parentNode) {\n        _Aobj.node.parentNode.insertBefore(_Aobj.node, _Aobj.node);\n      }\n    }\n  }\n\n  _self.commitTransform = __commitMatrixData;\n\n  function __commitMatrixData() {\n    atalaJquery.extend(_Adata, __dataFromMatrix(_mtx, _Cdata.getZoom(_Aself._pageindex)));\n\n    __commitRaphaelData();\n\n    _pathMtx = null;\n  } // transforms the annotation on the UI space\n\n\n  _self.transformUI = __transformUI;\n  var _pathMtx = null;\n\n  function __transformUI(x, y, w, h) {\n    _mtx = atalaRaphael.matrix(w, 0, 0, h, x, y);\n\n    if (!_pathMtx) {\n      _pathMtx = __matrixFromData(_Adata, 1);\n    }\n\n    _mtx.add(_pathMtx.a, _pathMtx.b, _pathMtx.c, _pathMtx.d, _pathMtx.e, _pathMtx.f);\n\n    __updateFromMatrix();\n  } // determines if any edge of the second rectangle is inside the bounds of the first\n\n\n  function __rectInRect(rect1, rect2) {\n    return __pointInRect(rect1, rect2.x, rect2.y) || __pointInRect(rect1, rect2.x + rect2.width, rect2.y) || __pointInRect(rect1, rect2.x, rect2.y + rect2.height) || __pointInRect(rect1, rect2.x + rect2.width, rect2.y + rect2.height);\n  } // determines if the points is within the bounds of the rectangle\n\n\n  function __pointInRect(rect, x, y) {\n    return x >= rect.x && x <= rect.x + rect.width && y >= rect.y && y <= rect.y + rect.height;\n  }\n\n  function __matrixFromData(data, z) {\n    var matrix;\n\n    if (data.points && data.points.length > 1) {\n      var box = _Aself.getBox();\n\n      matrix = atalaRaphael.matrix(1, 0, 0, 1, 0, 0);\n      matrix.scale(1 / box.width, 1 / box.height, 0, 0);\n      matrix.translate(-box.x, -box.y);\n    } else {\n      matrix = atalaRaphael.matrix(z, 0, 0, z, 0, 0);\n      matrix.translate(data.x, data.y);\n      matrix.scale(data.width, data.height, 0, 0);\n    }\n\n    return matrix;\n  }\n\n  function __dataFromMatrix(matrix, z) {\n    var val = matrix.split();\n    var data = {\n      x: val.dx / z,\n      y: val.dy / z,\n      width: val.scalex / z,\n      height: val.scaley / z\n    };\n    return data;\n  }\n};\n\n/* harmony default export */ var AnnotationDrawHandler = (AnnotationDrawHandler_DrawHandler);\n// CONCATENATED MODULE: ./src/annotations/Annotation.js\n\n\n//\n//  Annotation class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t02-09-12\tD. Cilley\t\tFile Created.\n//\t03-02-12\tD. Cilley\t\tFB 12982: Fixed annotation creation in Firefox\n//\t05-03-12\tD. Cilley\t\tReplaced ellipse with a path\n//\t09-17-12\tD. Cilley\t\tFB 13597: Handled new selectchange event to improve mobile.\n//\t10-19-12\tJ. Burch\t\tFB 13694: Fixing bug with recycled annotations\n//\t10-19-12\tD. Cilley\t\tFB 13690: Added getClonedData with update function\n//\t10-22-12\tD. Cilley\t\tFB 13694: Found a problem with original fix, added viewchanged event\n//\t11-05-12\tD. Cilley\t\tFB 13742, 13744: Fixed bugs in creating annotations.\n//\t11-07-12\tJ. Burch\t\tFB 13748: Fixing problem with getClonedData\n//\t11-15-12\tJ. Burch\t\tFB 13772: Fixing the movable, selectable, and resizable properties.\n//\t01-29-13\tD. Cilley\t\tFB 13946: Fixed default path opacity for lines, polys, and freehand.\n//\t02-15-13\tD. Cilley\t\tFB 13970: Removed stray commas to fix annotation drawing in IE7.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t02-22-13\tD. Cilley\t\tFB 13989: Rolled back a change in Arepaint from changeset 58054.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t03-21-13\tJ. Burch\t\tFB 13973: Refactored __ArebindUIEvents so that events were not being thrown away.\n//\t04-04-13\tD. Cilley\t\tFB 13993, 13996, 13997: Added AnnotationSelector for document level selecting.\n//\t07-31-13\tD. Cilley\t\tFB 14245: Added arrowhead functionality.\n//\t08-30-13\tD. Cilley\t\tFB 14274: Added multiview for Thumbnailer functionality.\n//\t11-13-13\tD. Cilley\t\tFB 14477: Fixed internal default setting on multiview annotations.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\n\n\n\nvar Annotation_Annotation = function Annotation(wdv, settings, cdata) {\n  var _wdv = wdv;\n  var _Cdata = cdata; // controller data object (do not modify values)\n\n  var _Aself = this;\n\n  var _Aeve = new AnnotationEventHelper(_Aself);\n\n  var _Aboundeve = null; // UI events bound \n\n  var _Aobj = null; // Raphael obj\n\n  var _Atxt = null; // TextAnnotationUI obj\n\n  var _Aglw = null; // Raphael glow obj\n\n  var _Adraw = null; // DrawHandler obj\n\n  var _Acustom = null; // Custom renderer obj if needed\n\n  var _Aclone = null;\n  var _bbox = null; // bounding box for annotation\n\n  var _Adata = settings.multiview ? settings : __createDefaultAnnotationData(); // default properties for specific annotation types\n  // \n\n\n  var _Adefaults = {\n    highlight: {\n      fill: {\n        color: 'yellow',\n        opacity: 0.5\n      },\n      outline: {\n        opacity: 0\n      }\n    },\n    image: {\n      fill: {\n        color: null\n      },\n      outline: {\n        opacity: 0\n      }\n    },\n    rectangle: {\n      fill: {\n        opacity: 0\n      }\n    },\n    stamp: {\n      cornerradius: 0,\n      text: {\n        autoscale: true,\n        verifyFontFamily: false\n      }\n    },\n    line: {\n      fill: {\n        color: null\n      },\n      outline: {\n        opacity: 1,\n        startcap: {\n          width: 'medium',\n          // Raphael arrow width: wide, narrow, medium\n          height: 'medium',\n          // Raphael arrow length: long, short, medium\n          style: 'none' // Raphael arrow type: classic, block, open, oval, diamond, none\n\n        },\n        endcap: {\n          width: 'medium',\n          // Raphael arrow width\n          height: 'medium',\n          // Raphael arrow length\n          style: 'none' // Raphael arrow type\n\n        }\n      }\n    },\n    lines: {\n      fill: {\n        color: null\n      },\n      outline: {\n        opacity: 1\n      }\n    },\n    freehand: {\n      fill: {\n        color: null\n      },\n      outline: {\n        opacity: 1\n      }\n    },\n    ellipse: {},\n    fillrect: {},\n    polygon: {},\n    text: {\n      text: {\n        verifyFontFamily: false\n      }\n    }\n  }; // default UI event handling \n\n  var _AuiEvents = {};\n\n  __Ainit();\n\n  function __Ainit() {\n    // multiview annotations don't need defaults set\n    if (!settings.multiview) {\n      __AinitData(settings.type);\n    }\n\n    __AsetDataInternal(settings, true);\n\n    __recalculateTransform();\n\n    if (_Adata.type === 'custom') {\n      _Acustom = new annotations_AnnotationCustomRenderer(_Adata, _Aeve);\n    }\n\n    _Adraw = new AnnotationDrawHandler(_Adata, _Cdata, _Aeve, _Aself, _Acustom);\n\n    __AbindEvents({\n      repaint: _Adraw.events.update,\n      viewchanged: _Adraw.events.viewchanged,\n      drawn: __AbindUiEvents,\n      resized: __AresizeFinished\n    });\n\n    if (_Adata.points && (_Adata.x > 0 || _Adata.y > 0)) {\n      __Atranslate(_Adata.x, _Adata.y); // client side doesn't use location or size for point based annotations\n\n\n      _Adata.x = 0;\n      _Adata.y = 0;\n      _Adata.width = 1;\n      _Adata.height = 1;\n    } // This has to be initialized after _Adraw is initialized\n\n\n    __AinitUiEvents();\n  }\n\n  function __AinitUiEvents() {\n    _AuiEvents = {\n      // selectable events\n      selectable: {\n        selectchange: __AtoggleSelected\n      },\n      // moving events\n      movable: {\n        dragstart: _Adraw.events.dragstart,\n        dragmove: _Adraw.events.dragmove,\n        dragend: _Adraw.events.dragend\n      },\n      // resizing events for mobile\n      resizable: {\n        pinchstart: _Adraw.events.pinchstart,\n        pinchmove: _Adraw.events.pinchmove,\n        pinchend: _Adraw.events.pinchend\n      },\n      boundEvents: {\n        'resizable': false,\n        'movable': false,\n        'selectable': false\n      },\n      isBound: function isBound(property) {\n        return this.boundEvents[property];\n      },\n      bound: function bound(property) {\n        this.boundEvents[property] = true;\n      },\n      unbound: function unbound(property) {\n        this.boundEvents[property] = false;\n      }\n    };\n  }\n\n  _Aself.dispose = __Adispose;\n\n  function __Adispose() {\n    if (_Adata.selected) {\n      __AtoggleSelected();\n    }\n\n    if (_Aeve) {\n      // first one unbinds raphael events, second unbinds all jquery events\n      //\t\t\t_Aeve.unbind(_Aobj);\n      _Aeve.unbind();\n    }\n\n    if (_Aobj) {\n      _Aobj.remove();\n    }\n\n    if (_Atxt) {\n      _Atxt.dispose();\n    }\n\n    if (_Aglw) {\n      _Aglw.remove();\n    }\n\n    if (_Adraw) {\n      _Adraw.unbindEvents();\n    }\n\n    _Adraw = null;\n    _Cdata = null;\n    _Aself = null;\n    _Aeve = null;\n    _Aobj = null;\n    _Atxt = null;\n    _Aglw = null;\n    _Adata = null;\n  }\n\n  _Aself.bind = __AbindEvents;\n\n  function __AbindEvents() {\n    _Aeve.bind.apply(_Aeve, arguments);\n  }\n\n  _Aself.unbind = __AunbindEvents;\n\n  function __AunbindEvents() {\n    _Aeve.unbind.apply(_Aeve, arguments);\n  }\n\n  _Aself.trigger = __AtriggerEvent;\n\n  function __AtriggerEvent() {\n    _Aeve.trigger.apply(_Aeve, arguments);\n\n    return _Aself;\n  }\n\n  function __createDefaultAnnotationData() {\n    /**\r\n     * Represents generic annotation data object.\r\n     *\r\n     * This basic object structure is applied to all annotations. Individual types of annotation could ignored some of those properties.\r\n     * This structure is used when configuring default values for particular annotation types using {@link WebDocumentViewerConfig.annotations}, creating annotations using {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#createOnPage|annotations.createOnPage} or retrieving annotations data using corresponding api.\r\n     *\r\n     * *Note*, Annotation could have only one of two positioning models\r\n     * - Box model, i.e. annotation position and size is defined by {@link AnnotationData.x | X}, {@link AnnotationData.y | Y}, {@link AnnotationData.width | width} and {@link AnnotationData.height | height} properties.\r\n     * For example, `rectangle` or `text` annotations.\r\n     *\r\n     * - Points model, which means that annotation consist of an array of individual points stored in {@link AnnotationData.points | points} property.\r\n     * For example, `lines` or `freehand` annotations.\r\n     *\r\n     * It's expected that annotation have only one of positioning model, and often rendering is performed basing on existence or absence of {@link AnnotationData.points | points} value. I.e. in case if {@link AnnotationData.points | points} is set, {@link AnnotationData.x | X}, {@link AnnotationData.y | Y}, {@link AnnotationData.width | width} and {@link AnnotationData.height | height} values could be ignored.\r\n     *\r\n     * @atalaconfig\r\n     * @alias AnnotationData\r\n     */\n    var data = {\n      // JSON serializable data object for transport to server\n\n      /**\r\n       * @property {Atalasoft.Annotations.AnnotationTypes} type - Annotation type.\r\n       */\n      type: '',\n\n      /**\r\n       * @property {number} [x=0] - X axis annotation coordinate in document coordinate space.\r\n       */\n      x: 0,\n\n      /**\r\n       * @property {number} [y=0] - Y axis annotation coordinate in document coordinate space.\r\n       */\n      y: 0,\n\n      /**\r\n       * @property {number} [width=0] - Width of the annotation box.\r\n       */\n      width: 0,\n\n      /**\r\n       * @property {number} [height=0] - Height of the annotation box.\r\n       */\n      height: 0,\n\n      /**\r\n       * @property {Point[]} [points=undefined] - Array of annotation points.\r\n       */\n      points: undefined,\n\n      /**\r\n       * @property {number} [rotation=0] - Represents annotation rotation angle.\r\n       *\r\n       * Note, this property is ignored when annotation is created from UI, i.e. when specified in {@link WebDocumentViewerConfig.annotations} configurations.\r\n       */\n      rotation: 0,\n\n      /**\r\n       * @private\r\n       */\n      transform: atalaRaphael.matrix(),\n\n      /**\r\n       * @property {boolean} [visible=true] - Indicates whether annotation is visible.\r\n       */\n      visible: true,\n\n      /**\r\n       * @property {boolean} [movable=true] - Indicates whether annotation could be moved through UI.\r\n       */\n      movable: true,\n\n      /**\r\n       * @property {boolean} [rotatable=true] -Indicates whether annotation could be rotated through UI.\r\n       */\n      rotatable: true,\n\n      /**\r\n       * @property {boolean} [resizable=true] - Indicates whether annotation could be resized through UI.\r\n       */\n      resizable: true,\n\n      /**\r\n       * @property {boolean} [selected=false] - Indicates whether annotation is currently selected.\r\n       */\n      selected: false,\n\n      /**\r\n       * @property {boolean} [selectable=true] - Indicates whether annotation is selectable.\r\n       */\n      selectable: true,\n\n      /**\r\n       * @property {boolean} [readonly=false] - Indicates whether annotation is readonly. If set to true annotation couldn't be modified through UI and context menu couldn't be enable for it.\r\n       * (There is a separate readonly property (annotation.text.readonly) for text area in text annotation.)\r\n       */\n      readonly: false,\n\n      /**\r\n       * @property {boolean} [burn=false] - Indicates whether this annotation should be \"burned\" to output document on save. If set to true, annotation will be rendered on top of the image for all output formats except PDF. For PDF documents, annotations will be rendered and added as a separate layer on top of the document content.\r\n       */\n      burn: false,\n\n      /**\r\n       * @property {string} [tooltip] - Annotation tooltip.\r\n       */\n      tooltip: '',\n\n      /**\r\n       * @property {string} name - Annotation type title. This will be shown as a caption for toolbar buttons representing \"extended\" types annotations. This applies to `stamp` and `image` types of annotation. I.e. name should be set to annotations defined by application using {@link WebDocumentViewerConfig.annotations| annotations.stamps} and {@link WebDocumentViewerConfig.annotations| annotations.images}.\r\n       */\n      name: '',\n\n      /**\r\n       * @property {string} [username] - Corresponds to server side `AnnotationData.UserName` property.\r\n       */\n      username: '',\n\n      /**\r\n       * @ignore\r\n       */\n      //this property not works properly since it's applied only on creation and ignored on resize\n      aspectratio: 0,\n      // 0 is unrestricted\n\n      /**\r\n       * @property {number} [cornerradius=0] - Represents corner rounding radius for Stamp annotations.\r\n       *\r\n       */\n      cornerradius: 0,\n\n      /**\r\n       * Represents annotation fill configuration.\r\n       * @typedef {Object} AnnotationFill\r\n       * @property {string} [color='white'] - Fill color.\r\n       * @property {number} [opacity=1] - Opacity level.\r\n       */\n\n      /**\r\n       * @property {AnnotationFill} [fill] - Represents annotation fill.\r\n       */\n      fill: {\n        color: 'white',\n        opacity: 1\n      },\n\n      /**\r\n       * @typedef AnnotationLineCap\r\n       * @property {string} [style] - Style of the cap. Valid values are `'block'`, `'open'`, `'oval'`, `'diamond'`, and `'none'`.\r\n       * @property {string} [width] - Width of the cap. Valid values are `'wide'`, `'narrow'`, and `'medium'`\r\n       * @property {string} [height] - Height of the cap. Valid values are `'long'`, `'short'`, and `'medium'`.\r\n       */\n\n      /**\r\n       * Represents annotation outline configuration.\r\n       * @typedef {Object} AnnotationOutline\r\n       * @property {string} [color='black'] - Outline color.\r\n       * @property {number} [opacity=1] - Opacity level.\r\n       * @property {number} [width=2] - Line width.\r\n       * @property {AnnotationLineCap} startcap - Starting point arrow cap configuration for the line annotation.\r\n       * @property {AnnotationLineCap} endcap - End point arrow cap configuration for the line annotation.\r\n       */\n\n      /**\r\n       * @property {AnnotationOutline} [outline] - Annotation outline.\r\n       */\n      outline: {\n        color: 'black',\n        opacity: 1,\n        width: 2,\n        startcap: null,\n        endcap: null\n      },\n\n      /**\r\n       * @property {string} [src] - Url of the image displayed by the \"image\" annotation.\r\n       */\n      src: '',\n      // image based anno\n\n      /**\r\n       * Represents configuration for text based annotations like 'text' or 'stamp'.\r\n       * @typedef {Object} AnnotationTextConfig\r\n       * @property {string} [value] - Displayed annotation text.\r\n       * @property {string} [align='left'] - Text align. Allowed values are `'left'`, `'center'`, or `'right'`.\r\n       * @property {Object} [font] - Annotation text font configuration.\r\n       * @property {boolean} [font.bold=false] - Indicates whether annotation text is bold.\r\n       * @property {boolean} [font.italic=false] - Indicates whether annotation text is italic.\r\n       * @property {boolean} [font.strike=false] - Indicates whether annotation text is strike.\r\n       * @property {boolean} [font.underline=false] - Indicates whether annotation text is underline.\r\n       * @property {string} [font.color='black'] - Annotation text color.\r\n       * @property {string} [font.family='Arial'] - Annotation text font family.\r\n       * @property {number} [font.size=12] - Annotation text font size.\r\n       *\r\n       * @property {boolean} [readonly=false] - Indicates whether annotation text could be changed.\r\n       * @property {boolean} [verifyFontFamily=false] - If true, the availability of the font family will be checked at saving. If the font family is not found, the font will be replaced by Microsoft Sans Serif.\r\n       *  \r\n       * @property {boolean} [autoscale] - Indicates whether text should be scaled to the size of the bounding box for the Stamp and Text annotations.\r\n       *\r\n       * This could be useful to make Stamp annotation looks similar to its representation burned into image or opened in different Atalasoft viewers.\r\n       * \r\n       */\n\n      /**\r\n       * @property {AnnotationTextConfig} [text] - Annotation text configuration.\r\n       */\n      text: {\n        // text based annos\n        value: null,\n        // text contents!\n        align: 'left',\n        font: {\n          // font props\n          bold: false,\n          italic: false,\n          strike: false,\n          underline: false,\n          color: 'black',\n          family: 'Arial',\n          size: 12\n        },\n        readonly: false,\n        // read only?\n        verifyFontFamily: false,\n        replies: null,\n        // comment annotation replies. not used?\n        parent: null,\n        // comment annotation anchor. not used?\n        autoscale: false\n      },\n\n      /**\r\n       * @property {Object} [extra] - Additional data that could be stored along with annotation. Application specific properties is expected to be inserted into this object.\r\n       * Those data will be transacted to extra properties of the server-side `AnnotationData` object.\r\n       */\n      extra: {}\n    };\n    /**\r\n     * Synchronizes user instance of the annotation data with corresponding internal state. Triggers UI invalidation if necessary.\r\n     *\r\n     * This method should be called to apply any property changes made by application.\r\n     * @function AnnotationData#update\r\n     * @instance\r\n     */\n\n    /**\r\n     * Returns the page index for particular annotation.\r\n     * @function AnnotationData#getPageIndex\r\n     * @instance\r\n     * @returns {number}\r\n     */\n\n    return data;\n  }\n\n  function __onChangeRotation(value, old) {\n    var diff = (value - old + 360) % 360;\n    var tmpMatrix = atalaRaphael.matrix();\n\n    var transformMatrix = __AgetTransform();\n\n    tmpMatrix.add(transformMatrix.a, transformMatrix.b, transformMatrix.c, transformMatrix.d, transformMatrix.e, transformMatrix.f);\n\n    var rect = __AgetBox(); // transform current doc space around center and check where location will be\n    // then we'll just put real location there and rotate around it instead of center.\n    // thus result will look like we've performed center rotation.\n\n\n    tmpMatrix.rotate(diff, rect.x + rect.width / 2, rect.y + rect.height / 2);\n    var newx = tmpMatrix.x(rect.x, rect.y);\n    var newy = tmpMatrix.y(rect.x, rect.y);\n\n    __Atranslate(newx - rect.x, newy - rect.y);\n\n    __recalculateTransform();\n  }\n\n  function __recalculateTransform() {\n    var tmpMatrix = atalaRaphael.matrix();\n\n    var rect = __AgetBox();\n\n    tmpMatrix.rotate(_Adata.rotation, rect.x, rect.y);\n    _Adata.transform = tmpMatrix;\n  } // this is some sort of hack - when we are done with UI resizing, _ATransform.matrix \n  // is still constructed to rotate object around old location(before any resizing)\n  // this were fine for UI but in model we should calculate rotation around (0;0)\n\n\n  function __AresizeFinished() {\n    var box = __AgetBox();\n\n    var newL = __AtransformPoint(__AgetTransform(), box);\n\n    if (newL.x !== box.x || newL.y !== box.y) {\n      __Atranslate(newL.x - box.x, newL.y - box.y);\n    }\n  } // map settings onto data\n\n\n  _Aself.set = __AsetData;\n\n  function __AsetData(cfg, deep) {\n    if (cfg) {\n      var oldRotation = _Adata.rotation;\n\n      if (cfg.hasOwnProperty('rotation')) {\n        cfg.rotation = (cfg.rotation + 360) % 360;\n      }\n\n      __AsetDataInternal(cfg, deep);\n\n      if (oldRotation !== _Adata.rotation) {\n        __onChangeRotation(_Adata.rotation, oldRotation);\n      }\n    }\n  }\n\n  function __AsetDataInternal(cfg, deep) {\n    if (deep) {\n      atalaJquery.extend(true, _Adata, cfg);\n    } else {\n      atalaJquery.extend(_Adata, cfg);\n    }\n  }\n\n  _Aself.get = __AgetData;\n\n  function __AgetData(s) {\n    if (s) {\n      return _Adata[s];\n    } else {\n      return _Adata;\n    }\n  }\n\n  _Aself.getTransform = __AgetTransform;\n\n  function __AgetTransform() {\n    return _Adata.transform;\n  }\n\n  function __AmakeClonedData() {\n    function __removeCloneExtras() {\n      if (_Adata.update) {\n        delete _Adata.update;\n      }\n\n      if (_Adata.getPageIndex) {\n        delete _Adata.getPageIndex;\n      }\n    }\n\n    _Aclone = {\n      // documented along with AnnotationData definition.\n      update: function update(viewOnly) {\n        // need to toggle selected before we overwrite the data\n        if (_Adata.selected !== _Aclone.selected) {\n          __AtoggleSelected();\n        }\n\n        var triggerevent = false;\n\n        var _Aprev = atalaJquery.extend(true, {}, _Adata);\n\n        delete _Aprev.update;\n        delete _Aprev.getPageIndex;\n        delete _Aprev.transform;\n\n        if (_Atxt && _Atxt.inEditMode()) {\n          __AtriggerEvent({\n            type: 'annotationtextchangefailed',\n            anno: _Aself\n          });\n\n          return;\n        }\n\n        if (!viewOnly) {\n          triggerevent = __AcompareData(_Aclone, _Adata);\n\n          __AsetData(_Aclone, true);\n        }\n\n        __removeCloneExtras();\n\n        __AupdateView();\n\n        __Arepaint();\n\n        __ArebindUiEvents();\n\n        if (triggerevent) {\n          __AtriggerEvent({\n            type: 'annotationchanged',\n            ann: _Aself,\n            annobefore: _Aprev\n          });\n        }\n      },\n      getPageIndex: function getPageIndex() {\n        return _Aself._pageindex;\n      }\n    };\n    atalaJquery.extend(true, _Aclone, _Adata);\n  }\n\n  _Aself.notifyChanges = _AsendChangedEvent;\n\n  function _AsendChangedEvent(props) {\n    var _Aprev = atalaJquery.extend(true, {}, _Aself.getClonedData());\n\n    delete _Aprev.update;\n    delete _Aprev.getPageIndex;\n    atalaJquery.extend(true, _Aprev, props);\n\n    __AtriggerEvent({\n      type: 'annotationchanged',\n      anno: _Aself,\n      annobefore: _Aprev\n    });\n  }\n\n  _Aself.getClonedData = __AgetClonedData;\n\n  function __AgetClonedData() {\n    if (!_Aclone) {\n      __AmakeClonedData();\n    } else {\n      atalaJquery.extend(true, _Aclone, _Adata);\n    }\n\n    delete _Aclone.transform;\n    return _Aclone;\n  }\n\n  _Aself.getObject = __AgetObject;\n\n  function __AgetObject() {\n    return _Aobj;\n  }\n\n  _Aself.getEventObject = __AgetEventObject;\n\n  function __AgetEventObject() {\n    return _Aeve;\n  }\n\n  _Aself.getZoom = function () {\n    return _Cdata.getZoom(_Aself._pageindex);\n  };\n\n  _Aself.stringify = __Astringify;\n  _Aself.getJSON = __Astringify;\n\n  function __Astringify() {\n    return JSON.stringify(_Adata);\n  }\n\n  _Aself.toggleSelected = __AtoggleSelected;\n\n  function __AtoggleSelected(e) {\n    if (!_Adata) {\n      return;\n    } // event args to trigger\t\n\n\n    var evt = {\n      ann: _Aself,\n      append: true,\n      // when e is undefined, we always append\n      page: null,\n      pageindex: _Aself._pageindex,\n      type: ''\n    };\n\n    if (e) {\n      evt.append = e.shiftKey || e.ctrlKey || e.append !== undefined && e.append;\n      evt.page = e.page;\n      evt.pageindex = e.pageindex;\n    } // only toggle if we're appending or it's not already selected\n\n\n    if (evt.append || !_Adata.selected) {\n      _Adata.selected = !_Adata.selected;\n      evt.type = _Adata.selected ? 'selected' : 'deselected';\n    } // clicked without append needs to notify controller\n    else if (_Adata.selected && !evt.append) {\n        evt.type = 'reselected';\n      } // only fire an event if we have something to do\n\n\n    if (evt.type !== '') {\n      __AtriggerEvent(evt);\n    }\n  }\n\n  _Aself.isCloneSource = __AisCloneSource;\n\n  function __AisCloneSource(clone) {\n    return _Aclone && _Aclone === clone;\n  }\n\n  function __AinitData(aType) {\n    atalaJquery.extend(true, _Adata, _Adefaults[aType]);\n  } // Since we don't know which drawing surface this annotation will be drawn\n  // on, we need to create it when the annotation starts drawing\n  // paper: Raphael drawing surface for this annotation\n\n\n  function __AcreateAnnotation(paper) {\n    var aobj = null;\n\n    switch (_Adata.type) {\n      case 'image':\n        aobj = paper.image();\n        aobj.attr('src', _Adata.src);\n        break;\n      // rectangle based annotations\t\n\n      case 'highlight':\n        aobj = paper.rect();\n        break;\n\n      case 'rectangle':\n        aobj = paper.rect();\n        break;\n\n      case 'fillrect':\n        aobj = paper.rect();\n        break;\n\n      case 'text':\n        aobj = paper.rect();\n        break;\n\n      case 'stamp':\n        aobj = paper.rect();\n        break;\n      // path based annotations\n\n      case 'ellipse':\n        aobj = paper.path();\n        break;\n\n      case 'line':\n        aobj = paper.path();\n        break;\n\n      case 'lines':\n        aobj = paper.path();\n        break;\n\n      case 'freehand':\n        aobj = paper.path();\n        break;\n\n      case 'polygon':\n        aobj = paper.path();\n        break;\n\n      case 'custom':\n        aobj = _Acustom.construct(paper);\n        break;\n    }\n\n    if (paper._annos) {\n      paper._annos.push(aobj);\n    }\n\n    return aobj;\n  }\n\n  function __AbindUiEvents() {\n    if (_Aboundeve !== null) {\n      if (_Aobj) {\n        _Aeve.unbind(_Aobj, _Aboundeve);\n      } else {\n        _Aeve.unbind(_Aboundeve);\n      }\n    }\n\n    var evts = {};\n\n    if (!_Adata.readonly && _Adata.selectable) {\n      atalaJquery.extend(evts, _AuiEvents.selectable);\n\n      _AuiEvents.bound('selectable');\n\n      if (!_Cdata.readonly && !_Adata.readonly && _Adata.movable) {\n        atalaJquery.extend(evts, _AuiEvents.movable);\n\n        _AuiEvents.bound('movable');\n      }\n\n      if (!_Cdata.readonly && !_Adata.readonly && _Adata.resizable && Browser.Features.Touch) {\n        atalaJquery.extend(evts, _AuiEvents.resizable);\n\n        _AuiEvents.bound('resizable');\n      }\n    }\n\n    _Aboundeve = evts;\n\n    _Aeve.bind(_Aobj, evts);\n  }\n\n  function __ArebindUiEvents() {\n    if (_Aboundeve !== null) {\n      // if the data is selectable but the event is not yet bound\n      if (!_Adata.readonly && _Adata.selectable) {\n        if (!_AuiEvents.isBound('selectable')) {\n          _Aeve.bind(_AuiEvents.selectable);\n\n          _AuiEvents.bound('selectable');\n        }\n\n        if (!_Adata.readonly && _Adata.movable && !_AuiEvents.isBound('movable')) {\n          _Aeve.bind(_AuiEvents.movable);\n\n          _AuiEvents.bound('movable');\n        } else if ((_Adata.readonly || !_Adata.movable) && _AuiEvents.isBound('movable')) {\n          _Aeve.unbind(_AuiEvents.movable);\n\n          _AuiEvents.unbound('movable');\n        }\n\n        if (Browser.Features.Touch) {\n          if (!_Adata.readonly && _Adata.resizable && !_AuiEvents.isBound('resizable')) {\n            _Aeve.bind(_AuiEvents.resizable);\n\n            _AuiEvents.bound('resizable');\n          } else if ((_Adata.readonly || !_Adata.resizable) && _AuiEvents.isBound('resizable')) {\n            _Aeve.unbind(_AuiEvents.resizable);\n\n            _AuiEvents.unbound('resizable');\n          }\n        }\n      } // OR if the data is NOT selectable but the event is still bound\n      else if ((_Adata.readonly || !_Adata.selectable) && _AuiEvents.isBound('selectable')) {\n          _Aeve.unbind(_AuiEvents.selectable);\n\n          _AuiEvents.unbound('selectable');\n\n          _Aeve.unbind(_AuiEvents.movable);\n\n          _AuiEvents.unbound('movable');\n\n          _Aeve.unbind(_AuiEvents.resizable);\n\n          _AuiEvents.unbound('resizable');\n        }\n    }\n  }\n\n  _Aself.getBox = __AgetBox;\n  /**\r\n   * Returns bounding box of the annotation in document space.\r\n   */\n\n  function __AgetBox() {\n    if (!_bbox && _Adata.points) {\n      _bbox = __calcPathBounds(_Adata.points);\n    }\n\n    var rect = _Adata.points ? _bbox : _Adata;\n    return {\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    };\n  } // moves the data points by the given deltas\n\n\n  _Aself.translate = __Atranslate;\n\n  function __Atranslate(dx, dy) {\n    if (_Adata.points) {\n      for (var i = 0; i < _Adata.points.length; i++) {\n        _Adata.points[i].x += dx;\n        _Adata.points[i].y += dy;\n      }\n\n      if (_bbox) {\n        _bbox.x += dx;\n        _bbox.y += dy;\n      }\n    }\n\n    if (_Adata.type === 'custom' || !_Adata.points) {\n      _Adata.x += dx;\n      _Adata.y += dy;\n    }\n\n    __recalculateTransform();\n\n    __AbufferRepaint();\n  } // scales and positions the annotation to fit within the given rectangle\n\n\n  _Aself.transform = __Atransform;\n\n  function __Atransform(x, y, w, h) {\n    var box = __AgetBox();\n\n    var sx = w / box.width;\n    var sy = h / box.height;\n\n    if (_Adata.points && _Adata.points.length > 0 && _Adata.type !== 'custom') {\n      // scale all points by the calculated values\n      for (var i = 0; i < _Adata.points.length; i++) {\n        _Adata.points[i].x = x + (_Adata.points[i].x - box.x) * sx;\n        _Adata.points[i].y = y + (_Adata.points[i].y - box.y) * sy;\n      } // we store these on the main object since the data object gets serialized to the server\n\n\n      _bbox.x = x;\n      _bbox.y = y;\n      _bbox.width *= sx;\n      _bbox.height *= sy;\n    } else {\n      _Adata.x = x;\n      _Adata.y = y;\n      _Adata.width *= sx;\n      _Adata.height *= sy;\n    }\n\n    __AtriggerEvent({\n      type: 'annoresizing'\n    });\n\n    __AbufferRepaint();\n  } // scales and positions the annotation in UI space\n\n\n  _Aself.transformUI = __AtransformUI;\n\n  function __AtransformUI() {\n    _Adraw.transformUI.apply(_Adraw, arguments);\n  }\n\n  _Aself.commitTransform = __AcommitTransform;\n\n  function __AcommitTransform() {\n    _Adraw.commitTransform();\n  }\n\n  var _Arpnt = false;\n\n  var _Atic = Browser.Explorer ? 20 : 5;\n\n  function __AbufferRepaint() {\n    if (!_Arpnt) {\n      _Arpnt = true;\n      setTimeout(__AunBufferRepaint, _Atic);\n    }\n  }\n\n  function __AunBufferRepaint() {\n    _Arpnt = false;\n\n    __Arepaint();\n  } // #region Mouse Events\n\n\n  _Aself.startDraw = __AstartDraw;\n\n  function __AstartDraw(e, paper, cfg, textannomobilezoom) {\n    __AsetData(cfg);\n\n    _Aobj = __AcreateAnnotation(paper);\n\n    _Aobj.transform(_Adraw.getTransform());\n\n    if (_Adata.type === 'text' || _Adata.type === 'stamp') {\n      _Atxt = new text_TextAnnotationUI(_wdv, _Aself, paper, _Cdata, textannomobilezoom);\n    } //Set extra property to dispaly tooltip\n\n\n    __AupdateTooltipView();\n\n    __AupdateView();\n\n    _Adraw.drawStart(e, _Aobj, _Atxt);\n  } // #endregion\n\n\n  _Aself.repaint = __Arepaint;\n\n  function __Arepaint(paper) {\n    // repaint called with paper means that we need to draw it again\n    if (paper) {\n      if (_Aglw) {\n        _Aglw = null;\n      } // creation handles the custom recreate as well\n\n\n      _Aobj = __AcreateAnnotation(paper); // only need to render it once, the rest should be transforms\n\n      if (_Acustom) {\n        _Acustom.render(_Aobj, _Adata);\n      }\n\n      __AupdateView();\n\n      __AbindUiEvents();\n\n      if ((_Adata.type === 'text' || _Adata.type === 'stamp') && _Atxt === null) {\n        _Atxt = new text_TextAnnotationUI(_wdv, _Aself, paper, _Cdata);\n      } // notify of paper change\n\n\n      if (_Atxt) {\n        _Atxt.changepaper(paper);\n      } // annotation view is on a new paper so we notify with viewchanged\n\n\n      __AtriggerEvent({\n        type: 'viewchanged',\n        annview: _Aobj,\n        textview: _Atxt\n      });\n    }\n\n    __AtriggerEvent('repaint');\n  }\n\n  _Aself.updateView = __AupdateView;\n\n  function __AupdateView() {\n    if (_Aobj) {\n      var kvp = __AmapFill();\n\n      atalaJquery.extend(kvp, __AmapOutline());\n\n      _Aobj.attr(kvp);\n\n      __AfixArrows();\n\n      if (_Adata.visible) {\n        _Aobj.show();\n      } else {\n        _Aobj.hide();\n      }\n    }\n\n    __AupdateTextView();\n\n    __AupdateImageView();\n\n    __AupdateTooltipView();\n  } // updates the text properties\n\n\n  function __AupdateTextView() {\n    if (_Atxt) {\n      _Atxt.set(_Adata.text);\n\n      _Atxt.updateView();\n    }\n  } // Raphael doesn't support updating this property, so we\n  // have to use our own methods.\n\n\n  function __AupdateImageView() {\n    if (_Aobj && _Aobj.node && _Adata.src !== '' && _Adata.type === 'image') {\n      if (_Aobj.node.src !== undefined && _Aobj.node.src) {\n        _Aobj.node.src = _Adata.src;\n      } else {\n        _Aobj.node.href.baseVal = _Adata.src;\n      }\n    }\n  } //Set extra property to display tooltip\n  //Text and stamp annotation tooltip updated in their own code\n\n\n  function __AupdateTooltipView() {\n    if (_Adata.tooltip && !(_Adata.type === 'text' || _Adata.type === 'stamp')) {\n      _Aobj.attr('title', _Adata.tooltip);\n    }\n  } // maps the fill properties to keys that Raphael uses\n\n\n  function __AmapFill() {\n    return {\n      'fill': _Adata.fill.color,\n      'fill-opacity': _Adata.fill.opacity\n    };\n  } // maps the outline properties to keys that Raphael uses\n\n\n  function __AmapOutline() {\n    var kvp = {\n      'stroke': _Adata.outline.color,\n      'stroke-width': _Adata.outline.width * _Cdata.getZoom(_Aself._pageindex),\n      'stroke-opacity': _Adata.outline.opacity\n    };\n    _Aobj._linewidth = _Adata.outline.width;\n\n    if (!atalaRaphael.fn.addArrow) {\n      if (_Adata.outline.startcap) {\n        // && _Adata.outline.startcap.style !== 'none'){\n        kvp['arrow-start'] = __AtranslateLineCap(_Adata.outline.startcap);\n      }\n\n      if (_Adata.outline.endcap) {\n        // && _Adata.outline.endcap.style !== 'none'){\n        kvp['arrow-end'] = __AtranslateLineCap(_Adata.outline.endcap);\n      }\n    }\n\n    return kvp;\n  }\n\n  function __AfixArrows() {\n    if (atalaRaphael.fn.addArrow) {\n      if (_Adata.outline.startcap) {\n        // && _Adata.outline.startcap.style !== 'none'){\n        atalaRaphael.fn.addArrow(_Aobj, __AtranslateLineCap(_Adata.outline.startcap), false);\n      }\n\n      if (_Adata.outline.endcap) {\n        // && _Adata.outline.endcap.style !== 'none'){\n        atalaRaphael.fn.addArrow(_Aobj, __AtranslateLineCap(_Adata.outline.endcap), true);\n      }\n    }\n  }\n\n  function __AtranslateLineCap(cap) {\n    return [cap.style, '-', cap.width, '-', cap.height].join('');\n  }\n\n  function __AtransformPoint(matrix, p) {\n    return {\n      x: matrix.x(p.x, p.y),\n      y: matrix.y(p.x, p.y)\n    };\n  }\n\n  var __ADataFieldsForRecurse = {\n    fill: [],\n    outline: ['startcap', 'endcap'],\n    text: ['font'],\n    font: [],\n    startcap: [],\n    endcap: []\n  };\n\n  function __AcompareData(clone, original) {\n    return __AcompareDataImpl(clone, original, ['fill', 'outline', 'text']);\n  }\n\n  function __AcompareDataImpl(clone, original, fieldsToCallRecurse) {\n    if (clone !== original) return !!clone;\n\n    for (var propName in clone) {\n      if (clone.hasOwnProperty(propName)) {\n        if (propName === 'extra') {\n          continue;\n        }\n\n        if (original.hasOwnProperty(propName)) {\n          if (propName === 'points') {\n            if (clone.points !== original.points) {\n              if (clone.points.length !== original.points.length) return true;\n\n              for (var i = 0; i < clone.points.length; i++) {\n                if (__AcompareDataImpl(clone.points[i], original.points[i], [])) {\n                  return true;\n                }\n              }\n            } else {\n              return !clone.points;\n            }\n          }\n\n          if (fieldsToCallRecurse.indexOf(propName) > -1) {\n            if (__AcompareDataImpl(clone[propName], original[propName], __ADataFieldsForRecurse[propName])) {\n              return true;\n            }\n          } else {\n            if (clone[propName] !== original[propName]) {\n              return true;\n            }\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  return _Aself;\n};\n\n/* harmony default export */ var annotations_Annotation = (Annotation_Annotation);\n// CONCATENATED MODULE: ./src/annotations/AnnotationSelector.js\n\n\n//\n//  Annotation Selector class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t04-04-13\tD. Cilley\t\tFile Created.\n//\t04-04-13\tD. Cilley\t\tFB 13993, 13996, 13997: Added AnnotationSelector for document level selecting.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t07-02-15\tD. Cilley\t\tBug 625845: Added dispose method.\n//-------------------------------------------------------------------------------------------------\n // Handles all of the selection based operations for the WebAnnotationController\n// annos: internal annos array object from the AnnotationController\n// pages: internal pageDiv array from the WDV\n\nvar AnnotationSelector_AnnotationSelector = function AnnotationSelector(annos, pages) {\n  var _self = this;\n\n  var _annos = annos; // root annotations array from the AnnotationController\n\n  var _pages = pages; // visible pages array from the WDV\n\n  var _selected = []; // array of nested arrays of currently selected annotations\n  // #region Internal Methods\n\n  _self.dispose = __dispose;\n  _self.select = __selectAnno;\n  _self.deselect = __deselectAnno;\n  _self.setAnnos = __setAnnos;\n  _self.setPages = __setPages;\n  _self.resolvePage = __resolvePage; // set internal objects\n\n  function __setAnnos(sAnnos) {\n    _annos = sAnnos;\n  }\n\n  function __setPages(sPages) {\n    _pages = sPages;\n  } // disposes of objects\n\n\n  function __dispose() {\n    _self = null;\n    _annos = null;\n    _pages = null;\n    _selected.length = 0;\n  } // selects an annotation or array of annotations\n\n\n  function __selectAnno(o, fIndex, append) {\n    __select(true, o, fIndex, append);\n  } // deselects an annotation or array of annotations\n\n\n  function __deselectAnno(o, fIndex, append) {\n    __select(false, o, fIndex, append);\n  } // ***************************************************\n  // All select operations must route through this event\n  // ***************************************************\n  // select: boolean, true to select, false to deselect\n  // o: object[s], Annotation object or array of Annotations\n  // fIndex: integer/object, frame index or page from _pages array\n  // append: boolean, false clears the other selected annotations on this frame index  \n\n\n  function __select(select, o, fIndex, append) {\n    var arr = [].concat(o);\n    var page = null;\n    var ann, pos; // get page and frame index values from input\n\n    page = __resolvePage(fIndex);\n\n    if (page === fIndex && page !== null) {\n      fIndex = page._index;\n    } // need to deselect before we select\n\n\n    if (!append) {\n      __deselectAllPage(page || fIndex);\n    } // select all annotations given\n\n\n    for (var i = 0; i < arr.length; i++) {\n      ann = arr[i];\n      pos = atalaJquery.inArray(ann, _selected[fIndex]); // array position, if selected\n\n      if (pos >= 0) {\n        // in selected\n        if (!select && _selected[fIndex][pos] === ann) {\n          // need to remove?\n          // remove it from the selected array\n          _selected[fIndex].splice(pos, 1);\n        }\n      } else {\n        // not in selected array\n        if (select) {\n          // need to add?\n          if (_selected[fIndex]) {\n            _selected[fIndex].push(ann);\n          } else {\n            _selected[fIndex] = [ann];\n          }\n        }\n      } // it's possible to select annotations that aren't on a page\n\n\n      if (page) {\n        if (select) {\n          page._grips.push(ann);\n        } else {\n          if (page._grips !== null) {\n            page._grips.remove(ann);\n          }\n        }\n      } // toggle the selected flag if it's not equal\n\n\n      if (ann.get('selected') !== select) {\n        // this call should be last, since it will fire select in the controller\n        ann.toggleSelected({\n          append: true,\n          pageindex: fIndex,\n          page: page\n        });\n      }\n    }\n  } // ********************************************************\n  // All page select operations must route through this event\n  // ********************************************************\n  // select: boolean, true to select, false to deselect\n  // fIndex: integer/object, frame index or page from _pages array\n\n\n  function __selectPage(select, fIndex) {\n    var i = typeof fIndex === 'object' ? fIndex._index : fIndex;\n\n    if (_annos[i]) {\n      __select(select, _annos[i], fIndex, true);\n    }\n  }\n\n  function __getClonedAnnotations(arr) {\n    var cloned = [];\n\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i]) {\n        cloned[i] = [];\n\n        for (var z = 0; z < arr[i].length; z++) {\n          cloned[i][z] = arr[i][z].getClonedData();\n        }\n      }\n    }\n\n    return cloned;\n  } // finds the visible page corresponding to the given frame index, if any \n\n\n  function __resolvePage(fIndex) {\n    var page = null;\n\n    if (typeof fIndex === 'object') {\n      page = fIndex;\n    } else {\n      fIndex = Math.max(fIndex, 0);\n      var pgsrch = atalaJquery.grep(_pages, function (pg) {\n        return pg._index === fIndex;\n      });\n\n      if (pgsrch.length >= 1) {\n        page = pgsrch[0];\n      }\n    }\n\n    return page;\n  } // #endregion\n  // #region WDV Exposed Methods\n\n\n  _self.deselectAll = __deselectAll;\n  _self.deselectPage = __deselectAllPage;\n  _self.getAnnotations = __getAnnotations;\n  _self.getSelected = __getSelected;\n  _self.selectAll = __selectAll;\n  _self.selectPage = __selectAllPage;\n\n  function __selectAllPage(fIndex) {\n    __selectPage(true, fIndex);\n  }\n\n  function __deselectAllPage(fIndex) {\n    __selectPage(false, fIndex);\n\n    var page = __resolvePage(fIndex);\n\n    if (page && page._grips) page._grips.repaint();\n  }\n\n  function __selectAll() {\n    for (var pi = 0; pi < _annos.length; pi++) {\n      __selectAllPage(pi);\n    }\n  }\n\n  function __deselectAll() {\n    for (var pi = 0; pi < _annos.length; pi++) {\n      __deselectAllPage(pi);\n    }\n  }\n\n  function __getSelected() {\n    return __getClonedAnnotations(_selected);\n  }\n  /**\r\n   * Gets an array of all annotation data objects.\r\n   * @returns array of arrays containing annotation data objects for each page of the document.\r\n   */\n\n\n  function __getAnnotations() {\n    return __getClonedAnnotations(_annos);\n  } // #endregion\n\n};\n\n/* harmony default export */ var annotations_AnnotationSelector = (AnnotationSelector_AnnotationSelector);\n// CONCATENATED MODULE: ./src/utils/LocalizationManager.ts\nfunction LocalizationManager_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2020 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\nvar LocalizationManager =\n/*#__PURE__*/\nfunction () {\n  function LocalizationManager() {}\n\n  /* {\r\n      annotations: {\r\n          // context menu items\r\n          menuDeleteButton: 'Delete',\r\n          menuPropertiesButton: 'Properties',\r\n            // properties dialog buttons\r\n          dialogButtonOk: 'OK',\r\n          dialogButtonReset: 'Reset',\r\n          dialogButtonCancel: 'Cancel',\r\n            // properties dialogs titles\r\n          rectangleDialogTitle: 'Rectangle Annotation Properties',\r\n          textDialogTitle: 'Text Annotation Properties',\r\n          ellipseDialogTitle: 'Ellipse Annotation Properties',\r\n          lineDialogTitle: 'Line Annotation Properties',\r\n          linesDialogTitle: 'Lines Annotation Properties',\r\n          freehandDialogTitle: 'Freehand Annotation Properties',\r\n          polygonDialogTitle: 'Polygon Annotation Properties',\r\n            // properties dialogs labels\r\n          labelFillColor: 'Fill Color:',\r\n          labelFillOpacity: 'Fill Opacity:',\r\n          labelRotation: 'Rotation:',\r\n          labelOutlineColor: 'Outline Color:',\r\n          labelOutlineOpacity: 'Outline Opacity:',\r\n          labelOutlineWidth: 'Outline Width:',\r\n            labelOutlineStartcapWidth: 'Outline Startcap Width:',\r\n          labelOutlineStartcapHeight: 'Outline Startcap Height:',\r\n          labelOutlineStartcapStyle: 'Outline Startcap Style:',\r\n          labelOutlineEndcapWidth: 'Outline Endcap Width:',\r\n          labelOutlineEndcapHeight: 'Outline Endcap Height:',\r\n          labelOutlineEndcapStyle: 'Outline Endcap Style:',\r\n            labelFontBold: 'Font Bold:',\r\n          labelFontItalic: 'Font Italic:',\r\n          labelFontColor: 'Font Color:',\r\n          labelFontFamily: 'Font Family:',\r\n          labelFontSize: 'Font Size:',\r\n            // true/false radio buttons\r\n          radioButtonTrue: 'True',\r\n          radioButtonFalse: 'False',\r\n            // Startcap/Endcap style values\r\n          valueStyleNone: 'None',\r\n          valueStyleOpen: 'Arrow',\r\n          valueStyleBlock: 'Filled Arrow',\r\n          valueStyleOval: 'Filled Ellipse',\r\n          valueStyleDiamond: 'Filled Diamond',\r\n            // Startcap/Endcap width values\r\n          valueWidthMedium: 'medium',\r\n          valueWidthWide: 'wide',\r\n          valueWidthNarrow: 'narrow',\r\n            // Startcap/Endcap height values\r\n          valueHeightMedium: 'medium',\r\n          valueHeightLong: 'long',\r\n          valueHeightShort: 'short'\r\n      }\r\n  };*/\n  LocalizationManager.SetLocalizationStrings = function SetLocalizationStrings(strings) {\n    this._strings = strings;\n  };\n\n  LocalizationManager.LocalizationAvailable = function LocalizationAvailable() {\n    return !(this._strings === undefined || this._strings.annotations === undefined);\n  };\n\n  LocalizationManager.GetAnnotationLocalizedString = function GetAnnotationLocalizedString(key) {\n    if (this._strings.annotations === undefined || this._strings.annotations[key] === undefined) {\n      if (this._englishStrings.annotations[key] === undefined) console.error('Missed english string for %s', key);\n      return this._englishStrings.annotations[key];\n    }\n\n    return this._strings.annotations[key];\n  };\n\n  return LocalizationManager;\n}();\n\nLocalizationManager_defineProperty(LocalizationManager, \"_strings\", {});\n\nLocalizationManager_defineProperty(LocalizationManager, \"_englishStrings\", LocalizationStrings);\n\n\n// CONCATENATED MODULE: ./src/annotations/AnnotationPropertyDialog.js\n\n\n\n\n\n\n\n\n\nfunction AnnotationPropertyDialog_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2019 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n\n\nfunction AnnotationPropertyDialog(parent) {\n  var self = this;\n  var divHostElement = atalaJquery('<div />');\n  var contentElement = atalaJquery('<div />');\n  var annotation = null;\n  var properties = null;\n  var capProperties = {\n    style: ['None:none', 'Arrow:open', 'Filled Arrow:block', 'Filled Ellipse:oval', 'Filled Diamond:diamond'],\n    width: ['medium', 'wide', 'narrow'],\n    height: ['medium', 'long', 'short']\n  };\n  var showProperties = {\n    fill: {\n      color: true,\n      opacity: true\n    },\n    rotation: true,\n    outline: {\n      color: true,\n      opacity: true,\n      width: true,\n      startcap: capProperties,\n      endcap: capProperties\n    },\n    text: {\n      font: {\n        bold: true,\n        italic: true,\n        //\t\t\t\t\tstrike: true,\n        //\t\t\t\t\tunderline: true,\n        color: true,\n        family: true,\n        size: true\n      }\n    }\n  };\n\n  function initialize() {\n    contentElement.appendTo(divHostElement);\n    var dialogButtons = {};\n    dialogButtons[LocalizationManager.GetAnnotationLocalizedString('dialogButtonOk')] = okhide;\n    dialogButtons[LocalizationManager.GetAnnotationLocalizedString('dialogButtonReset')] = reset;\n    dialogButtons[LocalizationManager.GetAnnotationLocalizedString('dialogButtonCancel')] = cancel;\n    divHostElement.dialog({\n      appendTo: parent,\n      minWidth: 320,\n      classes: {\n        'ui-dialog': 'atala-ui-dialog'\n      },\n      resizable: true,\n      autoOpen: false,\n      buttons: dialogButtons,\n      closeText: hide,\n      open: function open()\n      /*event, ui*/\n      {\n        var _this = this;\n\n        function updateControlsHeight(elements) {\n          var maxHeight = 0;\n\n          for (var idx = 0; idx < elements.length; idx++) {\n            var btnHeight = atalaJquery(elements[idx]).height();\n            if (btnHeight > maxHeight) maxHeight = btnHeight;\n          }\n\n          for (var _idx = 0; _idx < elements.length; _idx++) {\n            atalaJquery(elements[_idx]).height(maxHeight);\n          }\n        }\n\n        var buttons = divHostElement.parent().find('.ui-dialog-buttonset button');\n        updateControlsHeight(buttons);\n        divHostElement.dialog({\n          width: __defineDialogWidth(),\n          height: 'auto'\n        }); //hack fo losing focus after the dialog open\n\n        setTimeout(function () {\n          AnnotationPropertyDialog_newArrowCheck(this, _this);\n\n          divHostElement.find('input')[0].focus();\n        }.bind(this), 100);\n      },\n      beforeClose: function beforeClose(event) {\n        if (event.keyCode === atalaJquery.ui.keyCode.ESCAPE || event.hasOwnProperty('currentTarget') && event.currentTarget.classList.contains('ui-dialog-titlebar-close')) {\n          if (Browser.Explorer) {\n            divHostElement.parent().find('.ui-dialog-buttonset button')[1].focus();\n          }\n\n          reset();\n        }\n      }\n    }); //Close dialog by Enter keypress\n\n    divHostElement.keypress(function (event) {\n      if (event.keyCode === atalaJquery.ui.keyCode.ENTER) {\n        event.preventDefault(); //move focus to save entered data\n\n        divHostElement.parent().find('.ui-dialog-buttonset button')[0].focus();\n        okhide();\n      }\n    });\n  }\n\n  function __getTitleWidth() {\n    var titleText = divHostElement.parent().find('.ui-dialog-title').text() + 'AAAAAAAAA'; //To compensate padding which depends on font size\n\n    var calc = '<span class=\"atala_title_span\">' + titleText + '</span>';\n    atalaJquery('body').append(calc);\n    var width = atalaJquery('body').find('span:last').width();\n    atalaJquery('body').find('span:last').remove();\n    return width + 25; //Add width of closing button\n  }\n\n  function __getButtonSetWidth() {\n    var buttons = divHostElement.parent().find('.ui-dialog-buttonset button');\n    var btnSetWidth = 0;\n\n    for (var idx = 0; idx < buttons.length; idx++) {\n      btnSetWidth += atalaJquery(buttons[idx]).outerWidth(true);\n    }\n\n    var addition = 1.5 * parseInt(atalaJquery(buttons[0]).css('font-size'));\n    return btnSetWidth + addition;\n  }\n\n  function __defineDialogWidth() {\n    var minWidth = 320;\n    return Math.max(minWidth, __getTitleWidth(), __getButtonSetWidth());\n  }\n\n  self.show = show;\n\n  function show(ann) {\n    annotation = ann; // empty content and properties\n\n    contentElement.empty();\n    properties = {}; // deep copy shown properties from data object to allow cancel\n\n    for (var propName in showProperties) {\n      if (showProperties.hasOwnProperty(propName)) {\n        var prop = {};\n        prop[propName] = annotation.get(propName);\n        atalaJquery.extend(true, properties, prop);\n      }\n    } // populate property grid\n\n\n    walkData(annotation.get(), '', showProperties);\n    divHostElement.dialog('open');\n  }\n\n  self.hide = hide;\n\n  function hide() {\n    divHostElement.dialog('close');\n  }\n\n  self.isVisible = isVisible;\n\n  function isVisible() {\n    return divHostElement.dialog('isOpen');\n  }\n\n  self.cancel = cancel;\n\n  function cancel() {\n    reset();\n    hide();\n  }\n\n  self.reset = reset;\n\n  function reset() {\n    annotation.set(properties, true);\n    annotation.updateView();\n    annotation.repaint();\n    contentElement.empty();\n    walkData(annotation.get(), '', showProperties);\n    resetGrips();\n  }\n\n  self.okhide = okhide;\n\n  function okhide() {\n    if (annotation && propChanged()) {\n      annotation.notifyChanges(properties);\n    }\n\n    hide();\n  }\n\n  function walkData(data, pfx, shown) {\n    // need to nest this function so it has a closure reference to the data for this anno\n    function editorChanged(e) {\n      var dataField = this.getAttribute('dataField');\n\n      if (this.value && typeof this.value !== 'boolean') {\n        if (typeof data[dataField] === 'number') {\n          var propertyValue = parseFloat(this.value);\n\n          if (!isNaN(propertyValue) && dataField === 'rotation' && propertyValue !== data[dataField]) {\n            // set with data setter so corresponding recalculations will be triggered\n            annotation.set({\n              rotation: propertyValue\n            });\n            annotation.repaint();\n          } else if (dataField === 'opacity' && propertyValue >= 0 && propertyValue <= 1 || dataField !== 'opacity' && this.value >= 0) {\n            data[dataField] = propertyValue;\n          } else {\n            this.value = data[dataField];\n          }\n        } else {\n          data[dataField] = this.value;\n        }\n      } else if (e && typeof this.value === 'boolean') {\n        data[dataField] = e.target.id.indexOf('true') >= 0;\n      } else {\n        // no input, set it back\n        this.value = data[dataField];\n      }\n\n      annotation.updateView();\n      annotation.repaint();\n      resetGrips();\n    } // recursively walk through all properties contained in the data object\n\n\n    for (var i in data) {\n      if (data.hasOwnProperty(i)) {\n        if (typeof data[i] === 'object') {\n          var key = i !== 'text' ? capitalize(i) : '';\n\n          if (shown[i] && (i !== 'text' || i === 'text' && annotation.get('type') === 'text')) {\n            walkData(data[i], pfx + key, shown[i]);\n          }\n        } else {\n          if (i === 'type') {\n            var dialogTitle = LocalizationManager.GetAnnotationLocalizedString(data[i].replace('fillrect', 'rectangle') + 'DialogTitle');\n            divHostElement.dialog('option', 'title', dialogTitle);\n          } else if (shown[i]) {\n            var prop = atalaJquery('<div/>');\n            var input = propertyEditor(i, data[i], editorChanged, shown[i]);\n            input.attr('dataField', i);\n            input.title = '';\n            prop.addClass('ui-helper-clearfix atala-ui-dialog-clearfix');\n            prop.css({\n              overflow: 'hidden'\n            });\n            input.appendTo(prop);\n            var labelStr = LocalizationManager.GetAnnotationLocalizedString('label' + (pfx ? pfx : pfx) + capitalize(i));\n            prop.append(createLabel(labelStr));\n            prop.appendTo(contentElement);\n          }\n        }\n      }\n    }\n  }\n\n  function byteToHex(num) {\n    // Turns a number (0-255) into a 2-character hex number (00-ff)\n    return ('0' + num.toString(16)).slice(-2);\n  }\n\n  function ColorToHex(color) {\n    if (!LocalizationManager.LocalizationAvailable()) return color;\n    var cvs = document.createElement('canvas');\n    cvs.height = 1;\n    cvs.width = 1;\n    var ctx = cvs.getContext('2d');\n    ctx.fillStyle = color;\n    ctx.fillRect(0, 0, 1, 1);\n    var rgba = ctx.getImageData(0, 0, 1, 1).data;\n    var hex = [0, 1, 2].map(function (idx) {\n      return byteToHex(rgba[idx]);\n    }).join('');\n    return '#' + hex;\n  }\n\n  function propertyEditor(name, val, fnc, shown) {\n    var valType = typeof val;\n    var editor = null;\n\n    if (atalaJquery.isArray(shown)) {\n      // options available, make drop down\n      editor = atalaJquery('<select/>').attr({});\n      atalaJquery.each(shown, function (key, value) {\n        var val = value;\n        var txt = value;\n        var options = value.split(':');\n\n        if (options.length > 1) {\n          txt = options[0];\n          val = options[1];\n        }\n\n        txt = LocalizationManager.GetAnnotationLocalizedString('value' + capitalize(name) + capitalize(val));\n        editor.append(atalaJquery('<option/>', {\n          // this is intentional, shown is an array, so key is just a number\n          value: val,\n          text: txt\n        }));\n      });\n      editor.change(fnc);\n      editor.val(val);\n    } else if (valType === 'string' || valType === 'number') {\n      editor = atalaJquery('<input/>').attr({\n        'type': 'text'\n      });\n      var inputValue = val;\n      if (name === 'color') inputValue = ColorToHex(val);\n      editor.val(inputValue);\n      editor.change(fnc);\n      editor.focus(function () {\n        this.select();\n        this._focused = true;\n      });\n      editor.mouseup(function (e) {\n        if (this._focused) {\n          e.preventDefault();\n          this._focused = false;\n        }\n      });\n    } else if (valType === 'boolean') {\n      var setName = 'bool' + name;\n      editor = atalaJquery('<form/>').attr({\n        'id': setName,\n        'datafield': name\n      });\n      createRadio(editor, setName + true, setName, LocalizationManager.GetAnnotationLocalizedString('radioButtonTrue'), val);\n      createRadio(editor, setName + false, setName, LocalizationManager.GetAnnotationLocalizedString('radioButtonFalse'), !val);\n      editor.controlgroup();\n      editor.change(fnc);\n      editor[0].value = val;\n      editor.find('.ui-state-hover').each(function (index, item) {\n        atalaJquery(item).removeClass('ui-state-hover');\n      });\n    } else {\n      editor = atalaJquery('<div>' + val + '</div>');\n    }\n\n    editor.css({\n      'float': 'right'\n    });\n    return editor;\n  }\n\n  function createRadio(parent, id, name, text, val) {\n    parent.append(atalaJquery('<input/>').attr({\n      'type': 'radio',\n      'id': id,\n      'name': name,\n      'checked': val\n    }));\n    parent.append(atalaJquery('<label/>').attr({\n      'for': id\n    }).text(text).height('1.5em'));\n  }\n\n  function createLabel(text) {\n    return atalaJquery('<span/>').text(text);\n  }\n\n  function capitalize(s) {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  }\n\n  function resetGrips() {\n    var aobj = annotation.getObject();\n\n    if (aobj && aobj.paper && aobj.paper._page) {\n      aobj.paper._page._grips.repaint();\n    }\n  }\n\n  function propChanged() {\n    var actualprops = {}; // deep copy shown properties from data object to allow cancel\n\n    for (var propName in showProperties) {\n      if (showProperties.hasOwnProperty(propName)) {\n        var prop = {};\n        prop[propName] = annotation.get(propName);\n        atalaJquery.extend(true, actualprops, prop);\n      }\n    }\n\n    return JSON.stringify(actualprops) !== JSON.stringify(properties);\n  }\n\n  initialize();\n  return self;\n}\n\n/* harmony default export */ var annotations_AnnotationPropertyDialog = (AnnotationPropertyDialog);\n// CONCATENATED MODULE: ./src/annotations/AnnotationGrips.js\n\n//\n//  Annotation Grips class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t09-20-12\tD. Cilley\t\tFile Created, moved over relevant grips related notes:\n//\t04-11-12\tD. Cilley\t\tFB 12978: Fixed a bug that would zoom grips as well as annotations\n//\t04-17-12\tD. Cilley\t\tFB 12978: Fixed bugs introduced by original fix\n//\t04-17-12\tD. Cilley\t\tFB 13173: Fixed a bug that would show grips on the wrong page\n//\t04-18-12\tD. Cilley\t\tFB 13174: Fixed a bug that would not allow deselecting annotations\n//\t04-19-12\tD. Cilley\t\tFB 13175: Fixed a bug that would throw js errors when selected annotation were recycled\n//\t09-20-12\tD. Cilley\t\tFB 13589: Moved grips to separate file.\n//\t11-15-12\tJ. Burch\t\tFB 13772: Fixed a visual bug that made an unmovable annotation appeared to also not be selectable.\n//\t11-19-12\tJ. Burch\t\tFB 13791: Fixed a visual bug with grips after annotation was programmatically resized.\n//\t03-21-13\tJ. Burch\t\tFB 14047: Fixed a bug where annotation's 'selected' property was not being updated\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t04-04-13\tD. Cilley\t\tFB 13993, 13996, 13997: Added AnnotationSelector for document level selecting.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t07-10-15\tD. Cilley\t\tBug 607560: Fixed an offset bug related to pageborderwidth fix.\n//-------------------------------------------------------------------------------------------------\n\n\n // creates a pseudo group object with grips for selecting and manipulating annotations\n// pg: jQuery dom object, reusable div container that represents the page\n\nvar AnnotationGrips_Grips = function Grips(pg, cdata) {\n  var GripSide = 8;\n  var RotationGripOffset = 25;\n  var GripCursorSectorOffset = -360 / 16; // grips axis shift angle - describes when grip cursor style changes\n\n  var _Gd = {\n    e: 0,\n    ne: 315,\n    n: 270,\n    nw: 225,\n    w: 180,\n    sw: 135,\n    s: 90,\n    se: 45\n  }; // grip direction\n\n  var _GLoc = {}; //{ e: [1, 0], ne: [0.5, 0.5], n: [0, 1], nw: [-0.5, 0.5], w: [-1, 0], sw: [-0.5, -0.5], s: [0, -1], se: [0.5, -0.5] };\t// grip pos on unit circle\n\n  var _GSectors = {}; // grip sectors that maps to cursor style\n\n  var _Cdata = cdata;\n\n  var _Ggrips = pg._paper.set(); // grips group\n\n\n  var _Gselected = pg._paper.set(); // raphael object selection group\n\n\n  var _Gannos = []; // annotation selection group\n\n  var _GRotateGrip = null;\n  var _Gop = {}; // grips origin point\n\n  var _GhR,\n      _GvR = null; // resize axes\n\n\n  var _Grect = {\n    // grip bounding rect\n    x: 0,\n    y: 0,\n    width: 1,\n    height: 1,\n    x2: 1,\n    y2: 1\n  }; //to save annotation states before changing\n\n  var _initAnnos = [];\n  var _annoBeforeRotation = {};\n  var _Gevts = {\n    dragstart: function dragstart() {// fires when raphael object detects dragging has started\n    },\n    dragmove: function dragmove() {\n      _Ggrips.hide();\n    },\n    moved: function moved() {\n      // fires after annotation handles dragend\n      __Gupdate();\n\n      _Ggrips.show();\n\n      for (var i = 0; i < _Gannos.length; ++i) {\n        var data = _Gannos[i].get();\n\n        if (data.hasOwnProperty('rotatable') && !data.rotatable || data.hasOwnProperty('readonly') && !data.readonly) {\n          _GRotateGrip.hide();\n        }\n      }\n    }\n  };\n\n  __GInit();\n\n  function __GInit() {\n    var m; // create a grip for each direction, and add it to the grips group\n\n    for (var k in _Gd) {\n      if (_Gd.hasOwnProperty(k)) {\n        var obj = pg._paper.rect(0, 0, GripSide, GripSide);\n\n        var grip = __Ggrip(obj, k);\n\n        _Ggrips.push(grip);\n\n        _Ggrips[_Gd[k]] = grip;\n        m = atalaRaphael.matrix();\n        m.rotate(_Gd[k]); // fill the locations of the grips on unit circle\n\n        _GLoc[k] = {\n          x: m.x(1, 0),\n          y: m.y(1, 0)\n        };\n      }\n    }\n\n    _GRotateGrip = __GCreateRotateGrip();\n\n    __GinitCursorSectors();\n  }\n\n  function __Ggrip(g, dir) {\n    g.attr({\n      fill: '#FFFFE1',\n      cursor: (dir || 'ne') + '-resize'\n    });\n    g.grip = true;\n    g.rect = g.getBBox();\n    g.hide(); // center the grip on the given point\n\n    g.center = function (px, py, scale, transform) {\n      scale = scale || 1;\n      var w = GripSide / scale;\n      var h = GripSide / scale;\n      var r = w / 2; // need to compensate grid scaling before transforming all grips to annotation box.\n\n      var xcrisp = Math.round(w / 2) + 0.5;\n      var ycrisp = Math.round(h / 2) + 0.5;\n\n      if (Browser.Explorer) {\n        // for some reason, IE9+ renders horizontal lines crisp already, but not vertical\n        ycrisp -= 0.5;\n      }\n\n      var x = Math.round(px) - xcrisp;\n      var y = Math.round(py) - ycrisp; // subtract half a point and half a grip to center and make the edges crisp\n\n      if (!this.ellipse) {\n        this.attr({\n          x: x,\n          y: y,\n          width: w,\n          height: h,\n          'stroke-width': 1\n        });\n      } else {\n        x += r;\n        this.attr({\n          cx: x,\n          cy: y,\n          r: r,\n          'stroke-width': 1\n        });\n      } // raphael ignores stroke setting when transform scale is 1. so previous attr value will remain. resetting it forcibly.\n\n\n      this.node.setAttribute('stroke-width', 1);\n      this.transform(transform);\n    }; // if this isn't a directional grip, we don't need to interact with it\n\n\n    if (dir) {\n      g.d = {\n        key: dir,\n\n        /* eslint-disable no-bitwise */\n        n: ~dir.indexOf('n'),\n        s: ~dir.indexOf('s'),\n        w: ~dir.indexOf('w'),\n        e: ~dir.indexOf('e')\n        /* eslint-enable no-bitwise */\n\n      };\n      g.mousedown(function (e) {\n        return __GstartBox(e, this.d);\n      });\n    }\n\n    return g;\n  }\n\n  function __GCreateRotateGrip() {\n    var obj = pg._paper.circle(0, 0, GripSide / 2);\n\n    var g = __Ggrip(obj).attr({\n      fill: '#00FF40',\n      cursor: 'pointer'\n    });\n\n    g.ellipse = true;\n\n    _Ggrips.push(g);\n\n    g.mousedown(function (e) {\n      return __GStartRotate(e, g);\n    });\n    return g;\n  } // takes an Annotation object\n\n\n  this.push = function (o) {\n    if (!__contains(o)) {\n      _Gannos.push(o);\n\n      _Gselected.push(o.getObject());\n\n      if (o.get('selectable') === true) {\n        __Gbind(o);\n      }\n\n      __Gupdate();\n\n      _Ggrips.toFront();\n\n      _Ggrips.show();\n    }\n  };\n\n  this.contains = __contains;\n\n  function __contains(o) {\n    return atalaJquery.inArray(o, _Gannos) !== -1;\n  } // takes an Annotation object\n\n\n  this.remove = function (o) {\n    for (var i = 0; i < _Gannos.length; i++) {\n      if (_Gannos[i] === o) {\n        _Gannos.splice(i, 1);\n      }\n    }\n\n    _Gselected.exclude(o.getObject());\n\n    __Gunbind(o);\n  }; // clear should only be used to switch pages, it doesn't deselect annos\n\n\n  this.clear = __Gclear;\n\n  function __Gclear() {\n    for (var i = 0; i < _Gannos.length; i++) {\n      __Gunbind(_Gannos[i]);\n    }\n\n    _Gannos.length = 0;\n\n    _Gselected.clear();\n\n    _Ggrips.hide();\n  }\n\n  function __Gbind(o) {\n    o.getEventObject().bind(_Gevts);\n  }\n\n  function __Gunbind(o) {\n    o.getEventObject().unbind(_Gevts);\n  }\n\n  this.repaint = __Gupdate;\n\n  function __Gupdate() {\n    if (_Gselected.length > 0) {\n      __GupdateBounds();\n    } else {\n      if (_Gannos.length > 0) {\n        __Gclear();\n      } else {\n        _Ggrips.hide();\n      }\n    }\n  }\n\n  this.updateCursor = __GUpdateCursor;\n\n  function __GUpdateCursor(angle) {\n    for (var gd in _Gd) {\n      if (_Gd.hasOwnProperty(gd)) {\n        __GsetCursor(_Ggrips[_Gd[gd]], angle);\n      }\n    }\n  } // gets the bounding rectangle from the selected raphael objects\n\n\n  function __GupdateBounds() {\n    if (_Gselected.length > 0) {\n      // if we have a single el selected - let's put transformed grips.\n      var r = _Gselected.length === 1 ? _Gannos[0].getBox() : _Gselected.getBBox(); // set doesn't support second overload(i.e. overload for original box).\n\n      _Grect.x = r.x;\n      _Grect.y = r.y;\n      _Grect.width = r.width;\n      _Grect.height = r.height;\n      _Grect.x2 = r.x + r.width;\n      _Grect.y2 = r.y + r.height;\n      _Grect.xmid = r.x + r.width / 2;\n      _Grect.ymid = r.y + r.height / 2; // set grip positions\n\n      __GplaceGrips();\n    }\n  } // This gets called to redraw the grips to the new size\n\n\n  function __GsetRect(x, y, w, h) {\n    // vertical resize?\n    if (_GvR === 0) {\n      _Grect.x = x;\n      _Grect.width = Math.max(w, 1); // sizes below 1 are bad\n\n      _Grect.x2 = x + _Grect.width;\n      _Grect.xmid = x + _Grect.width / 2;\n    } // horizontal resize?\n\n\n    if (_GhR === 0) {\n      _Grect.y = y;\n      _Grect.height = Math.max(h, 1); // sizes below 1 are bad\n\n      _Grect.y2 = y + _Grect.height;\n      _Grect.ymid = y + _Grect.height / 2;\n    } // set grip positions\n\n\n    __GplaceGrips();\n  } // This gets called to fit the object to the grips\n\n\n  function __GfitAnnos() {\n    for (var i = 0; i < _Gannos.length; i++) {\n      _Gannos[i].transform(_Grect.x, _Grect.y, _Grect.width, _Grect.height);\n    }\n  } // places the grips along the bounding rect\n\n\n  function __GplaceGrips() {\n    var isSingleAnno = _Gselected.length === 1;\n    var m = atalaRaphael.matrix();\n    var scale = 1;\n    var transform = '';\n\n    var viewerTransform = _Cdata.getViewerTransform(pg._index);\n\n    m.add(viewerTransform.a, viewerTransform.b, viewerTransform.c, viewerTransform.d, viewerTransform.e, viewerTransform.f);\n\n    if (isSingleAnno) {\n      var annoTransform = _Gannos[0].getTransform();\n\n      if (annoTransform) m.add(annoTransform.a, annoTransform.b, annoTransform.c, annoTransform.d, annoTransform.e, annoTransform.f);\n      scale = _Cdata.getZoom(pg._index);\n      transform = m.toTransformString(true);\n    }\n\n    _Ggrips[_Gd.nw].center(_Grect.x, _Grect.y, scale, transform); // nw\n\n\n    _Ggrips[_Gd.ne].center(_Grect.x2, _Grect.y, scale, transform); // ne\n\n\n    _Ggrips[_Gd.sw].center(_Grect.x, _Grect.y2, scale, transform); // sw\n\n\n    _Ggrips[_Gd.se].center(_Grect.x2, _Grect.y2, scale, transform); // se\n\n\n    _Ggrips[_Gd.n].center(_Grect.xmid, _Grect.y, scale, transform); // n\n\n\n    _Ggrips[_Gd.w].center(_Grect.x, _Grect.ymid, scale, transform); // w \n\n\n    _Ggrips[_Gd.e].center(_Grect.x2, _Grect.ymid, scale, transform); // e\n\n\n    _Ggrips[_Gd.s].center(_Grect.xmid, _Grect.y2, scale, transform); // s\n\n\n    var data = _Gannos[0].get();\n\n    if (!data.hasOwnProperty('rotatable') || data.rotatable && (!data.hasOwnProperty('readonly') || !data.readonly)) {\n      _GRotateGrip.show();\n\n      _GRotateGrip.center(_Grect.xmid, _Grect.y - RotationGripOffset / scale, scale, transform);\n    } else {\n      _GRotateGrip.hide();\n    }\n\n    var annRotation = _Gannos.length === 1 ? _Gannos[0].get().rotation : 0;\n\n    __GUpdateCursor(annRotation + _Cdata.getPageRotation(pg._index));\n  }\n\n  function __GgetMousePos(e) {\n    var po = pg.offset();\n    var so = getSVGOffset(pg._paper.canvas, pg);\n    var p = {\n      x: e.pageX - (po.left + so.left),\n      y: e.pageY - (po.top + so.top)\n    };\n    return p;\n  }\n\n  function __GStartRotate(e) {\n    e.stopPropagation(); // multi-resize not allowed yet\n\n    if (_Gannos.length !== 1 || _Gselected.length !== 1) {\n      return;\n    }\n\n    for (var i = 0; i < _Gannos.length; i++) {\n      var ann = _Gannos[i].get();\n\n      if (ann.hasOwnProperty('readonly') && ann.readonly || ann.hasOwnProperty('rotatable') && !ann.rotatable) {\n        return;\n      }\n    }\n\n    atalaJquery.extend(_Gop, _Grect);\n\n    var m = _Gannos[0].getTransform();\n\n    var xmid = m.x(_Gop.xmid, _Gop.ymid);\n    _Gop.ymid = m.y(_Gop.xmid, _Gop.ymid);\n    _Gop.xmid = xmid;\n    _annoBeforeRotation = atalaJquery.extend(true, {}, _Gannos[0].getClonedData());\n    delete _annoBeforeRotation.update;\n    delete _annoBeforeRotation.getPageIndex;\n    atalaJquery(pg._paper.canvas).on({\n      mouseup: __GEndRotate,\n      mousemove: __GRotateBox\n    });\n  }\n\n  function __GRotateBox(e) {\n    e.stopPropagation();\n\n    var p = __GpointToDocSpace(__GgetMousePos(e)); // inverted counter-clockwise rotation angle, that is angle of mouse to annotation center - 90(which is grip initial angle).\n    // i.e. long formula is 360 - (Math.atan2(-(p.y - _Gop.ymid), p.x - _Gop.xmid) * 180 / Math.PI - 90)\n\n\n    var angle = Math.atan2(p.y - _Gop.ymid, p.x - _Gop.xmid) * 180 / Math.PI + 90;\n\n    if (_Gannos.length === 1) {\n      _Gannos[0].set({\n        rotation: angle\n      });\n\n      _Gannos[0].repaint();\n    }\n\n    pg._grips.repaint();\n\n    return false;\n  }\n\n  function __GEndRotate(e) {\n    e.stopPropagation();\n    atalaJquery(pg._paper.canvas).off({\n      mouseup: __GEndRotate,\n      mousemove: __GRotateBox\n    });\n\n    if (_Gannos.length === 1) {\n      _Gannos[0].getEventObject().trigger('rotated'); //trigger annotationchanged event\n\n\n      _Gannos[0].getEventObject().trigger({\n        type: 'annotationchanged',\n        ann: _Gannos[0],\n        annobefore: _annoBeforeRotation\n      });\n    }\n\n    return false;\n  } // caclulates offsets based on the grip clicked\n\n\n  function __GstartBox(e, d) {\n    e.stopPropagation(); // multi-resize not allowed yet\n\n    if (_Gannos.length > 1) {\n      return;\n    }\n\n    for (var i = 0; i < _Gannos.length; i++) {\n      if (!_Gannos[i].get('resizable')) {\n        _initAnnos = [];\n        return;\n      } else {\n        //save annotation state\n        _initAnnos[i] = atalaJquery.extend(true, {}, _Gannos[i].getClonedData());\n        delete _initAnnos[i].update;\n        delete _initAnnos[i].getPageIndex;\n      }\n    }\n\n    atalaJquery.extend(_Gop, _Grect);\n    _GvR = _Gd[d.key] === _Gd.n || _Gd[d.key] === _Gd.s ? 1 : 0;\n    _GhR = _Gd[d.key] === _Gd.w || _Gd[d.key] === _Gd.e ? 1 : 0;\n\n    if (d.n || _GhR === 1) {\n      _Gop.y = _Gop.y2;\n    }\n\n    if (d.w) {\n      _Gop.x = _Gop.x2;\n    }\n\n    atalaJquery(pg._paper.canvas).on({\n      mouseup: __GendBox,\n      mousemove: __GsizeBox\n    });\n    return false;\n  } // method for sizing bounding box\n\n\n  function __GsizeBox(e) {\n    e.stopPropagation();\n\n    if (_Gselected.length === 1) {\n      // now only single anno resize supported. if want multiple - \n      // we just need to store grips transform, since raphael set doesn't store it\n      var p = __GpointToAnnoSpace(__GgetMousePos(e));\n\n      var nw = Math.abs(p.x - _Gop.x);\n      var nh = Math.abs(p.y - _Gop.y);\n      var nx = p.x < _Gop.x ? _Gop.x - nw : _Gop.x;\n      var ny = p.y < _Gop.y ? _Gop.y - nh : _Gop.y;\n\n      __GsetRect(nx, ny, nw, nh);\n\n      __GfitAnnos();\n    }\n\n    return false;\n  }\n\n  function __GendBox(e) {\n    e.stopPropagation();\n\n    for (var i = 0; i < _Gannos.length; i++) {\n      _Gannos[i].getEventObject().trigger('resized');\n\n      _Gannos[i].getEventObject().trigger('annoresized');\n\n      _Gannos[i].getEventObject().trigger({\n        type: 'annotationchanged',\n        ann: _Gannos[i],\n        annobefore: _initAnnos[i]\n      });\n\n      _Gannos[i].repaint();\n    }\n\n    if (_Gselected.length > 0) {\n      __GupdateBounds();\n    }\n\n    atalaJquery(pg._paper.canvas).off({\n      mouseup: __GendBox,\n      mousemove: __GsizeBox\n    });\n    return false;\n  }\n\n  function __GpointToAnnoSpace(p) {\n    if (_Gselected.length > 0) {\n      var obj = _Gselected[0].type === 'set' ? _Gselected[0][0] : _Gselected[0];\n      var srcMatrix = obj.matrix.invert();\n      var docPt = {\n        x: srcMatrix.x(p.x, p.y),\n        y: srcMatrix.y(p.x, p.y)\n      };\n      return docPt;\n    }\n\n    return p;\n  }\n\n  function __GpointToDocSpace(p) {\n    var matrix = _Cdata.getViewerTransform(pg._index).invert();\n\n    var newx = matrix.x(p.x, p.y);\n    p.y = matrix.y(p.x, p.y);\n    p.x = newx;\n    return p;\n  }\n\n  function __GsetCursor(grip, rotation) {\n    if (grip && grip.d && grip.d.key) {\n      var m = atalaRaphael.matrix();\n      m.rotate(rotation);\n      var pos = {\n        x: m.x(_GLoc[grip.d.key].x, _GLoc[grip.d.key].y),\n        y: m.y(_GLoc[grip.d.key].x, _GLoc[grip.d.key].y)\n      };\n\n      for (var s in _GSectors) {\n        if (_GSectors.hasOwnProperty(s)) {\n          if (__GisInsideSector(pos, _GSectors[s].start, _GSectors[s].end)) {\n            grip.attr({\n              cursor: (_GSectors[s].dir || 'ne') + '-resize'\n            });\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  function __GinitCursorSectors() {\n    var m = atalaRaphael.matrix();\n    m.rotate(GripCursorSectorOffset, 0, 0);\n\n    var makeGripSector = function makeGripSector(dirStart, dirEnd) {\n      // cursor changes at the middle of each of grip sectors(we have 8). \n      // so to find changing axes, we need to shift grips axes to 360/16.\n      var sector = {\n        dir: dirEnd,\n        start: {\n          x: m.x(_GLoc[dirStart].x, _GLoc[dirStart].y),\n          y: m.y(_GLoc[dirStart].x, _GLoc[dirStart].y)\n        },\n        end: {\n          x: m.x(_GLoc[dirEnd].x, _GLoc[dirEnd].y),\n          y: m.y(_GLoc[dirEnd].x, _GLoc[dirEnd].y)\n        }\n      };\n      return sector;\n    }; // manually set order of processing, because grips are connected here - first is the beginning of the sector and next is the end.\n\n\n    var gdirections = ['e', 'ne', 'n', 'nw', 'w', 'sw', 's', 'se'];\n\n    for (var i = 0; i < gdirections.length - 1; ++i) {\n      if (i === 0) {\n        _GSectors[gdirections[i]] = makeGripSector(gdirections[gdirections.length - 1], gdirections[i]);\n      }\n\n      _GSectors[gdirections[i + 1]] = makeGripSector(gdirections[i], gdirections[i + 1]);\n    }\n  }\n\n  function __GisInsideSector(point, sectorStart, sectorEnd) {\n    function areClockwise(v1, v2) {\n      return -v1.x * v2.y + v1.y * v2.x > 0;\n    }\n\n    return !areClockwise(sectorStart, point) && areClockwise(sectorEnd, point);\n  }\n};\n\n/* harmony default export */ var AnnotationGrips = (AnnotationGrips_Grips);\n// CONCATENATED MODULE: ./src/controller/AnnotationController.js\n\n\n\n\n\n\n\n\n\n\nfunction AnnotationController_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//\n//  Annotation Controller class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t02-09-12\tD. Cilley\t\tFile Created.\n//\t02-22-12\tD. Cilley\t\tFB 12934: Fixed Stamp and Image saving\n//\t02-23-12\tD. Cilley\t\tFB 12940: Fixed annotation show problem with loading from Url\n//\t03-01-12\tD. Cilley\t\tFB 12939: Fixed IE page translation after annotation create\n//\t03-01-12\tD. Cilley\t\tFB 12947, FB 12977, FB 12973, FB 12990: Only one annotation should be created at a time\n//\t03-02-12\tD. Cilley\t\tFB 12982: Fixed annotation creation in Firefox\n//\t03-03-12\tD. Cilley\t\tFB 12938: Fixed an exception when showing properties of path annots\n//\t03-03-12\tD. Cilley\t\tFB 13009, FB 13010: Fixed bugs while drawing over other objects\n//\t03-04-12\tD. Cilley\t\tFB 12496, FB 12991: still fixing (select multiple, right click delete, menus won't come back)\n//\t03-13-12\tD. Cilley\t\tFB 13073: Added __disposePaper to support deleting of pages in the parent control\n//\t04-11-12\tD. Cilley\t\tFB 12978: Fixed a bug that would zoom grips as well as annotations\n//\t04-17-12\tD. Cilley\t\tFB 12978: Fixed bugs introduced by original fix\n//\t04-17-12\tD. Cilley\t\tFB 13173: Fixed a bug that would show grips on the wrong page\n//\t04-18-12\tD. Cilley\t\tFB 13174: Fixed a bug that would not allow deselecting annotations\n//\t04-19-12\tD. Cilley\t\tFB 13175: Fixed a bug that would throw js errors when selected annotation were recycled\n//\t05-08-12\tD. Cilley\t\tFB 13067: Fixed stamp font saving, text anno round trip, and stamp editing\n//\t06-20-12\tD. Cilley\t\tFB 13301: Fixed a bug that would fill freehand and lines annots\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t09-20-12\tD. Cilley\t\tFB 13589: Moved grips to separate file.\n//\t10-18-12\tD. Cilley\t\tFB 13691: Disposed of context menu DOM elements when we're done with them.\n//\t10-19-12\tD. Cilley\t\tFB 13690: Returning getClonedData instead of annotation view\n//\t10-25-12\tD. Cilley\t\tFB 13715: Refactored internal vars, and added __getDebugInfo for testing.  \n//\t10-25-12\tD. Cilley\t\tFB 13714: Added Raphael version check.  \n//\t11-01-12\tJ. Burch\t\tFB 13732: Added deselectAll method.\n//\t11-05-12\tD. Cilley\t\tFB 13742, 13744: Fixed bugs in creating annotations.\n//\t11-07-12\tJ. Burch\t\tFB 13748, 13725: Refactored public events, made mobile ones public, added public deleteAnno method.\n//\t11-09-12\tD. Cilley\t\tFB 13757: Added callbacks and 'async' on several methods to help with firing events.\n//\t11-12-12\tD. Cilley\t\tFB 13763: Fixed a bug with loading annotation data from config options.\n//\t11-19-12\tJ. Burch\t\tFB 13768, 13767: Adding new annotation events, fixing menu close bug.\n//\t11-19-12\tJ. Burch\t\tFB 13791, 13792: Fixing a bug with properties menu, renamed public events\n//\t12-18-12\tD. Cilley\t\tFB 13874: Added HTML support to Raphael to help render text better.\n//\t02-06-13\tD. Cilley\t\tFB 13957: Added config option for script resource url.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t02-22-13\tD. Cilley\t\tFB 13988: Fixed an IE7 reflow height bug that would interrupt text anno drawing.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t04-04-13\tD. Cilley\t\tFB 13993, 13996, 13997: Added AnnotationSelector for document level selecting.\n//\t04-23-13\tJ. Burch\t\tFB 13096: Fixing some initialization errors where _menu and _props were never constructed.\n//\t04-30-13\tD. Cilley\t\tFB 14116: Fixed a bug that didn't position annotations correctly in IE7-8 while zooming.\n//\t05-07-13\tD. Cilley\t\tFB 14119: Fixed AnnotationController initialization if scripts were already loaded.\n//\t05-10-13\tD. Cilley\t\tFB 14145: Fixed IE7-8 image annotation scaling after zoom.\n//\t05-15-13\tD. Cilley\t\tFB 14150: Fixed IE10 specific reflow problem.\n//\t07-15-13\tD. Cilley\t\tFB 14215: Added beforehandlerrequest and handlerreturned events.\n//\t07-31-13\tD. Cilley\t\tFB 14245: Added arrowhead functionality.\n//\t08-30-13\tD. Cilley\t\tFB 14274: Added Thumbnailer functionality.\n//\t08-30-13\tD. Cilley\t\tFB 14275: Fixed multi-loading scripts when there's more than one WDV.\n//\t11-12-13\tD. Cilley\t\tFB 14186: Added ability to cancel or switch annotation drawing.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t02-03-15\tD. Cilley\t\tBug 321042: Fixed deleting of active annotation.\n//\t03-25-15\tD. Cilley\t\tBug 591740: Fixed hiding of the drawing surface if it was shown inside annotationcreated event.\n//\t06-18-15\tD. Cilley\t\tBug 607560: Fixed a bug that clipped annotations incorrectly when pageborderwidth was set.\n//\t07-02-15\tD. Cilley\t\tBug 625845: Added dispose method.\n//\t07-10-15\tD. Cilley\t\tBug 607560: Fixed an offset bug related to pageborderwidth fix.\n//\t09-01-15\tD. Cilley\t\tTask 630965: Added event bind tracking and intellisense.\n//\t09-15-15\tD. Cilley\t\tBug 627869: Added support for forcing all pages to be fit into the same size.\n//\t09-30-15\tD. Cilley\t\tBug 610232: Fixed __redrawVisiblePages so that it would stop unnecessarily redrawing annotation and form layers.\n//\t12-04-15\tD. Cilley\t\tBug 670919, 670924, 670938: Fixed several ZoomArea bugs.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\n\n\n\n\n // wdv: parent WebDocumentViewer object\n// internals: internal functions and objects from the WDV\n// readonly: annotations are only shown\n\n/**\r\n * WebDocumentViewer Annotations API.\r\n * @class\r\n * @inner\r\n * @name AnnotationController\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n */\n\nvar AnnotationController_AnnotationController = function AnnotationController(wdv, internals, readonly) {\n  var _self = this;\n\n  var _wdv = wdv;\n  var _wdvInternals = internals; // #region Intellisense\n\n  var _selector = new annotations_AnnotationSelector();\n\n  var _exposedEvents = {\n    /**\r\n     * @callback AnnotationCallback\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     */\n\n    /**\r\n     * Triggers when the user uses the mouse to click on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationclicked\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationclicked: null,\n\n    /**\r\n     * This event is triggered when annotation is created, whether through mouse/touch events or programmatically.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationcreated\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {number} page - event.Index of the page where annotation is created.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationcreated: null,\n\n    /**\r\n     * Triggers when the user uses the mouse to double-click on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdoubleclicked\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationdoubleclicked: null,\n\n    /**\r\n     *  Triggers when an annotation is loaded into the document. There are multiple ways how annotations could be loaded, for example passing the {@link WebDocumentViewerConfig.annotationsurl| annotationsurl} in the constructor, or by calling {@link Atalasoft.Controls.WebDocumentViewer#openUrl | viewer.openUrl}. In this case event will be fired for each loaded annotation from all layers.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationloaded\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     * @param {Object} event.customData - The event customer data from server.\r\n     */\n    annotationloaded: null,\n\n    /**\r\n     *  Triggers when all annotations are loaded into the document. There are multiple ways how annotations could be loaded, for example passing the {@link WebDocumentViewerConfig.annotationsurl| annotationsurl} in the constructor, or by calling {@link Atalasoft.Controls.WebDocumentViewer#openUrl | viewer.openUrl}. In this case event will be fired for each loaded annotation from all layers.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationsloaded\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {Object} event.customData - The event customer data from server.\r\n     */\n    annotationsloaded: null,\n\n    /** Triggers when the user has depressed a mouse button on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmousedown\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmousedown: null,\n\n    /** Triggers when the user has depressed the left mouse button on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmousedownleft\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmousedownleft: null,\n\n    /** Triggers when the user has depressed the right mouse button on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmousedownright\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmousedownright: null,\n\n    /** Triggers when the user moves the mouse pointer over an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmousemove\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmousemove: null,\n\n    /** Triggers when the user has moved the mouse pointer out of the bounds of the annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmouseout\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmouseout: null,\n\n    /** Triggers when the user has moved the mouse pointer into the bounds of the annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmouseover\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmouseover: null,\n\n    /** Triggers when the user has released a mouse button on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmouseup\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmouseup: null,\n\n    /** Triggers when an annotation has been moved.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationmoved\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationmoved: null,\n\n    /** Triggers when an annotation has been rotated.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationrotated\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationrotated: null,\n\n    /** Triggers when a pinch gesture has been detected on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationpinchresize\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationpinchresize: null,\n\n    /** Triggers when an annotation has been repainted.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationrepainted\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationrepainted: null,\n\n    /** Triggers when an annotation has been resized.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationresized\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationresized: null,\n\n    /** Triggers when the user right clicks on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationrightclicked\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationrightclicked: null,\n\n    /** Triggers when a touch end event has been finished on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationtouchend\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationtouchend: null,\n\n    /** Triggers when a touch move event is happening on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationtouchmove\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationtouchmove: null,\n\n    /** Triggers when a touch event has started on an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationtouchstart\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationtouchstart: null,\n\n    /** Triggers when user finishes text edit for Text annotation and Text annotation edit mode is switched off.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationtextchanged\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationtextchanged: null,\n\n    /** Triggers when an annotation has been changed.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationchanged\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.anno - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     * @param {AnnotationData} event.annobefore - Annotation object before the changes were applied.  \r\n     */\n    annotationchanged: null,\n\n    /** Triggers when a layer has been inserted into the document.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#layerinserted\r\n     * @param {Object} event - Event data object.\r\n     * @param {number} event.index - Index of the inserted layer.\r\n     */\n    layerinserted: null,\n\n    /** Triggers when a layer has moved from one index to another within the document.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#layermoved\r\n     * @param {Object} event - Event arguments.\r\n     * @param {number} event.srcindex - Index from which layer was moved.\r\n     * @param {number} event.destindex - Index of the moved layer.\r\n     */\n    layermoved: null,\n\n    /** Triggers when a layer has been removed from the document.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#layerremoved\r\n     * @param {Object} event - Event arguments.\r\n     * @param {number} event.index - Index from which layer was removed.\r\n     * @param {AnnotationData[]} event.layer - The removed layer data.\r\n     */\n    layerremoved: null,\n\n    /** Triggers when a layer has been changed. Fired by any type of layers structure: {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#insertLayer|insertLayer},  {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#moveLayer|moveLayer} or {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#removeLayer|removeLayer}.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#layerschanged\r\n     * @type {NotificationCallback}\r\n     */\n    layerschanged: null,\n\n    /** Triggers when all annotations have been deleted.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationscleared\r\n     */\n    annotationscleared: null,\n\n    /** Triggers when an annotation is deleted.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdeleted\r\n     * @param {Object} event - Event arguments.\r\n     * @param {number} event.page - Index of the page where annotation has been removed.\r\n     * @param {number} event.index - Index at which annotation has been removed.\r\n     */\n    annotationdeleted: null,\n\n    /** Triggers when a user has started drawing an annotation with the mouse or a touch event.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdrawstart\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.ann - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationdrawstart: null,\n\n    /** Triggers when a user has finished drawing an annotation with the mouse or a touch event.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdrawend\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {boolean} event.cancelled - Indicates whether annotation draw was cancelled.\r\n     * @param {AnnotationData} event.ann - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationdrawend: null,\n\n    /** Triggers when an annotation has started dragging.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdragstart\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.ann - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationdragstart: null,\n\n    /** Triggers when an annotation has finished dragging.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#annotationdragend\r\n     * @type {AnnotationCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} event.annotation - Annotation object related to the event.\r\n     * @param {AnnotationData} event.ann - Deprecated. Please use `annotation` property. This property will be removed soon.\r\n     */\n    annotationdragend: null,\n\n    /**\r\n     * @callback AnnotationHandler\r\n     * @param {AnnotationData} annotation - annotation data object on which action is performed.\r\n     */\n\n    /**\r\n     * @typedef {Object} AnnotationContextMenu\r\n     * @property {AnnotationHandler} [...menuItemTitle] - Menu item handlers. All own properties of the menu object will be translated to menu items.\r\n     */\n\n    /**\r\n     * Callback signature for {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#event:contextmenu | contextmenu} event.\r\n     * @callback AnnotationContextMenuCallback\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} annotation - The data of the annotation which context menu were activated.\r\n     * @param {AnnotationContextMenu} menu - The menu configuration. Keys of this object is treated as menu titles and values under those keys are handler functions.\r\n     * This object could be modified by application to extend or modify current menu instance.\r\n     */\n\n    /** Triggers when the context menu is shown for an annotation.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#contextmenu\r\n     * @type {AnnotationContextMenuCallback}\r\n     * @param {Object} event - Event data object.\r\n     * @param {AnnotationData} annotation - The data of the annotation which context menu were activated.\r\n     * @param {AnnotationContextMenu} menu - The menu configuration. Keys of this object is treated as menu titles and values under those keys are handler functions.\r\n     * This object could be modified by application to extend or modify current menu instance.\r\n     */\n    contextmenu: null,\n\n    /** Triggers when the Raphael dependency has finished loading.\r\n     * @event Atalasoft.Controls.WebDocumentViewer~AnnotationController#raphaelloaded\r\n     * @deprecated WDV doesn't try to load any dependencies by its own. You need to add all necessary scripts to page's head section manually.\r\n     */\n    raphaelloaded: null\n  };\n  var _exposedApi = {\n    /** @lends Atalasoft.Controls.WebDocumentViewer~AnnotationController */\n    annotations: {\n      events: _exposedEvents,\n\n      /**\r\n       * Gets an array of selected annotation data objects.\r\n       * @returns {AnnotationData[]} - Annotation data objects for selected annotations only.\r\n       * @instance\r\n       * @function\r\n       */\n      getSelected: _selector.getSelected,\n\n      /**\r\n       * Selects all annotations on every page.\r\n       * @instance\r\n       * @function\r\n       */\n      selectAll: _selector.selectAll,\n\n      /**\r\n       * Deselects all annotations on every page.\r\n       * @instance\r\n       * @function\r\n       */\n      deselectAll: _selector.deselectAll,\n\n      /**\r\n       * Selects all annotations on the given page.\r\n       * @param {number} index - The index of the page the annotations should be selected on.\r\n       * @instance\r\n       * @function\r\n       */\n      selectAllOnPage: _selector.selectPage,\n\n      /**\r\n       * Deselects all annotations on the given page.\r\n       * @param {number} index - The index of the page the annotations should be deselected on.\r\n       * @instance\r\n       * @function\r\n       */\n      deselectAllOnPage: _selector.deselectPage,\n\n      /**\r\n       * Cancels the drawing of an annotation and returns the viewer to the previous tool.\r\n       * @instance\r\n       * @function\r\n       */\n      cancelDraw: __cancelAnnotationDraw,\n\n      /**\r\n       * Setups the viewport to create an annotation\r\n       * @param {AnnotationData} aConfig - Configuration for the annotation to draw\r\n       * @param {NotificationCallback} [callback] - function to call when the annotation has finished drawing.\r\n       * @param {NotificationCallback} [cancelled] - function to call when the annotation draw was canceled.\r\n       * @instance\r\n       * @function\r\n       */\n      drawAnnotation: __drawAnnotationPublic,\n\n      /**\r\n       * Gets an array of annotation data objects located on the given zero based page index.\r\n       * @param {number} index - The page index the annotations are located on.\r\n       * @returns {AnnotationData[]} Annotation data objects on the given page.\r\n       * @instance\r\n       * @function\r\n       */\n      getFromPage: __getAnnosFromPagePublic,\n\n      /**\r\n       * Creates an annotation on the desired page with the given annotation data.\r\n       * @param {AnnotationData} annotationConfig - Key value pairs representing annotation data.\r\n       * @param {number} index - The index of the page the annotation should be created on.\r\n       * @returns {AnnotationData} - Annotation data.\r\n       * @instance\r\n       * @function\r\n       */\n      createOnPage: __createAnnotationPublic,\n\n      /**\r\n       * Deletes an annotation on the given page by it's index on the page.\r\n       * @param {number} pageIndex - Page index the annotation is located on.\r\n       * @param {number} annIndex - Index of the annotation on the page.\r\n       * @instance\r\n       * @function\r\n       */\n      deleteFromPage: __deleteAnnoOnPage,\n\n      /**\r\n       * Shows the editor dialog for text annotations. Ignores other types of annotations.\r\n       * @param {AnnotationData} annotation - the annotation object to show editor for.\r\n       *\r\n       * Annotation object should be retrieved using corresponding API. If it's constructed by the application, annotation won't be matched.\r\n       * @instance\r\n       * @function\r\n       */\n      showEditor: __showTextAnnoEditorPublic,\n\n      /**\r\n       * Hides the text annotation editor. Applies only to text annotations and ignores other types of annotations.\r\n       * @param {AnnotationData} annotation - The annotation object to hide editor for.\r\n       * @instance\r\n       * @function\r\n       */\n      hideEditor: __hideTextAnnoEditorPublic,\n\n      /**\r\n       * Sets the default annotation properties for initially created annotations. This accepts the same input as the {@link WebDocumentViewerConfig.annotations|config.annotations.defaults}.\r\n       * @param {AnnotationData[]} aConfig - Default configurations for different types of the annotations.\r\n       * @returns {Atalasoft.Controls.WebDocumentViewer}\r\n       * @instance\r\n       * @function\r\n       */\n      setDefaults: __setAnnotationDefaults,\n\n      /**\r\n       * Sets the default annotation properties for image annotations. This accepts the same input as the {@link WebDocumentViewerConfig.annotations|config.annotations.images}\r\n       * @param {AnnotationData[]} aConfig - Default configurations image annotations.\r\n       * @returns {Atalasoft.Controls.WebDocumentViewer}\r\n       * @instance\r\n       * @function\r\n       */\n      setImages: __setImages,\n\n      /**\r\n       * Sets the default annotation properties for stamp annotations. This accepts the same input as the {@link WebDocumentViewerConfig.annotations|config.annotations.stamps}.\r\n       * @param {AnnotationData[]} aConfig - Default configurations stamp annotations.\r\n       * @returns {Atalasoft.Controls.WebDocumentViewer}\r\n       * @instance\r\n       * @function\r\n       */\n      setStamps: __setStamps,\n\n      /**\r\n       * Inserts a layer of annotations at the source URL and index into the given page index. Single layer of annotations corresponds to single document page.\r\n       * @param {string} sourceUrl - Reserved for future use.\r\n       * @param {AnnotationData[]} layer - The annotation layer data.\r\n       * @param {number} index - Index the layer is to be inserted into.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @function\r\n       */\n      insertLayer: __insertLayerPublic,\n\n      /**\r\n       * Removes a layer(page annotation) of annotations. All other layers are shifted. This operation corresponds to removing page from the document.\r\n       * @param {number} index - index of the layer to be removed.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @function\r\n       */\n      removeLayer: __removeLayerPublic,\n\n      /**\r\n       * Moves a layer of annotations from one page index to another.\r\n       * @param {number} sourceIndex - index of the layer to be moved.\r\n       * @param {number} destIndex - Destination zero based page index.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @function\r\n       */\n      moveLayer: __moveLayerPublic,\n\n      /**\r\n       * Scrolls viewer to the specified annotation.\r\n       * @param {AnnotationData} anno - the annotation object to scroll to.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @function \r\n       */\n      scrollTo: __scrollToAnnoPublic\n    },\n    // old locations\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#deselectAll|annotations.deselectAll} instead.\r\n     */\n    deselectAll: _selector.deselectAll,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#createOnPage|annotations.createOnPage} instead.\r\n     */\n    createAnnotationOnPage: __createAnnotationPublic,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#getFromPage|annotations.getFromPage} instead.\r\n     */\n    getAnnotationsFromPage: __getAnnosFromPagePublic,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#deleteFromPage|annotations.deleteFromPage} instead.\r\n     */\n    deleteAnnotationOnPageAtIndex: __deleteAnnoOnPage,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#setDefaults|annotations.setDefaults} instead.\r\n     */\n    setAnnotationDefaults: __setAnnotationDefaults,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#setImages|annotations.setImages} instead.\r\n     */\n    setImages: __setImages,\n\n    /**\r\n     * @instance\r\n     * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n     * @function\r\n     * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer~AnnotationController#setStamps|annotations.setStamps} instead.\r\n     */\n    setStamps: __setStamps\n  };\n  AnnotationController.__exposedApi = _exposedApi.annotations; // we call this function without params to establish intellisense API\n\n  if (!wdv) {\n    return null;\n  } // #endregion\n\n\n  var _wdvConfig = internals._config; // parent WebDocumentViewer config object\n\n  var _pages = internals._pages; // internal pageDiv array from the WDV\n\n  var _wdvReady = false;\n  var _vp = null; // viewport object\n\n  var _menu = null; // jQuery UI menu for context options\n\n  var _menuConfig = null;\n  var _props = null;\n  var _matrix = null; // top level matrix used for scroll position translation\n\n  var _data = {\n    // data object for controller properties\n    annos: [],\n    // array of arrays with annotations that have been added or changed since loading or saving\n    activepage: null,\n    // active page\n    activeanno: null,\n    // active annotation\n    readonly: readonly ? true : false,\n    zoom: _wdv.getZoom(),\n    getZoom: _wdvInternals.getPageScale,\n    getViewerTransform: _wdvInternals.getViewerTransform,\n    getPageRotation: _wdvInternals.getPageRotation\n  };\n  var _defaults = {}; // annotation defaults object\n\n  var _drawing = false; // flag indicating if the controller is waiting to finish drawing an annotation\n\n  var _drawReady = false; // flag indicating if the controller is ready to start drawing an annotation\n  // shortcuts for exposed event handlers triggered on the main WDV object\n\n  var _publicEvents = {\n    click: 'annotationclicked',\n    dblclick: 'annotationdoubleclicked',\n    touchstart: 'annotationtouchstart',\n    interactend: 'annotationtouchend',\n    touchmove: 'annotationtouchmove',\n    pinchmove: 'annotationpinchresize',\n    rightclick: 'annotationrightclicked',\n    mousedown: 'annotationmousedown',\n    mousedownleft: 'annotationmousedownleft',\n    mousedownright: 'annotationmousedownright',\n    mousemove: 'annotationmousemove',\n    mouseout: 'annotationmouseout',\n    mouseup: 'annotationmouseup',\n    mouseover: 'annotationmouseover',\n    annocreate: 'annotationcreated',\n    annoload: 'annotationloaded',\n    moved: 'annotationmoved',\n    rotated: 'annotationrotated',\n    annoresized: 'annotationresized',\n    repaint: 'annotationrepainted',\n    layerinserted: 'layerinserted',\n    layerremoved: 'layerremoved',\n    layermoved: 'layermoved',\n    layerschanged: 'layerschanged',\n    annotationchanged: 'annotationchanged',\n    annotationtextchanged: 'annotationtextchanged'\n  }; // #region Dependencies\n\n  __initAnnotations();\n\n  __extendWDV(); // #endregion\n  // #region Control LifeCycle\n\n\n  function __beforeInit() {\n    _selector.setAnnos(_data.annos);\n\n    _selector.setPages(_pages);\n  } // executes stored commands once Raphael has loaded\n\n\n  function __initAnnotations() {\n    __beforeInit(); // adds html object support to Raphael\n\n\n    __extendRaphael();\n\n    _matrix = atalaRaphael.matrix(1, 0, 0, 1, 0, 0);\n\n    _wdv.bind({\n      scroll: __scroll,\n      pagerecycled: __recyclePaper,\n      pageshown: __pageShown,\n      zoomchanged: __zoomChanged,\n      pagerotated: __pageRotated\n    });\n\n    _menuConfig = {}; //     //\t\t\t'Order to Front': function(){ __menuAnnoReorder();},\n    //     //\t\t\t'Order to Back': function(){ __menuAnnoReorder(0);},\n    //     'Delete': __menuAnnoDelete,\n    //     'Properties': __menuAnnoProperties\n    // };\n    // initialize context menu with localized menu items\n\n    _menuConfig[LocalizationManager.GetAnnotationLocalizedString('menuDeleteButton')] = __menuAnnoDelete;\n    _menuConfig[LocalizationManager.GetAnnotationLocalizedString('menuPropertiesButton')] = __menuAnnoProperties; // is WDV ready or still loading scripts?\n\n    if (_wdvInternals._state.initialized) {\n      __wdvInitialized();\n    } else {\n      _wdv.bind({\n        initialized: __wdvInitialized\n      });\n    }\n  }\n\n  function __wdvInitialized() {\n    _wdvReady = true;\n\n    if (!_data.readonly) {\n      _menu = __initMenu(_menuConfig);\n      _props = new annotations_AnnotationPropertyDialog(internals._config.parent);\n\n      if (_wdvConfig.annotations.defaults != null) {\n        __setAnnotationDefaults(_wdvConfig.annotations.defaults);\n      }\n\n      if (_wdvConfig.annotations.stamps != null) {\n        __setStamps(_wdvConfig.annotations.stamps);\n      }\n\n      if (_wdvConfig.annotations.images != null) {\n        __setImages(_wdvConfig.annotations.images);\n      }\n\n      if (_wdvConfig.annotations.custom != null) {\n        __setCustom(_wdvConfig.annotations.custom);\n      }\n    }\n  }\n  /**\r\n   * [Internal] Disposes memory intensive objects\r\n   * @returns undefined\r\n   */\n\n\n  function __dispose() {\n    _self = null;\n    _wdv = null;\n    _wdvInternals = null;\n    _wdvConfig = null;\n    _pages = null;\n    _vp = null;\n    _menu = null;\n    _menuConfig = null;\n    _props = null;\n    _data.annos.length = 0;\n    _data.activepage = null;\n    _data.activeanno = null;\n    _data.zoom = null;\n\n    _selector.dispose();\n\n    _selector = null;\n  } // #endregion\n  // #region Extend and fix Raphael\n\n\n  function __extendRaphael() {\n    var ieSVG = atalaRaphael.svg && !Browser.Features.foreignObject;\n\n    if (atalaRaphael.vml) {\n      atalaRaphael.fn.html = __ERaddHtmlVML;\n    } else {\n      // if (!Browser.Explorer){\n      atalaRaphael.fn.html = __ERaddGenericHtmldSVG;\n\n      __ERfixSVGMarker();\n    }\n\n    atalaRaphael.fn.atalaImage = __ERaddImageBasedSVG;\n\n    function __ERaddHtmlVML(html, x, y, width, height) {\n      var fobj = __ERcreateSVG(this, this, null, 'div', x, y, width, height); // we're using an html tag to start with, so we don't need a new inner div\n\n\n      var div = fobj.node;\n      div.innerHTML = html ? html : '';\n      fobj.innerDom = div;\n      div.style.position = 'absolute';\n      fobj.__tsfm = fobj.transform;\n\n      fobj.transform = function () {\n        // apply transform to Raphael so internals have the right matrix\n        this.__tsfm.apply(this, arguments);\n\n        this.repaint();\n\n        __ERvmlScalePos(this.attrs);\n      };\n\n      function __ERvmlScalePos(attrs) {\n        var split = fobj.matrix.split();\n\n        if (attrs.hasOwnProperty('x') && attrs.x !== undefined && attrs.hasOwnProperty('y') && attrs.y !== undefined) {\n          var location = {\n            x: attrs.x * split.scalex,\n            y: attrs.y * split.scaley\n          };\n\n          if (split.rotate !== 0) {\n            var box = __calcPathBounds([{\n              x: attrs.x,\n              y: attrs.y\n            }, {\n              x: attrs.x + attrs.width,\n              y: attrs.y\n            }, {\n              x: attrs.x + attrs.width,\n              y: attrs.y + attrs.height\n            }, {\n              x: attrs.x,\n              y: attrs.y + attrs.height\n            }], fobj.matrix);\n\n            location = box;\n          }\n\n          div.style.left = Math.round(location.x) + 'px';\n          div.style.top = Math.round(location.y) + 'px';\n        }\n      }\n\n      fobj.backgroundColor = function (bg) {\n        div.style.backgroundColor = bg;\n        this.repaint();\n      };\n\n      fobj.repaint = function () {\n        div.style.filter = 'progid:DXImageTransform.Microsoft.Chroma(color=\"' + div.style.backgroundColor + '\"); ' + this.matrix.toFilter();\n      };\n\n      fobj.__attr = fobj.attr; // override Raphael's attr function since it expects VML\n\n      fobj.attr = function (attrs) {\n        this.__attr.apply(this, arguments);\n\n        if (attrs) {\n          __ERvmlScalePos(attrs);\n\n          if (attrs.hasOwnProperty('width')) {\n            div.style.width = attrs.width + 'px';\n          }\n\n          if (attrs.hasOwnProperty('height')) {\n            div.style.height = attrs.height + 'px';\n          }\n        }\n      };\n\n      fobj.isHtml = true;\n      return fobj;\n    }\n\n    function __ERaddImageBasedSVG(html, x, y, width, height) {\n      return __ERaddHtmlSVGInternal.call(this, html, x, y, width, height, true);\n    }\n\n    function __ERaddGenericHtmldSVG(html, x, y, width, height) {\n      return __ERaddHtmlSVGInternal.call(this, html, x, y, width, height);\n    }\n\n    function __ERaddHtmlSVGInternal(html, x, y, width, height, forceImage) {\n      var svgNS = 'http://www.w3.org/2000/svg'; // IE9+ supports SVG, but doesn't support the foreignObject tag, so \n      // we need to use a different rendering method\n\n      var tag = ieSVG || forceImage ? 'image' : 'foreignObject';\n\n      var fobj = __ERcreateSVG(this, this, svgNS, tag, x, y, width, height);\n\n      var div = null; // ieSVG doesn't use the textarea box to render the text\n\n      if (!ieSVG) {\n        var xhtmlNS = 'http://www.w3.org/1999/xhtml';\n        div = document.createElementNS(xhtmlNS, 'div');\n        var xmlNS = 'http://www.w3.org/2000/xmlns/';\n        div.setAttributeNS(xmlNS, 'xmlns', xmlNS);\n        div.innerHTML = html ? html : '';\n        fobj.node.appendChild(div);\n        fobj.isHtml = true;\n      }\n\n      fobj.innerDom = div;\n      return fobj;\n    }\n\n    function __ERcreateSVG(paper, parent, ns, type, x, y, w, h, r) {\n      var svg = ns === null ? document.createElement(type) : document.createElementNS(ns, type);\n\n      if (parent.canvas && parent.canvas.appendChild) {\n        parent.canvas.appendChild(svg);\n      }\n\n      var rsvg = new paper.constructor.el.constructor(svg, paper);\n      rsvg.attrs = {\n        x: x,\n        y: y,\n        width: w,\n        height: h,\n        r: r || 0,\n        rx: r || 0,\n        ry: r || 0,\n        fill: 'none',\n        stroke: '#000'\n      };\n      rsvg.skew = {};\n      rsvg.type = type;\n\n      if (type === 'g') {\n        rsvg.canvas = rsvg.node;\n      }\n\n      for (var key in rsvg.attrs) {\n        if (rsvg.attrs.hasOwnProperty(key) && rsvg.attrs[key] !== undefined) {\n          svg.setAttribute(key, rsvg.attrs[key] + '');\n        }\n      }\n\n      return rsvg;\n    } // adds a new arrow marker creation function to work around a Raphael marker sharing bug\n\n\n    function __ERfixSVGMarker() {\n      var markers = {\n        block: 'M5,0 0,2.5 5,5z',\n        classic: 'M5,0 0,2.5 5,5 3.5,3 3.5,2z',\n        diamond: 'M2.5,0 5,2.5 2.5,5 0,2.5z',\n        open: 'M6,1 1,3.5 6,6',\n        oval: 'M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z'\n      };\n      var markerCounter = {};\n\n      var $ = function $(el, attr) {\n        if (attr) {\n          if (typeof el === 'string') {\n            el = $(el);\n          }\n\n          for (var key in attr) {\n            if (attr.hasOwnProperty(key)) {\n              if (key.substring(0, 6) === 'xlink:') {\n                el.setAttributeNS('http://www.w3.org/1999/xlink', key.substring(6), String(attr[key]));\n              } else {\n                el.setAttribute(key, String(attr[key]));\n              }\n            }\n          }\n        } else {\n          el = atalaRaphael._g.doc.createElementNS('http://www.w3.org/2000/svg', el);\n\n          if (el.style) {\n            el.style.webkitTapHighlightColor = 'rgba(0,0,0,0)';\n          }\n        }\n\n        return el;\n      }; // this function was pulled from Raphael, and modified to pass JSHint\n\n\n      atalaRaphael.fn.addArrow = function (o, value, isEnd) {\n        if (o.type === 'path') {\n          var values = String(value).toLowerCase().split('-'),\n              p = o.paper,\n              se = isEnd ? 'end' : 'start',\n              node = o.node,\n              attrs = o.attrs,\n              stroke = attrs['stroke-width'],\n              i = values.length,\n              type = 'classic',\n              from,\n              to,\n              dx,\n              refX,\n              attr,\n              w = 3,\n              h = 3,\n              t = 5;\n\n          while (i--) {\n            switch (values[i]) {\n              case 'block':\n              case 'classic':\n              case 'oval':\n              case 'diamond':\n              case 'open':\n              case 'none':\n                type = values[i];\n                break;\n\n              case 'wide':\n                h = 5;\n                break;\n\n              case 'narrow':\n                h = 2;\n                break;\n\n              case 'long':\n                w = 5;\n                break;\n\n              case 'short':\n                w = 2;\n                break;\n            }\n          }\n\n          if (type === 'open') {\n            w += 2;\n            h += 2;\n            t += 2;\n            dx = 1;\n            refX = isEnd ? 4 : 1;\n            attr = {\n              fill: 'none',\n              stroke: attrs.stroke\n            };\n          } else {\n            refX = dx = w / 2;\n            attr = {\n              fill: attrs.stroke,\n              stroke: 'none'\n            };\n          }\n\n          if (o._.WDVarrows) {\n            if (isEnd) {\n              if (o._.WDVarrows.endPath) {\n                markerCounter[o._.WDVarrows.endPath]--;\n              }\n\n              if (o._.WDVarrows.endMarker) {\n                markerCounter[o._.WDVarrows.endMarker]--;\n              }\n            } else {\n              if (o._.WDVarrows.startPath) {\n                markerCounter[o._.WDVarrows.startPath]--;\n              }\n\n              if (o._.WDVarrows.startMarker) {\n                markerCounter[o._.WDVarrows.startMarker]--;\n              }\n            }\n          } else {\n            o._.WDVarrows = {};\n          }\n\n          if (type !== 'none') {\n            // makes markerCounter obsolete, no refactoring done yet:\n            var randSuffix = Math.random().toString(36).substring(7),\n                pathId = 'dave-marker-' + type,\n                markerId = 'dave-marker-' + se + type + w + h + randSuffix;\n\n            if (!atalaRaphael._g.doc.getElementById(pathId)) {\n              p.defs.appendChild($($('path'), {\n                'stroke-linecap': 'round',\n                d: markers[type],\n                id: pathId\n              }));\n              markerCounter[pathId] = 1;\n            } else {\n              markerCounter[pathId]++;\n            }\n\n            var marker = atalaRaphael._g.doc.getElementById(markerId),\n                use;\n\n            if (!marker) {\n              marker = $($('marker'), {\n                id: markerId,\n                markerHeight: h,\n                markerWidth: w,\n                orient: 'auto',\n                refX: refX,\n                refY: h / 2\n              });\n              use = $($('use'), {\n                'xlink:href': '#' + pathId,\n                transform: (isEnd ? 'rotate(180 ' + w / 2 + ' ' + h / 2 + ') ' : '') + 'scale(' + w / t + ',' + h / t + ')',\n                'stroke-width': (1 / ((w / t + h / t) / 2)).toFixed(4)\n              });\n              marker.appendChild(use);\n              p.defs.appendChild(marker);\n              markerCounter[markerId] = 1;\n            } else {\n              markerCounter[markerId]++;\n              use = marker.getElementsByTagName('use')[0];\n            }\n\n            $(use, attr);\n            var delta = dx * (type !== 'diamond' && type !== 'oval');\n\n            if (isEnd) {\n              from = o._.WDVarrows.startdx * stroke || 0;\n              to = atalaRaphael.getTotalLength(attrs.path) - delta * stroke;\n            } else {\n              from = delta * stroke;\n              to = atalaRaphael.getTotalLength(attrs.path) - (o._.WDVarrows.enddx * stroke || 0);\n            } // 'to' was going negative and causing errors in chrome\n\n\n            to = to < 0 ? 0 : to;\n            attr = {};\n            attr['marker-' + se] = 'url(#' + markerId + ')';\n\n            if (to || from) {\n              attr.d = atalaRaphael.getSubpath(attrs.path, from, to);\n            }\n\n            $(node, attr);\n            o._.WDVarrows[se + 'Path'] = pathId;\n            o._.WDVarrows[se + 'Marker'] = markerId;\n            o._.WDVarrows[se + 'dx'] = delta;\n            o._.WDVarrows[se + 'Type'] = type;\n            o._.WDVarrows[se + 'String'] = value;\n          } else {\n            if (isEnd) {\n              from = o._.WDVarrows.startdx * stroke || 0;\n              to = atalaRaphael.getTotalLength(attrs.path) - from;\n            } else {\n              from = 0;\n              to = atalaRaphael.getTotalLength(attrs.path) - (o._.WDVarrows.enddx * stroke || 0);\n            }\n\n            if (o._.WDVarrows[se + 'Path']) {\n              $(node, {\n                d: atalaRaphael.getSubpath(attrs.path, from, to)\n              });\n            }\n\n            delete o._.WDVarrows[se + 'Path'];\n            delete o._.WDVarrows[se + 'Marker'];\n            delete o._.WDVarrows[se + 'dx'];\n            delete o._.WDVarrows[se + 'Type'];\n            delete o._.WDVarrows[se + 'String'];\n          }\n\n          for (attr in markerCounter) {\n            if (markerCounter.hasOwnProperty(attr) && !markerCounter[attr]) {\n              var item = atalaRaphael._g.doc.getElementById(attr);\n\n              if (item) {\n                item.parentNode.removeChild(item);\n              }\n            }\n          }\n        }\n      };\n    }\n  } // #endregion\n  // #region Extend WDV\n  // adds Annotation specific methods to WDV \n\n\n  function __extendWDV() {\n    if (_wdv.typeOf === 'Atalasoft.Controls.WebDocumentViewer') {\n      atalaJquery.extend(_wdv, _exposedApi);\n    }\n  } // event fires when the WDV has scrolled by any amount\n\n\n  function __scroll(e) {\n    _matrix.translate(e.dx, e.dy);\n  } // throws an error on the parent WDV\n  //function __throwError(name, msg) {\n  //    _wdv.trigger({\n  //        type: 'throwerror',\n  //        name: name,\n  //        msg: msg\n  //    });\n  //}\n  // event fires when the WDV has finished zooming\n\n\n  function __zoomChanged(e) {\n    _data.zoom = e.zoom;\n  } // #endregion\n  // #region Page Methods\n  // these are not exposed to the user, only to the parent WDV\n  // overwrite instance public API to point to same data as internal API. otherwise exception is not clear since data is captured from shared closure\n\n\n  _self.__exposedApi = _exposedApi.annotations;\n  _self.addDrawingSurface = __initPaper;\n  _self.removeDrawingSurface = __disposePaper;\n  _self.insertLayer = __insertLayer;\n  _self.removeLayer = __removeLayer;\n  _self.moveLayer = __moveLayer;\n  _self.showLayer = __showLayer; // sets up a Raphael paper to be used on the given page object\n  // pg: jQuery dom object, reusable div container that represents the page\n\n  function __initPaper(pg) {\n    var _this = this;\n\n    if (pg instanceof atalaJquery) {\n      // page and the objects below always stay connected, and get reused\n      // together when new images are loaded\n      pg._paper = atalaRaphael(pg[0]);\n      pg._paper.canvas.style.position = 'absolute';\n      pg._paper.canvas.style.zIndex = '2';\n\n      if (_wdvConfig.pageborderwidth > 0) {\n        pg._paper.canvas.style.left = _wdvConfig.pageborderwidth + 'px';\n        pg._paper.canvas.style.top = _wdvConfig.pageborderwidth + 'px';\n      } // set to hold annotations separately from other objects\n\n\n      pg._paper._annos = pg._paper.set(); // set to hold garbage objects left around by Raphael\n\n      pg._paper._trash = pg._paper.set(); // need a reference to the 'parent' object\n\n      pg._paper._page = pg; // create a matrix and translate it to the offset of the page\n\n      pg._matrix = atalaRaphael.matrix(1, 0, 0, 1, 0, 0);\n\n      pg._matrix.translate(-pg.offset().left, -pg.offset().top); // create selection grips for this page\n\n\n      pg._grips = new AnnotationGrips(pg, _data);\n\n      var clearAllSelection = function clearAllSelection() {\n        AnnotationController_newArrowCheck(this, _this);\n\n        __clearAllSelection(pg);\n      }.bind(this);\n\n      pg.on('mousedown', clearAllSelection);\n\n      if (Browser.Features.Touch) {\n        pg.on('touchstart', clearAllSelection);\n      }\n\n      pg.on({\n        pageresize: function pageresize(e) {\n          e.page = pg;\n\n          __resizePaper(e);\n        },\n        pagezoom: function pagezoom(e) {\n          e.page = pg;\n\n          __zoomPaper(e);\n        }\n      });\n      return true;\n    }\n\n    return false;\n  } // sets up a Raphael paper to be used on the given page object\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  function __disposePaper(pg) {\n    if (pg instanceof atalaJquery) {\n      if (pg._paper) {\n        pg._paper._annos = null;\n        pg._paper._page = null;\n        pg._paper = null;\n      }\n\n      pg._matrix = null;\n      pg._grips = null;\n      return true;\n    }\n\n    return false;\n  } // inserts a new layer into the document\n  // sourceUrl: string, relative url to get the layer data from\n  // source: number or layer, index of the layer in the source document\n  // index: number, layer index to insert the layer into\n\n\n  function __insertLayer(sourceUrl, source, index) {\n    if (!sourceUrl && typeof source === 'number') {\n      source = __removeLayer(source);\n    }\n\n    source = source || [];\n\n    if (index == null) {\n      index = _data.annos.length;\n    } else if (index < 0) {\n      index = 0;\n    }\n\n    if (index > _data.annos.length) {\n      var oldLength = _data.annos.length;\n      _data.annos[index] = source;\n\n      for (var i = oldLength; i < _data.annos.length; ++i) {\n        if (!_data.annos[i]) {\n          _data.annos[i] = [];\n        }\n      }\n    } else {\n      _data.annos.splice(index, 0, source);\n    }\n\n    return index;\n  } // removes a page from the document\n  // index: number, page index to remove the page from\n\n\n  function __removeLayer(index) {\n    if (index < _data.annos.length) {\n      return _data.annos.splice(index, 1)[0];\n    }\n\n    return null;\n  } // moves a page at source index to the destination index\n  // sourceIndex: number, original index of the page to move\n  // destIndex: number, destination index to move the page to\n  // returns the actual insert index\n\n\n  function __moveLayer(sourceIndex, index) {\n    return __insertLayer(null, __removeLayer(sourceIndex), index);\n  } // function used in paper foreach to move the object to the trash set if it's not a grip\n\n\n  function __raphaelThrasher(raphObj) {\n    if (raphObj && raphObj.remove && !raphObj.grip && raphObj.paper && raphObj.paper._trash) {\n      raphObj.paper._trash.push(raphObj);\n    }\n  }\n\n  function __resizePaper(e) {\n    e.page._paper.setSize(e.width, e.height);\n\n    e.page._paper.canvas.style.width = e.width;\n    e.page._paper.canvas.style.height = e.height;\n\n    __repaintPage(e.page);\n  } // e.index: index of the shown page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __pageShown(e) {\n    __showLayer(e.index, e.page);\n  } // shows annotations that correspond to the given page\n\n\n  function __showLayer(index, page) {\n    if (index < _data.annos.length) {\n      __clearPage(page);\n\n      if (_data.annos[index] && _data.annos[index].length) {\n        var ann;\n\n        for (var i = 0; i < _data.annos[index].length; i++) {\n          ann = _data.annos[index][i];\n          ann._pageindex = index;\n          ann.repaint(page._paper);\n\n          if (ann.get('selected')) {\n            _selector.select(ann, index, true);\n          }\n        }\n      }\n    }\n  }\n\n  function __clearPage(page) {\n    // clear grips\n    page._grips.clear(); // remove all known annos\n\n\n    page._paper._annos.remove();\n\n    page._paper._annos.clear(); // remove anything else except for the grips\n\n\n    page._paper.forEach(function (obj) {\n      if (obj && obj.remove && !obj.grip && obj.paper && obj.paper._trash) {\n        obj.paper._trash.push(obj);\n      }\n    }); // remove all other objects\n\n\n    page._paper._trash.remove();\n\n    page._paper._trash.clear();\n\n    __cancelAnnotationDraw();\n  } // sets the active page of the controller\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  function __setActivePage(pg) {\n    _data.activepage = pg;\n  } // recycles paper by clearing annotations for the page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __recyclePaper(e) {\n    if (e.page._paper) {\n      __clearPage(e.page);\n\n      e.page.append(e.page._paper.canvas);\n    }\n  }\n\n  function __zoomPaper(e) {\n    // when width & height are zeroes, it knocks out IE and FF mind, so they cant resize svg object back.\n    if (isFinite(e.width) && isFinite(e.height) && e.width && e.height) {\n      _data.zoom = e.zoom;\n\n      e.page._paper.setSize(e.width, e.height);\n\n      e.page._paper.canvas.style.width = e.width;\n      e.page._paper.canvas.style.height = e.height;\n\n      e.page._paper.forEach(function (obj) {\n        if (obj && obj.transform && !obj.grip) {\n          // need to zoom the stroke since Raphael doesn't\n          if (obj._linewidth !== undefined) {\n            obj.attr('stroke-width', obj._linewidth * _data.zoom);\n          }\n\n          var clip = obj.attr('clip-rect');\n\n          if (typeof clip === 'object' && typeof clip.length === 'number') {\n            obj.attr('clip-rect', clip);\n          }\n        }\n      });\n\n      __repaintPage(e.page);\n    }\n  }\n\n  function __pageRotated(e) {\n    __repaintPage(e.page);\n  }\n\n  function __repaintPage(page) {\n    if (page) {\n      if (page._index >= 0 && _data.annos[page._index]) {\n        for (var i = 0; i < _data.annos[page._index].length; i++) {\n          _data.annos[page._index][i].repaint();\n        }\n\n        if (page) {\n          page._grips.repaint();\n        }\n      }\n    }\n  } // #endregion\n  // #region Menu\n  // shows context menu if it exists\n  // e.x: int, x position of the mouse click relative to the page\n  // e.y: int, y position of the mouse click relative to the page\n\n\n  function __menuShow(e) {\n    if (_menu) {\n      var propertiesMenuItem = LocalizationManager.GetAnnotationLocalizedString('menuPropertiesButton');\n      var deleteMenuItem = LocalizationManager.GetAnnotationLocalizedString('menuDeleteButton'); //if the active anno is readonly, we don't want the user to edit properties\n\n      if (_data.activeanno.get('readonly')) {\n        _menu.children(':contains(' + propertiesMenuItem + ')').off('click').children('a, div').css('color', '#cdc9c9');\n\n        _menu.children(':contains(' + deleteMenuItem + ')').off('click').children('a, div').css('color', '#cdc9c9');\n      } else {\n        var propDiv = _menu.children(':contains(' + propertiesMenuItem + ')');\n\n        if (propDiv.data('events') === undefined || !('click' in propDiv.data('events'))) {\n          propDiv.on('click', __menuAnnoProperties);\n        }\n\n        propDiv.children('a').css('color', '#000000');\n      } // need to add the menu to the DOM if it's not already\n\n\n      if (_menu.closest().length === 0) {\n        _vp.prepend(_menu);\n      }\n\n      var menuLoc = {\n        x: e.x - 6,\n        y: e.y - 6\n      };\n\n      _menu.css({\n        'left': menuLoc.x,\n        'top': menuLoc.y\n      });\n\n      _menu.show();\n\n      _menu.visible = true;\n    }\n  }\n\n  function __generateMenu(e) {\n    if (_menu) {\n      if (_menu.visible) {\n        __menuHide();\n      } // we need create a new one\n\n\n      _menu.remove();\n    }\n\n    var menuCopy = atalaJquery.extend(true, {}, _menuConfig);\n\n    _wdv.trigger('contextmenu', [_data.activeanno.getClonedData(), menuCopy]);\n\n    if (!atalaJquery.isEmptyObject(menuCopy)) {\n      for (var i in menuCopy) {\n        if (menuCopy.hasOwnProperty(i)) {\n          menuCopy[i] = __wrapMenuMethod(menuCopy[i]);\n        }\n      }\n\n      _menu = __initMenu(menuCopy);\n    } else {\n      _menu = null;\n    }\n\n    __menuShow(e);\n  } // hides the context menu if it exists\n\n\n  function __menuHide() {\n    if (_menu) {\n      _menu.hide();\n\n      _menu.visible = false;\n    }\n  }\n\n  function __initMenu(menuConfig) {\n    var menu = _wdvInternals.createMenu(menuConfig);\n\n    menu.css({\n      'position': 'fixed',\n      'z-index': 99999\n    });\n    menu.mouseleave(__menuHide);\n    menu.visible = false;\n    return menu;\n  }\n\n  function __wrapMenuMethod(func) {\n    return function () {\n      __menuHide();\n\n      return func.call(this, _data.activeanno.getClonedData());\n    };\n  }\n\n  function __menuAnnoDelete() {\n    var findex = _data.activepage ? _data.activepage._index : 0;\n\n    if (_data.annos[findex]) {\n      var z = atalaJquery.inArray(_data.activeanno, _data.annos[findex]);\n\n      if (z !== -1) {\n        _data.activeanno = null;\n\n        __deleteAnnoAtIndex(z, findex);\n      }\n    }\n\n    __menuHide();\n  }\n\n  function __menuAnnoProperties() {\n    __menuHide();\n\n    _props.show(_data.activeanno);\n  }\n  /*\tTODO: flesh out reorder menu\r\n      function __menuAnnoReorder(i){\r\n          __menuHide();\r\n      }\r\n  */\n  // #endregion\n  // #region Exposed Methods\n\n\n  _self.clear = __clearAnnotations;\n  _self.createAnnotation = __createAnnotation;\n  _self.deleteAnnoOnPage = __deleteAnnoOnPage;\n  _self.drawAnnotation = __drawAnnotation;\n  _self.getAnnosFromPage = __getAnnosFromPagePublic;\n  _self.setStamps = __setStamps;\n  _self.setAnnotationDefaults = __setAnnotationDefaults;\n  _self.setImages = __setImages;\n  _self.setCustom = __setCustom;\n  /**\r\n   * Clears the annotations and related data from all pages\r\n   */\n\n  function __clearAnnotations() {\n    if (_data.annos.length > 0) {\n      _data.annos.length = 0;\n\n      if (_pages) {\n        for (var i = 0; i < _pages.length; i++) {\n          // clear selected annotations\n          _pages[i]._grips.clear(); // remove anything else except for the grips\n\n\n          _pages[i]._paper.forEach(__raphaelThrasher); // remove all other objects\n\n\n          _pages[i]._paper._trash.remove();\n\n          _pages[i]._paper._trash.clear(); // remove all known annos\n\n\n          _pages[i]._paper._annos.remove();\n\n          _pages[i]._paper._annos.clear();\n        }\n      }\n\n      _wdv.trigger({\n        type: 'annotationscleared'\n      });\n    }\n  }\n  /**\r\n   * Creates an annotation on the desired page with the given annotation data.\r\n   * @param aConfig: object, Key value pairs representing annotation data.\r\n   * @param pgNum: number, The zero based index of the page the annotation should be created on.\r\n   * @param callback: function, Function to be called when the operation has completed.\r\n   * @returns object: Atalasoft.Annotations.Annotation.\r\n   */\n\n\n  function __createAnnotation(aConfig, pgNum, callback) {\n    var annConfig = {};\n\n    if (aConfig.multiview) {\n      annConfig = aConfig;\n    } else {\n      if (aConfig && aConfig.type && _defaults[aConfig.type]) {\n        atalaJquery.extend(true, annConfig, _defaults[aConfig.type]);\n      }\n\n      atalaJquery.extend(true, annConfig, aConfig);\n    }\n\n    var newAnno = new annotations_Annotation(_wdv, annConfig, _data);\n    newAnno._pageindex = pgNum;\n\n    if (_data.annos[pgNum] === undefined) {\n      _data.annos[pgNum] = [];\n    }\n\n    _data.annos[pgNum].push(newAnno);\n\n    _wdvInternals.redrawPageFromIndex(pgNum, true);\n\n    if (typeof callback === 'function') {\n      callback(newAnno);\n    }\n\n    __bindAnnoEvents(newAnno);\n\n    return newAnno;\n  } // Need a public facing function to return a clone, not internal annotation object.\n  // callback receives internal annotation object, so not intended for user.\n\n\n  function __createAnnotationPublic(aConfig, pgNum, callback) {\n    var clonedAnno = __createAnnotation(aConfig, pgNum, callback).getClonedData();\n\n    _wdv.trigger({\n      type: _publicEvents.annocreate,\n      anno: clonedAnno,\n      annotation: clonedAnno,\n      page: pgNum\n    });\n\n    return clonedAnno;\n  }\n\n  function __deleteAnnoOnPage(pgNum, annIndex) {\n    __deleteAnnoAtIndex(annIndex, pgNum);\n  } // made a separate function because the documented inputs are reversed\n\n  /**\r\n   * Deletes an annotation on the given z-index and zero based page index.\r\n   * @param annIndex: number, Zero based z-index of the annotation.\r\n   * @param pgNum: number, Zero based page index the annotation is located on.\r\n   */\n\n\n  function __deleteAnnoAtIndex(annIndex, pgNum) {\n    var delanno = _data.annos[pgNum].splice(annIndex, 1)[0];\n\n    if (_data.activepage && _data.activepage._paper) _data.activepage._paper._annos.exclude(delanno.getObject());\n    if (_data.activeanno === delanno) _data.activeanno = null;\n    delanno.dispose();\n    if (_data.activepage && _data.activepage._grips) _data.activepage._grips.repaint();\n\n    _wdv.trigger({\n      type: 'annotationdeleted',\n      page: pgNum,\n      index: annIndex\n    });\n  }\n\n  function __getAnnosFromPagePublic(pageNum) {\n    var annArray = [];\n\n    if (_data.annos.length === 0 || _data.annos[pageNum] === undefined) {\n      return annArray;\n    }\n\n    for (var i = 0; i < _data.annos[pageNum].length; i++) {\n      annArray[i] = _data.annos[pageNum][i].getClonedData();\n    }\n\n    return annArray;\n  }\n\n  function __scrollToAnnoPublic(anno, callback) {\n    var _this2 = this;\n\n    var callbackFunc = function callbackFunc() {\n      AnnotationController_newArrowCheck(this, _this2);\n\n      if (typeof callback === 'function') callback();\n    }.bind(this);\n\n    var pageNum = anno.getPageIndex();\n\n    var annObj = __findFromClone(anno, pageNum);\n\n    if (annObj) {\n      var annoZoom = annObj.getZoom();\n      var annTypes = annotations_AnnotationTypes;\n      var annCenter = {\n        x: 0,\n        y: 0\n      };\n\n      if (anno.type === annTypes.line || anno.type === annTypes.lines || anno.type === annTypes.freehand) {\n        var pointsX = anno.points.map(function (p) {\n          AnnotationController_newArrowCheck(this, _this2);\n\n          return p.x;\n        }.bind(this));\n        var pointsY = anno.points.map(function (p) {\n          AnnotationController_newArrowCheck(this, _this2);\n\n          return p.y;\n        }.bind(this));\n        annCenter.x = (Math.min.apply(Math, pointsX) + Math.max.apply(Math, pointsX)) / 2;\n        annCenter.y = (Math.min.apply(Math, pointsY) + Math.max.apply(Math, pointsY)) / 2;\n      } else {\n        annCenter.x = anno.x + anno.width / 2;\n        annCenter.y = anno.y + anno.height / 2;\n      }\n\n      annCenter.x *= annoZoom;\n      annCenter.y *= annoZoom;\n\n      _wdvInternals.showPagePoint(pageNum, annCenter, PageSelection.Center, true, callbackFunc);\n    } else {\n      callbackFunc();\n    }\n\n    return;\n  }\n\n  function __findFromClone(clone, pageIndex) {\n    if (isFinite(pageIndex)) {\n      if (pageIndex < _data.annos.length) {\n        for (var i = 0; i < _data.annos[pageIndex].length; ++i) {\n          if (_data.annos[pageIndex][i].isCloneSource(clone)) {\n            return _data.annos[pageIndex][i];\n          }\n        }\n      }\n    } else {\n      for (var _i = 0; _i < _data.annos.length; ++_i) {\n        var ann = __findFromClone(clone, _i);\n\n        if (ann) {\n          return ann;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function __insertLayerPublic(sourceUrl, sourceIndex, index, callback) {\n    index = __insertLayer(sourceUrl, sourceIndex, index);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.layerinserted,\n      srcurl: sourceUrl,\n      srcindex: sourceIndex,\n      index: index\n    });\n\n    _wdv.trigger(_publicEvents.layerschanged);\n  }\n\n  function __removeLayerPublic(index, callback) {\n    var layer = __removeLayer(index);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.layerremoved,\n      layer: layer,\n      index: index\n    });\n\n    _wdv.trigger(_publicEvents.layerschanged);\n  }\n\n  function __moveLayerPublic(sourceIndex, destIndex, callback) {\n    destIndex = __moveLayer(sourceIndex, destIndex);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.layermoved,\n      srcindex: sourceIndex,\n      destindex: destIndex\n    });\n\n    _wdv.trigger(_publicEvents.layerschanged);\n  }\n\n  function __setAnnotationDefaults(aConfig) {\n    _wdvConfig.annotations.defaults = aConfig;\n\n    for (var i = 0; i < aConfig.length; i++) {\n      if (typeof aConfig[i].type === 'string') {\n        _defaults[aConfig[i].type] = aConfig[i];\n      }\n    }\n\n    return _wdv;\n  }\n\n  function __setStamps(sConfig) {\n    _wdvConfig.annotations.stamps = sConfig;\n\n    for (var i = 0; i < sConfig.length; i++) {\n      __validateStampConfig(sConfig[i]);\n    }\n\n    if (_wdvReady) {\n      var bConfig = {\n        type: 'button',\n        id: _wdvInternals._id + '_toolbar_Button_Stamp',\n        icon: 'stamp',\n        tooltip: 'Draw Stamp',\n        text: ''\n      };\n\n      var span = _wdvInternals.createDropDownButton(bConfig);\n\n      bConfig.onclick = _wdvInternals.drawAnnotation;\n\n      _wdvInternals.createDropDownMenu(span, bConfig, sConfig);\n    }\n\n    return _wdv;\n  }\n\n  function __setImages(iConfig) {\n    _wdvConfig.annotations.images = iConfig;\n\n    for (var i = 0; i < iConfig.length; i++) {\n      __validateImageConfig(iConfig[i]);\n    }\n\n    if (_wdvReady) {\n      var bConfig = {\n        type: 'button',\n        id: _wdvInternals._id + '_toolbar_Button_Image',\n        icon: 'image',\n        tooltip: 'Draw Image',\n        text: ''\n      };\n\n      var span = _wdvInternals.createDropDownButton(bConfig);\n\n      bConfig.onclick = _wdvInternals.drawAnnotation;\n\n      _wdvInternals.createDropDownMenu(span, bConfig, iConfig);\n    }\n\n    return _wdv;\n  }\n  /**\r\n   * Sets the default annotation properties for initially created custom annotations.  This accepts the same input as the main config.\r\n   * @param cConfig: array, An array of JSON objects representing custom annotation types.\r\n   * @returns object: Atalasoft.Controls.WebDocumentViewer\r\n   */\n\n\n  function __setCustom(cConfig) {\n    _wdvConfig.annotations.custom = cConfig;\n\n    for (var i = 0; i < cConfig.length; i++) {\n      __validateCustomConfig(cConfig[i]);\n    }\n\n    if (_wdvReady) {\n      var bConfig = {\n        type: 'button',\n        id: _wdvInternals._id + '_toolbar_Button_Custom',\n        icon: 'image',\n        tooltip: 'Draw Custom',\n        text: ''\n      };\n\n      var span = _wdvInternals.createDropDownButton(bConfig);\n\n      bConfig.onclick = _wdvInternals.drawAnnotation;\n\n      _wdvInternals.createDropDownMenu(span, bConfig, cConfig);\n    }\n\n    return _wdv;\n  }\n\n  function __showTextAnnoEditorPublic(annotation) {\n    return __showTextAnnoEditor(annotation, true);\n  }\n\n  function __hideTextAnnoEditorPublic(annotation) {\n    return __showTextAnnoEditor(annotation, false);\n  }\n\n  function __showTextAnnoEditor(annotation, shown) {\n    if (annotation.type === 'text' && annotation) {\n      var page = annotation.getPageIndex();\n\n      var annObj = __findFromClone(annotation, page);\n\n      if (shown) {\n        var visible = annotation.visible;\n\n        if (visible) {\n          if (_wdvInternals.isPageInView(page)) {\n            __doShowEditor(annObj, page);\n          } else {\n            _wdv.showPage(annotation.getPageIndex(), function () {\n              __doShowEditor(annObj, page);\n            });\n          }\n        }\n      } else {\n        annObj.trigger('hideeditor');\n      }\n    }\n  }\n\n  function __doShowEditor(annotation, page) {\n    if (annotation) {\n      if (annotation.get('selectable') !== false) {\n        _selector.select(annotation, page, false);\n      }\n\n      annotation.trigger('showeditor');\n    }\n  } // #endregion\n  // #region Private Exposed Methods\n\n\n  _self.dispose = __dispose;\n  /**\r\n   * [Internal] Gets debug info object\r\n   * @returns debug info object if available, otherwise null\r\n   */\n\n  _self.__getDebugInfo = __getDebugInfo;\n\n  function __getDebugInfo() {\n    var info = {};\n    atalaJquery.extend(true, info, {\n      data: _data,\n      defaults: _defaults,\n      drawing: _drawing,\n      drawready: _drawReady,\n      matrix: _matrix,\n      menu: _menu,\n      menuconfig: _menuConfig,\n      pages: _pages,\n      props: _props,\n      viewport: _vp\n    });\n    return info;\n  }\n  /**\r\n   * [Internal] Links the annotation data between two controls\r\n   * @param linker internal object of type __LVlinker\r\n   * @returns undefined\r\n   */\n\n\n  _self.__linkAnnotations = __linkAnnotations;\n\n  function __linkAnnotations(linker) {\n    if (linker) {\n      if (!linker._annos) {\n        linker._annos = _data.annos;\n      } else if (atalaJquery.isArray(linker._annos)) {\n        _data.annos = linker._annos;\n      }\n    }\n  }\n  /**\r\n   * [Internal] Clears all selection of annotations\r\n   */\n\n\n  _self.__clearAllSelection = __clearAllSelection;\n\n  function __clearAllSelection(pg) {\n    __setActivePage(pg);\n\n    _selector.deselectPage(pg);\n\n    __menuHide();\n  }\n\n  _self.setViewPort = __setViewPort;\n\n  function __setViewPort(obj) {\n    if (obj) {\n      if (!(obj instanceof atalaJquery)) {\n        obj = atalaJquery(obj);\n      }\n\n      _vp = obj;\n    }\n  } // #endregion\n  // #region Annotation Drawing\n  // sets up the viewport to create an annotation\n  // aConfig: key value pairs sent\n  // callback: function to call when the annotation has finished drawing\n  // cancelled: function to call when the annotation draw was cancelled\n\n\n  function __drawAnnotation(aConfig, configPrecedesDefault, callback, cancelled) {\n    // if we're still drawing, don't draw another one\n    if (_drawing) {\n      return null;\n    }\n\n    var config = atalaJquery.extend(true, {}, aConfig); // starts with default anno, and overlays aConfig defaults\n\n    if (aConfig && aConfig.type && _defaults[aConfig.type]) {\n      config = atalaJquery.extend(true, config, _defaults[aConfig.type]);\n      if (configPrecedesDefault) config = atalaJquery.extend(true, config, aConfig);\n    } // explicitly remove rotation since draw through UI don't support it.\n\n\n    config.rotation = 0; // previous annotation was never added to anything, we should dispose of it\n\n    if (_data.activeanno && _data.activeanno.getObject() === null) {\n      __cancelAnnotation();\n    } // prepare drawing surfaces\n\n\n    __prepareForDraw(); // create the new annotation from data\n\n\n    _data.activeanno = new annotations_Annotation(_wdv, config, _data);\n\n    _data.activeanno.bind({\n      drawn: __finishAnnotation,\n      cancelled: __cancelAnnotation\n    });\n\n    if (typeof callback === 'function') {\n      __annotationCreatedCallback = callback;\n    }\n\n    if (typeof cancelled === 'function') {\n      __annotationCancelledCallback = cancelled;\n    }\n\n    return _data.activeanno;\n  }\n\n  function __drawAnnotationPublic(aConfig, callback, cancelled) {\n    _wdvInternals._controllers.mouseTool.setTool(MouseToolType.None, MouseToolType.None);\n\n    var completedCallback = function completedCallback() {\n      _wdvInternals._controllers.mouseTool.setTool(MouseToolType.Pan, MouseToolType.None);\n\n      if (typeof callback === 'function') callback();\n    };\n\n    var cancelledCallback = function cancelledCallback() {\n      _wdvInternals._controllers.mouseTool.setTool(MouseToolType.Pan, MouseToolType.None);\n\n      if (typeof cancelled === 'function') cancelled();\n    };\n\n    __drawAnnotation(aConfig, true, completedCallback, cancelledCallback);\n  }\n\n  var __annotationCreatedCallback = function __annotationCreatedCallback() {// intentionally left blank, this gets overwritten\n  };\n\n  var __annotationCancelledCallback = function __annotationCancelledCallback() {// intentionally left blank, this gets overwritten\n  }; // prepares all pages for drawing, since we don't know where the user will draw\n\n\n  function __prepareForDraw() {\n    if (!_drawReady) {\n      _vp.on('mousedown', __startAnnotationDraw);\n\n      if (Browser.Features.Touch) {\n        _vp.on('touchstart', __startAnnotationDraw);\n      }\n\n      for (var i = 0; i < _pages.length; i++) {\n        _pages[i]._draw.toFront();\n      }\n\n      _drawReady = true;\n    }\n  } // resets all pages to state before prepareForDraw was called\n\n\n  function __cleanupDraw() {\n    if (_drawReady) {\n      _vp.off('mousedown', __startAnnotationDraw);\n\n      if (Browser.Features.Touch) {\n        _vp.off('touchstart', __startAnnotationDraw);\n      }\n\n      for (var i = 0; i < _pages.length; i++) {\n        _pages[i]._draw.reset();\n      }\n\n      _drawReady = false;\n    }\n  } // draws an annotation with the mouse\n\n\n  function __startAnnotationDraw(e) {\n    _drawing = true; // don't want to start drawing this annotation again if a mousedown happens'\n\n    _vp.off('mousedown', __startAnnotationDraw);\n\n    if (Browser.Features.Touch) {\n      _vp.off('touchstart', __startAnnotationDraw);\n    }\n\n    var clonedData = _data.activeanno.getClonedData();\n\n    _wdv.trigger({\n      type: 'annotationdrawstart',\n      annotation: clonedData,\n      ann: clonedData\n    });\n\n    _data.activeanno._pageindex = _data.activepage._index;\n\n    _data.activeanno.startDraw(e, _data.activepage._paper, {}, _wdv.config.textannomobilezoom);\n  }\n\n  function __finishAnnotation() {\n    __finishDrawing();\n\n    __annotationCreated(_data.activeanno);\n  }\n\n  function __cancelAnnotation() {\n    _data.activeanno.dispose();\n\n    _data.activeanno = null;\n\n    if (_drawing) {\n      __finishDrawing(true);\n    }\n  }\n\n  function __cancelAnnotationDraw() {\n    if (_drawReady) {\n      if (_drawing) {\n        // user has started drawing the annotation\n        __cancelAnnotation();\n      } else {\n        if (_data.activeanno) {\n          _data.activeanno.dispose();\n\n          _data.activeanno = null;\n        }\n\n        __cleanupDraw();\n      } // call the callback, and set it back to empty\n\n\n      __annotationCancelledCallback({\n        annotation: null\n      });\n\n      __annotationCancelledCallback = function __annotationCancelledCallback() {};\n    }\n  }\n\n  function __finishDrawing(cancelled) {\n    _drawing = false;\n\n    __cleanupDraw();\n\n    var clonedData = cancelled ? null : _data.activeanno.getClonedData();\n\n    _wdv.trigger({\n      type: 'annotationdrawend',\n      annotation: clonedData,\n      ann: clonedData,\n      cancelled: cancelled ? true : false\n    });\n  }\n\n  function __annotationCreated(anno) {\n    var page = _data.activepage;\n    var findex = page ? page._index : 0;\n\n    if (_data.annos[findex]) {\n      _data.annos[findex].push(anno);\n    } else {\n      _data.annos[findex] = [anno];\n    }\n\n    _data.activeanno.unbind({\n      drawn: __finishAnnotation,\n      cancelled: __cancelAnnotation\n    });\n\n    __bindAnnoEvents(_data.activeanno);\n\n    _selector.select(_data.activeanno, page, false); // call the callback, and set it back to empty\n\n\n    __annotationCreatedCallback({\n      annotation: anno\n    });\n\n    __annotationCreatedCallback = function __annotationCreatedCallback() {};\n\n    var clonedData = anno.getClonedData();\n\n    _wdv.trigger({\n      type: _publicEvents.annocreate,\n      anno: clonedData,\n      annotation: clonedData,\n      page: findex\n    });\n  } // #endregion\n  // #region Annotation Events\n\n\n  function __bindAnnoEvents(anno) {\n    function __triggerPublicEvent(e) {\n      var clonedData = anno.getClonedData();\n\n      _wdv.trigger({\n        type: _publicEvents[e.type],\n        anno: clonedData,\n        annotation: clonedData\n      });\n    }\n\n    anno.bind({\n      dragstart: function dragstart() {\n        var clonedData = anno.getClonedData();\n\n        _wdv.trigger({\n          type: 'annotationdragstart',\n          ann: clonedData,\n          annotation: clonedData\n        });\n      },\n      dragend: function dragend() {\n        var clonedData = anno.getClonedData();\n\n        _wdv.trigger({\n          type: 'annotationdragend',\n          annotation: clonedData,\n          ann: clonedData\n        });\n      },\n      interactstart: function interactstart() {\n        if (!_data.activepage || _data.activepage._paper !== anno.getObject().paper) {\n          __setActivePage(anno.getObject().paper._page);\n        }\n\n        _data.activeanno = anno;\n      },\n      annotationchanged: function annotationchanged(e) {\n        var clonedData = anno.getClonedData();\n\n        _wdv.trigger({\n          type: 'annotationchanged',\n          annotation: clonedData,\n          anno: clonedData,\n          annobefore: e.annobefore\n        });\n      },\n      selected: __selectAnnotation,\n      deselected: __selectAnnotation,\n      reselected: __selectAnnotation,\n      contextmenu: __generateMenu,\n      serverrenderurlrequested: __serverRenderUrlRequested,\n      moved: __triggerPublicEvent,\n      rotated: __triggerPublicEvent,\n      annoresized: __triggerPublicEvent,\n      interactend: __triggerPublicEvent,\n      touchstart: __triggerPublicEvent,\n      touchmove: __triggerPublicEvent,\n      pinchmove: __triggerPublicEvent,\n      click: __triggerPublicEvent,\n      dblclick: __triggerPublicEvent,\n      rightclick: __triggerPublicEvent,\n      mousedown: __triggerPublicEvent,\n      mousedownleft: __triggerPublicEvent,\n      mousedownright: __triggerPublicEvent,\n      mouseup: __triggerPublicEvent,\n      mousemove: __triggerPublicEvent,\n      mouseover: __triggerPublicEvent,\n      repaint: __triggerPublicEvent,\n      annotationtextchanged: __triggerPublicEvent,\n      annotationtextchangefailed: function annotationtextchangefailed() {\n        _wdv.trigger({\n          type: 'throwerror',\n          name: 'updateAnnotation',\n          msg: 'Failed to change annotation text, because it is already edited by UI.'\n        });\n      }\n    });\n  }\n\n  function __selectAnnotation(e) {\n    var page = e.page || e.pageindex >= 0 ? e.pageindex : _data.activepage;\n\n    var pageDiv = _selector.resolvePage(page);\n\n    if (pageDiv) // the selection api is able to work on both page div and page index(if page is not in DOM in the moment).\n      page = pageDiv;\n\n    if (e.type === 'selected' || e.type === 'reselected') {\n      _data.activeanno = e.ann;\n\n      _selector.select(e.ann, page, e.append);\n\n      if (_props && _props.isVisible()) {\n        _props.show(e.ann);\n      }\n    } else {\n      _selector.deselect(e.ann, page, e.append);\n\n      if (_props && _props.isVisible()) {\n        _props.cancel();\n      }\n    }\n\n    if (pageDiv && pageDiv._grips) pageDiv._grips.repaint();\n  }\n\n  function __serverRenderUrlRequested(e) {\n    var callback = e.complete;\n\n    var url = __stringifyAnnotationData(e.data);\n\n    if (typeof callback === 'function') {\n      callback.call(url);\n    }\n  } // #endregion\n  // #region Ajax/Json Methods\n  // these are not exposed to the user, only to the parent WDV\n\n\n  _self.stringifyChanges = __stringifyChanges;\n  _self.stringifyAnnotationData = __stringifyAnnotationData;\n  _self.createHandlerRequest = __createHandlerRequest;\n  _self.makeHandlerRequest = __makeHandlerRequestAsync;\n  _self.loadAnnotationsUrl = __loadAnnosAsync;\n  _self.loadAnnotations = __onAnnotationsLoaded;\n\n  function __stringifyChanges() {\n    var arr = [];\n\n    for (var key in _data.annos) {\n      if (_data.annos.hasOwnProperty(key)) {\n        arr[key] = {\n          items: []\n        };\n        var pageRotation = 0;\n\n        var scale = _wdvInternals.getPageScale(key);\n\n        var m = atalaRaphael.matrix();\n\n        if (_wdvInternals._config.persistrotation) {\n          pageRotation = _wdvInternals.getPageRotation(key);\n          m = _wdvInternals.getViewerTransform(key);\n          var reverseZoom = 1 / scale;\n          m.scale(reverseZoom, reverseZoom, 0, 0);\n          m.e *= reverseZoom;\n          m.f *= reverseZoom;\n        }\n\n        for (var z in _data.annos[key]) {\n          if (_data.annos[key].hasOwnProperty(z)) {\n            var annData = atalaJquery.extend(true, {}, _data.annos[key][z].get());\n\n            if (annData.rotation || pageRotation) {\n              var box = _data.annos[key][z].getBox();\n\n              var halfWidth = box.width / 2;\n              var halfHeight = box.height / 2;\n              var transform = atalaRaphael.matrix();\n\n              var dataAnnoTransform = _data.annos[key][z].getTransform();\n\n              transform.add(m.a, m.b, m.c, m.d, m.e, m.f);\n              transform.add(dataAnnoTransform.a, dataAnnoTransform.b, dataAnnoTransform.c, dataAnnoTransform.d, dataAnnoTransform.e, dataAnnoTransform.f); // center point is visually invariant to rotation,\n              // so it depends only on page rotation.\n\n              var targetCenter = {\n                x: transform.x(box.x + halfWidth, box.y + halfHeight),\n                y: transform.y(box.x + halfWidth, box.y + halfHeight)\n              };\n              var dx = targetCenter.x - halfWidth - box.x;\n              var dy = targetCenter.y - halfHeight - box.y;\n\n              if (annData.points) {\n                for (var i = 0; i < annData.points.length; i++) {\n                  if (annData.type === 'line') {\n                    // desktop renderers doesn't show rotation grip for 'lines' and seems like not expect rotation on them\n                    // so setting line rotation knocks out their mind. ignoring line rotation.\n                    var x = transform.x(annData.points[i].x, annData.points[i].y);\n                    annData.points[i].y = transform.y(annData.points[i].x, annData.points[i].y);\n                    annData.points[i].x = x;\n                  } else {\n                    annData.points[i].x += dx;\n                    annData.points[i].y += dy;\n                  }\n                }\n              } else if (annData.type === 'custom' || !annData.points) {\n                annData.x += dx;\n                annData.y += dy;\n              }\n\n              annData.rotation = annData.type !== 'line' ? (annData.rotation + pageRotation) % 360 : 0;\n            }\n\n            arr[key].items[z] = annData;\n\n            __convertColorProps(annData);\n          }\n        }\n      }\n    }\n\n    return JSON.stringify(arr);\n  }\n\n  function __stringifyAnnotationData(data) {\n    __convertColorProps(data);\n\n    return JSON.stringify(data);\n  }\n\n  function __convertColorProps(data) {\n    for (var i in data) {\n      if (i === 'color' && data[i] != null) {\n        var col = atalaRaphael.getRGB(data[i]);\n\n        if (col.error) {\n          col.hex = '#000000';\n        }\n\n        data[i] = col.hex;\n      } else if (i !== 'points' && typeof data[i] === 'object') {\n        __convertColorProps(data[i]);\n      }\n    }\n  } // annUrl should stay second parameter for generic document loading code in viewer\n\n\n  function __createHandlerRequest(serverUrl, annUrl, docurl, offset, length) {\n    docurl = docurl || _wdv.config.documenturl;\n    var hRequest = {\n      type: 'annodata',\n      serverurl: serverUrl,\n      query: '?atalaanndata=',\n      method: 'GET',\n      data: {\n        atala_annurl: annUrl,\n        atala_docurl: docurl,\n        atala_a_ofs: offset,\n        atala_a_len: length\n      },\n      cancel: false,\n      info: {\n        layers: [],\n        offset: offset || 0,\n        length: length,\n        error: undefined\n      }\n    }; // workaround for IE that encodes null as string\n\n    for (var key in hRequest.data) {\n      if (hRequest.data.hasOwnProperty(key) && hRequest.data[key] === null) {\n        hRequest.data[key] = undefined;\n      }\n    }\n\n    return hRequest;\n  }\n\n  function __makeHandlerRequestAsync(hRequest, preserveExisting, callback) {\n    if (typeof preserveExisting === 'function') {\n      callback = preserveExisting;\n      preserveExisting = false;\n    }\n\n    if (!preserveExisting) {\n      // keep rest of the pages untouched if we are doing only partial reload.\n      __clearAnnotations();\n    } //  defined inline so we have a closure reference to callback\n\n\n    function __complete(info) {\n      if (hRequest.info.docIndex !== undefined) {\n        info.offset = hRequest.info.docIndex;\n      } // clear this particular page since loading end up in error.\n\n\n      if (!info.layers && info.error && preserveExisting) {\n        for (var i = info.offset; i < info.offset + hRequest.info.length; i++) {\n          _data.annos[i] = [];\n        }\n      } // we assume that all requests made through this method are for annotations\n\n\n      __onAnnotationsLoaded(info); // only execute the callback if it exists\n\n\n      if (typeof callback === 'function') {\n        callback.call(undefined, info.error, info);\n      }\n    }\n\n    _wdvInternals.makeHandlerRequest(hRequest, __complete, __complete);\n  } // contacts the server for annotation info, JSON is returned to __onAnnotationsLoaded\n\n\n  function __loadAnnosAsync(serverUrl, annUrl, docUrl, offset, length, docIndex, callback) {\n    var args = Array.prototype.slice.call(arguments);\n    callback = args.pop();\n\n    if (typeof callback !== 'function') {\n      args.push(callback);\n    }\n\n    serverUrl = args.shift();\n    annUrl = args.shift();\n    docUrl = args.shift();\n    offset = args.shift();\n    length = args.shift();\n    docIndex = args.shift();\n\n    var hRequest = __createHandlerRequest(serverUrl, annUrl, docUrl, offset, length);\n\n    if (docIndex !== undefined) {\n      hRequest.info.docIndex = docIndex;\n    }\n\n    __makeHandlerRequestAsync(hRequest, offset >= 0 && length >= 1, callback);\n  }\n\n  function __onAnnotationsLoaded(info) {\n    if (info) {\n      var annsLoadedEvt = {\n        type: 'annotationsloaded',\n        customData: info.customData\n      };\n\n      if (info.layers) {\n        for (var i = 0; i < info.layers.length; i++) {\n          info.offset = info.offset || 0;\n          var fIndex = info.offset + i;\n\n          if (_data.annos[fIndex] && _data.annos[fIndex].length > 0) {\n            _data.annos[fIndex].length = 0;\n          } else {\n            _data.annos[fIndex] = [];\n          }\n\n          var layer = info.layers[i];\n\n          if (layer) {\n            layer._index = isFinite(layer._index) && layer._index >= 0 ? layer._index : fIndex; // workaround to support layer visibility setting that could came from another viewers. set only when explicitly requested.\n\n            layer.visible = layer.visible !== undefined ? layer.visible : true;\n\n            if (layer.items) {\n              for (var j = 0; j < layer.items.length; j++) {\n                layer.items[j].visible = layer.items[j].visible && layer.visible;\n                _data.annos[fIndex][j] = new annotations_Annotation(_wdv, layer.items[j], _data);\n                _data.annos[fIndex][j]._pageindex = layer._index;\n\n                var data = _data.annos[fIndex][j].getClonedData();\n\n                _wdv.trigger({\n                  type: _publicEvents.annoload,\n                  anno: data,\n                  annotation: data,\n                  customData: info.customData\n                });\n\n                __bindAnnoEvents(_data.annos[fIndex][j]);\n              }\n            }\n          }\n        }\n      } else if (info.error) {\n        annsLoadedEvt.error = info.error;\n      }\n\n      annsLoadedEvt.offset = info.offset;\n      annsLoadedEvt.length = info.layers ? info.layers.length : 0;\n\n      _wdv.trigger(annsLoadedEvt);\n    }\n  } // #endregion\n  // #region Input Validation\n  // fixes the stamp annotation config\n\n\n  function __validateStampConfig(cfg) {\n    cfg.type = 'stamp';\n\n    if (cfg.text) {\n      __validateTextConfig(cfg.text); // stamps cannot be edited via UI\n\n\n      cfg.text.readonly = true;\n    }\n\n    return cfg;\n  } // fixes the text properties of an annotation config\n\n\n  function __validateTextConfig(cfg) {\n    if (cfg && cfg.font && cfg.font.size) {\n      // we don't support unit based fonts\n      cfg.font.size = parseFloat(cfg.font.size);\n    }\n\n    return cfg;\n  } // fixes the image annotation config\n\n\n  function __validateImageConfig(cfg) {\n    cfg.type = 'image';\n    return cfg;\n  } // checks that the custom annotation is in good form\n\n\n  function __validateCustomConfig(cfg) {\n    cfg.type = 'custom';\n  } // #endregion\n\n};\n\n/* harmony default export */ var controller_AnnotationController = (AnnotationController_AnnotationController);\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.includes.js\nvar es_array_includes = __webpack_require__(118);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.constructor.js\nvar es_regexp_constructor = __webpack_require__(119);\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.includes.js\nvar es_string_includes = __webpack_require__(122);\n\n// CONCATENATED MODULE: ./src/forms/FormField.js\n\n\n\n\n\n//\n//  Form Field class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t03-28-14\tD. Cilley\t\tFile Created.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//  04-13-15\tA. Huck\t\t\tBug 595087: Changed form element from input[type=text] to textarea if multiline is true.\n//  04-15-15\tA. Huck\t\t\tBug 595087: Added getParentName and getName methods. Added code to propagate changes to multiview form fields.\n//  05-11-15\tA. Daniell\t\tBug 611100: Fixed size of textarea to match 'noScroll' behavior in multiline pdf text form. \n//  05-22-15\tA. Daniell\t\tBug 611100: Added text form data value to store the max height after initial rendering.\n//  06-03-15\tA. Daniell\t\tBug 611100: Added a config option to preserve overflow on load.\n//  06-04-15\tA. Daniell\t\tBug 611100: Added an update to the text data layer on input.\n//\t06-11-15\tA. Huck\t\t\tBug 623575: Added handlers to stop propagation of mousedown and mouseup events.\n//  08-18-15\tA. Huck\t\t\tBug 635762: Added support the maxlength property of text fields.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\nvar FormField_Field = function Field(settings, fdata, pageindex) {\n  var _Fdata = fdata; // form controller data object (do not modify values)\n\n  var _self = this;\n\n  var _jqe = atalaJquery({}); // jquery instance to bind events to\n\n\n  var _jqebound = null; // UI events bound \n\n  var _obj = null; // HTML obj\n\n  var _clone = null;\n  var _pageindex = pageindex;\n  var _data = {\n    // JSON serializable data object for transport to server\n    type: '',\n    backgroundcolor: '',\n    color: null,\n    fieldname: '',\n    hidden: false,\n    isfieldrequired: false,\n    items: null,\n    locked: false,\n    norotate: false,\n    noview: false,\n    nozoom: false,\n    readonly: false,\n    required: false,\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    // this is fields own rotation to compensate pdf page rotation.\n    // we only need to rotate around center here - server will calculate translation.\n    rotation: 0,\n    border: {\n      color: '#000',\n      style: 'none',\n      radius: {\n        vertical: 0,\n        horizontal: 0\n      },\n      width: 0\n    },\n    text: {\n      // text based fields\n      value: null,\n      // text contents!\n      align: 'left',\n      font: {\n        // font props\n        bold: false,\n        italic: false,\n        strike: false,\n        underline: false,\n        color: 'black',\n        family: 'Arial',\n        size: 12,\n        paddingtop: 0,\n        linespacing: 0\n      },\n      ismultiline: false,\n      ispassword: false,\n      isrichtext: false,\n      scrollable: false,\n      maxlength: 0,\n      maximumfieldheight: -1,\n      //-1 = initial load\n      preserveoverflow: false\n    }\n  }; // default properties for specific field types\n\n  var _defaults = {\n    button: {},\n    checkbox: {\n      checked: false,\n      group: null\n    },\n    radio: {\n      checked: false,\n      group: null\n    },\n    textbox: {\n      text: {\n        leftPadding: 2,\n        rightPadding: 2,\n        preserveoverflow: false\n      }\n    },\n    signature: {\n      text: {\n        leftPadding: 2,\n        rightPadding: 2,\n        preserveoverflow: false\n      }\n    },\n    choice: {\n      multiline: false //\t\t\ttext: {\n      //\t\t\t\tpadstart: 3\n      //\t\t\t}\n\n    }\n  }; // default UI event handling \n\n  var _uiEvents = {}; // #region Control Lifecycle\n\n  __init();\n\n  function __init() {\n    _self._pageindex = pageindex;\n\n    __initData(settings.type);\n\n    __setData(settings, true);\n  }\n\n  function __initData(fType) {\n    atalaJquery.extend(true, _data, _defaults[fType]);\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    if (_jqe) {\n      _jqe.off();\n    }\n\n    _Fdata = null;\n    _self = null;\n    _jqe = null;\n    _data = null;\n  } // #endregion\n  // #region Exposed Methods\n\n\n  _self.bind = __bindEvents;\n\n  function __bindEvents() {\n    _jqe.on.apply(_jqe, arguments);\n  }\n\n  _self.unbind = __unbindEvents;\n\n  function __unbindEvents() {\n    _jqe.off.apply(_jqe, arguments);\n  }\n\n  _self.trigger = __triggerEvent;\n\n  function __triggerEvent() {\n    _jqe.trigger.apply(_jqe, arguments);\n\n    return _self;\n  } // map settings onto data\n\n\n  _self.set = __setData;\n\n  function __setData(cfg, deep) {\n    if (cfg) {\n      if (deep) {\n        atalaJquery.extend(true, _data, cfg);\n      } else {\n        atalaJquery.extend(_data, cfg);\n      }\n    }\n  }\n\n  _self.get = __getData;\n\n  function __getData(s) {\n    if (s) {\n      return _data[s];\n    } else {\n      return _data;\n    }\n  }\n\n  _self.setPageIndex = __setPageIndex;\n\n  function __setPageIndex(index) {\n    _pageindex = index;\n\n    if (_self.hasOwnProperty('_pageindex')) {\n      _self._pageindex = index;\n    }\n  }\n\n  function __makeClonedData() {\n    function __removeCloneExtras() {\n      if (_data.update) {\n        delete _data.update;\n      }\n    }\n\n    _clone = {\n      update: function update() {\n        //TODO: check if data changed, and fire a datachanged event\n        atalaJquery.extend(true, _data, _clone);\n\n        __removeCloneExtras();\n\n        __updateView();\n\n        __repaint();\n\n        __rebindUiEvents();\n      }\n    };\n    atalaJquery.extend(true, _clone, _data);\n  }\n\n  _self.getClonedData = __getClonedData;\n\n  function __getClonedData() {\n    if (!_clone) {\n      __makeClonedData();\n    } else {\n      atalaJquery.extend(true, _clone, _data);\n    }\n\n    return _clone;\n  }\n\n  _self.getObject = __getObject;\n\n  function __getObject() {\n    return _obj;\n  }\n\n  _self.getEventObject = __getEventObject;\n\n  function __getEventObject() {\n    return _jqe;\n  }\n\n  _self.getZoom = function () {\n    return _Fdata.zoom;\n  };\n\n  _self.stringify = __stringify;\n  _self.getJSON = __stringify;\n\n  function __stringify() {\n    return JSON.stringify(_data);\n  } // #endregion\n  // browser-independent method for getting the selected text in a input or textarea element.\n  // See: http://stackoverflow.com/a/3373056\n\n\n  function __getTextSelection(element) {\n    var start = 0,\n        end = 0,\n        normalizedValue,\n        range,\n        textInputRange,\n        len,\n        endRange;\n\n    if (typeof element.selectionStart === 'number' && typeof element.selectionEnd === 'number') {\n      start = element.selectionStart;\n      end = element.selectionEnd;\n    } else {\n      range = document.selection.createRange();\n\n      if (range && range.parentElement() === element) {\n        len = element.value.length;\n        normalizedValue = element.value.replace(/\\r\\n/g, '\\n'); // Create a working TextRange that lives only in the input\n\n        textInputRange = element.createTextRange();\n        textInputRange.moveToBookmark(range.getBookmark()); // Check if the start and end of the selection are at the very end\n        // of the input, since moveStart/moveEnd doesn't return what we want\n        // in those cases\n\n        endRange = element.createTextRange();\n        endRange.collapse(false);\n\n        if (textInputRange.compareEndPoints('StartToEnd', endRange) > -1) {\n          start = end = len;\n        } else {\n          start = -textInputRange.moveStart('character', -len);\n          start += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n          if (textInputRange.compareEndPoints('EndToEnd', endRange) > -1) {\n            end = len;\n          } else {\n            end = -textInputRange.moveEnd('character', -len);\n            end += normalizedValue.slice(0, end).split('\\n').length - 1;\n          }\n        }\n      }\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  } // See: http://stackoverflow.com/a/3275506\n\n\n  function __offsetToRangeCharacterMove(element, offset) {\n    return offset - (element.value.slice(0, offset).split('\\r\\n').length - 1);\n  } // Browser-independent function to set the selected text in an input or textarea element\n  // See: http://stackoverflow.com/a/3275506\n\n\n  function __setTextSelection(element, selection) {\n    if (typeof element.selectionStart === 'number' && typeof element.selectionEnd === 'number') {\n      element.selectionStart = selection.start;\n      element.selectionEnd = selection.end;\n    } else {\n      var range = element.createTextRange();\n\n      var startCharMove = __offsetToRangeCharacterMove(element, selection.start);\n\n      range.collapse(true);\n\n      if (selection.start === selection.end) {\n        range.move('character', startCharMove);\n      } else {\n        range.moveEnd('character', __offsetToRangeCharacterMove(element, selection.end));\n        range.moveStart('character', startCharMove);\n      }\n\n      range.select();\n    }\n  } // #region DOM Creation & Events\n  // Since we don't know which drawing surface this field will be drawn\n  // on, we need to create it starts drawing\n  // form: jQuery drawing surface for this form field\n\n\n  function __createField(form) {\n    var fobj = null;\n    var isPasted = false;\n\n    switch (_data.type) {\n      case 'button':\n        fobj = atalaJquery('<button/>');\n        fobj.click(function () {\n          __triggerEvent({\n            type: 'buttonclicked',\n            name: _data.fieldname\n          });\n\n          return false;\n        });\n        break;\n\n      case 'textbox':\n      case 'signature':\n        if (_data.text.multiline) {\n          fobj = atalaJquery('<textarea/>').css('overflow-y', _data.text.scrollable ? 'auto' : 'hidden').css('resize', 'none');\n        } else {\n          fobj = atalaJquery('<input type=\"text\" />');\n        } // Normalizes the _data.text.value. (Fixes some issues caused by how different browsers interpret linebreaks)\n\n\n        _data.text.value = fobj.val(_data.text.value).val();\n        fobj.on('paste', function () {\n          // Used to notify oninput event that onpaste is what caused the value to change\n          isPasted = true;\n          return true;\n        });\n        fobj.on('input', function (e) {\n          if (_data.text.maximumfieldheight === -1) {\n            //initial\n            _data.text.maximumfieldheight = atalaJquery(this).get(0).scrollHeight;\n          }\n\n          var isMaxLength = _data.text.maxlength > 0 && atalaJquery(this).val().length > _data.text.maxlength;\n\n          var isMaxHeight = !_data.text.scrollable && atalaJquery(this).get(0).scrollHeight > _data.text.maximumfieldheight;\n\n          var isAddingText = atalaJquery(this).val().length > _data.text.value.length;\n\n          if (isAddingText && (isMaxLength || isMaxHeight)) {\n            var selection = __getTextSelection(e.target);\n\n            if (isPasted && _data.text.maxlength > 0) {\n              var currValue = atalaJquery(this).val();\n              var isPastingAtEnd = currValue.length === selection.start;\n\n              if (isPastingAtEnd) {\n                // If pasting at the end of the string, all we have to do is make sure to truncate any extra characters at the end.\n                atalaJquery(this).val(currValue.substr(0, _data.text.maxlength));\n              } else {\n                // If pasting within a string (Inserting text) we need to determine how many characters of the pasted text can fit and only insert that many characters.\n                // The length of the string which was pasted.\n                var pastedLength = currValue.length - _data.text.value.length; // The number of remaining characters (I.e. How many more can fit).\n\n                var remainder = _data.text.maxlength - _data.text.value.length; // Get the left string (Beginning, including however many characters in the pasted value can fit within the remaining characters)\n\n                var left = currValue.substr(0, selection.start - pastedLength + remainder); // Get the ending string (Ending text, starting where the pasted text ended).\n\n                var right = _data.text.value.substr(selection.start - pastedLength); // Concatenate them together to get the new value.\n\n\n                atalaJquery(this).val(left + right); // Put the text cursor back where it started (This gets set to the end of the string by the call to .val).\n\n                __setTextSelection(e.target, {\n                  start: left.length,\n                  end: left.length\n                });\n              }\n            } else {\n              atalaJquery(this).val(_data.text.value); //reset to last fitting val\n              // Put the text cursor back where it started (This gets set to the end of the string by the call to .val).\n\n              __setTextSelection(e.target, {\n                start: selection.start - 1,\n                end: selection.start - 1\n              });\n            }\n          }\n\n          if (!_data.text.preserveoverflow && atalaJquery(this).get(0).scrollHeight < _data.text.maximumfieldheight) {\n            //allow maxfieldheight to shrink back to client height(min of scroll height)\n            _data.text.maximumfieldheight = atalaJquery(this).get(0).scrollHeight;\n          }\n\n          _data.text.value = atalaJquery(this).val(); // Reset isPasted.\n\n          isPasted = false;\n        });\n        break;\n\n      case 'checkbox':\n        fobj = atalaJquery('<input type=\"checkbox\" />').prop({\n          name: _data.group,\n          checked: _data.checked\n        });\n        fobj.val(_data.value);\n        break;\n\n      case 'radio':\n        fobj = atalaJquery('<input type=\"radio\" />').prop({\n          name: _data.group,\n          checked: _data.checked\n        });\n        fobj.val(_data.value);\n        break;\n\n      case 'choice':\n        fobj = atalaJquery('<select></select>');\n        fobj.text(_data.value);\n        fobj.attr({\n          multiple: _data.multiple,\n          size: _data.multiline && _data.items ? _data.items.length : 0\n        });\n\n        if (_data.items) {\n          fobj.items = [];\n\n          for (var itemkey in _data.items) {\n            if (_data.items.hasOwnProperty(itemkey)) {\n              var opt = atalaJquery('<option></option>', {\n                selected: _data.items[itemkey].checked,\n                value: _data.items[itemkey].value,\n                text: _data.items[itemkey].text\n              });\n              fobj.append(opt);\n              fobj.items[itemkey] = opt;\n            }\n          }\n        } // this is to force a change event to fire on mouse or touch select for multiline fields\n\n\n        if (_data.multiline && _data.items) {\n          var manualTrigger = function manualTrigger() {\n            atalaJquery(this).trigger('change');\n          };\n\n          fobj.on({\n            mouseup: manualTrigger,\n            touchend: manualTrigger\n          });\n        }\n\n        break;\n\n      case 'generic':\n        fobj = atalaJquery('<div></div>');\n        break;\n    } // generally one time set properties\n\n\n    if (fobj) {\n      if (_data.type === 'textbox' || _data.type === 'signature') {\n        var top = _data.text.font.paddingtop;\n        var lineHeight = _data.text.font.linespacing > 0 ? _data.text.font.linespacing + 'px' : '1.14pt';\n        fobj.css({\n          resize: 'none',\n          position: 'absolute',\n          paddingTop: _data.multiline ? top : 0,\n          paddingBottom: _data.multiline ? '2pt' : 0,\n          lineHeight: lineHeight,\n          margin: 0,\n          '-webkit-box-sizing': 'border-box',\n          '-moz-box-sizing': 'border-box',\n          'box-sizing': 'border-box'\n        });\n      } else {\n        fobj.css({\n          resize: 'none',\n          position: 'absolute',\n          padding: 0,\n          margin: 0,\n          '-webkit-box-sizing': 'border-box',\n          '-moz-box-sizing': 'border-box',\n          'box-sizing': 'border-box'\n        });\n      }\n\n      fobj.on({\n        click: __sp,\n        mousedown: __sp,\n        mouseup: __sp,\n        change: __onFieldChanged,\n        uncheck: __onFieldUnchecked,\n        focusin: __onFieldFocusIn,\n        focusout: __onFieldFocusOut,\n        touchstart: __sp,\n        touchend: __sp\n      });\n    }\n\n    if (form._fields) {\n      form._fields.push(fobj);\n    }\n\n    form.append(fobj);\n    return fobj;\n  }\n\n  function __rebindUiEvents() {\n    if (_jqebound !== null) {\n      // if the data is selectable but the event is not yet bound\n      if (!_data.readonly && _data.selectable) {\n        if (!_uiEvents.isBound('selectable')) {\n          _jqe.on(_uiEvents.selectable);\n\n          _uiEvents.bound('selectable');\n        }\n\n        if (!_data.readonly && _data.movable && !_uiEvents.isBound('movable')) {\n          _jqe.on(_uiEvents.movable);\n\n          _uiEvents.bound('movable');\n        } else if ((_data.readonly || !_data.movable) && _uiEvents.isBound('movable')) {\n          _jqe.off(_uiEvents.movable);\n\n          _uiEvents.unbound('movable');\n        }\n\n        if (Browser.Features.Touch) {\n          if (!_data.readonly && _data.resizable && !_uiEvents.isBound('resizable')) {\n            _jqe.on(_uiEvents.resizable);\n\n            _uiEvents.bound('resizable');\n          } else if ((_data.readonly || !_data.resizable) && _uiEvents.isBound('resizable')) {\n            _jqe.off(_uiEvents.resizable);\n\n            _uiEvents.unbound('resizable');\n          }\n        }\n      } // OR if the data is NOT selectable but the event is still bound\n      else if ((_data.readonly || !_data.selectable) && _uiEvents.isBound('selectable')) {\n          _jqe.off(_uiEvents.selectable);\n\n          _uiEvents.unbound('selectable');\n\n          _jqe.off(_uiEvents.movable);\n\n          _uiEvents.unbound('movable');\n\n          _jqe.off(_uiEvents.resizable);\n\n          _uiEvents.unbound('resizable');\n        }\n    }\n  } // #endregion\n  // gets the parent name of the field (All text appearing before the last '.' in the fieldname proeprty)\n\n\n  _self.getParentName = __getParentName;\n\n  function __getParentName() {\n    var index = _data.fieldname.lastIndexOf('.');\n\n    if (index >= 0) {\n      return _data.fieldname.substr(0, index);\n    }\n\n    return null;\n  } // gets the name of the field (All text appearing after the last '.' in the fieldname proeprty)\n\n\n  _self.getName = __getName;\n\n  function __getName() {\n    var index = _data.fieldname.lastIndexOf('.');\n\n    if (index >= 0) {\n      return _data.fieldname.substr(index + 1);\n    }\n\n    return _data.fieldname;\n  } // #region Interaction Events\n  // updates the data object connected to the DOM field\n\n\n  function __onFieldChanged(e) {\n    var parentName = __getParentName(_data);\n\n    var selectedOptions = [];\n\n    switch (_data.type) {\n      case 'button':\n        break;\n\n      case 'textbox':\n      case 'signature':\n        _data.text.value = this.value; // Check for multiviews and update those with the new value.\n\n        if (_Fdata.multiviewFields.hasOwnProperty(parentName)) {\n          var multiviewFields = _Fdata.multiviewFields[parentName];\n\n          for (var idx in multiviewFields) {\n            if (multiviewFields.hasOwnProperty(idx)) {\n              var multiviewField = multiviewFields[idx];\n\n              if (multiviewField !== _self) {\n                var data = multiviewField.get();\n                data.text.value = this.value;\n                multiviewField.updateView();\n              }\n            }\n          }\n        }\n\n        break;\n\n      case 'checkbox':\n        _data.checked = this.checked;\n\n        if (_data.group && _data.checked) {\n          atalaJquery('input[name=\"' + _data.group + '\"]').trigger('uncheck');\n          _data.checked = true;\n          this.checked = true;\n        }\n\n        break;\n\n      case 'radio':\n        // trigger custom event on all radios in this group to set the data.checked to false\n        if (_data.group) {\n          atalaJquery('input[name=\"' + _data.group + '\"]').trigger('uncheck');\n        }\n\n        _data.checked = this.checked;\n        break;\n\n      case 'choice':\n        if (e.target.selectedOptions !== undefined) {\n          selectedOptions = e.target.selectedOptions;\n        } else {\n          // IE and FF both don't support e.target.selectedOptions.\n          if (e.target.multiple) {\n            for (var i = 0; i < e.target.options.length; i++) {\n              if (e.target.options[i].selected) {\n                selectedOptions.push(e.target.options[i]);\n              }\n            }\n          } else if (e.target.selectedIndex >= 0) {\n            selectedOptions.push(e.target.options[e.target.selectedIndex]);\n          }\n        }\n\n        for (var itemIndex in _data.items) {\n          if (_data.items.hasOwnProperty(itemIndex)) {\n            var item = _data.items[itemIndex];\n            item.checked = false;\n\n            for (var optionIndex in selectedOptions) {\n              if (selectedOptions.hasOwnProperty(optionIndex)) {\n                var option = selectedOptions[optionIndex];\n\n                if (option.value === item.value) {\n                  item.checked = true;\n                }\n              }\n            }\n          }\n        }\n\n        break;\n    }\n  }\n\n  function __onFieldUnchecked(e) {\n    if (e.target.type === 'checkbox') {\n      e.target.checked = false;\n    }\n\n    _data.checked = false;\n  }\n\n  function __onFieldFocusIn() {\n    __updateDefaultValue(true);\n\n    __triggerEvent({\n      type: 'fieldfocusin',\n      field: _self\n    });\n  }\n\n  function __onFieldFocusOut() {\n    __updateDefaultValue(false);\n\n    __triggerEvent({\n      type: 'fieldfocusout',\n      field: _self\n    });\n  } // #endregion\n  // #region DOM Updates\n\n\n  _self.repaint = __repaint;\n\n  function __repaint(form) {\n    // repaint called with form means that we need to draw it again\n    if (form && typeof form === 'object') //jquery-ui-1.13 defines function _form(), so check that form is not this function.\n      {\n        _obj = __createField(form);\n        _obj.zoom = __zoomField;\n\n        __updateView(); // annotation view is on a new paper so we notify with viewchanged\n\n\n        __triggerEvent({\n          type: 'viewchanged',\n          fieldview: _obj\n        });\n      }\n\n    __triggerEvent('repaint');\n  }\n\n  _self.updateView = __updateView;\n\n  function __updateView() {\n    if (_obj) {\n      if (_data.hidden || _data.noview) {\n        _obj.hide(); // nothing left to do if it's not visible\n\n\n        return;\n      } else {\n        _obj.show();\n      }\n\n      var css = atalaJquery.extend({}, __getTransformCss(), __getStyleCss());\n\n      _obj.css(css);\n\n      __updateHighlight();\n\n      __updateReadOnly();\n\n      if (_data.type === 'textbox') {\n        __updateDefaultValue(_obj.is(':focus'));\n      } else if (_data.type === 'button') {\n        _obj.text(_data.text.value);\n      }\n    }\n  }\n\n  function __getStyleCss() {\n    var underlined = _data.border && _data.border.style === 'underline';\n    return {\n      backgroundColor: _data.backgroundcolor,\n      color: _data.color || _data.text.font.color,\n      borderStyle: _data.border && _data.border.style && !underlined ? _data.border.style : 'none',\n      borderBottomStyle: underlined ? 'solid' : 'inherit',\n      borderColor: _data.border ? _data.border.color : null,\n      fontFamily: _data.text.font.family,\n      fontStyle: _data.text.font.italic ? 'italic' : _data.text.font.oblique ? 'oblique' : 'normal',\n      fontWeight: _data.text.font.bold ? 'bold' : '',\n      textAlign: _data.text.align\n    };\n  }\n\n  function __getTransformCss() {\n    var m = _Fdata.getViewerTransform(_pageindex),\n        tl = FormField_transformPoint(m, _data.x, _data.y),\n        br = FormField_transformPoint(m, _data.x + _data.width, _data.y + _data.height);\n\n    var z = _Fdata.getZoom(_pageindex);\n\n    var width = _data.width * z;\n    var height = _data.height * z;\n    var loc = {\n      x: (tl.x + br.x - width) / 2,\n      y: (tl.y + br.y - height) / 2\n    };\n\n    var angle = _Fdata.getPageRotation(_pageindex) + _data.rotation;\n\n    var transform = 'rotate(' + angle + 'deg)';\n    var css = {\n      'left': Math.round(loc.x) + 'px',\n      'top': Math.round(loc.y) + 'px',\n      'width': width + 'px',\n      'height': height + 'px',\n      'max-width': width + 'px',\n      'max-height': height + 'px'\n    };\n    var fieldTransform = angle !== 0 ? __htmlTransformStyle(transform) : __htmlTransformStyle('');\n    atalaJquery.extend(css, fieldTransform);\n\n    if (_data.type === 'textbox' || _data.type === 'signature') {\n      css.cursor = angle % 180 === 0 ? 'text' : 'vertical-text';\n    }\n\n    css.visibility = 'visible';\n    return css;\n  }\n\n  function __updateDefaultValue(focused) {\n    if (_data.type === 'textbox') {\n      if (!focused) {\n        if (!_data.text.value) {\n          _obj.val(_data.text.defaultvalue); // TODO: change color to be lighter\n\n        } else if (_obj.val() !== _data.text.value) {\n          _obj.val(_data.text.value);\n        }\n      }\n    }\n  }\n\n  function __updateHighlight() {\n    if (_Fdata.highlighted) {\n      _obj.addClass('atala-ui-form-highlight');\n\n      if (_data.required) {\n        _obj.addClass('atala-ui-form-required');\n      } else {\n        _obj.removeClass('atala-ui-form-required');\n      }\n    } else {\n      _obj.removeClass('atala-ui-form-highlight');\n    }\n  }\n\n  function __updateReadOnly() {\n    if (_data.readonly) {\n      _obj.attr('readonly', 'readonly');\n    } else {\n      _obj.removeAttr('readonly');\n    }\n  }\n\n  _self.zoom = __zoomField;\n\n  function __zoomField(z) {\n    z = z || _Fdata.getZoom(_pageindex);\n\n    _obj.css({\n      fontSize: Math.round((_data.text.font.size || 12) * z * (_Fdata.dpi / 96)),\n      borderWidth: _data.border ? Math.round(_data.border.width * z) : 0\n    });\n\n    if (_data.text && _data.text.align) {\n      _obj.css({\n        paddingLeft: _data.text.leftPadding * z + 'px',\n        paddingRight: _data.text.rightPadding * z + 'px'\n      });\n    }\n\n    __updateView();\n  }\n\n  return _self;\n};\n\nfunction FormField_transformPoint(matrix, x, y) {\n  return {\n    x: matrix.x(x, y),\n    y: matrix.y(x, y)\n  };\n}\n\n/* harmony default export */ var FormField = (FormField_Field);\n// CONCATENATED MODULE: ./src/controller/FormController.js\n\n\n\n\n\n\n\n\n//\n//  Form Controller class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t03-07-14\tD. Cilley\t\tFile Created.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//  04-13-15\tA. Huck\t\t\tBug 595087: Bound the WDV scroll event to force a call to focusOut (Triggering a save on form data)\n//  04-15-15\tA. Huck\t\t\tBug 595087: Added multiviewFields dictionary to _data and initialized in __onFieldsLoaded.\n//\t07-02-15\tD. Cilley\t\tBug 625845: Added dispose method.\n//\t09-01-15\tD. Cilley\t\tTask 630965: Added event bind tracking and intellisense.\n//-------------------------------------------------------------------------------------------------\n\n\n // wdv: parent WebDocumentViewer object\n// internals: internal functions and objects from the WDV\n// readonly: form elements are only shown\n// ignoring FormsController from documentation - it's look not complete and not very useful for user since\n// we cant modify and generate forms now. But Api flexibility is now similar to annotations.\n\n/**\r\n * WebDocumentViewer PDF Forms API.\r\n * @class\r\n * @inner\r\n * @name FormController\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n * @ignore\r\n */\n\nvar FormController_FormController = function FormController(wdv, internals, readonly) {\n  var _self = this;\n\n  var _wdv = wdv;\n  var _wdvInternals = internals;\n  var _exposedApi = {\n    forms: {\n      events: {\n        /** Triggers when the user uses the mouse to click on a field. Populated keys: e.field */\n        fieldclicked: null,\n\n        /** Triggers when the user uses the mouse to create a field. Populated keys: e.field */\n        fieldcreated: null,\n\n        /** Triggers when the user uses the mouse to double-click on a field. Populated keys: e.field */\n        fielddoubleclicked: null,\n\n        /** Triggers when a field is loaded into the document. Populated keys: e.field */\n        fieldloaded: null,\n\n        /** Triggers when the user has depressed a mouse button on a field. Populated keys: e.field */\n        fieldmousedown: null,\n\n        /** Triggers when the user has depressed the left mouse button on a field. Populated keys: e.field */\n        fieldmousedownleft: null,\n\n        /** Triggers when the user has depressed the right mouse button on a field. Populated keys: e.field */\n        fieldmousedownright: null,\n\n        /** Triggers when the user moves the mouse pointer over a field. Populated keys: e.field */\n        fieldmousemove: null,\n\n        /** Triggers when the user has moved the mouse pointer out of the bounds of the field. Populated keys: e.field */\n        fieldmouseout: null,\n\n        /** Triggers when the user has moved the mouse pointer into the bounds of the field. Populated keys: e.field */\n        fieldmouseover: null,\n\n        /** Triggers when the user has released a mouse button on a field. Populated keys: e.field */\n        fieldmouseup: null,\n\n        /** Triggers when a field has been moved. Populated keys: e.field */\n        fieldmoved: null,\n\n        /** Triggers when a pinch gesture has been detected on a field. Populated keys: e.field */\n        fieldpinchresize: null,\n\n        /** Triggers when a field has been repainted. Populated keys: e.field */\n        fieldrepainted: null,\n\n        /** Triggers when a field has been resized. Populated keys: e.field */\n        fieldresized: null,\n\n        /** Triggers when the user right clicks on a field. Populated keys: e.field */\n        fieldrightclicked: null,\n\n        /** Triggers when a touch end event has finished on a field. Populated keys: e.field */\n        fieldtouchend: null,\n\n        /** Triggers when a touch move event is happening on a field. Populated keys: e.field */\n        fieldtouchmove: null,\n\n        /** Triggers when a touch event has started on a field. Populated keys: e.field */\n        fieldtouchstart: null\n      },\n      createOnPage: __createFieldPublic,\n      deleteFromPage: __deleteFieldPublic,\n      getFromPage: __getFieldsFromPagePublic,\n      insertForm: __insertFormPublic,\n      moveForm: __moveFormPublic,\n      removeForm: __removeFormPublic\n    }\n  };\n  FormController.__exposedApi = _exposedApi.forms; // we call this function without params to establish intellisense API\n\n  if (!wdv) {\n    return null;\n  }\n\n  var _pages = internals._pages; // internal pageDiv array from the WDV\n\n  var _vp = null; // viewport object\n\n  var _data = {\n    // data object for controller properties\n    fields: [],\n    // array of arrays with fields that have been added or changed since loading or saving\n    multiviewFields: {},\n    // dictionary mapping parent names to multiview children.\n    activepage: null,\n    // active page\n    activefield: null,\n    // active form field\n    highlighted: true,\n    readonly: readonly ? true : false,\n    getZoom: _wdvInternals.getPageScale,\n    getViewerTransform: _wdvInternals.getViewerTransform,\n    getPageRotation: _wdvInternals.getPageRotation,\n    dpi: 96\n  };\n  var _defaults = {}; // form defaults object\n\n  var _drawing = false; // flag indicating if the controller is waiting to finish drawing\n\n  var _drawReady = false; // flag indicating if the controller is ready to start drawing\n\n  var _lastFieldFocusInEvent = null; // the last focusin event that was triggered by a field.\n\n  var _publicEvents = {\n    click: 'fieldclicked',\n    dblclick: 'fielddoubleclicked',\n    touchstart: 'fieldtouchstart',\n    interactend: 'fieldtouchend',\n    touchmove: 'fieldtouchmove',\n    pinchmove: 'fieldpinchresize',\n    rightclick: 'fieldrightclicked',\n    mousedown: 'fieldmousedown',\n    mousedownleft: 'fieldmousedownleft',\n    mousedownright: 'fieldmousedownright',\n    mousemove: 'fieldmousemove',\n    mouseout: 'fieldmouseout',\n    mouseup: 'fieldmouseup',\n    mouseover: 'fieldmouseover',\n    create: 'fieldcreated',\n    load: 'fieldloaded',\n    moved: 'fieldmoved',\n    resized: 'fieldresized',\n    repaint: 'fieldrepainted'\n  };\n  var genNamesPrefix = '<~Atala_Unnamed_';\n  var __multiPageFields = []; // #region Control LifeCycle\n\n  function __initForms() {\n    _wdv.bind({\n      pagerecycled: __recycleForm,\n      pageshown: __pageShown,\n      zoomchanged: __zoomChanged,\n      pagerotated: __rotateForm\n    });\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    _self = null;\n    _wdv = null;\n    _wdvInternals = null;\n    _pages = null;\n    _vp = null;\n    _data.fields.length = 0;\n    _data.multiviewFields = null;\n    _data.activepage = null;\n    _data.activefield = null;\n  } // #endregion\n  // #region Extend WDV\n  // adds Forms specific methods to WDV \n\n\n  function __extendWDV() {\n    if (_wdv.typeOf === 'Atalasoft.Controls.WebDocumentViewer') {\n      atalaJquery.extend(_wdv, _exposedApi);\n    }\n  } // event fires when the WDV has finished zooming\n\n\n  function __zoomChanged() {} // #endregion\n  // #region Page Methods\n  // sets up a new layer to put form fields on\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  _self.addFormLayer = __initForm;\n\n  function __initForm(pg) {\n    if (pg instanceof atalaJquery) {\n      pg._form = _wdvInternals.createDiv(pg);\n\n      pg._form.css({\n        position: 'absolute',\n        zIndex: 4\n      }); // array of form fields currently shown on this page\n\n\n      pg._form._fields = []; // need a reference to the 'parent' object\n\n      pg._form._page = pg;\n\n      var setActivePage = function setActivePage() {\n        __setActivePage(pg);\n      };\n\n      pg.on('mousedown', setActivePage);\n\n      if (Browser.Features.Touch) {\n        pg.on('touchstart', setActivePage);\n      }\n\n      pg.on({\n        pageresize: function pageresize(e) {\n          e.page = pg;\n\n          __resizeForm(e);\n        },\n        pagezoom: function pagezoom(e) {\n          e.page = pg;\n\n          __zoomForm(e);\n        }\n      });\n      return true;\n    }\n\n    return false;\n  } // inserts a new form layer into the document\n  // sourceUrl: string, relative url to get the form data from\n  // source: number or layer, index of the form in the source document\n  // index: number, layer index to insert the form into\n\n\n  _self.insertForm = __insertForm;\n\n  function __insertForm(sourceUrl, source, index) {\n    if (sourceUrl == null && typeof source === 'number') {\n      source = __removeForm(source);\n    }\n\n    source = source || [];\n\n    if (index == null) {\n      index = _data.fields.length;\n    } else if (index < 0) {\n      index = 0;\n    }\n\n    if (index > _data.fields.length) {\n      var oldLength = _data.fields.length;\n      _data.fields[index] = source;\n\n      for (var i = oldLength; i < _data.fields.length; ++i) {\n        if (!_data.fields[i]) {\n          _data.fields[i] = [];\n        }\n      }\n    } else {\n      _data.fields.splice(index, 0, source);\n    }\n  } // removes a form from the document\n  // index: number, page index to remove the form from\n\n\n  _self.removeForm = __removeForm;\n\n  function __removeForm(index) {\n    if (index < _data.fields.length) {\n      return _data.fields.splice(index, 1)[0];\n    }\n\n    return null;\n  } // moves a form at source index to the destination index\n  // sourceIndex: number, original index of the form to move\n  // destIndex: number, destination index to move the form to\n\n\n  _self.moveForm = __moveForm;\n\n  function __moveForm(sourceIndex, index) {\n    __insertForm(null, __removeForm(sourceIndex), index);\n  } // removes the form layer\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  _self.removeFormLayer = __disposeForm;\n\n  function __disposeForm(pg) {\n    if (pg instanceof atalaJquery) {\n      if (pg._form) {\n        pg._form._fields = null;\n        pg._form._page = null;\n        pg._form = null;\n      }\n\n      return true;\n    }\n\n    return false;\n  } // shows fields that correspond to the given page\n\n\n  _self.showLayer = __showLayer;\n\n  function __showLayer(index, page) {\n    if (index < _data.fields.length && _data.fields[index] && _data.fields[index].length) {\n      var field;\n\n      __clearPage(page);\n\n      for (var i = 0; i < _data.fields[index].length; i++) {\n        field = _data.fields[index][i];\n        field.setPageIndex(index);\n        field.repaint(page._form);\n      }\n    }\n  }\n\n  function __clearPage(page) {\n    if (page._form && page._form._fields) {\n      // remove all fields\n      page._form._fields.length = 0;\n\n      page._form.empty();\n    }\n  } // e.index: index of the shown page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __pageShown(e) {\n    __showLayer(e.index, e.page);\n  } // blurs the current focus, if any. Used to force the focusOut event to fire (Saves field from view to data layer)\n  // Bound to the scroll event on the WDV to fix an issue where form data clears and is not saved when scrolling occurs.\n\n\n  function __forceUnfocus() {\n    if (_lastFieldFocusInEvent.field != null) {\n      _lastFieldFocusInEvent.field.getObject()[0].blur();\n    }\n  } // recycles form by clearing the page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __recycleForm(e) {\n    if (e.page._form) {\n      __clearPage(e.page); //TODO: check to see if we need to re-add this form to the page\t\t\n      //e.page.append(e.page._form);\n\n    }\n  }\n\n  function __resizeForm(e) {\n    __updatePageFields(e.page);\n  } // sets the active page of the controller\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  function __setActivePage(pg) {\n    _data.activepage = pg;\n  }\n\n  function __zoomForm(e) {\n    for (var key in e.page._form._fields) {\n      if (e.page._form._fields.hasOwnProperty(key)) {\n        e.page._form._fields[key].zoom(_wdvInternals.getPageScale(e.index));\n      }\n    }\n  }\n\n  function __rotateForm(e) {\n    __updatePageFields(e.page);\n  }\n\n  function __updatePageFields(page) {\n    if (page) {\n      if (_data.fields.length && _data.fields[page._index]) {\n        for (var i = 0; i < _data.fields[page._index].length; i++) {\n          _data.fields[page._index][i].updateView();\n        }\n      }\n    }\n  } // #endregion\n  // #region WDV Exposed Methods\n  // Need a public facing function to return a clone, not internal form object.\n\n  /**\r\n   * Creates a field on the desired page with the given field data.\r\n   * @param fConfig: object, Key value pairs representing field data.\r\n   * @param pgNum: number, The zero based index of the page the field should be created on.\r\n   * @param callback: function, Function to be called when the operation has completed.\r\n   * @returns object, Key value pairs representing field data.\r\n   */\n\n\n  function __createFieldPublic(fConfig, pgNum, callback) {\n    var clonedField = __createField(fConfig, pgNum, callback).getClonedData();\n\n    _wdv.trigger({\n      type: _publicEvents.fieldcreate,\n      field: clonedField\n    });\n\n    return clonedField;\n  }\n  /**\r\n   * Deletes a field on the given z-index and zero based page index.\r\n   * @param pgNum: number, Zero based page index the field is located on.\r\n   * @param fieldIndex: number, Zero based z-index of the field.\r\n   */\n\n\n  function __deleteFieldPublic(pgNum, fieldIndex) {\n    __deleteFieldAtIndex(fieldIndex, pgNum);\n  }\n  /**\r\n   * Gets an array of field data objects located on the given zero based page index.\r\n   * @param pageNum: number, Zero based page index the fields are located on.\r\n   * @returns array: Array of field data objects on the given page index. \r\n   */\n\n\n  function __getFieldsFromPagePublic(pageNum) {\n    var fieldArray = [];\n\n    if (_data.fields.length === 0 || _data.fields[pageNum] === undefined) {\n      return fieldArray;\n    }\n\n    for (var i = 0; i < _data.fields[pageNum].length; i++) {\n      fieldArray[i] = _data.fields[pageNum][i].getClonedData();\n    }\n\n    return fieldArray;\n  }\n  /**\r\n   * Inserts a form from the source URL and index into the given page index.\r\n   * @param sourceUrl: string, Url of the desired form.\r\n   * @param sourceIndex: number, Zero based page index the form is copied from.\r\n   * @param index: number, Zero based page index the form is to be inserted into.\r\n   * @param callback: function, Function to be called when the operation has completed.\r\n   */\n\n\n  function __insertFormPublic(sourceUrl, sourceIndex, index, callback) {\n    __insertForm(sourceUrl, sourceIndex, index);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.forminserted,\n      srcurl: sourceUrl,\n      srcindex: sourceIndex,\n      index: index\n    });\n\n    _wdv.trigger(_publicEvents.formschanged);\n  }\n  /**\r\n   * Removes a form from the given page index.\r\n   * @param index: number, Zero based page index of the form to be removed.\r\n   * @param callback: function, Function to be called when the operation has completed.\r\n   */\n\n\n  function __removeFormPublic(index, callback) {\n    __removeForm(index);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.formremoved,\n      index: index\n    });\n\n    _wdv.trigger(_publicEvents.formschanged);\n  }\n  /**\r\n   * Moves a form from one page index to another.\r\n   * @param sourceIndex: number, Zero based page index of the form to be moved.\r\n   * @param destIndex: number, Destination zero based page index.\r\n   * @param callback: function, Function to be called when the operation has completed.\r\n   */\n\n\n  function __moveFormPublic(sourceIndex, destIndex, callback) {\n    __moveForm(sourceIndex, destIndex);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger({\n      type: _publicEvents.formmoved,\n      srcindex: sourceIndex,\n      destindex: destIndex\n    });\n\n    _wdv.trigger(_publicEvents.formschanged);\n  } // #endregion\n  // #region Controller Level Exposed Methods\n  // overwrite instance public API to point to same data as internal API. otherwise exception is not clear since data is captured from shared closure\n\n\n  _self.__exposedApi = _exposedApi.forms;\n  _self.__getDebugInfo = __getDebugInfo;\n  _self.__linkForms = __linkForms;\n  _self.clear = __clearForms;\n  _self.createField = __createField;\n  _self.deleteFieldOnPage = __deleteFieldPublic;\n  _self.getFieldsFromPage = __getFieldsFromPagePublic;\n  _self.setViewPort = __setViewPort;\n\n  function __getDebugInfo() {\n    var info = {};\n    atalaJquery.extend(true, info, {\n      data: _data,\n      pages: _pages,\n      viewport: _vp\n    });\n    return info;\n  }\n\n  function __linkForms(linker) {\n    if (linker) {\n      if (!linker._fields) {\n        linker._fields = _data.fields;\n      } else if (Array.isArray(linker._fields)) {\n        _data.fields = linker._fields;\n      }\n    }\n  }\n\n  function __clearForms() {\n    if (_data.fields.length > 0) {\n      _data.fields.length = 0;\n\n      if (_pages) {\n        for (var i = 0; i < _pages.length; i++) {\n          // remove all objects\n          __clearPage(_pages[i]);\n        }\n      }\n\n      _wdv.trigger({\n        type: 'formscleared'\n      });\n    }\n  } // fConfig: key value pairs sent\n  // pgNum: the index of the page the field should be created on\n\n\n  function __createField(fConfig, pgNum, callback) {\n    var fieldConfig = {};\n\n    if (fConfig && fConfig.type && _defaults[fConfig.type]) {\n      atalaJquery.extend(true, fieldConfig, _defaults[fConfig.type]);\n    }\n\n    atalaJquery.extend(true, fieldConfig, fConfig);\n    var newField = new FormField(fieldConfig, _data, pgNum);\n\n    if (_data.fields[pgNum] === undefined) {\n      _data.fields[pgNum] = [];\n    }\n\n    _data.fields[pgNum].push(newField);\n\n    _wdvInternals.redrawVisiblePages();\n\n    if (typeof callback === 'function') {\n      callback(newField);\n    }\n\n    __bindFieldEvents(newField);\n\n    return newField;\n  }\n\n  function __deleteFieldAtIndex(fieldIndex, pgNum) {\n    var delField = _data.fields[pgNum].splice(fieldIndex, 1)[0];\n\n    if (_data.activepage) {\n      _data.activepage._form._fields.splice(fieldIndex, 1);\n    }\n\n    delField.dispose();\n\n    _wdv.trigger({\n      type: 'fielddeleted',\n      page: pgNum,\n      index: fieldIndex\n    });\n  }\n\n  function __setViewPort(obj) {\n    if (obj) {\n      if (!(obj instanceof atalaJquery)) {\n        obj = atalaJquery(obj);\n      }\n\n      _vp = obj;\n    }\n  } // #endregion\n  // #region Field Drawing\n  // sets up the viewport to create a form field with the mouse\n  // fConfig: key value pairs sent from button/function call\n  // callback: function to call when the field has finished drawing\n  // cancelled: function to call when the field draw was cancelled\n\n\n  _self.drawField = __drawField;\n\n  var __fieldCreatedCallback = function __fieldCreatedCallback() {}; // eslint-disable-next-line no-unused-vars\n\n\n  function __drawField(fConfig, callback) {\n    // if we're still drawing, don't draw another one\n    if (_drawing) {\n      return null;\n    } // starts with default field, and overlays button defaults\n\n\n    if (fConfig && fConfig.type && _defaults[fConfig.type]) {\n      atalaJquery.extend(true, fConfig, _defaults[fConfig.type]);\n    } // previous field was never added to anything, we should dispose of it\n\n\n    if (_data.activefield && _data.activefield.getObject() === null) {\n      __cancelField();\n    } // prepare drawing surfaces\n\n\n    __prepareForDraw(); // create the new field from data\n\n\n    _data.activefield = new FormField(fConfig, _data, _data.activepage ? _data.activepage._index : undefined);\n\n    _data.activefield.bind({\n      drawn: __finishField,\n      cancelled: __cancelField\n    });\n\n    if (typeof callback === 'function') {\n      __fieldCreatedCallback = callback;\n    }\n\n    return _data.activefield;\n  } // prepares all pages for drawing, since we don't know where the user will draw\n\n\n  function __prepareForDraw() {\n    if (!_drawReady) {\n      _vp.on('mousedown', __startFieldDraw);\n\n      if (Browser.Features.Touch) {\n        _vp.on('touchstart', __startFieldDraw);\n      }\n\n      for (var i = 0; i < _pages.length; i++) {\n        _pages[i]._draw.toFront();\n      }\n\n      _drawReady = true;\n    }\n  } // resets all pages to state before prepareForDraw was called\n\n\n  function __cleanupDraw() {\n    if (_drawReady) {\n      _vp.off('mousedown', __startFieldDraw);\n\n      if (Browser.Features.Touch) {\n        _vp.off('touchstart', __startFieldDraw);\n      }\n\n      for (var i = 0; i < _pages.length; i++) {\n        _pages[i]._draw.reset();\n      }\n\n      _drawReady = false;\n    }\n  } // draws a form field with the mouse\n\n\n  function __startFieldDraw(e) {\n    _drawing = true; // don't want to start drawing this field again if another mousedown happens'\n\n    _vp.off('mousedown', __startFieldDraw);\n\n    if (Browser.Features.Touch) {\n      _vp.off('touchstart', __startFieldDraw);\n    }\n\n    _wdv.trigger({\n      type: 'fielddrawstart',\n      field: _data.activefield.getClonedData()\n    });\n\n    _data.activefield._pageindex = _data.activepage._index;\n\n    _data.activefield.startDraw(e, _data.activepage._form, {});\n  }\n\n  function __finishField() {\n    __fieldCreated(_data.activefield);\n\n    __finishDrawing();\n  }\n\n  function __cancelField() {\n    _data.activefield.dispose();\n\n    _data.activefield = null;\n\n    if (_drawing) {\n      __finishDrawing(true);\n    }\n  }\n\n  function __finishDrawing(cancelled) {\n    _drawing = false;\n\n    __cleanupDraw();\n\n    _wdv.trigger({\n      type: 'fielddrawend',\n      field: cancelled ? null : _data.activefield.getClonedData(),\n      cancelled: cancelled ? true : false\n    });\n  }\n\n  function __onFieldFocusIn(e) {\n    _lastFieldFocusInEvent = e;\n\n    _wdv.bind('scroll', __forceUnfocus);\n  }\n\n  function __onFieldFocusOut() {\n    _wdv.unbind('scroll', __forceUnfocus);\n  }\n\n  function __fieldCreated(field) {\n    var page = _data.activepage;\n    var pindex = page ? page._index : 0;\n\n    if (_data.fields[pindex]) {\n      _data.fields[pindex].push(field);\n    } else {\n      _data.fields[pindex] = [field];\n    } // TODO: add drawing methods\t\t\n\n\n    _data.activefield.unbind({//\t\t\tdrawn: __finishField,\n      //\t\t\tcancelled: __cancelField\n    });\n\n    __bindFieldEvents(_data.activefield); // call the callback, and set it back to empty\n\n\n    __fieldCreatedCallback({\n      field: field\n    });\n\n    __fieldCreatedCallback = function __fieldCreatedCallback() {};\n\n    _wdv.trigger({\n      type: _publicEvents.fieldcreate,\n      field: field.getClonedData()\n    });\n  } // #endregion\n  // #region Field Events\n\n\n  function __bindFieldEvents(field) {\n    function __triggerPublicEvent(e) {\n      _wdv.trigger({\n        type: _publicEvents[e.type],\n        field: field.getClonedData()\n      });\n    }\n\n    field.bind({\n      interactstart: function interactstart() {\n        if (!_data.activepage || _data.activepage._form !== field.getObject().form) {\n          __setActivePage(field.getObject().form._page);\n        }\n\n        _data.activefield = field;\n      },\n      moved: __triggerPublicEvent,\n      resized: __triggerPublicEvent,\n      interactend: __triggerPublicEvent,\n      touchstart: __triggerPublicEvent,\n      touchmove: __triggerPublicEvent,\n      pinchmove: __triggerPublicEvent,\n      click: __triggerPublicEvent,\n      dblclick: __triggerPublicEvent,\n      rightclick: __triggerPublicEvent,\n      mousedown: __triggerPublicEvent,\n      mousedownleft: __triggerPublicEvent,\n      mousedownright: __triggerPublicEvent,\n      mousemove: __triggerPublicEvent,\n      mouseout: __triggerPublicEvent,\n      mouseup: __triggerPublicEvent,\n      mouseover: __triggerPublicEvent,\n      repaint: __triggerPublicEvent,\n      fieldfocusin: __onFieldFocusIn,\n      fieldfocusout: __onFieldFocusOut\n    });\n  } // #endregion\n  // #region Ajax/Json Methods\n\n\n  _self.stringifyChanges = __stringifyChanges; //Define the multiview fields which are located on different pages\n\n  function __getMultiPageFieldNames() {\n    var arr = [];\n\n    for (var key in _data.multiviewFields) {\n      if (_data.multiviewFields[key].every(isLinkedToPage)) {\n        arr.push(key);\n      }\n    }\n\n    return arr;\n  }\n\n  function isLinkedToPage(field) {\n    var num = -1;\n    var fieldName = field.getName();\n    var re = new RegExp(genNamesPrefix + '(\\\\d+)');\n    var result = fieldName.match(re) || [];\n\n    if (result.length > 0) {\n      num = result[1];\n    }\n\n    return field._pageindex === parseInt(num);\n  }\n\n  function __stringifyChanges() {\n    var arr = {};\n    var hasData = false;\n    var counter = 0;\n\n    for (var key in _data.fields) {\n      if (_data.fields.hasOwnProperty(key) && _data.fields[key].length > 0) {\n        arr[key] = [];\n\n        for (var z in _data.fields[key]) {\n          if (_data.fields[key].hasOwnProperty(z)) {\n            hasData = true;\n\n            var fieldData = _data.fields[key][z].get();\n\n            if (fieldData.fieldname.indexOf(genNamesPrefix) > 0) {\n              var parentName = _data.fields[key][z].getParentName(); //Multipage field found and it is linked to other page\n\n\n              if (__multiPageFields.includes(parentName)) {\n                var re = new RegExp(genNamesPrefix + '(\\\\d+)');\n                fieldData.fieldname = fieldData.fieldname.replace(re, genNamesPrefix + counter);\n              }\n            }\n\n            arr[key][z] = fieldData;\n          }\n        }\n\n        counter++;\n      }\n    }\n\n    return hasData ? JSON.stringify({\n      forms: {\n        fields: arr\n      }\n    }) : undefined;\n  } // adds an unnamed field to the multiview set of its parent.\n\n\n  function __applyMultiview(field) {\n    var parentName = field.getParentName();\n    var fieldName = field.getName();\n\n    if (fieldName.indexOf(genNamesPrefix) >= 0) {\n      if (_data.multiviewFields.hasOwnProperty(parentName)) {\n        _data.multiviewFields[parentName].push(field);\n      } else {\n        _data.multiviewFields[parentName] = [field];\n      }\n    }\n  }\n\n  _self.createHandlerRequest = __createHandlerRequest; // formUrl should stay second parameter for generic document loading code in viewer\n\n  function __createHandlerRequest(serverUrl, formUrl, docurl, offset, length) {\n    docurl = docurl || _wdv.config.documenturl;\n    var hRequest = {\n      type: 'formdata',\n      serverurl: serverUrl,\n      query: '?atalaformdata=',\n      method: 'GET',\n      data: {\n        atala_formurl: formUrl,\n        atala_docurl: docurl,\n        atala_a_ofs: offset,\n        atala_a_len: length\n      },\n      cancel: false,\n      info: {\n        fields: [],\n        length: length,\n        error: undefined\n      }\n    }; // workaround for IE that encodes null as string\n\n    for (var key in hRequest.data) {\n      if (hRequest.data.hasOwnProperty(key) && hRequest.data[key] === null) {\n        hRequest.data[key] = undefined;\n      }\n    }\n\n    return hRequest;\n  }\n\n  _self.makeHandlerRequest = __makeHandlerRequestAsync;\n\n  function __makeHandlerRequestAsync(hRequest, preserveExisting, callback) {\n    if (typeof preserveExisting === 'function') {\n      callback = preserveExisting;\n      preserveExisting = false;\n    }\n\n    if (!preserveExisting) {\n      __clearForms();\n    } // defined inline so we have a closure reference to callback\n\n\n    function __complete(info) {\n      if (hRequest.info.docIndex !== undefined) {\n        info.offset = hRequest.info.docIndex;\n      } // we assume that all requests made through this method are for fields\n\n\n      __onFieldsLoaded(info); // only execute the callback if it exists\n\n\n      if (typeof callback === 'function') {\n        callback.call(undefined, info.error, info);\n      }\n    }\n\n    _wdvInternals.makeHandlerRequest(hRequest, __complete, __complete);\n  } // contacts the server for form info, JSON is returned to __onFieldsLoaded\n\n\n  _self.loadFormUrl = __loadFieldsAsync;\n\n  function __loadFieldsAsync(serverUrl, formUrl, docUrl, offset, length, docIndex, callback) {\n    var args = Array.prototype.slice.call(arguments);\n    callback = args.pop();\n\n    if (typeof callback !== 'function') {\n      args.push(callback);\n    }\n\n    serverUrl = args.shift();\n    formUrl = args.shift();\n    docUrl = args.shift();\n    offset = args.shift();\n    length = args.shift();\n    docIndex = args.shift();\n\n    var hRequest = __createHandlerRequest(serverUrl, formUrl, docUrl, offset, length);\n\n    if (docIndex !== undefined) {\n      hRequest.info.docIndex = docIndex;\n    }\n\n    __makeHandlerRequestAsync(hRequest, offset >= 0 && length >= 1, callback);\n  }\n\n  _self.loadForms = __onFieldsLoaded;\n\n  function __onFieldsLoaded(info) {\n    if (info) {\n      var fieldsLoadedEvt = {\n        type: 'formsloaded',\n        forms: info.forms,\n        customData: info.customData\n      };\n\n      if (info.dpi) {\n        _data.dpi = info.dpi;\n      }\n\n      if (info.forms && info.forms.fields) {\n        for (var i = 0; i < info.forms.fields.length; i++) {\n          info.offset = info.offset || 0;\n          var pIndex = info.offset + i;\n\n          if (_data.fields[pIndex] && _data.fields[pIndex].length > 0) {\n            _data.fields[pIndex].length = 0;\n          } else {\n            _data.fields[pIndex] = [];\n          }\n\n          var layer = info.forms.fields[i];\n\n          if (layer && layer.length > 0) {\n            for (var j = 0; j < layer.length; j++) {\n              _data.fields[pIndex][j] = new FormField(layer[j], _data, pIndex);\n\n              __applyMultiview(_data.fields[pIndex][j]);\n\n              _wdv.trigger({\n                type: _publicEvents.load,\n                field: _data.fields[pIndex][j].getClonedData()\n              });\n\n              __bindFieldEvents(_data.fields[pIndex][j]);\n            }\n\n            __multiPageFields = __getMultiPageFieldNames();\n          }\n        }\n      } else if (info.error) {\n        fieldsLoadedEvt.error = info.error;\n      }\n\n      _wdv.trigger(fieldsLoadedEvt);\n    }\n  } // #endregion\n  // #region Input Validation\n\n  /*\r\n  // fixes the font properties of a config\r\n  function __validateFontConfig(cfg) {\r\n      if (cfg && cfg.font && cfg.font.size) {\r\n          // we don't support unit based fonts\r\n          cfg.font.size = parseFloat(cfg.font.size); \r\n      }\r\n      \r\n      return cfg;\r\n  }\r\n  */\n  // #endregion\n\n\n  __extendWDV();\n\n  __initForms();\n};\n\n/* harmony default export */ var controller_FormController = (FormController_FormController);\n// CONCATENATED MODULE: ./src/upload/UploadControlCssClasses.ts\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\nvar UploadControlCssClasses;\n\n(function (UploadControlCssClasses) {\n  UploadControlCssClasses[\"Button\"] = \"atala-upload-button\";\n  UploadControlCssClasses[\"DragAndDrop\"] = \"atala-upload-drag-and-drop\";\n  UploadControlCssClasses[\"DragAndDropImage\"] = \"atala-upload-drag-and-drop-image\";\n  UploadControlCssClasses[\"FileProgress\"] = \"atala-upload-progress-file\";\n  UploadControlCssClasses[\"FileProgressImage\"] = \"atala-upload-progress-file-image\";\n  UploadControlCssClasses[\"MultipleFilesHeaderRow\"] = \"atala-upload-files-header-row\";\n  UploadControlCssClasses[\"MultipleFilesHeader\"] = \"atala-upload-files-header\";\n  UploadControlCssClasses[\"TextElement\"] = \"atala-upload-text-element\";\n  UploadControlCssClasses[\"Control\"] = \"atala-upload-control\";\n  UploadControlCssClasses[\"AreaContainer\"] = \"atala-upload-flex-area\";\n  UploadControlCssClasses[\"AreaNonTable\"] = \"atala-upload-flex-area-non-table\";\n  UploadControlCssClasses[\"AreaSingleFile\"] = \"atala-upload-single-file\";\n  UploadControlCssClasses[\"AreaSingleFileNoDragDrop\"] = \"atala-upload-single-file-no-drag-drop\";\n  UploadControlCssClasses[\"AreaMultipleFile\"] = \"atala-upload-multiple-files\";\n  UploadControlCssClasses[\"AreaMultipleFileDragDrop\"] = \"atala-upload-multiple-files-drag-and-drop\";\n  UploadControlCssClasses[\"ButtonsContainer\"] = \"atala-upload-flex-buttons\";\n  UploadControlCssClasses[\"Buttons\"] = \"atala-upload-buttons\";\n  UploadControlCssClasses[\"CloseButton\"] = \"atala-upload-close-button\";\n  UploadControlCssClasses[\"CancelButton\"] = \"atala-upload-cancel-button\";\n  UploadControlCssClasses[\"OkButton\"] = \"atala-upload-ok-button\";\n  UploadControlCssClasses[\"AddButton\"] = \"atala-upload-add-button\";\n  UploadControlCssClasses[\"MultipleFilesHeaderName\"] = \"atala-upload-files-header-name\";\n  UploadControlCssClasses[\"MultipleFilesHeaderSize\"] = \"atala-upload-files-header-size\";\n  UploadControlCssClasses[\"MultipleFilesHeaderStatus\"] = \"atala-upload-files-header-status\";\n  UploadControlCssClasses[\"MultipleFilesRow\"] = \"atala-upload-files-row\";\n  UploadControlCssClasses[\"MultipleFilesCell\"] = \"atala-upload-files-cell\";\n  UploadControlCssClasses[\"MultipleFilesCellName\"] = \"atala-upload-files-cell-name\";\n  UploadControlCssClasses[\"MultipleFilesCellSize\"] = \"atala-upload-files-cell-size\";\n  UploadControlCssClasses[\"MultipleFilesCellStatus\"] = \"atala-upload-files-cell-status\";\n  UploadControlCssClasses[\"MultipleFilesCellCancelButton\"] = \"atala-upload-files-cancel-button\";\n})(UploadControlCssClasses || (UploadControlCssClasses = {}));\n// CONCATENATED MODULE: ./src/upload/FileUploadProgressHandler.ts\n\n\nfunction FileUploadProgressHandler_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\nvar FileUploadProgressHandlerImpl =\n/*#__PURE__*/\nfunction () {\n  function FileUploadProgressHandlerImpl(filename, statusText) {\n    FileUploadProgressHandler_defineProperty(this, \"cancel\", false);\n\n    FileUploadProgressHandler_defineProperty(this, \"progressCounter\", 0);\n\n    FileUploadProgressHandler_defineProperty(this, \"filename\", void 0);\n\n    FileUploadProgressHandler_defineProperty(this, \"statusText\", void 0);\n\n    this.filename = filename;\n    this.statusText = statusText;\n  }\n\n  var _proto = FileUploadProgressHandlerImpl.prototype;\n\n  _proto.handler = function handler(e) {\n    if (this.isUploadStartEventData(e)) {\n      if (e.fileinfo.filename === this.filename && this.cancel) {\n        e.fileinfo.cancel = true;\n      }\n    } else {\n      if (e.uploadinfo.filename === this.filename) {\n        if (this.cancel) {\n          e.uploadinfo.cancel = true;\n        }\n\n        if (this.progressCounter % 5 === 0) {\n          this.statusText.text(\"Uploading (\" + (e.uploadinfo.uploadedbytes / e.uploadinfo.totalbytes * 100).toFixed(0) + \" %)\");\n        }\n\n        this.progressCounter++;\n      }\n    }\n  };\n\n  _proto.isUploadStartEventData = function isUploadStartEventData(e) {\n    return e.fileinfo !== undefined;\n  };\n\n  return FileUploadProgressHandlerImpl;\n}();\n// CONCATENATED MODULE: ./src/upload/DragAndDropHandler.ts\nfunction DragAndDropHandler_inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction DragAndDropHandler_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction DragAndDropHandler_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\nvar DragAndDropHandler_DragAndDropHandler =\n/*#__PURE__*/\nfunction () {\n  function DragAndDropHandler(control, allowMultipleFiles) {\n    DragAndDropHandler_defineProperty(this, \"enterLeaveLevel\", 0);\n\n    DragAndDropHandler_defineProperty(this, \"dragEffect\", void 0);\n\n    DragAndDropHandler_defineProperty(this, \"control\", void 0);\n\n    DragAndDropHandler_defineProperty(this, \"allowMultipleFiles\", void 0);\n\n    this.control = control;\n    this.allowMultipleFiles = allowMultipleFiles;\n    this.dragEffect = '';\n  }\n\n  var _proto = DragAndDropHandler.prototype;\n\n  _proto.onDragEnter = function onDragEnter(e) {\n    if (this.dragEffect === '' && this.enterLeaveLevel === 0) {\n      this.dragEffect = this.calcDragEffect(e.dataTransfer);\n    }\n\n    if (this.isDataTransferPresented(e.dataTransfer)) e.dataTransfer.dropEffect = this.dragEffect;\n    this.enterLeaveLevel++;\n  };\n\n  _proto.onDrop = function onDrop(e) {\n    if (this.dragEffect !== 'none') {\n      this.control.processFiles(this.getFilesFromDataTransfer(e.dataTransfer));\n    }\n\n    this.resetState();\n  };\n\n  _proto.onDragLeave = function onDragLeave() {\n    this.enterLeaveLevel--;\n\n    if (this.enterLeaveLevel === 0) {\n      this.dragEffect = '';\n    }\n  };\n\n  _proto.onDragOver = function onDragOver(e) {\n    if (this.isDataTransferPresented(e.dataTransfer)) e.dataTransfer.dropEffect = this.dragEffect;\n  };\n\n  _proto.calcDragEffect = function calcDragEffect(dataTransfer) {\n    var _this = this;\n\n    if (this.control.uploadRequested || !this.isDataTransferPresented(dataTransfer)) return 'none';\n    var typesValid;\n\n    if (Browser.Firefox) {\n      typesValid = dataTransfer.types.length === 2 && dataTransfer.types.some(function (t) {\n        DragAndDropHandler_newArrowCheck(this, _this);\n\n        return t === 'Files';\n      }.bind(this));\n    } else {\n      typesValid = dataTransfer.types.length === 1 && dataTransfer.types[0] === 'Files';\n    }\n\n    if (typesValid) {\n      if (!this.allowMultipleFiles && dataTransfer.items.length !== 1) {\n        return 'none';\n      } else {\n        return 'copy';\n      }\n    } else {\n      return 'none';\n    }\n  };\n\n  _proto.processDragAndDropEvent = function processDragAndDropEvent(e) {\n    e.preventDefault();\n    var dragEvent = e.originalEvent;\n\n    switch (dragEvent.type) {\n      case 'dragenter':\n        this.onDragEnter(dragEvent);\n        break;\n\n      case 'dragover':\n        this.onDragOver(dragEvent);\n        break;\n\n      case 'drop':\n        this.onDrop(dragEvent);\n        break;\n\n      case 'dragleave':\n        this.onDragLeave();\n        break;\n    }\n  };\n\n  _proto.getFilesFromDataTransfer = function getFilesFromDataTransfer(dataTransfer) {\n    var files = [];\n    if (!this.isDataTransferPresented(dataTransfer)) return files;\n\n    for (var i = 0; i < dataTransfer.files.length; i++) {\n      files.push(dataTransfer.files[i]);\n    }\n\n    return files;\n  };\n\n  _proto.resetState = function resetState() {\n    this.dragEffect = '';\n    this.enterLeaveLevel = 0;\n  };\n\n  _proto.isDataTransferPresented = function isDataTransferPresented(dataTransfer) {\n    return dataTransfer !== null;\n  };\n\n  return DragAndDropHandler;\n}();\nvar DragAndDropHandlerIE =\n/*#__PURE__*/\nfunction (_DragAndDropHandler) {\n  DragAndDropHandler_inheritsLoose(DragAndDropHandlerIE, _DragAndDropHandler);\n\n  function DragAndDropHandlerIE() {\n    return _DragAndDropHandler.apply(this, arguments) || this;\n  }\n\n  var _proto2 = DragAndDropHandlerIE.prototype;\n\n  _proto2.onDragEnter = function onDragEnter() {};\n\n  _proto2.onDragOver = function onDragOver() {};\n\n  _proto2.onDragLeave = function onDragLeave() {};\n\n  _proto2.onDrop = function onDrop(e) {\n    if (this.control.uploadRequested || !this.isDataTransferPresented(e.dataTransfer)) return;\n\n    if (e.dataTransfer.types.length !== 1 || e.dataTransfer.types[0] !== 'Files') {\n      return;\n    } else {\n      if (!this.allowMultipleFiles && e.dataTransfer.files.length !== 1) {\n        return;\n      } else {\n        this.control.processFiles(this.getFilesFromDataTransfer(e.dataTransfer));\n      }\n    }\n  };\n\n  return DragAndDropHandlerIE;\n}(DragAndDropHandler_DragAndDropHandler);\n// CONCATENATED MODULE: ./src/upload/UploadBaseControl.ts\n\n\n\n\n\n\n\nfunction UploadBaseControl_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction UploadBaseControl_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction UploadBaseControl_createClass(Constructor, protoProps, staticProps) { if (protoProps) UploadBaseControl_defineProperties(Constructor.prototype, protoProps); if (staticProps) UploadBaseControl_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction UploadBaseControl_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n\n\n\nvar UploadBaseControl_UploadBaseControl =\n/*#__PURE__*/\nfunction () {\n  function UploadBaseControl(controller) {\n    var _this = this;\n\n    UploadBaseControl_defineProperty(this, \"control\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"openFileDlgBtn\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"openFileForm\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"callbackToManipulateParentUi\", function () {\n      UploadBaseControl_newArrowCheck(this, _this);\n    }.bind(this));\n\n    UploadBaseControl_defineProperty(this, \"allowedDragAndDrop\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"uiShouldBeClosedAfterUpload\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"isVisible\", false);\n\n    UploadBaseControl_defineProperty(this, \"progressHandlers\", []);\n\n    UploadBaseControl_defineProperty(this, \"uploadRequested\", false);\n\n    UploadBaseControl_defineProperty(this, \"reinitNeeded\", false);\n\n    UploadBaseControl_defineProperty(this, \"processFileFinishedUpload\", function () {\n      UploadBaseControl_newArrowCheck(this, _this);\n    }.bind(this));\n\n    UploadBaseControl_defineProperty(this, \"controller\", void 0);\n\n    UploadBaseControl_defineProperty(this, \"openFileDlgChangeHandler\", function () {\n      UploadBaseControl_newArrowCheck(this, _this);\n\n      var files = this.openFileDlgBtn[0].files;\n      this.processFiles(this.convertFileListToFilesArray(files));\n      this.openFileForm[0].reset();\n    }.bind(this));\n\n    UploadBaseControl_defineProperty(this, \"handleUploadFinished\", function () {\n      UploadBaseControl_newArrowCheck(this, _this);\n\n      if (this.uiShouldBeClosedAfterUpload) this.controller.finish(false);else {\n        this.control.find(\".\" + UploadControlCssClasses.CancelButton).css('display', 'none');\n        this.control.find(\".\" + UploadControlCssClasses.CloseButton).css('display', '');\n      }\n    }.bind(this));\n\n    UploadBaseControl_defineProperty(this, \"processProgressHandlers\", function (e) {\n      var _this2 = this;\n\n      UploadBaseControl_newArrowCheck(this, _this);\n\n      this.progressHandlers.forEach(function (h) {\n        UploadBaseControl_newArrowCheck(this, _this2);\n\n        return h.handler(e);\n      }.bind(this));\n    }.bind(this));\n\n    this.controller = controller;\n    var container = atalaJquery('<div/>').addClass(UploadControlCssClasses.Control).css('flex-flow', 'column').css('height', '100%').css('width', '100%').addClass('ui-widget');\n    var workArea = atalaJquery('<div/>').addClass(UploadControlCssClasses.AreaContainer).css('display', 'flex').css('flex-flow', 'column').css('flex', '1 1 auto').css('align-content', 'center').css('overflow', 'auto');\n    var uploadButtons = atalaJquery('<div/>').addClass(UploadControlCssClasses.ButtonsContainer).css('flex', '0 1 auto');\n    container.append(workArea);\n    container.append(uploadButtons);\n    this.control = container;\n    this.openFileDlgBtn = atalaJquery('<input/>').attr('type', 'file').change(this.openFileDlgChangeHandler);\n    this.openFileForm = atalaJquery('<form/>').css('display', 'none');\n    this.openFileDlgBtn.appendTo(this.openFileForm);\n    this.openFileForm.appendTo(this.control);\n    this.allowedDragAndDrop = false;\n    this.uiShouldBeClosedAfterUpload = false;\n  }\n\n  var _proto = UploadBaseControl.prototype;\n\n  _proto.init = function init(parent, config) {\n    var _this3 = this;\n\n    this.openFileDlgBtn.attr('accept', config.allowedFileTypes);\n    var buttons = atalaJquery(this.control.children('.' + UploadControlCssClasses.ButtonsContainer));\n    this.initArea(config);\n    this.initButtons(buttons, config);\n    this.control.css('display', 'none');\n    this.control.appendTo(parent);\n    this.allowedDragAndDrop = config.allowDragDrop;\n    this.uiShouldBeClosedAfterUpload = config.closeUiAfterUpload;\n\n    if (this.allowedDragAndDrop) {\n      var dragAndDropHandler = Browser.Explorer ? new DragAndDropHandlerIE(this, config.allowMultipleFiles) : new DragAndDropHandler_DragAndDropHandler(this, config.allowMultipleFiles);\n      this.area.on('dragenter', function (e) {\n        UploadBaseControl_newArrowCheck(this, _this3);\n\n        return dragAndDropHandler.processDragAndDropEvent(e);\n      }.bind(this)).on('dragover', function (e) {\n        UploadBaseControl_newArrowCheck(this, _this3);\n\n        return dragAndDropHandler.processDragAndDropEvent(e);\n      }.bind(this)).on('drop', function (e) {\n        UploadBaseControl_newArrowCheck(this, _this3);\n\n        return dragAndDropHandler.processDragAndDropEvent(e);\n      }.bind(this)).on('dragleave', function (e) {\n        UploadBaseControl_newArrowCheck(this, _this3);\n\n        return dragAndDropHandler.processDragAndDropEvent(e);\n      }.bind(this));\n    }\n  };\n\n  _proto.activate = function activate(callback) {\n    this.callbackToManipulateParentUi = callback;\n\n    if (this.allowedDragAndDrop) {\n      this.callbackToManipulateParentUi(false);\n      this.show();\n    } else {\n      this.openFileDlgBtn.click();\n    }\n  };\n\n  _proto.close = function close() {\n    this.unbindEvents();\n    this.hide();\n  };\n\n  _proto.getControlDom = function getControlDom() {\n    return this.control;\n  };\n\n  _proto.initButtons = function initButtons(buttons, config) {\n    var _this4 = this;\n\n    var buttonsControl = atalaJquery('<div/>').addClass(UploadControlCssClasses.Buttons).css('float', 'right');\n    var addButton = atalaJquery('<button/>').addClass(UploadControlCssClasses.Button).addClass(UploadControlCssClasses.AddButton).button({\n      label: 'Add...'\n    }).click(function (e) {\n      UploadBaseControl_newArrowCheck(this, _this4);\n\n      e.preventDefault();\n      this.openFileDlgBtn.click();\n    }.bind(this));\n    var closeButton = atalaJquery('<button/>').addClass(UploadControlCssClasses.Button).addClass(UploadControlCssClasses.CloseButton).button({\n      label: 'Close'\n    }).css('display', 'none').click(function (e) {\n      UploadBaseControl_newArrowCheck(this, _this4);\n\n      e.preventDefault();\n      this.close();\n    }.bind(this));\n    var cancelButton = atalaJquery('<button/>').addClass(UploadControlCssClasses.Button).addClass(UploadControlCssClasses.CancelButton).button({\n      label: 'Cancel'\n    }).click(function (e) {\n      UploadBaseControl_newArrowCheck(this, _this4);\n\n      e.preventDefault();\n      this.controller.abort();\n      this.close();\n    }.bind(this));\n    if (config.allowMultipleFiles || config.allowDragDrop) buttonsControl.prepend(addButton);\n    buttonsControl.append(cancelButton);\n    if (!config.closeUiAfterUpload) buttonsControl.append(closeButton);\n    buttonsControl.appendTo(buttons);\n  };\n\n  _proto.initAreaImpl = function initAreaImpl(areaId, progress, caption) {\n    var control = atalaJquery('<div/>').addClass(areaId).addClass(UploadControlCssClasses.TextElement);\n    this.initAreaContents(control, progress, caption);\n    return control;\n  };\n\n  _proto.initAreaContents = function initAreaContents(control, progress, caption) {\n    var img = atalaJquery('<div/>').addClass(progress ? UploadControlCssClasses.FileProgressImage : UploadControlCssClasses.DragAndDropImage);\n    var text = atalaJquery('<span/>').addClass(progress ? UploadControlCssClasses.FileProgress : UploadControlCssClasses.DragAndDrop).text(caption);\n    control.append(img).append(text);\n  };\n\n  _proto.reinitArea = function reinitArea(progress, caption) {\n    var control = this.area.children().first();\n    control.children().remove();\n    this.initAreaContents(control, progress, caption);\n    return control;\n  };\n\n  _proto.processFiles = function processFiles(files) {\n    if (this.uploadRequested) {\n      return;\n    }\n\n    if (files.length > 0) {\n      var passedFiles = this.filterFiles(files);\n\n      if (passedFiles.length > 0) {\n        if (!this.allowedDragAndDrop) {\n          this.callbackToManipulateParentUi(false);\n          this.show();\n        }\n\n        this.addFilesToUi(passedFiles);\n      }\n    } else if (!this.allowedDragAndDrop) {\n      this.controller.abort();\n    }\n  };\n\n  _proto.filterFiles = function filterFiles(files, alreadyAddedFiles) {\n    var failedFileNames = this.controller.filterFiles(files, alreadyAddedFiles === undefined ? [] : alreadyAddedFiles);\n    var passedFiles = [];\n\n    for (var i = 0; i < files.length; i++) {\n      if (failedFileNames[0] === files[i].name) {\n        failedFileNames.shift();\n      } else {\n        passedFiles.push(files[i]);\n      }\n    }\n\n    return passedFiles;\n  };\n\n  _proto.bindEvents = function bindEvents() {\n    this.controller.bind({\n      fileuploadstarted: this.processProgressHandlers,\n      fileuploadfinished: this.processFileFinishedUpload,\n      fileuploaderror: this.processFileFinishedUpload,\n      fileuploading: this.processProgressHandlers,\n      uploadfinished: this.handleUploadFinished\n    });\n  };\n\n  _proto.unbindEvents = function unbindEvents() {\n    this.controller.unbind({\n      fileuploadstarted: this.processProgressHandlers,\n      fileuploadfinished: this.processFileFinishedUpload,\n      fileuploaderror: this.processFileFinishedUpload,\n      fileuploading: this.processProgressHandlers,\n      uploadfinished: this.handleUploadFinished\n    });\n  };\n\n  _proto.show = function show() {\n    this.control.css('display', 'flex');\n    this.controlParent.children().first().css('display', 'none');\n    this.isVisible = true;\n  };\n\n  _proto.hide = function hide() {\n    var _this5 = this;\n\n    this.control.css('display', 'none');\n    this.controlParent.children().first().css('display', 'block');\n    this.isVisible = false;\n    this.progressHandlers.length = 0;\n    this.callbackToManipulateParentUi(true);\n\n    this.callbackToManipulateParentUi = function () {\n      UploadBaseControl_newArrowCheck(this, _this5);\n    }.bind(this);\n\n    this.uploadRequested = false;\n    this.reinitNeeded = this.allowedDragAndDrop;\n    this.switchButtonEnabledState(UploadControlCssClasses.AddButton, true);\n\n    if (!this.uiShouldBeClosedAfterUpload) {\n      this.control.find(\".\" + UploadControlCssClasses.CloseButton).css('display', 'none');\n      this.control.find(\".\" + UploadControlCssClasses.CancelButton).css('display', '');\n    }\n  };\n\n  _proto.convertSize = function convertSize(sizeInBytes) {\n    var size = sizeInBytes;\n    var sizeModifiers = ['B', 'KB', 'MB', 'GB', 'TB'];\n    var sizeModIdx = 0;\n\n    while (size > 1024) {\n      size /= 1024;\n      sizeModIdx++;\n    }\n\n    return size.toFixed(2) + \" \" + sizeModifiers[sizeModIdx];\n  };\n\n  _proto.addProgressHandler = function addProgressHandler(filename, jqTextElem) {\n    this.progressHandlers.push(new FileUploadProgressHandlerImpl(filename, jqTextElem));\n  };\n\n  _proto.removeProgressHandler = function removeProgressHandler(filename) {\n    var _this6 = this;\n\n    var ph = this.progressHandlers.filter(function (h) {\n      UploadBaseControl_newArrowCheck(this, _this6);\n\n      return h.filename === filename;\n    }.bind(this))[0];\n\n    if (ph !== null) {\n      this.progressHandlers.splice(this.progressHandlers.indexOf(ph), 1);\n    }\n  };\n\n  _proto.cancelUpload = function cancelUpload(filename) {\n    var _this7 = this;\n\n    var ph = this.progressHandlers.filter(function (h) {\n      UploadBaseControl_newArrowCheck(this, _this7);\n\n      return h.filename === filename;\n    }.bind(this))[0];\n\n    if (ph !== null && ph !== undefined) {\n      ph.cancel = true;\n    }\n  };\n\n  _proto.convertFileListToFilesArray = function convertFileListToFilesArray(files) {\n    var filesArr = [];\n\n    for (var i = 0; i < files.length; i++) {\n      filesArr.push(files[i]);\n    }\n\n    return filesArr;\n  };\n\n  _proto.switchButtonEnabledState = function switchButtonEnabledState(buttonClass, enable) {\n    var command = enable ? 'enable' : 'disable';\n    this.control.find(\".\" + buttonClass).button(command);\n  };\n\n  _proto.isFileSuccessEventData = function isFileSuccessEventData(e) {\n    return e.filepath !== undefined;\n  };\n\n  UploadBaseControl_createClass(UploadBaseControl, [{\n    key: \"controlParent\",\n    get: function get() {\n      return this.control.parent();\n    }\n  }, {\n    key: \"area\",\n    get: function get() {\n      return atalaJquery(this.control.children('.' + UploadControlCssClasses.AreaContainer));\n    }\n  }]);\n\n  return UploadBaseControl;\n}();\n// CONCATENATED MODULE: ./src/upload/UploadMultilpeFilesControl.ts\n\n\n\n\n\nfunction UploadMultilpeFilesControl_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction UploadMultilpeFilesControl_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction UploadMultilpeFilesControl_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction UploadMultilpeFilesControl_createClass(Constructor, protoProps, staticProps) { if (protoProps) UploadMultilpeFilesControl_defineProperties(Constructor.prototype, protoProps); if (staticProps) UploadMultilpeFilesControl_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction UploadMultilpeFilesControl_inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction UploadMultilpeFilesControl_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n\nvar UploadMultilpeFilesControl_UploadMultipleFilesControl =\n/*#__PURE__*/\nfunction (_UploadBaseControl) {\n  UploadMultilpeFilesControl_inheritsLoose(UploadMultipleFilesControl, _UploadBaseControl);\n\n  UploadMultilpeFilesControl_createClass(UploadMultipleFilesControl, null, [{\n    key: \"rowTemplate\",\n    get: function get() {\n      if (this.rowTemplateField === null) {\n        this.rowTemplateField = this.getFileRowTemplate();\n      }\n\n      return this.rowTemplateField;\n    }\n  }]);\n\n  function UploadMultipleFilesControl(controller) {\n    var _this2 = this;\n\n    var _this;\n\n    _this = _UploadBaseControl.call(this, controller) || this;\n\n    UploadMultilpeFilesControl_defineProperty(UploadMultilpeFilesControl_assertThisInitialized(_this), \"files\", []);\n\n    UploadMultilpeFilesControl_defineProperty(UploadMultilpeFilesControl_assertThisInitialized(_this), \"table\", void 0);\n\n    UploadMultilpeFilesControl_defineProperty(UploadMultilpeFilesControl_assertThisInitialized(_this), \"uploadElems\", []);\n\n    _this.processFileFinishedUpload = function (e) {\n      UploadMultilpeFilesControl_newArrowCheck(this, _this2);\n\n      if (_this.isFileSuccessEventData(e)) {\n        _this.markStatusFinished(e.filename, true);\n      } else {\n        _this.markStatusFinished(e.errorinfo.filename, false, e.errorinfo.canceled);\n      }\n    }.bind(this);\n\n    return _this;\n  }\n\n  var _proto = UploadMultipleFilesControl.prototype;\n\n  _proto.init = function init(parent, config) {\n    _UploadBaseControl.prototype.init.call(this, parent, config);\n\n    this.openFileDlgBtn.attr('multiple', true);\n  };\n\n  _proto.initArea = function initArea(config) {\n    var control;\n\n    if (config.allowDragDrop) {\n      control = this.initAreaImpl(UploadControlCssClasses.AreaMultipleFile, false, 'Drop files here');\n      control.addClass(UploadControlCssClasses.AreaMultipleFileDragDrop);\n      this.area.addClass(UploadControlCssClasses.AreaNonTable);\n    } else {\n      control = atalaJquery('<div/>').addClass(UploadControlCssClasses.AreaMultipleFile).addClass(UploadControlCssClasses.TextElement);\n      this.initFilesTable(control);\n    }\n\n    control.appendTo(this.area);\n  };\n\n  _proto.initFilesTable = function initFilesTable(control) {\n    this.area.removeClass(UploadControlCssClasses.AreaNonTable);\n    var headersRow = atalaJquery('<div/>').addClass(UploadControlCssClasses.MultipleFilesHeaderRow).addClass('ui-widget-header');\n    var headerName = atalaJquery('<div/>').addClass(UploadControlCssClasses.MultipleFilesHeaderName).addClass(UploadControlCssClasses.MultipleFilesHeader).text('Name');\n    var headerSize = atalaJquery('<div/>').addClass(UploadControlCssClasses.MultipleFilesHeaderSize).addClass(UploadControlCssClasses.MultipleFilesHeader).text('Size');\n    var headerStatus = atalaJquery('<div/>').addClass(UploadControlCssClasses.MultipleFilesHeaderStatus).addClass(UploadControlCssClasses.MultipleFilesHeader).text('Status');\n    headersRow.append(headerName).append(headerSize).append(headerStatus).appendTo(control);\n    this.table = control;\n  };\n\n  _proto.initButtons = function initButtons(buttons, config) {\n    var _this3 = this;\n\n    _UploadBaseControl.prototype.initButtons.call(this, buttons, config);\n\n    var buttonsControl = buttons.children().first();\n    var okButton = atalaJquery('<button/>').addClass(UploadControlCssClasses.OkButton).button({\n      label: 'OK'\n    }).addClass(UploadControlCssClasses.Button).click(function (e) {\n      UploadMultilpeFilesControl_newArrowCheck(this, _this3);\n\n      e.preventDefault();\n      this.bindEvents();\n      this.uploadRequested = true;\n      this.switchButtonEnabledState(UploadControlCssClasses.AddButton, false);\n      this.switchButtonEnabledState(UploadControlCssClasses.OkButton, false);\n      this.controller.uploadFiles(this.files);\n    }.bind(this));\n    buttonsControl.children('.' + UploadControlCssClasses.AddButton).first().after(okButton);\n  };\n\n  _proto.processFiles = function processFiles(files) {\n    var _this4 = this;\n\n    if (!this.isVisible) {\n      _UploadBaseControl.prototype.processFiles.call(this, files);\n    } else {\n      if (this.uploadRequested) {\n        return;\n      }\n\n      if (files.length > 0) {\n        var passedFiles = this.filterFiles(files, this.files.map(function (fl) {\n          UploadMultilpeFilesControl_newArrowCheck(this, _this4);\n\n          return fl.name;\n        }.bind(this)));\n\n        if (passedFiles.length > 0) {\n          this.switchButtonEnabledState(UploadControlCssClasses.OkButton, true);\n          this.addFilesToUi(passedFiles);\n        }\n      }\n    }\n  };\n\n  _proto.addFilesToUi = function addFilesToUi(files) {\n    var _this$files, _this$table;\n\n    if (this.allowedDragAndDrop && this.table === undefined) {\n      var control = this.area.children().first();\n      control.children().remove();\n      control.removeClass(UploadControlCssClasses.AreaMultipleFileDragDrop);\n      this.initFilesTable(control);\n    }\n\n    var fileRows = [];\n\n    for (var i = 0; i < files.length; i++) {\n      fileRows.push(this.addRowToFilesTable(files[i]));\n    }\n\n    (_this$files = this.files).push.apply(_this$files, files);\n\n    (_this$table = this.table).append.apply(_this$table, fileRows);\n  };\n\n  _proto.addRowToFilesTable = function addRowToFilesTable(file) {\n    var _this5 = this;\n\n    var fileName = file.name;\n    var tableRow = UploadMultipleFilesControl.rowTemplate.clone();\n    atalaJquery(\".\" + UploadControlCssClasses.MultipleFilesCellName, tableRow).text(fileName);\n    atalaJquery(\".\" + UploadControlCssClasses.MultipleFilesCellSize, tableRow).text(this.convertSize(file.size));\n    var statusText = atalaJquery(\".\" + UploadControlCssClasses.FileProgress, tableRow);\n    var removeFileUpload = atalaJquery(\".\" + UploadControlCssClasses.MultipleFilesCellCancelButton, tableRow).click(function (e) {\n      UploadMultilpeFilesControl_newArrowCheck(this, _this5);\n\n      e.preventDefault();\n\n      if (!this.uploadRequested) {\n        this.files.splice(this.files.indexOf(file, 0), 1);\n        this.removeProgressHandler(fileName);\n        tableRow.remove();\n\n        if (this.files.length === 0) {\n          this.controller.abort();\n          this.close();\n        }\n      } else {\n        this.cancelUpload(fileName);\n        removeFileUpload.css('display', 'none');\n        statusText.text('Canceled');\n      }\n    }.bind(this));\n    this.addProgressHandler(file.name, statusText);\n    this.addFinishHandler(file.name, statusText, removeFileUpload);\n    return tableRow;\n  };\n\n  _proto.show = function show() {\n    this.switchButtonEnabledState(UploadControlCssClasses.OkButton, !this.allowedDragAndDrop);\n\n    if (this.reinitNeeded) {\n      this.reinitArea(false, 'Drop files here').addClass(UploadControlCssClasses.AreaMultipleFileDragDrop);\n      this.area.addClass(UploadControlCssClasses.AreaNonTable);\n      this.table = undefined;\n    }\n\n    _UploadBaseControl.prototype.show.call(this);\n  };\n\n  _proto.hide = function hide() {\n    _UploadBaseControl.prototype.hide.call(this);\n\n    this.files.length = 0;\n    this.uploadElems.length = 0;\n\n    if (this.table !== undefined) {\n      this.table.children('.atala-upload-files-row').remove();\n    }\n  };\n\n  _proto.addFinishHandler = function addFinishHandler(filename, statusText, removeFileButton) {\n    this.uploadElems.push({\n      filename: filename,\n      statusTextElem: statusText,\n      cancelUploadBtn: removeFileButton\n    });\n  };\n\n  _proto.markStatusFinished = function markStatusFinished(filename, success, canceled) {\n    var _this6 = this;\n\n    if (canceled === void 0) {\n      canceled = false;\n    }\n\n    var upCtrl = this.uploadElems.filter(function (ctrl) {\n      UploadMultilpeFilesControl_newArrowCheck(this, _this6);\n\n      return ctrl.filename === filename;\n    }.bind(this))[0];\n\n    if (upCtrl !== null && upCtrl !== undefined) {\n      upCtrl.cancelUploadBtn.css('display', 'none');\n\n      if (success) {\n        upCtrl.statusTextElem.text('Finished');\n      } else if (canceled) {\n        upCtrl.statusTextElem.text('Canceled');\n      } else {\n        upCtrl.statusTextElem.text('Error');\n      }\n    }\n  };\n\n  UploadMultipleFilesControl.getFileRowTemplate = function getFileRowTemplate() {\n    var tableRow = atalaJquery(\"<div class=\\\"\" + UploadControlCssClasses.MultipleFilesRow + \"\\\">\\n<div class=\\\"\" + UploadControlCssClasses.MultipleFilesCell + \" \" + UploadControlCssClasses.MultipleFilesCellName + \"\\\"></div>\\n<div class=\\\"\" + UploadControlCssClasses.MultipleFilesCell + \" \" + UploadControlCssClasses.MultipleFilesCellSize + \"\\\"/></div>\\n<div class=\\\"\" + UploadControlCssClasses.MultipleFilesCell + \" \" + UploadControlCssClasses.MultipleFilesCellStatus + \"\\\">\\n<span class=\\\"\" + UploadControlCssClasses.FileProgress + \"\\\">Upload pending</span>\\n<button title=\\\"Removes file from upload queue\\\" class=\\\"atala-ui-button \" + UploadControlCssClasses.MultipleFilesCellCancelButton + \"\\\"/>\\n</div>\\n</div>\");\n    atalaJquery(\".\" + UploadControlCssClasses.MultipleFilesCellCancelButton, tableRow).button({\n      icon: 'atala-ui-icon atala-ui-icon-upload-cancel',\n      showLabel: false\n    });\n    return tableRow;\n  };\n\n  return UploadMultipleFilesControl;\n}(UploadBaseControl_UploadBaseControl);\n\nUploadMultilpeFilesControl_defineProperty(UploadMultilpeFilesControl_UploadMultipleFilesControl, \"rowTemplateField\", null);\n// CONCATENATED MODULE: ./src/upload/UploadSingleFileControl.ts\n\n\nfunction UploadSingleFileControl_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction UploadSingleFileControl_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction UploadSingleFileControl_inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction UploadSingleFileControl_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\nvar UploadSingleFileControl_UploadSingleFileControl =\n/*#__PURE__*/\nfunction (_UploadBaseControl) {\n  UploadSingleFileControl_inheritsLoose(UploadSingleFileControl, _UploadBaseControl);\n\n  function UploadSingleFileControl(controller) {\n    var _this2 = this;\n\n    var _this;\n\n    _this = _UploadBaseControl.call(this, controller) || this;\n\n    UploadSingleFileControl_defineProperty(UploadSingleFileControl_assertThisInitialized(_this), \"fileName\", '');\n\n    UploadSingleFileControl_defineProperty(UploadSingleFileControl_assertThisInitialized(_this), \"uploadProgressSpan\", null);\n\n    UploadSingleFileControl_defineProperty(UploadSingleFileControl_assertThisInitialized(_this), \"uploadProgressImage\", null);\n\n    _this.processFileFinishedUpload = function (e) {\n      UploadSingleFileControl_newArrowCheck(this, _this2);\n\n      if (_this.isFileSuccessEventData(e)) {\n        _this.uploadProgressSpan.text('Upload finished');\n      } else {\n        if (e.errorinfo.canceled) {\n          _this.uploadProgressSpan.text('Upload canceled');\n        } else {\n          _this.uploadProgressSpan.text('An error occurred during upload');\n        }\n      }\n\n      _this.uploadProgressImage.css('display', 'none');\n    }.bind(this);\n\n    return _this;\n  }\n\n  var _proto = UploadSingleFileControl.prototype;\n\n  _proto.initArea = function initArea(config) {\n    var areaId = UploadControlCssClasses.AreaSingleFile;\n    var caption = 'Uploading...';\n\n    if (config.allowDragDrop) {\n      caption = 'Drop file here';\n    }\n\n    var control = this.initAreaImpl(areaId, !config.allowDragDrop, caption);\n\n    if (!config.allowDragDrop) {\n      this.uploadProgressSpan = control.children('.' + UploadControlCssClasses.FileProgress).first();\n      this.uploadProgressImage = control.children('.' + UploadControlCssClasses.FileProgressImage).first();\n      control.addClass(UploadControlCssClasses.AreaSingleFileNoDragDrop);\n    }\n\n    control.appendTo(this.area);\n    this.area.addClass(UploadControlCssClasses.AreaNonTable);\n  };\n\n  _proto.addFilesToUi = function addFilesToUi(files) {\n    if (this.allowedDragAndDrop) {\n      this.reinitArea(true, 'Uploading...');\n    }\n\n    this.uploadRequested = true;\n    this.fileName = files[0].name;\n    this.addProgressHandler(this.fileName, this.uploadProgressSpan);\n    this.bindEvents();\n    this.switchButtonEnabledState(UploadControlCssClasses.AddButton, false);\n    this.controller.uploadFile(files[0]);\n  };\n\n  _proto.show = function show() {\n    if (this.reinitNeeded) {\n      this.reinitArea(false, 'Drop file here');\n    }\n\n    _UploadBaseControl.prototype.show.call(this);\n  };\n\n  _proto.hide = function hide() {\n    _UploadBaseControl.prototype.hide.call(this);\n\n    if (this.uploadProgressImage !== null) {\n      this.uploadProgressImage.css('display', '');\n    }\n  };\n\n  _proto.reinitArea = function reinitArea(progress, caption) {\n    var control = _UploadBaseControl.prototype.reinitArea.call(this, progress, caption);\n\n    if (!progress) {\n      control.removeClass(UploadControlCssClasses.AreaSingleFileNoDragDrop);\n      this.uploadProgressSpan = null;\n      this.uploadProgressImage = null;\n    } else {\n      this.uploadProgressSpan = control.children('.' + UploadControlCssClasses.FileProgress).first();\n      this.uploadProgressImage = control.children('.' + UploadControlCssClasses.FileProgressImage).first();\n      control.addClass(UploadControlCssClasses.AreaSingleFileNoDragDrop);\n    }\n  };\n\n  return UploadSingleFileControl;\n}(UploadBaseControl_UploadBaseControl);\n// CONCATENATED MODULE: ./src/controller/UploadController.ts\n\n\n\n\n\n\n\n\nfunction UploadController_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\nfunction UploadController_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction UploadController_createClass(Constructor, protoProps, staticProps) { if (protoProps) UploadController_defineProperties(Constructor.prototype, protoProps); if (staticProps) UploadController_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction UploadController_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tUpload Controller class. Responsible for files upload\n//\tCopyright 2003-2018 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n\n\n\nvar UploadControllerState;\n\n(function (UploadControllerState) {\n  UploadControllerState[UploadControllerState[\"Idle\"] = 0] = \"Idle\";\n  UploadControllerState[UploadControllerState[\"Canceling\"] = 1] = \"Canceling\";\n  UploadControllerState[UploadControllerState[\"Uploading\"] = 2] = \"Uploading\";\n})(UploadControllerState || (UploadControllerState = {}));\n\nvar UploadController_UploadController =\n/*#__PURE__*/\nfunction () {\n  //#region Fields\n  //#endregion\n  //#region Constructor and dispose\n  function UploadController(wdv, wdvInternals) {\n    var _this = this;\n\n    UploadController_defineProperty(this, \"config\", void 0);\n\n    UploadController_defineProperty(this, \"trigger\", void 0);\n\n    UploadController_defineProperty(this, \"bind\", void 0);\n\n    UploadController_defineProperty(this, \"unbind\", void 0);\n\n    UploadController_defineProperty(this, \"sendRequest\", void 0);\n\n    UploadController_defineProperty(this, \"uploadControlField\", null);\n\n    UploadController_defineProperty(this, \"state\", UploadControllerState.Idle);\n\n    UploadController_defineProperty(this, \"filesToUpload\", []);\n\n    UploadController_defineProperty(this, \"uploadingFiles\", []);\n\n    UploadController_defineProperty(this, \"hasErrors\", false);\n\n    UploadController_defineProperty(this, \"wasCanceled\", false);\n\n    UploadController_defineProperty(this, \"uploadCallback\", null);\n\n    UploadController_defineProperty(this, \"abort\", function () {\n      UploadController_newArrowCheck(this, _this);\n\n      if (!this.config.enabled) {\n        return;\n      }\n\n      if (this.state === UploadControllerState.Uploading) {\n        this.hasErrors = true;\n        this.wasCanceled = true;\n        this.state = UploadControllerState.Canceling;\n        this.abortActiveRequests();\n      }\n\n      this.finish(true);\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"finish\", function (forced) {\n      UploadController_newArrowCheck(this, _this);\n\n      if (this.config.closeUiAfterUpload || forced) this.uploadControl.close();\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onFileUploadStarted\", function (fileName, size) {\n      UploadController_newArrowCheck(this, _this);\n\n      if (this.state === UploadControllerState.Canceling) return false;\n      var eventData = {\n        type: 'fileuploadstarted',\n        fileinfo: {\n          filename: fileName,\n          size: size,\n          cancel: false\n        }\n      };\n      this.trigger(eventData);\n      return !eventData.fileinfo.cancel;\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onFileUploadFinished\", function (event, filename) {\n      UploadController_newArrowCheck(this, _this);\n\n      if (!event.success || event.canceled || event.error !== undefined) {\n        var _eventData = {\n          type: 'fileuploaderror',\n          errorinfo: {\n            filename: filename,\n            canceled: event.canceled,\n            customData: event.customData\n          }\n        };\n        this.hasErrors = true;\n\n        if (!_eventData.errorinfo.canceled) {\n          _eventData.errorinfo.error = event.error;\n        } else {\n          this.wasCanceled = true;\n        }\n\n        this.trigger(_eventData);\n      } else {\n        this.trigger({\n          type: 'fileuploadfinished',\n          filepath: event.filename,\n          filename: filename,\n          customData: event.customData\n        });\n      }\n\n      this.tryToFinishUpload(filename);\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onFileUploadFailed\", function (status, message, filename) {\n      UploadController_newArrowCheck(this, _this);\n\n      var eventData = {\n        type: 'fileuploaderror',\n        errorinfo: {\n          filename: filename,\n          canceled: status === 'abort'\n        }\n      };\n      this.hasErrors = true;\n\n      if (!eventData.errorinfo.canceled) {\n        eventData.errorinfo.error = status;\n\n        if (message) {\n          eventData.errorinfo.error += \": \" + message;\n        }\n      } else {\n        this.wasCanceled = true;\n      }\n\n      this.trigger(eventData);\n      this.tryToFinishUpload(filename);\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onUploadStarted\", function () {\n      UploadController_newArrowCheck(this, _this);\n\n      var eventData = {\n        type: 'uploadstarted',\n        info: {\n          cancel: false\n        }\n      };\n      this.trigger(eventData);\n      return !eventData.info.cancel;\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onUploadFinished\", function () {\n      UploadController_newArrowCheck(this, _this);\n\n      var eventData = {\n        type: 'uploadfinished',\n        canceled: this.wasCanceled,\n        success: !this.hasErrors\n      };\n      this.trigger(eventData);\n    }.bind(this));\n\n    UploadController_defineProperty(this, \"onFileUploading\", function (filename, uploaded, total) {\n      var _this2 = this;\n\n      UploadController_newArrowCheck(this, _this);\n\n      if (this.state === UploadControllerState.Canceling) return false;\n      var uploadingFilesWithFilename = this.uploadingFiles.filter(function (uf) {\n        UploadController_newArrowCheck(this, _this2);\n\n        return uf.filename === filename;\n      }.bind(this));\n      if (uploadingFilesWithFilename.length === 0 || uploadingFilesWithFilename.length > 1) return true;\n      var uploadingFile = uploadingFilesWithFilename[0];\n      if (uploadingFile.canceled) return true;\n      var eventData = {\n        type: 'fileuploading',\n        uploadinfo: {\n          filename: filename,\n          uploadedbytes: uploaded,\n          totalbytes: total,\n          cancel: false\n        }\n      };\n      this.trigger(eventData);\n      uploadingFile.canceled = eventData.uploadinfo.cancel;\n      return !eventData.uploadinfo.cancel;\n    }.bind(this));\n\n    this.trigger = wdv.trigger;\n    this.sendRequest = wdvInternals.makeHandlerRequest;\n    this.bind = wdv.bind;\n    this.unbind = wdv.unbind;\n    var wdvUploadConfig = wdv.config;\n    this.config = {\n      serverUrl: wdv.config.serverurl,\n      enabled: wdvUploadConfig.upload.enabled !== false,\n      allowMultipleFiles: !!wdvUploadConfig.upload.allowmultiplefiles,\n      allowedFileTypes: wdvUploadConfig.upload.allowedfiletypes,\n      allowDragDrop: !!wdvUploadConfig.upload.allowdragdrop,\n      allowedMaxFileSize: wdvUploadConfig.upload.allowedmaxfilesize,\n      uploadPath: wdvUploadConfig.upload.uploadpath,\n      uiParent: wdv.config.parent,\n      filesUploadConcurrency: wdv.config.upload.filesuploadconcurrency,\n      closeUiAfterUpload: wdv.config.upload.closeuiafterupload\n    };\n  }\n\n  var _proto = UploadController.prototype;\n\n  _proto.dispose = function dispose() {} //#endregion\n  //#region Upload API\n  ;\n\n  _proto.uploadWithUi = function uploadWithUi(callbackToManipulateParentUi) {\n    this.uploadControl.activate(callbackToManipulateParentUi);\n  };\n\n  _proto.uploadFiles = function uploadFiles(files, uploadpath, callback) {\n    var _this3 = this;\n\n    if (this.checkControllerState() && this.checkIfUploadDisabled() && this.checkFilesToUpload(files) && this.checkUploadPath(uploadpath) && this.checkCallback(callback)) {\n      this.state = UploadControllerState.Uploading;\n\n      if (!this.fireUploadStartedEvent()) {\n        this.abort();\n        this.tryToFinishUpload();\n        return;\n      }\n\n      files.forEach(function (file) {\n        UploadController_newArrowCheck(this, _this3);\n\n        return this.uploadFileOnServer(uploadpath, file);\n      }.bind(this));\n\n      while (this.uploadingFiles.length < this.config.filesUploadConcurrency && this.filesToUpload.length > 0) {\n        this.startFileUpload(this.filesToUpload.pop());\n      }\n\n      if (typeof callback === 'function') this.uploadCallback = callback;\n    }\n  };\n\n  _proto.uploadFile = function uploadFile(file, uploadpath, callback) {\n    this.uploadFiles([file], uploadpath, callback);\n  };\n\n  _proto.uploadFileOnServer = function uploadFileOnServer(uploadPath, file) {\n    /* eslint-disable @typescript-eslint/camelcase */\n    var uploadParams = {\n      atala_upath: this.config.uploadPath,\n      atala_subpath: uploadPath\n    };\n    var fileUploadParams = atalaJquery.extend(true, {}, uploadParams, {\n      atala_filename: file.name,\n      atala_filetype: file.type\n    });\n    /* eslint-enable @typescript-eslint/camelcase */\n\n    var hRequest = {\n      type: 'fileupload',\n      serverurl: this.config.serverUrl,\n      query: '?atalafileupload=',\n      method: 'POST',\n      data: fileUploadParams,\n      file: file,\n      cancel: false\n    };\n    this.filesToUpload.push(hRequest);\n  };\n\n  _proto.startFileUpload = function startFileUpload(hRequest) {\n    if (this.onFileUploadStarted(hRequest.file.name, hRequest.file.size)) {\n      this.uploadingFiles.push({\n        filename: hRequest.file.name,\n        canceled: false,\n        jqxhr: this.sendRequest(hRequest, this.onFileUploadFinished, this.onFileUploadFailed, this.onFileUploading)\n      });\n    } else {\n      this.onFileUploadFailed('abort', '', hRequest.file.name);\n    }\n  };\n\n  _proto.fireUploadStartedEvent = function fireUploadStartedEvent() {\n    return this.onUploadStarted();\n  };\n\n  _proto.checkControllerState = function checkControllerState() {\n    if (this.state === UploadControllerState.Uploading || this.state === UploadControllerState.Canceling && this.uploadingFiles.length > 0) {\n      this.throwError('checkControllerState', 'Web Document Viewer already performs an upload operation and can start the another one. Please try again later');\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.checkUploadPath = function checkUploadPath(uploadPath) {\n    if (!!uploadPath && typeof uploadPath !== 'string') {\n      this.throwError('checkUploadPath', \"uploadpath object '\" + uploadPath + \"' is not a string. Please check your input parameters and try again.\");\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.checkIfUploadDisabled = function checkIfUploadDisabled() {\n    if (!this.config.enabled) {\n      this.throwError('checkUploadEnabled', 'Upload is not enabled in this Web Document Viewer instance. Please check the viewer configuration and try again.');\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.checkFilesToUpload = function checkFilesToUpload(files) {\n    if (!Array.isArray(files)) {\n      this.throwError('checkFilesToUpload', 'The parameter is not an array. Please check your input parameters.');\n      return false;\n    }\n\n    for (var i = 0; i < files.length; i++) {\n      var file = files[i];\n\n      if (!(file instanceof File)) {\n        this.throwError('checkFilesToUpload', \"An object \" + file + \" doesn't implement File interface object. Please check your input parameters and try again.\");\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  _proto.checkAlreadyAddedFiles = function checkAlreadyAddedFiles(files) {\n    if (!files) return true;\n\n    if (!Array.isArray(files)) {\n      this.throwError('checkAlreadyAddedFiles', 'The parameter is not an array. Please check your input data.');\n      return false;\n    }\n\n    for (var i = 0; i < files.length; i++) {\n      var file = files[i];\n\n      if (typeof file !== 'string') {\n        this.throwError('checkAlreadyAddedFiles', \"An object \" + file + \" doesn't implement File interface object. Please check your input parameters.\");\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  _proto.checkCallback = function checkCallback(callback) {\n    if (!!callback && typeof callback !== 'function') {\n      this.throwError('checkCallback', \"callback object '\" + callback + \"' is not a function. Please check your input parameters and try again.\");\n      return false;\n    }\n\n    return true;\n  };\n\n  _proto.throwError = function throwError(name, msg) {\n    this.trigger({\n      type: 'throwerror',\n      name: name,\n      msg: msg\n    });\n  };\n\n  _proto.tryToFinishUpload = function tryToFinishUpload(filename) {\n    var _this4 = this;\n\n    if (filename) {\n      this.uploadingFiles.splice(this.uploadingFiles.indexOf(this.uploadingFiles.filter(function (uf) {\n        UploadController_newArrowCheck(this, _this4);\n\n        return uf.filename === filename;\n      }.bind(this))[0]), 1);\n    }\n\n    if (this.filesToUpload.length > 0) {\n      this.startFileUpload(this.filesToUpload.pop());\n    } else if (this.uploadingFiles.length === 0) {\n      if (this.state !== UploadControllerState.Idle) {\n        this.state = UploadControllerState.Idle;\n        this.onUploadFinished();\n        if (this.uploadCallback !== null) this.uploadCallback();\n      }\n\n      this.hasErrors = false;\n      this.wasCanceled = false;\n    }\n  };\n\n  _proto.filterFilesPublic = function filterFilesPublic(files, alreadyAddedFiles, callback) {\n    var _this5 = this;\n\n    var passedFiles = [];\n\n    if (this.checkIfUploadDisabled() && this.checkFilesToUpload(files) && this.checkAlreadyAddedFiles(alreadyAddedFiles) && this.checkCallback(callback)) {\n      var failedFiles;\n\n      if (!alreadyAddedFiles) {\n        failedFiles = this.filterFiles(files, []);\n      } else {\n        failedFiles = this.filterFiles(files, alreadyAddedFiles);\n      }\n\n      passedFiles = files.filter(function (file) {\n        var _this6 = this;\n\n        UploadController_newArrowCheck(this, _this5);\n\n        return !failedFiles.some(function (failedFn) {\n          UploadController_newArrowCheck(this, _this6);\n\n          return failedFn === file.name;\n        }.bind(this));\n      }.bind(this));\n\n      if (typeof callback === 'function') {\n        callback();\n      }\n    }\n\n    return passedFiles;\n  };\n\n  _proto.filterFiles = function filterFiles(files, alreadyAddedFiles) {\n    var _this7 = this;\n\n    var failedFiles = [];\n    var allowedFileTypes = this.config.allowedFileTypes.toLowerCase().split(',');\n    var filenames = alreadyAddedFiles.map(function (fn) {\n      UploadController_newArrowCheck(this, _this7);\n\n      return fn;\n    }.bind(this));\n    var filesLength = files.length;\n\n    for (var i = 0; i < filesLength; i++) {\n      var file = files[i];\n      var fileName = file.name;\n      var rejectReason = FileUploadRejectReason.None;\n\n      if (file.size > this.config.allowedMaxFileSize) {\n        failedFiles.push(fileName);\n        rejectReason = FileUploadRejectReason.Size;\n      } else {\n        var fileIsAlreadyAdded = false;\n        var fileNamesLength = filenames.length;\n\n        for (var j = 0; j < fileNamesLength; j++) {\n          if (filenames[j] === fileName) {\n            fileIsAlreadyAdded = true;\n            break;\n          }\n        }\n\n        if (fileIsAlreadyAdded) {\n          failedFiles.push(fileName);\n          rejectReason = FileUploadRejectReason.Name;\n        } else {\n          var lastFilenamePart = fileName.split('.').pop();\n          var fileExt = '.' + (lastFilenamePart ? lastFilenamePart.toLowerCase() : '');\n          var fileType = file.type.toLowerCase();\n          var fileTypeFound = false;\n\n          for (var _j = 0; _j < allowedFileTypes.length; _j++) {\n            var ft = allowedFileTypes[_j];\n\n            if (ft === fileExt || ft.trim() === '') {\n              fileTypeFound = true;\n              break;\n            } //Probably it's a wild-carded MIME-type like image/*\n\n\n            var ftParts = ft.split('/');\n            var fileTypeParts = fileType.split('/');\n\n            if (ftParts.length === 2 && fileTypeParts.length === 2) {\n              if (ftParts[0] === fileTypeParts[0] && (ftParts[1] === fileTypeParts[1] || ftParts[1] === '*')) {\n                fileTypeFound = true;\n                break;\n              }\n            }\n          }\n\n          if (!fileTypeFound) {\n            failedFiles.push(fileName);\n            rejectReason = FileUploadRejectReason.Type;\n          }\n        }\n      }\n\n      this.onFileAddedToUpload(file, rejectReason);\n      filenames.push(fileName);\n    }\n\n    return failedFiles;\n  };\n\n  _proto.abortActiveRequests = function abortActiveRequests() {\n    var _this8 = this;\n\n    this.uploadingFiles.forEach(function (uf) {\n      UploadController_newArrowCheck(this, _this8);\n\n      return uf.jqxhr.abort();\n    }.bind(this));\n  } //#endregion\n  //#region Event handlers\n  ;\n\n  _proto.onFileAddedToUpload = function onFileAddedToUpload(file, rejectReason) {\n    var eventData = {\n      type: 'fileaddedtoupload',\n      filename: file.name,\n      success: rejectReason === 0,\n      reason: rejectReason\n    };\n    this.trigger(eventData);\n  } //#endregion\n  //#region Upload UI\n  ;\n\n  _proto.getUploadControl = function getUploadControl() {\n    return this.uploadControl.getControlDom();\n  }\n  /**\r\n   *\r\n   * Creates a jQuery UI upload control.\r\n   * @param {any} parent - parent object to append to.\r\n   */\n  ;\n\n  _proto.createUploadControl = function createUploadControl(parent) {\n    var ctrl;\n\n    if (this.config.allowMultipleFiles) {\n      ctrl = new UploadMultilpeFilesControl_UploadMultipleFilesControl(this);\n    } else {\n      ctrl = new UploadSingleFileControl_UploadSingleFileControl(this);\n    }\n\n    ctrl.init(parent, this.config);\n    return ctrl;\n  } //#endregion\n  ;\n\n  UploadController_createClass(UploadController, [{\n    key: \"uploadControl\",\n    get: function get() {\n      if (this.uploadControlField === null) {\n        this.uploadControlField = this.createUploadControl(this.config.uiParent);\n      }\n\n      return this.uploadControlField;\n    }\n  }]);\n\n  return UploadController;\n}();\n\n\n// CONCATENATED MODULE: ./src/controller/DocumentController.js\n\n\n\n\n\n\n\n\nfunction DocumentController_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//\n//  Document Manipulation Controller class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t04-30-14\tD. Cilley\t\tFile Created.\n//\t08-27-14\tD. Cilley\t\tBug 367422: Fixed a bug that would use old mapping for newly opened documents.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t07-02-15\tD. Cilley\t\tBug 625845: Added dispose method.\n//\t09-01-15\tD. Cilley\t\tTask 630965: Added event bind tracking and intellisense.\n//\t09-15-15\tD. Cilley\t\tBug 627869: Added support for forcing all pages to be fit into the same size.\n//-------------------------------------------------------------------------------------------------\n\n\n // wdv: parent WebDocumentViewer object\n// internals: internal functions and objects from the WDV\n// viewerId: id of the viewer, for view-state specific operations.\n\n/**\r\n * WebDocumentViewer Document operations API.\r\n * @class\r\n * @name DocumentController\r\n * @inner\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n */\n\nvar DocumentController_ManipulationController = function ManipulationController(wdv, internals, viewerId) {\n  var _self = this;\n\n  var _wdv = wdv;\n  var _wdvInternals = internals;\n  var _viewerId = viewerId; // #region Intellisense\n\n  var _exposedApi = {\n    document: {\n      events: {\n        /**\r\n         * Triggers when a page is added to the document.\r\n         * @event Atalasoft.Controls.WebDocumentViewer~DocumentController#pageinserted\r\n         * @param {Object} e - Event arguments.\r\n         * @param {string} e.srcuri - Source document identifier.\r\n         * @param {number} e.srcindex - Index of the inserted page in the source document.\r\n         * @param {number} e.destindex - Page insert index.\r\n         */\n        pageinserted: null,\n\n        /** Triggers when a page is removed from the document.\r\n         * @event Atalasoft.Controls.WebDocumentViewer~DocumentController#pageremoved\r\n         * @param {Object} e - Event arguments.\r\n         * @param {number} e.index - Index of the removed page.\r\n         */\n        pageremoved: null,\n\n        /**\r\n         * Triggers when a page is moved within the same document.\r\n         * @event Atalasoft.Controls.WebDocumentViewer~DocumentController#pagemoved\r\n         * @param {Object} e - Event arguments.\r\n         * @param {number} e.shiftedsrcindex - Corrected initial page index. Represents an initial page index with all shifts and calculations during a batch operation. Can be useful, when {@link movePages} is called.\r\n         * @param {number} e.srcindex - Initial page index.\r\n         * @param {number} e.destindex - Destination page index.\r\n         */\n        pagemoved: null,\n\n        /**\r\n         * Triggers when the document is changed.\r\n         * This event indicates document structure or internal state changes and causes visible pages repaint.\r\n         * @event Atalasoft.Controls.WebDocumentViewer~DocumentController#documentchanged\r\n         */\n        documentchanged: null,\n\n        /**\r\n         * Fired when document page has been rotated.\r\n         * @event Atalasoft.Controls.WebDocumentViewer~DocumentController#pagerotated\r\n         * @param {Object} e - Event arguments\r\n         * @param {number} e.index - Index of the rotated page.\r\n         * @param {number} e.angle - Clockwise page rotation angle.\r\n         */\n        pagerotated: null\n      },\n\n      /**\r\n       * Inserts a page at the destination index from the given source uri and index.\r\n       * @param {string} [documenturl] - The identifier of the document which contains the page. If empty, `src` numeric value is considered as referencing currently opened document.\r\n       * @param {number|string|DocumentPageReference} src - zero based index of the page in the source document. Can be passed as string representation of a number. Or page descriptor returned by the {@link Atalasoft.Controls.WebDocumentViewer~DocumentController#getPageReference|getPageReference}.\r\n       * @param {number} destination - Index in the target document to insert the page.\r\n       * @param {NotificationCallback} [callback] - function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       *\r\n       *\r\n       * @example\r\n       * <caption>Assuming we have two instances of the {@link Atalasoft.Controls.WebDocumentThumbnailer| WebDocumentThumbnailer} control\r\n       * both having document opened. To copy first page of one control into first position of another\r\n       * following code could be used. </caption>\r\n       *\r\n       * _thumb1.document.insertPage(null, _thumb2.document.getPageReference(0), 0);\r\n       *\r\n       * // this call will insert new page and correctly handle annotations and forms data, so new empty layers will be created.\r\n       * // If annotations should be also coped from the source document, it could be done explicitly using following code\r\n       *\r\n       * var annotations = _thumb1.annotations.getFromPage(0);\r\n       * for (var i = 0; i < annotations.length; i++) {\r\n       * \t_thumb2.annotations.createOnPage(annotations[i], 0);\r\n       * }\r\n       */\n      insertPage: __insertPagePublic,\n\n      /**\r\n       * Inserts a page at the destination index from the given source uri and index.\r\n       * @param {string} [documenturl] - The identifier of the document which contains the page. If empty, `src` numeric value is considered as referencing currently opened document.\r\n       * @param {number[]|string[]|DocumentPageReference[]} src - zero based indices of the pages in the source document. Can be passed as string representation of numbers. Or page descriptors returned by the {@link Atalasoft.Controls.WebDocumentViewer~DocumentController#getPageReference|getPageReference}.\r\n       * @param {number} destination - Index in the target document to insert the page.\r\n       * @param {NotificationCallback} [callback] - function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       *\r\n       */\n      insertPages: __insertPagesPublic,\n\n      /**\r\n       * Removes the page at the given index.\r\n       * @param {number|string} index - Index of the page to remove. Can be passed as string representation of a number\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      removePage: __removePagePublic,\n\n      /**\r\n       * Removes pages at given indices.\r\n       * @param {number[]|string[]} indices - Indices of pages to remove. Can be passed as string representation of numbers\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      removePages: __removePagesPublic,\n\n      /**\r\n       * Moves a page from the source index to the destination index within single document.\r\n       * @param {number|string} sourceIndex - Source index to get the page from. Can be passed as string representation of a number\r\n       * @param {number|string} destinationIndex - Destination index to insert the page. Can be passed as string representation of a number\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      movePage: __movePagePublic,\n\n      /**\r\n       * Moves pages from the source indices to the destination index within single document.\r\n       * @param {number[]|string[]} sourceIndices - Source indices to get pages from. Can be passed as string representation of numbers\r\n       * @param {number|string} destinationIndex - Destination index to insert pages. Can be passed as string representation of a number\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      movePages: __movePagesPublic,\n\n      /**\r\n       * Rotates the specified angle page to the specified angle.\r\n       *\r\n       * Note, that `angle` represents final rotation value that will be applied to the original page.\t\t\t *\r\n       * @param {number|string} index - Index of the page to rotate. Can be passed as string representation of a number\r\n       * @param {number|string} angle - Clockwise rotation angle in degrees. Can be passed as string representation of a number\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       *\r\n       * @example\r\n       * <caption>If rotation should be applied to already rotated page, use {@link Atalasoft.Controls.WebDocumentViewer~DocumentController#getPageRotation| getPageRotation} to get current page rotation.</caption>\r\n       * viewer.document.rotatePage(0, viewer.document.getPageRotation(0) + 90);\r\n       */\n      rotatePage: __rotatePagePublic,\n\n      /**\r\n       * Rotates specified angle pages to specified angles.\r\n       *\r\n       * Note, that `angles` represents final rotation values that will be applied to original pages.\r\n       * @param {number[]|string[]} indices - Indices of pages to rotate.\r\n       * @param {number|number[]|string|string[]} angles - Clockwise rotation angles in degrees. Can be passed as string representation of a number If angles is a number|string or an number[]|string[] with length 1,\r\n       * then all pages will be rotated to this angle, otherwise each page will be rotated to the specified angle in array.\r\n       * @param {NotificationCallback} [callback] - Function to execute when the operation has completed.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       *\r\n       * @example\r\n       * <caption>Rotate pages with indexes 0 and 3 on 90 degrees</caption>\r\n       * viewer.document.rotatePages([0, 3], 90)\r\n       *\r\n       * @example\r\n       * <caption>Rotate page with index 0 on 180 degrees and page with index 3 on 90 degrees</caption>\r\n       * viewer.document.rotatePages([0, 3], [180, 90])\r\n       */\n      rotatePages: __rotatePagesPublic,\n\n      /**\r\n       * Gets the rotation angle of the specified page.\r\n       * @param {number} index - Index of the page to retrieve rotation angle.\r\n       * @returns {number} Clockwise rotation angle of the specified page.\r\n       *\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      getPageRotation: __getPageRotation,\n\n      /**\r\n       * Document page descriptor.\r\n       * @typedef {Object} DocumentPageReference\r\n       * @property {string} uri - Identifier of the document containing the page.\r\n       * @property {number} index - Index of the referenced page in current document.\r\n       */\n\n      /**\r\n       * Gets the page reference object for the specified page. This can be passed as a 'srcindex' parameter into document.insertPage method.\r\n       * @param {number} index - Index of the page to get the reference.\r\n       * @returns {DocumentPageReference}\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      getPageReference: __getPageReferencePublic,\n\n      /**\r\n       * Represents bookmark data object.\r\n       * @typedef {Object} BookmarkData\r\n       * @property {number} id - Bookmark id.\r\n       * @property {number} Page - Page which bookmark refers to.\r\n       * @property {number} Top - Vertical offset from the beginning of the page.(In PDF coordinates).\r\n       * @property {number} Left - Horizontal offset from the beginning of the page.(In PDF coordinates).\r\n       * @property {number} initRotation - The rotation angle of page in the original document, in degrees.\r\n       * @property {string} Text - Bookmark text.\r\n       * @property {BookmarkData[]} Children - Array containing child bookmarks\r\n       */\n\n      /**\r\n       * Gets all bookmarks for PDF document.\r\n       * @returns {BookmarkData[]}\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      getBookmarks: __getBookmarksPublic,\n\n      /**\r\n       * Gets an array of child bookmarks relative to specified.\r\n       * @param {BookmarkData} bookmark - Bookmark object for which children are searched.\r\n       * @returns {BookmarkData[]}\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function\r\n       */\n      getChildBookmarks: __getChildBookmarksPublic,\n\n      /**\r\n       * Scrolls viewer to the specified bookmark.\r\n       * @param {BookmarkData} bookmark - Bookmark object to scroll to.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function \r\n       */\n      scrollToBookmark: __scrollToBookmarkPublic,\n\n      /**\r\n       * Removes whole information about the bookmarks from PDF document.\r\n       * @param {NotificationCallback} [callback] - Function to be called when the operation has completed.\r\n       * @instance\r\n       * @memberOf Atalasoft.Controls.WebDocumentViewer~DocumentController\r\n       * @function \r\n       */\n      removeAllBookmarks: __removeAllBookmarksPublic\n    }\n  };\n  ManipulationController.__exposedApi = _exposedApi.document; // we call this function without params to establish intellisense API\n\n  if (!wdv) {\n    return null;\n  } // #endregion\n\n\n  var _data = {\n    // data object for controller properties\n    changes: [],\n    // array of objects representing changes in the document\n    mapping: null,\n    count: 0,\n    // number of pages in addition to original document\n    inserted: 0,\n    // number of pages inserted from other documents regardless of full count\n    info: {\n      // image info from the server\n      count: 0,\n      dpi: 96,\n      size: {\n        width: 0,\n        height: 0\n      },\n      vector: false,\n      bookmarks: []\n    }\n  };\n  var _publicEvents = {\n    inserted: 'pageinserted',\n    removed: 'pageremoved',\n    moved: 'pagemoved',\n    changed: 'documentchanged',\n    rotated: 'pagerotated'\n  }; // #region Controller LifeCycle\n\n  function __initController() {\n    _wdv.bind({\n      pagerecycled: __onPageRecycled,\n      pageshown: __onPageShown,\n      documentinfochanged: __onDocumentInfoChanged\n    });\n  }\n\n  function __onDocumentInfoChanged(e) {\n    _data.info = e.info;\n    _data.mapping = null;\n    _data.changes.length = 0;\n    _data.count = 0;\n    _data.inserted = 0;\n    _data.length = 0;\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    _self = null;\n    _wdv = null;\n    _wdvInternals = null; // _data.changes.length = 0;\n    // _data.mapping =  null;\n    // _data.info = null;\n  } // #endregion\n  // #region Extend WDV\n  // adds manipulation specific methods to WDV \n\n\n  function __extendWDV() {\n    if (_wdv.typeOf === 'Atalasoft.Controls.WebDocumentViewer') {\n      atalaJquery.extend(_wdv, _exposedApi);\n    }\n  }\n\n  var delayedError = null;\n\n  function __throwError(name, msg, delay) {\n    if (delay) {\n      if (delayedError === null) {\n        delayedError = {\n          name: name,\n          message: msg\n        };\n      } else {\n        delayedError.message += \"\\r\\n\" + msg;\n      }\n    } else {\n      _wdv.trigger({\n        type: 'throwerror',\n        name: name,\n        msg: msg\n      });\n    }\n  } // #endregion\n  // #region Private Page Methods\n  // overwrite instance public API to point to same data as internal API. otherwise exception is not clear since data is captured from shared closure\n\n\n  _self.__exposedApi = _exposedApi.document;\n  _self.getPageDefinition = __getPageDefinition;\n  _self.setPageCacheIndex = __setPageCacheIndex;\n  _self.insertPage = __insertPagePublic;\n  _self.removePage = __removePagePublic;\n  _self.movePage = __movePagePublic;\n  _self.rotatePage = __rotatePagePublic;\n  _self.insertPages = __insertPagesPublic;\n  _self.removePages = __removePagesPublic;\n  _self.movePages = __movePagesPublic;\n  _self.rotatePages = __rotatePagesPublic;\n  _self.getPageFitMultiplier = __getPageFitMultiplier;\n  _self.setPageFitMultiplier = __setPageFitMultiplier;\n  _self.getPageRotation = __getPageRotation;\n  _self.getPageSize = __getPageSize;\n  _self.setPageSize = __setPageSize;\n  _self.getBookmarks = __getBookmarksPublic;\n  _self.getChildBookmarks = __getChildBookmarksPublic;\n  _self.scrollToBookmark = __scrollToBookmarkPublic;\n  _self.updatePageText = __updatePageTextData;\n  _self.getPageText = __getPageTextData;\n  _self.initDocumentText = __initDocumentText;\n  _self.getPageIndexByImageIndex = __getPageIndexByImageIndex;\n  _self.canBeTiled = __canBeTiled; // checks if the mapping has been created, if not, creates it\n\n  function __checkPageMapping() {\n    if (_data.mapping == null) {\n      __initPageMapping();\n    }\n  }\n\n  function __ensureViewState(index, id) {\n    __checkPageMapping();\n\n    if (_data.mapping[index]) {\n      if (!_data.mapping[index].viewerstate[id]) {\n        _data.mapping[index].viewerstate[id] = {\n          size: null,\n          fitmultiplier: null\n        };\n      }\n    }\n  }\n\n  function __getPageIndexByImageIndex(mapsto) {\n    // if it is a source document page\n    if (mapsto < _data.info.count) {\n      for (var i = 0; i < _data.mapping.length; i++) {\n        if (_data.mapping[i].index === mapsto) return i;\n      }\n    } else {\n      // if the page was inserted\n      for (var j = 0; j < _data.mapping.length; j++) {\n        if (_data.mapping[j].pageref && _data.mapping[j].pageref.mapsto === mapsto) return j;\n      }\n    }\n\n    return -1;\n  } // creates initial page mapping\n\n\n  function __initPageMapping() {\n    var count = Math.max(_data.info.count, 0);\n    _data.mapping = new Array(count);\n\n    for (var i = 0; i < count; ++i) {\n      _data.mapping[i] = __createEmptyMapping(i);\n    }\n  }\n\n  function __createEmptyMapping(i) {\n    return {\n      index: i,\n      viewerstate: {},\n      // need to track fitmultipliers and page momentary size independently for each control\n      pageref: null,\n      angle: 0,\n      text: null\n    };\n  }\n\n  function __setPageCacheIndex(pageIndex, cacheIndex) {\n    __ensureViewState(pageIndex, _viewerId);\n\n    if (_data.mapping[pageIndex] && _data.mapping[pageIndex].viewerstate) {\n      _data.mapping[pageIndex].viewerstate[_viewerId].cacheIndex = cacheIndex;\n    }\n  }\n\n  function __getPageDefinition(index, id) {\n    id = id || _viewerId;\n\n    __checkPageMapping();\n\n    if (index >= 0 && index < _data.mapping.length && _data.mapping[index]) {\n      var mapping = _data.mapping[index];\n      var pageref = null;\n      var uri = null;\n\n      if (mapping === -1) {\n        return null;\n      } else if (mapping.pageref != null) {\n        pageref = mapping.pageref;\n        index = pageref.index;\n        uri = pageref.uri;\n      } else {\n        index = mapping.index;\n      }\n\n      var cacheIndex = mapping.viewerstate[id] && mapping.viewerstate[id].cacheIndex >= 0 ? mapping.viewerstate[id].cacheIndex : -1;\n      return {\n        // index in source document\n        index: index,\n        // external page description\n        ref: pageref,\n        // index in dom 'img' cache \n        cacheIndex: cacheIndex,\n        // external page document identifier.\n        uri: uri\n      };\n    }\n\n    return null;\n  }\n\n  function __getPageReference(index) {\n    __checkPageMapping();\n\n    if (index >= 0 && index < _data.mapping.length) {\n      if (_data.mapping[index].pageref !== null) {\n        return _data.mapping[index].pageref;\n      } else {\n        return _data.mapping[index].index;\n      }\n    } else {\n      return null;\n    }\n  } // passing id is a hack to avoid viewer to work with a document controllers that are not currently controlling it(i.e. with multiple detached thumbnails)\n\n\n  function __getPageFitMultiplier(index, id) {\n    id = id || _viewerId; //__checkPageMapping();  __ensureViewState calls this function too.\n\n    __ensureViewState(index, id);\n\n    if (index >= 0 && index < _data.mapping.length && _data.mapping[index].viewerstate[id].fitmultiplier) {\n      return _data.mapping[index].viewerstate[id].fitmultiplier;\n    } else {\n      return 1;\n    }\n  } // passing id is a hack to avoid viewer to work with a document controllers that are not currently controlling it(i.e. with multiple detached thumbnails)\n\n\n  function __setPageFitMultiplier(index, m, id) {\n    id = id || _viewerId; //__checkPageMapping(); __ensureViewState calls this function too.\n\n    __ensureViewState(index, id);\n\n    if (index >= 0 && index < _data.mapping.length) {\n      _data.mapping[index].viewerstate[id].fitmultiplier = m;\n    }\n  }\n\n  function __getPageRotation(index) {\n    __checkPageMapping();\n\n    if (index >= 0 && index < _data.mapping.length) {\n      return _data.mapping[index].angle;\n    }\n\n    return 0;\n  } // inserts a new page into the document\n  // sourceUri: string, relative uri to get the page from\n  // sourceMapping: object, contains index, pageref, and fitmultiplier of the page in the source document\n  // index: number, page index to insert the page into\n\n\n  function __insertPage(sourceUri, sourceMapping, index) {\n    var sourceRef = sourceMapping;\n\n    if (sourceUri && sourceUri !== wdv.config.documenturl) {\n      sourceRef.pageref = {\n        uri: sourceUri,\n        index: sourceMapping.index,\n        mapsto: _data.info.count + _data.inserted\n      };\n    }\n\n    _data.count++;\n    _data.inserted++;\n\n    _data.mapping.splice(index, 0, sourceRef);\n  } // removes a page from the document\n  // index: number, page index to remove the page from\n\n\n  function __removePage(index) {\n    _data.count--;\n    return _data.mapping.splice(index, 1)[0];\n  } // e.index: index of the shown page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __onPageShown() {} // e.index: index of the recycled page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __onPageRecycled() {} // #endregion\n  // #region WDV Exposed Methods\n\n\n  function __getPageReferencePublic(index) {\n    var ref = __getPageReference(index);\n\n    if (ref !== null) {\n      if (typeof ref === 'object') {\n        // return a copy\n        return {\n          'uri': ref.uri,\n          'index': ref.index\n        };\n      } else if (IsNumber(ref)) {\n        return {\n          'uri': wdv.config.documenturl,\n          'index': ref\n        };\n      }\n    }\n\n    return ref;\n  }\n\n  function __insertPagePublic(srcuri, srcindex, destindex, callback) {\n    if (Array.isArray(srcindex)) {\n      __throwError('IncorrectIndex', 'Source index can not be an array.');\n\n      return;\n    }\n\n    __insertPagesPublic(srcuri, [srcindex], destindex, callback);\n  }\n\n  function __insertPagesPublic(srcUri, srcIndices, destIndex, callback) {\n    __checkPageMapping();\n\n    var checkedIndices;\n    var uriFromParameter;\n\n    if (typeof srcUri === 'string' && srcUri.trim().length > 0) {\n      delayedError = null;\n      checkedIndices = __checkIndices(srcIndices, Number.MAX_VALUE, false, true);\n      uriFromParameter = true;\n\n      if (delayedError !== null) {\n        if (delayedError.name === 'IncorrectNumbers') {\n          __throwError('IncorrectIndices', 'When this methods has set srcUri, then srcIndices should be an array of numbers ' + 'representing page indices from an external document. ' + (\"Please check your input parameters and try again.\\r\\n\\tInner error: \" + delayedError.message));\n        } else {\n          __throwError(delayedError.name, delayedError.message);\n        }\n      }\n    } else if (srcUri === null || srcUri === undefined) {\n      var checkPageReferences = function checkPageReferences(pageRefs) {\n        var notAReference = [];\n        var result = null;\n        var refsFromIndices = null;\n\n        if (!Array.isArray(pageRefs)) {\n          __throwError('IncorrectPageReferences', \"Objects \" + pageRefs + \" are not an array.\");\n\n          return result;\n        }\n\n        if (__validateNumbers(pageRefs)) {\n          refsFromIndices = new Array(pageRefs.length);\n\n          for (var i = 0; i < pageRefs.length; i++) {\n            refsFromIndices[i] = __getPageReferencePublic(pageRefs[i]);\n          }\n        }\n\n        for (var _i = 0; _i < pageRefs.length; _i++) {\n          var idx = refsFromIndices !== null ? refsFromIndices[_i] : pageRefs[_i];\n\n          if (typeof idx !== 'object' || idx === null || typeof idx.uri !== 'string' || idx.uri.trim().length === 0) {\n            notAReference.push(idx);\n            continue;\n          }\n\n          var checkedPageRefNumber = __checkIndices([idx.index], Number.MAX_VALUE);\n\n          if (checkedPageRefNumber !== null) idx.index = checkedPageRefNumber[0];else notAReference.push(idx);\n        }\n\n        if (notAReference.length > 1) __throwError('IncorrectPageReferences', \"Objects \\\"\" + notAReference.join('\", \"') + \"\\\" are not correct page references.\");else if (notAReference.length > 0) __throwError('IncorrectPageReferences', \"Object \\\"\" + notAReference[0] + \"\\\" is not a correct page reference.\");else result = refsFromIndices !== null ? refsFromIndices : pageRefs;\n        return result;\n      };\n\n      uriFromParameter = false;\n      checkedIndices = checkPageReferences(srcIndices);\n    } else {\n      __throwError('IncorrectUri', \"Uri has invalid value \\\"\" + srcUri + \"\\\". It must be an uri to the source document or not set.\");\n\n      return;\n    }\n\n    var destIdx = __checkDestIndex(destIndex, false);\n\n    if (checkedIndices === null || destIdx === null) return;\n    var destIndxB = destIdx; //save destination index for bookmark recalculation\n\n    _wdvInternals._state.batchoperation++;\n\n    for (var i = 0; i < checkedIndices.length; i++) {\n      var uri = uriFromParameter ? srcUri : checkedIndices[i].uri;\n      var srcIdx = uriFromParameter ? checkedIndices[i] : checkedIndices[i].index;\n\n      if (i === checkedIndices.length - 1) {\n        _wdvInternals._state.batchoperation--;\n      }\n\n      var sourceMapping = __createEmptyMapping(srcIdx);\n\n      __insertPage(uri, sourceMapping, destIdx);\n\n      if (_wdvInternals._controllers.annotations) {\n        _wdvInternals._controllers.annotations.insertLayer(null, null, destIdx);\n      }\n\n      if (_wdvInternals._controllers.forms) {\n        _wdvInternals._controllers.forms.insertForm(null, null, destIdx);\n      }\n\n      _data.changes.push({\n        type: 'insertpage',\n        uri: uri,\n        src: sourceMapping.index,\n        dest: destIdx\n      });\n\n      _wdv.trigger({\n        type: _publicEvents.inserted,\n        srcuri: uri,\n        srcindex: srcIdx,\n        destindex: destIdx\n      });\n\n      destIdx++;\n    } //Update bookmarks\n\n\n    __updateBookmarksOnInsert(destIndxB, checkedIndices.length);\n\n    if (typeof callback === 'function') callback();\n\n    _wdv.trigger(_publicEvents.changed);\n  }\n\n  function __removePagePublic(index, callback) {\n    __removePagesPublic([index], callback);\n  }\n\n  function __removePagesPublic(indices, callback) {\n    var _this = this;\n\n    __checkPageMapping();\n\n    var checkedIndices = __checkSrcIndices(indices, true);\n\n    if (checkedIndices === null) return;\n    _wdvInternals._state.batchoperation++;\n    checkedIndices.sort(function (a, b) {\n      DocumentController_newArrowCheck(this, _this);\n\n      return b - a;\n    }.bind(this)).forEach(function (pageIndex, idx) {\n      DocumentController_newArrowCheck(this, _this);\n\n      if (idx === checkedIndices.length - 1) {\n        _wdvInternals._state.batchoperation--;\n      }\n\n      __removePage(pageIndex);\n\n      if (_wdvInternals._controllers.annotations) {\n        _wdvInternals._controllers.annotations.removeLayer(pageIndex);\n      }\n\n      if (_wdvInternals._controllers.forms) {\n        _wdvInternals._controllers.forms.removeForm(pageIndex);\n      }\n\n      _data.changes.push({\n        type: 'removepage',\n        index: pageIndex\n      }); //Update bookmarks\n\n\n      __removeBookmarksToPage(pageIndex);\n\n      _wdv.trigger({\n        type: _publicEvents.removed,\n        index: pageIndex\n      });\n    }.bind(this));\n    if (typeof callback === 'function') callback();\n\n    _wdv.trigger(_publicEvents.changed);\n  }\n\n  function __movePagePublic(srcindex, destindex, callback) {\n    __movePagesPublic([srcindex], destindex, callback);\n  }\n\n  function __movePagesPublic(srcIndices, destIndex, callback) {\n    __checkPageMapping();\n\n    var checkedSrcIndices = __checkSrcIndices(srcIndices, true);\n\n    var checkedDestIndex = __checkDestIndex(destIndex, true);\n\n    if (checkedSrcIndices === null || checkedDestIndex === null) return;\n    var destIdx = checkedDestIndex;\n    var destShiftDirection = checkedSrcIndices[0] > checkedDestIndex ? +1 : -1;\n    _wdvInternals._state.batchoperation++;\n\n    var _loop = function _loop(i) {\n      var _this2 = this;\n\n      var arrIdx = i;\n      var srcIdx = checkedSrcIndices[arrIdx];\n      /*\r\n       * Try to calculate where original page is?\r\n       * In some cases it can change its index:\r\n       * Example:\r\n       *   Original document pages : [0, 1, 2, 3, 4, 5]\r\n       *   Operation - movePages ([1,3], 4)\r\n       *   page with index 1 has shift 0\r\n       *   BUT page with index 3 will have shift -1, because on previous step we move page 1 to the end of the document\r\n       *\r\n       * Example 2:\r\n       *   Original document pages [0, 1, 2, 3, 4, 5]\r\n       *   Operation - movePages ([3,2], 0)\r\n       *   page with index 3 has shift 0\r\n       *   BUT page with index 3 will have shift +1, because on previous step we move page 3 to the start of the document\r\n       *\r\n       * In other words, you need to calculate index shift because in some case page order is changed during move operation. \r\n       */\n\n      var srcIdxShift = 0;\n      var destIdxShift = 0;\n\n      if (srcIdx < checkedDestIndex) {\n        srcIdxShift = -checkedSrcIndices.filter(function (elem, idx) {\n          DocumentController_newArrowCheck(this, _this2);\n\n          return idx < arrIdx && elem < srcIdx && elem < checkedDestIndex;\n        }.bind(this)).length;\n      } else if (srcIdx > checkedDestIndex) {\n        srcIdxShift = checkedSrcIndices.filter(function (elem, idx) {\n          DocumentController_newArrowCheck(this, _this2);\n\n          return idx < arrIdx && elem > srcIdx;\n        }.bind(this)).length;\n      } else {\n        if (destShiftDirection < 0) srcIdxShift = -checkedSrcIndices.filter(function (elem, idx) {\n          DocumentController_newArrowCheck(this, _this2);\n\n          return idx < arrIdx && elem < srcIdx && elem < checkedDestIndex;\n        }.bind(this)).length;else srcIdxShift = checkedSrcIndices.filter(function (elem, idx) {\n          DocumentController_newArrowCheck(this, _this2);\n\n          return idx < arrIdx && elem > srcIdx;\n        }.bind(this)).length;\n      }\n\n      if (i > 0) {\n        if (srcIdxShift < 0 || srcIdx < checkedDestIndex) destIdxShift = -1;\n      }\n\n      destIdx += destIdxShift;\n\n      if (i === checkedSrcIndices.length - 1) {\n        _wdvInternals._state.batchoperation--;\n      }\n\n      __insertPage(null, __removePage(srcIdx + srcIdxShift), destIdx);\n\n      if (_wdvInternals._controllers.annotations) {\n        _wdvInternals._controllers.annotations.moveLayer(srcIdx + srcIdxShift, destIdx);\n      }\n\n      if (_wdvInternals._controllers.forms) {\n        _wdvInternals._controllers.forms.moveForm(srcIdx + srcIdxShift, destIdx);\n      }\n\n      _data.changes.push({\n        type: 'movepage',\n        src: srcIdx + srcIdxShift,\n        dest: destIdx\n      }); //Update bookmarks\n\n\n      __updateBookmarksOnMove(srcIdx + srcIdxShift, destIdx);\n\n      _wdv.trigger({\n        type: _publicEvents.moved,\n        shiftedsrcindex: srcIdx + srcIdxShift,\n        srcindex: srcIdx,\n        destindex: destIdx\n      });\n\n      destIdx++;\n    };\n\n    for (var i = 0; i < checkedSrcIndices.length; i++) {\n      _loop(i);\n    }\n\n    if (typeof callback === 'function') callback();\n\n    _wdv.trigger(_publicEvents.changed);\n  }\n\n  function __rotatePagePublic(index, angle, callback) {\n    if (Array.isArray(angle)) {\n      __throwError('rotatePage', \"angle \" + angle + \" is array.\");\n\n      return;\n    }\n\n    __rotatePagesPublic([index], angle, callback);\n  }\n\n  function __rotatePagesPublic(indices, angles, callback) {\n    var _this3 = this;\n\n    __checkPageMapping();\n\n    var checkAnglesFunc = function checkAnglesFunc(anglesToCheck, isNumberOrString) {\n      var result = isNumberOrString ? __checkNumbers([anglesToCheck]) : __checkNumbers(anglesToCheck);\n      if (result) for (var i = 0; i < result.length; i++) {\n        if (result[i] % 90) {\n          __throwError('rotatePages', 'Angle must be a multiple of 90 degrees.');\n\n          return null;\n        }\n\n        result[i] = result[i] % 360;\n      }\n      return result;\n    };\n\n    var checkedIndices = __checkSrcIndices(indices);\n\n    var angleIsNumberOrString = typeof angles === 'number' || typeof angles === 'string';\n    var checkedAngles = checkAnglesFunc(angles, angleIsNumberOrString);\n    if (checkedIndices === null || checkedAngles === null) return;\n\n    if (!angleIsNumberOrString && checkedIndices.length !== checkedAngles.length) {\n      __throwError('rotatePages', 'Indices array and angles array have different lengths.');\n\n      return;\n    }\n\n    _wdvInternals._state.batchoperation++;\n    checkedIndices.forEach(function (pageIdx, i) {\n      DocumentController_newArrowCheck(this, _this3);\n\n      var pageAngle = checkedAngles.length > 1 ? checkedAngles[i] : checkedAngles[0];\n\n      if (i === checkedIndices.length - 1) {\n        _wdvInternals._state.batchoperation--;\n      }\n\n      var pageDiv = __rotatePage(pageIdx, pageAngle);\n\n      _data.changes.push({\n        type: 'rotatepage',\n        index: pageIdx,\n        angle: pageAngle\n      });\n\n      _wdv.trigger({\n        type: _publicEvents.rotated,\n        index: pageIdx,\n        page: pageDiv,\n        angle: pageAngle\n      });\n    }.bind(this));\n    if (typeof callback === 'function') callback(); //TFS#1130484 By some reason uncommenting this line breaks rotation in IE11. \n    //_wdv.trigger(_publicEvents.changed);\n  }\n\n  function __rotatePage(index, angle) {\n    _data.mapping[index].angle = angle;\n    var pageDiv = null;\n\n    for (var i = 0; i < _wdvInternals._pages.length; ++i) {\n      var pg = _wdvInternals._pages[i];\n\n      if (pg._index === index) {\n        pageDiv = pg;\n        break;\n      }\n    }\n\n    var adjustNeeded = !!pageDiv && !!pageDiv._img;\n\n    if (adjustNeeded) {\n      _wdvInternals.startDomManipulation();\n\n      _wdvInternals.adjustVisiblePages(true, _wdvInternals.endDomManipulation);\n    }\n\n    return pageDiv;\n  }\n\n  function __updatePageTextData(index, pageData) {\n    __checkPageMapping();\n\n    if (index >= 0 && index < _data.mapping.length) {\n      _data.mapping[index].text = pageData;\n    }\n  }\n\n  function __getPageTextData(index) {\n    if (index >= 0 && index < _data.mapping.length) {\n      return _data.mapping[index].text;\n    }\n\n    return null;\n  }\n\n  function __initDocumentText(document) {\n    if (document && document.pages) {\n      __checkPageMapping(); // occurs on document load so in most cases mappings collection directly correspond to source document.\n\n\n      for (var i = 0; i < _data.mapping.length; ++i) {\n        if (i < document.pages.length) {\n          if (_data.mapping[i].index === i) {\n            _data.mapping[i].text = document.pages[i];\n          } else {\n            // we are not expected to get here, but maybe somehow method were called after pages added/removed\n            for (var j = 0; j < _data.mapping.length; ++j) {\n              if (_data.mapping[j].index === i) {\n                _data.mapping[j].text = document.pages[i];\n              }\n            }\n          }\n        } else {\n          _data.mapping[i].text = null;\n        }\n      }\n    }\n  } // //Constructs bookmark tree from the plain array\n\n\n  function __getBookmarksPublic() {\n    var _this4 = this;\n\n    var result = new Array();\n\n    if (_data.info.bookmarks) {\n      _data.info.bookmarks.forEach(function (bookmark) {\n        DocumentController_newArrowCheck(this, _this4);\n\n        if (bookmark.Parent === -1) {\n          //No parent\n          __pushBookmarkToArray(result, bookmark);\n        } else {\n          __addToParent(result, bookmark);\n        }\n      }.bind(this));\n    }\n\n    return result;\n  }\n\n  function __pushBookmarkToArray(array, bookmark) {\n    array.push({\n      id: bookmark.id,\n      Text: bookmark.Text,\n      Page: bookmark.Page,\n      Top: bookmark.Top,\n      Left: bookmark.Left,\n      initRotation: bookmark.PageRotation,\n      Children: []\n    });\n  } //We know that on the server bookmarks were added to the end of array, so we should search the parent among the last elements of the tree \n\n\n  function __addToParent(array, bookmark) {\n    var last_element = array[array.length - 1];\n\n    if (last_element.id === bookmark.Parent) {\n      __pushBookmarkToArray(last_element.Children, bookmark);\n    } else {\n      __addToParent(last_element.Children, bookmark);\n    }\n  }\n\n  function __addChildBookToArray(id, array) {\n    var _this5 = this;\n\n    var children = _data.info.bookmarks.filter(function (bookmark) {\n      DocumentController_newArrowCheck(this, _this5);\n\n      return bookmark.Parent === id;\n    }.bind(this));\n\n    if (children.length > 0) {\n      children.forEach(function (book) {\n        DocumentController_newArrowCheck(this, _this5);\n\n        __pushBookmarkToArray(array, book);\n\n        __addChildBookToArray(book.id, array[array.length - 1].Children);\n      }.bind(this));\n    }\n  }\n\n  function __removeChildBookmarks(parentId, array) {\n    for (var i = 0; i < array.length; i++) {\n      if (array[i].Parent === parentId) {\n        var newId = array[i].id;\n        array.splice(i, 1);\n        i--; //This is necessary to do not skip next item\n\n        __removeChildBookmarks(newId, array);\n      }\n    }\n\n    return array;\n  }\n\n  function __getChildBookmarksPublic(bookmark) {\n    if (typeof bookmark !== 'object' || isNaN(bookmark.id)) {\n      __throwError('Invalid argument', 'Bookmark object is expected as input parameter');\n    }\n\n    var res = [];\n\n    __addChildBookToArray(bookmark.id, res);\n\n    return res;\n  }\n\n  function __scrollToBookmarkPublic(bookmark, callback) {\n    var _this6 = this;\n\n    if (typeof bookmark !== 'object' || isNaN(bookmark.id) || isNaN(bookmark.Page)) {\n      __throwError('Invalid argument', 'Bookmark object is expected as an input parameter');\n    }\n\n    var callbackFunc = function callbackFunc() {\n      DocumentController_newArrowCheck(this, _this6);\n\n      if (typeof callback === 'function') callback();\n    }.bind(this);\n\n    var pdfDpi = 72.0;\n    var pageIndex = ParseInt(bookmark.Page, 10);\n    var top = ParseInt(bookmark.Top, 10);\n    var left = ParseInt(bookmark.Left, 10);\n    var initRotation = ParseInt(bookmark.initRotation, 10);\n    var bPoint = {\n      x: 0,\n      y: 0\n    };\n\n    if (!isNaN(top)) {\n      var dpi = _data.info.dpi;\n\n      var zoom = _wdv.getZoom();\n\n      if (_wdvInternals._config.forcepagefit) {\n        zoom = zoom * __getPageFitMultiplier(pageIndex, _viewerId);\n      }\n\n      var size = __getPageSize(pageIndex, _viewerId);\n\n      if (!size) {\n        size = __getPageSize(0, _viewerId);\n      }\n\n      var rotation = (__getPageRotation(pageIndex) + initRotation) % 360;\n      var topDpi = 0;\n\n      if (top > 0) {\n        topDpi = Math.round(top / pdfDpi * dpi);\n      } else {\n        topDpi = size.height;\n      } // TFS: 1500824: Do not show the previous page if Top value is designated to outside the page.\n\n\n      if (topDpi > size.height) {\n        topDpi = size.height;\n      }\n\n      var leftDpi = isNaN(left) ? 0 : Math.round(left / pdfDpi * dpi);\n\n      if (leftDpi > size.width) {\n        leftDpi = size.width;\n      }\n\n      if (rotation === 180) {\n        bPoint.y = Math.round(topDpi * zoom);\n\n        if (leftDpi > 0) {\n          bPoint.x = Math.round((size.width - leftDpi) * zoom);\n        }\n      } else if (rotation === 90) {\n        bPoint.y = Math.round(leftDpi * zoom);\n        bPoint.x = Math.round(topDpi * zoom);\n      } else if (rotation === 270) {\n        bPoint.y = Math.round((size.height - leftDpi) * zoom);\n        bPoint.x = Math.round((size.width - topDpi) * zoom);\n      } else {\n        bPoint.y = Math.round((size.height - topDpi) * zoom);\n        bPoint.x = Math.round(leftDpi * zoom);\n      }\n    }\n\n    _wdvInternals.showPagePoint(pageIndex, bPoint, PageSelection.TopLeft, true, callbackFunc);\n  }\n\n  function __removeAllBookmarksPublic(callback) {\n    _data.info.bookmarks = [];\n\n    _wdvInternals.disableBookmarkButton();\n\n    _data.changes.push({\n      type: 'removebookmarks'\n    });\n\n    if (typeof callback === 'function') callback();\n  }\n\n  function __updateBookmarksOnInsert(dest, count) {\n    if (typeof _data.info.bookmarks !== 'undefined' && _data.info.bookmarks && _data.info.bookmarks.length > 0) {\n      for (var i = 0; i < _data.info.bookmarks.length; i++) {\n        if (_data.info.bookmarks[i].Page >= dest) {\n          _data.info.bookmarks[i].Page += count;\n        }\n      }\n    }\n  }\n\n  function __removeBookmarksToPage(index) {\n    if (typeof _data.info.bookmarks !== 'undefined' && _data.info.bookmarks && _data.info.bookmarks.length > 0) {\n      for (var i = 0; i < _data.info.bookmarks.length; i++) {\n        if (_data.info.bookmarks[i].Page === index) {\n          //remove this bookmark and all children.\n          var id = _data.info.bookmarks[i].id;\n          var result = _data.info.bookmarks;\n          result.splice(i, 1);\n          i--;\n          result = __removeChildBookmarks(id, result);\n          _data.info.bookmarks = result;\n        } else if (_data.info.bookmarks[i].Page > index) {\n          _data.info.bookmarks[i].Page -= 1;\n        }\n      }\n    }\n  }\n\n  function __updateBookmarksOnMove(src, dest) {\n    if (typeof _data.info.bookmarks !== 'undefined' && _data.info.bookmarks && _data.info.bookmarks.length > 0) {\n      for (var i = 0; i < _data.info.bookmarks.length; i++) {\n        var pageIndex = _data.info.bookmarks[i].Page;\n\n        if (pageIndex === src) {\n          _data.info.bookmarks[i].Page = dest;\n        }\n\n        if (src > dest) {\n          if (pageIndex >= dest && pageIndex < src) {\n            _data.info.bookmarks[i].Page += 1;\n          }\n        } else {\n          if (pageIndex > src && pageIndex <= dest) {\n            _data.info.bookmarks[i].Page -= 1;\n          }\n        }\n      }\n    }\n  } // #endregion\n  // #region Private Exposed Methods\n\n\n  _self.__getDebugInfo = __getDebugInfo;\n\n  function __getDebugInfo() {\n    var info = {};\n    atalaJquery.extend(true, info, {\n      data: _data,\n      changes: _data.changes\n    });\n    return info;\n  }\n\n  _self.__linkChanges = __linkChanges;\n\n  function __linkChanges(linker) {\n    if (linker) {\n      if (!linker._changes) {\n        linker._changes = _data;\n      } else {\n        _data = linker._changes;\n      }\n    }\n  }\n\n  _self.clear = __clearDocumentPublic;\n\n  function __clearDocumentPublic(callback) {\n    _data.clear();\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n\n    _wdv.trigger(_publicEvents.changed);\n  }\n\n  _self.getPageCount = __getPageCount;\n\n  function __getPageCount() {\n    return _data.info.count + _data.count;\n  } // viewer id is required to avoid explicit size changes for same page which \n  // is displayed in the viewer and thumbnailer(changing size requires adjusting internal state).\n  // passing id is a hack to avoid viewer to work with a document controllers that are not currently controlling it(i.e. with multiple detached thumbnails)\n\n\n  function __getPageSize(index, id) {\n    id = id || _viewerId;\n\n    __ensureViewState(index, id);\n\n    if (index >= 0 && index < _data.mapping.length) {\n      var size = _data.mapping[index].viewerstate[id].size;\n\n      if (!size) {\n        var info = _data.info;\n\n        if (info.pagesizes && info.pagesizes[index]) {\n          return info.pagesizes[index];\n        }\n      }\n\n      return size;\n    }\n  } //We determine if the tiling should be used by the presence a pagesizes field in the getDocumentInfo response.\n\n\n  function __canBeTiled(threshold, index) {\n    if (_data.mapping[index].pageref === null) {\n      var info = _data.info;\n      var realIndex = _data.mapping[index].index;\n\n      if (info.pagesizes && (info.pagesizes[realIndex].width > threshold || info.pagesizes[realIndex].height > threshold)) {\n        return true;\n      }\n    } else {\n      var pagesize = _data.mapping[index].viewerstate[_viewerId].size;\n\n      if (pagesize && (pagesize.width > threshold || pagesize.height > threshold)) {\n        return true;\n      }\n    }\n\n    return false;\n  } // viewer id is required to avoid explicit size changes for same page which \n  // is displayed in the viewer and thumbnailer(changing size requires adjusting internal state).\n  // passing id is a hack to avoid viewer to work with a document controllers that are not currently controlling it(i.e. with multiple detached thumbnails)\n\n\n  function __setPageSize(index, size, id) {\n    id = id || _viewerId;\n\n    __ensureViewState(index, id);\n\n    if (index >= 0 && index < _data.mapping.length) {\n      _data.mapping[index].viewerstate[id].size = size;\n    }\n  }\n\n  function __checkDestIndex(destIndex, moveOperation) {\n    var idx = __checkIndices([destIndex], _data.mapping.length + (moveOperation ? 0 : 1));\n\n    if (idx) return idx[0];\n    return idx;\n  }\n\n  function __checkSrcIndices(indices, checkForRepeat) {\n    return __checkIndices(indices, _data.mapping.length, checkForRepeat);\n  }\n\n  function __checkIndices(indices, maxIndex, checkForRepeat, delayErr) {\n    var _this7 = this;\n\n    var outOfRange = [];\n    var repeated = [];\n    var result = null;\n    var errName = 'IncorrectIndices';\n\n    if (!Array.isArray(indices)) {\n      __throwError(errName, \"Object \" + indices + \" is not an array.\", delayErr);\n\n      return result;\n    }\n\n    indices = __checkNumbers(indices, delayErr);\n    if (indices) indices.forEach(function (index, i, indicesArr) {\n      var _this8 = this;\n\n      DocumentController_newArrowCheck(this, _this7);\n\n      if (index < 0 || index >= maxIndex) outOfRange.push(index);\n      if (checkForRepeat && indicesArr.filter(function (value) {\n        DocumentController_newArrowCheck(this, _this8);\n\n        return value === index;\n      }.bind(this)).length > 1 && repeated.indexOf(index) === -1) repeated.push(index);\n    }.bind(this));\n    if (outOfRange.length > 1) __throwError(errName, \"Page indices \" + outOfRange.join(', ') + \" are outside of the document.\", delayErr);else if (outOfRange.length > 0) __throwError(errName, \"Page index \" + outOfRange[0] + \" is outside of the document.\", delayErr);else if (repeated.length > 1) __throwError(errName, \"Page indices \" + repeated.join(', ') + \" are included more than once.\", delayErr);else if (repeated.length > 0) __throwError(errName, \"Page index \" + repeated[0] + \" is included more than once.\", delayErr);else result = indices;\n    return result;\n  }\n\n  function __checkNumbers(numbers, delayErr) {\n    var _this9 = this;\n\n    var notANumber = [];\n    var result = [];\n\n    if (!Array.isArray(numbers)) {\n      __throwError('IncorrectNumbers', \"Object \" + numbers + \" is not an array.\", delayErr);\n\n      return result;\n    }\n\n    numbers.forEach(function (number) {\n      DocumentController_newArrowCheck(this, _this9);\n\n      var parsedNumber = ParseInt(number);\n      if (parsedNumber === null) notANumber.push(number);else result.push(parsedNumber);\n    }.bind(this));\n\n    if (notANumber.length > 1) {\n      __throwError('IncorrectNumbers', \"Objects \\\"\" + notANumber.join('\", \"') + \"\\\" are not numbers.\", delayErr);\n\n      result = null;\n    } else if (notANumber.length > 0) {\n      __throwError('IncorrectNumbers', \"Object \\\"\" + notANumber[0] + \"\\\" is not a number.\", delayErr);\n\n      result = null;\n    }\n\n    return result;\n  }\n\n  function __validateNumbers(numbers) {\n    var _this10 = this;\n\n    var notANumber = [];\n\n    if (!Array.isArray(numbers)) {\n      return false;\n    }\n\n    numbers.forEach(function (number) {\n      DocumentController_newArrowCheck(this, _this10);\n\n      var parsedNumber = ParseInt(number);\n      if (parsedNumber === null) notANumber.push(number);\n    }.bind(this));\n    return notANumber.length === 0;\n  } // #endregion\n  // #region Ajax/Json Methods\n\n\n  _self.stringifyChanges = __stringifyChanges;\n\n  function __stringifyChanges() {\n    var arr = [];\n    var pagecount = {\n      'type': 'docinfo',\n      'pagescount': _data.info.count\n    };\n    arr.push(pagecount);\n\n    for (var key in _data.changes) {\n      if (_data.changes.hasOwnProperty(key)) {\n        if (_wdv.config.persistrotation || _data.changes[key].type !== 'rotatepage') {\n          var obj = {};\n\n          for (var z in _data.changes[key]) {\n            if (_data.changes[key].hasOwnProperty(z)) {\n              obj[z] = _data.changes[key][z];\n            }\n          }\n\n          arr.push(obj);\n        }\n      }\n    }\n\n    return JSON.stringify({\n      changes: arr\n    });\n  } // #endregion\n\n\n  __extendWDV();\n\n  __initController();\n};\n\n/* harmony default export */ var DocumentController = (DocumentController_ManipulationController);\n// CONCATENATED MODULE: ./src/controller/TextController.js\n\n\n\n\n\n\nfunction TextController_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//\n//  Text Controller class. Responsible for editable text logic.\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n\n\n\n // wdv: parent WebDocumentViewer object\n\n/**\r\n * WebDocumentViewer Text Layer operations API.\r\n * @class\r\n * @inner\r\n * @name TextController\r\n * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n */\n\nvar TextController_TextController = function TextController(wdv, internals, settings) {\n  var _self = this;\n\n  var _wdv = wdv;\n  var _wdvInternals = internals;\n\n  var _internalEvents = (internals ? internals._internalEvents : null) || atalaJquery({});\n\n  var _exposedApi = {\n    /**\r\n     * @lends Atalasoft.Controls.WebDocumentViewer~TextController\r\n     */\n    text: {\n      events: {\n        /**\r\n         * Triggers when page text loaded.\r\n         * @event Atalasoft.Controls.WebDocumentViewer#pagetextloaded\r\n         * @type {LoadPageTextCallback}\r\n         * @param {Object} event - The event object.\r\n         * @param {number} event.index - index of the page for which text data has been loaded.\r\n         * @param {Object} event.customData - The event customer data from server.\r\n         */\n        pagetextloaded: null,\n\n        /**\r\n         * Triggers when UI text selection complete.\r\n         * @event Atalasoft.Controls.WebDocumentViewer#textselected\r\n         * @type {NotificationCallback}\r\n         */\n        textselected: null\n      },\n\n      /**\r\n       * Retrieves the selected text.\r\n       * @return {string} Selected text. Line break is inserted after each line and region.\r\n       * @instance\r\n       * @function\r\n       */\n      getSelected: __getSelectedText,\n\n      /**\r\n       * Copies selected text to clipboard. This method don't depend on {@link TextMouseToolConfig| TextMouseToolConfig.hookcopy} config option, i.e. text will be copied if `ctrl+c` copying is disabled for user.\r\n       * @instance\r\n       * @function\r\n       */\n      copySelected: __copySelectedText,\n\n      /** Selects all text on the page.\r\n       * Any optional arguments could be omitted and callback could be passed instead of it.\r\n       * This method is intended to select whole page text or to be used in conjunction with text search API when `region`, `line`, `word` indexes are passed to application using search iterator.\r\n       *\r\n       * @param {number} index - Index of the page to select page on.\r\n       * @param {number} [region] - Index of the region to select.\r\n       * @param {number} [line] - Index of the line to select.\r\n       * @param {number} [word] - Index of the word to select.\r\n       * @param {NotificationCallback} [success] - Function that that is called when page text is loaded and selected.\r\n       * @param {NotificationCallback} [fail] - Function that that is called when page text load is failed.\r\n       *\r\n       * @instance\r\n       * @function\r\n       *\r\n       * @example <caption>Search result match object could be used to retrieve region line and word indexes of the match starting object.</caption>\r\n       * <caption> Search text occurrence and automatically select it. Note, that `match.word` is the index of the first word in matched text. If search phrase contain multiple words, only firs will be selected in this example. </caption>\r\n       *  _viewer.text.search('findme', 0, function (it, match) {\r\n       *       if (it.isValid()) {\r\n       *           _viewer.text.selectPageText(match.page, match.region, match.line, match.word);\r\n       *       }\r\n       *  });\r\n       */\n      selectPageText: __selectPageText,\n\n      /**\r\n       * @callback GetPageTextCallback\r\n       * @param {string} text - The returned text.\r\n       */\n\n      /**\r\n       * Returns all text for the specified page.\r\n       * @param {number} index - Index of the page to retrieve text.\r\n       * @param {GetPageTextCallback} [success] - function that that is called when page text is loaded and formatted.\r\n       * @param {NotificationCallback} [fail] - Function that that is called when page text load is failed.\r\n       *\r\n       * @instance\r\n       * @function\r\n       */\n      getPageText: __getPageText,\n\n      /**\r\n       * Clears all text selection for the document.\r\n       * @instance\r\n       * @function\r\n       */\n      clearSelection: __clearSelection,\n\n      /**\r\n       * Marks page text data for reload. After this call text data will be loaded next time page will be inserted into DOM on scrolling. I.e. this method won't triggered immediate text reload, even for visible pages.\r\n       * @param {number} [index] - Index of the page to reset text data. If not specified whole document text data is reset.\r\n       * @instance\r\n       * @function\r\n       */\n      resetPageText: __resetPageText,\n\n      /**\r\n       * Callback signature for {@link Atalasoft.Controls.WebDocumentViewer~TextController#reloadPageText|reloadPageText} method.\r\n       * @callback ReloadPageTextCallback\r\n       * @param {number} index - Index of the page for which operation has been performed.\r\n       */\n\n      /**\r\n       * Forcibly triggers page text load.\r\n       * @param {number} index - Index of the page to reset text data.\r\n       * @param {LoadPageTextCallback} [success] - Function that that is called when page text is loaded successfully.\r\n       * @param {LoadPageTextCallback} [fail] - Function that that is called when page text load is failed.\r\n       *\r\n       * @instance\r\n       * @function\r\n       */\n      reloadPageText: __reloadPageText,\n\n      /**             \r\n       * Indicates whether page text is loaded.             \r\n       * @param {number} index - Index of the page to check text data state.\r\n       * @instance\r\n       * @function\r\n       */\n      isPageTextLoaded: __isPageTextLoaded,\n\n      /**\r\n       * Triggers text search. This method also triggers UI search behavior - highlight for matched text occurrences selection of current text result and scrolling during text results iteration.\r\n       * @param {string} text - Text to search for. The text must be at least 3 characters long.\r\n       * @param {number} [startPage] - Index of the page to start search from. If not specified first page in document is assumed to be the first in search.\r\n       * @param {TextSearchCallback} [callback] - Search callback that receives search results iterator.\r\n       * @returns If callback is specified - search results iterator that allows navigation over search results, otherwise null.\r\n       *\r\n       * @instance\r\n       * @function\r\n       * @deprecated - Use the {@link Atalasoft.Controls.WebDocumentViewer~TextController#searchOnPages|searchOnPages} method instead.\r\n       */\n      search: __search,\n\n      /**\r\n       * Triggers text search for the specified pages. This method also triggers UI search behavior - highlight for matched text occurrences selection of current text result and scrolling during text results iteration.\r\n       * @param {string} text - Text to search for. The text must be at least 3 characters long.\r\n       * @param {number} [startPage] - Index of the page to start search from. If not specified first page in document is assumed to be the first in search.\r\n       * @param {number} [endPage] - Index of the page to end search where. If not specified last page in document is assumed to be the last in search.\r\n       * @param {number} [activePage] - Index of the page from that viewer should start scrolling to the next search result.\r\n       * @param {TextSearchCallback} [callback] - Search callback that receives search results iterator.\r\n       * @returns If callback is specified - search results iterator that allows navigation over search results, otherwise null.\r\n       *\r\n       * @instance\r\n       * @function\r\n       */\n      searchOnPages: __searchOnPages\n    }\n  };\n  TextController.__exposedApi = _exposedApi.text; // we call this function without params to establish intellisense API\n\n  if (!wdv) {\n    return null;\n  }\n\n  var Tolerance = 0.1; // we have floated coordinates rounded, there could be some fluctuations. need to compensate them.\n\n  var _vp = null; // viewport object\n\n  var _pages = internals._pages; // internal pageDiv array from the WDV\n\n  var _data = {\n    // data object for controller properties\n    activepage: null,\n    // active page\n    origin: __makePoint(0, 0),\n    originPage: -1,\n    rectangular: false,\n    selectionCache: [],\n    searchQuery: null\n  };\n  var _config = {};\n  atalaJquery.extend(_config, settings || {}); // #region Control LifeCycle\n\n  function __initTextLayer() {\n    _wdv.bind({\n      pagerecycled: __recyclePage,\n      pageshown: __pageShown,\n      zoomchanged: __zoomChanged,\n      documentchanged: __onDocumentChanged\n    });\n\n    _internalEvents.on({\n      textselectstart: __onSelectionStart,\n      textselectmove: __onSelectionMove,\n      textselectend: __onSelectionEnd,\n      textselectcopy: __onSelectionCopy\n    });\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    _wdv.unbind({\n      pagerecycled: __recyclePage,\n      pageshown: __pageShown,\n      zoomchanged: __zoomChanged,\n      documentchanged: __onDocumentChanged\n    });\n\n    _internalEvents.off({\n      textselectstart: __onSelectionStart,\n      textselectmove: __onSelectionMove,\n      textselectend: __onSelectionEnd\n    });\n\n    _self = null;\n    _wdv = null;\n    _vp = null;\n    _data.searchQuery = null;\n    _data.selectionCache = [];\n    _data.activepage = null;\n  }\n\n  function __getPageData(index) {\n    return _wdvInternals._controllers.document.getPageText(index);\n  } // #endregion\n  // #region Extend WDV\n  // adds Text specific methods to WDV\n\n\n  function __extendWDV() {\n    if (_wdv.typeOf === 'Atalasoft.Controls.WebDocumentViewer') {\n      atalaJquery.extend(_wdv, _exposedApi);\n    }\n  }\n  /**\r\n   * jQuery trigger shortcut\r\n   * @returns object, WebDocumentViewer\r\n   */\n\n\n  function __triggerEvent(args) {\n    _wdv.trigger(args);\n\n    return _self;\n  }\n\n  function __triggerInternalEvent() {\n    _internalEvents.trigger.apply(_internalEvents, arguments);\n\n    return _self;\n  }\n\n  function __throwError(name, msg) {\n    _wdv.trigger({\n      type: 'throwerror',\n      name: name,\n      msg: msg\n    });\n  } // event fires when the WDV has finished zooming\n\n\n  function __zoomChanged() {} // removes the form layer\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  _self.removeTextLayer = __disposeTextLayer;\n\n  function __disposeTextLayer(pg) {\n    if (pg instanceof atalaJquery) {\n      if (pg._text) {\n        pg._text._page = null;\n        pg._text = null;\n      }\n\n      return true;\n    }\n\n    return false;\n  } // #endregion\n  // #region Page Methods\n  // sets up a new layer to put form fields on\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  _self.addTextLayer = __initText;\n\n  function __initText(pg) {\n    if (pg instanceof atalaJquery) {\n      pg._text = _wdvInternals.createDOM('canvas', pg);\n\n      pg._text.css({\n        width: '100%',\n        height: '100%',\n        position: 'absolute',\n        zIndex: 0\n      });\n\n      pg._text.attr('width', pg.width()).attr('height', pg.height()); // need a reference to the 'parent' object\n\n\n      pg._text._page = pg;\n      pg.on(Browser.Features.Touch ? 'touchstart' : 'mousedown', function () {\n        __setActivePage(pg);\n      });\n      pg.on({\n        pageresize: function pageresize(e) {\n          e.page = pg;\n\n          __resizeTextLayer(e);\n        },\n        pagezoom: function pagezoom(e) {\n          e.page = pg;\n\n          __zoomTextLayer(e);\n        }\n      });\n      return true;\n    }\n\n    return false;\n  }\n\n  _self.showLayer = __showLayer;\n\n  function __showLayer(index, page) {\n    if (page._text) {\n      __clearPage(page);\n\n      var pageData = __getPageData(index);\n\n      if (pageData) {\n        var ctx = __getDrawContext(page, pageData);\n\n        if (ctx && pageData.searchResult) {\n          __highlightPageSearchResults(ctx, pageData);\n        }\n\n        if (ctx && pageData.selection) {\n          var sel = pageData.selection;\n\n          for (var i = 0; i < sel.regions.length; i++) {\n            for (var j = 0; j < sel.regions[i].lines.length; j++) {\n              var line = sel.regions[i].lines[j];\n\n              for (var k = 0; line.words && k < line.words.length; k++) {\n                var word = line.words[k];\n\n                __highlightRegion(ctx, word.bounds.x, word.bounds.y, word.bounds.width, word.bounds.height, _config.selection);\n              }\n            }\n          }\n        }\n      }\n    }\n  } // recycles form by clearing the page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __recyclePage(e) {\n    __clearPage(e.page);\n  } // e.index: index of the shown page\n  // e.page: jQuery dom object, reusable div container that represents the page\n\n\n  function __pageShown(e) {\n    __showLayer(e.index, e.page);\n  }\n\n  function __clearPage(page) {\n    if (page._text) {\n      // remove all fields\n      __clearSelectionUI(page._index);\n    }\n  }\n\n  function __resizeTextLayer(e) {\n    e.page._text.attr('width', e.width).attr('height', e.height);\n\n    e.page._text.width(e.width);\n\n    e.page._text.height(e.height);\n\n    __showLayer(e.index, e.page);\n  } // sets the active page of the controller\n  // pg: jQuery dom object, reusable div container that represents the page\n\n\n  function __setActivePage(pg) {\n    _data.activepage = pg;\n  }\n\n  function __zoomTextLayer(e) {\n    __resizeTextLayer(e);\n  }\n\n  function __onDocumentChanged() {\n    if (_data.searchQuery && _data.searchQuery.iterator) {\n      _data.searchQuery.iterator.dispose();\n\n      _data.searchQuery = null;\n\n      __clearSearchResults();\n\n      for (var i = 0; i < _pages.length; i++) {\n        __showLayer(_pages[i]._index, _pages[i]);\n      }\n    }\n  } // #endregion\n  // #region Public API\n\n\n  function __isPageTextLoaded(index) {\n    var pageData = __getPageData(index);\n\n    return !!(pageData && !pageData.loading);\n  }\n\n  function __selectPageText(index, region, line, word, success, fail) {\n    var _this2 = this;\n\n    var deferred = atalaJquery.Deferred();\n    var params = Array.prototype.slice.call(arguments, 1);\n\n    if (params.length > 2 && typeof params[params.length - 2] === 'function') {\n      fail = params.pop();\n      success = params.pop();\n    } else if (params.length > 1 && typeof params[params.length - 1] === 'function') {\n      success = params.pop();\n    }\n\n    region = params[0];\n    line = params[1];\n    word = params[2];\n\n    __ensurePageTextLoaded(index).done(function (index, pageData) {\n      var _this3 = this;\n\n      TextController_newArrowCheck(this, _this2);\n\n      var bounds = pageData.bounds;\n\n      if (region !== undefined && pageData.regions[region] && (line === undefined || !pageData.regions[region].lines[line])) {\n        __selectSingleRegionText(index, region);\n      } else {\n        region = pageData.regions[region];\n\n        if (line !== undefined && region.lines[line]) {\n          line = region.lines[line];\n          bounds = __getMinimalSelectingRectangle(line.bounds, region);\n\n          if (word !== undefined && line.words[word]) {\n            bounds = __getMinimalSelectingRectangle(line.words[word].bounds, region);\n          }\n        }\n\n        __select(index, __makePoint(bounds.x, bounds.y), index, __makePoint(bounds.right, bounds.bottom));\n      }\n\n      var callback = function callback() {\n        TextController_newArrowCheck(this, _this3);\n\n        if (_wdv.config.mousetool.text.hookcopy) {\n          _wdvInternals._dom.viewport.focus();\n        }\n\n        deferred.resolve();\n\n        if (success && typeof success === 'function') {\n          success();\n        }\n      }.bind(this);\n\n      if (_wdvInternals.isPageInView(index)) {\n        callback();\n      } else {\n        _wdv.showPage(index, callback);\n      }\n    }.bind(this)).fail(function () {\n      TextController_newArrowCheck(this, _this2);\n\n      deferred.reject();\n\n      if (fail && typeof fail === 'function') {\n        fail();\n      }\n    }.bind(this));\n\n    return deferred.promise();\n  }\n\n  function __getPageText(index, success, fail) {\n    var _this4 = this;\n\n    var deferred = atalaJquery.Deferred();\n\n    __ensurePageTextLoaded(index).done(function () {\n      TextController_newArrowCheck(this, _this4);\n\n      var text = '';\n\n      var pageData = __getPageData(index);\n\n      if (pageData) {\n        for (var i = 0; i < pageData.regions.length; i++) {\n          var regionText = __getRegionText(pageData.regions[i]);\n\n          if (regionText) {\n            text += regionText;\n          }\n        }\n      }\n\n      deferred.resolve(text);\n\n      if (success && typeof success === 'function') {\n        success(text);\n      }\n    }.bind(this)).fail(function () {\n      TextController_newArrowCheck(this, _this4);\n\n      deferred.reject();\n\n      if (fail && typeof fail === 'function') {\n        fail();\n      }\n    }.bind(this));\n\n    return deferred.promise();\n  }\n\n  function __resetPageText(index) {\n    if (index === undefined || index === null) {\n      for (var i = 0; i < _wdvInternals._controllers.document.getPageCount(); i++) {\n        __resetPageText(i);\n      }\n    }\n\n    var data = __getPageData(index);\n\n    if (data) {\n      _wdvInternals._controllers.document.updatePageText(index, null);\n\n      if (_data.selectionCache[index]) {\n        _data.selectionCache[index] = null;\n\n        if (_wdvInternals.findPageFromIndex(index)) {\n          __clearSelectionUI(index, null);\n        }\n      }\n    }\n  }\n\n  function __reloadPageText(index, success, fail) {\n    var _this5 = this;\n\n    __resetPageText(index);\n\n    return __ensurePageTextLoaded(index).done(function () {\n      TextController_newArrowCheck(this, _this5);\n\n      if (success && typeof success === 'function') {\n        success(index);\n      }\n    }.bind(this)).fail(function () {\n      TextController_newArrowCheck(this, _this5);\n\n      if (fail && typeof fail === 'function') {\n        fail(index);\n      }\n    }.bind(this));\n  } // #endregion Public API\n  // #region Controller Level Exposed Methods\n  // overwrite instance public API to point to same data as internal API. otherwise exception is not clear since data is captured from shared closure\n\n\n  _self.__exposedApi = _exposedApi.text;\n  _self.__getDebugInfo = __getDebugInfo;\n  _self.__linkText = __linkText;\n  _self.clear = __clearText;\n  _self.setViewPort = __setViewPort;\n  _self.search = __search;\n  _self.clearSelection = __clearSelection;\n  _self.ensurePageTextLoaded = __ensurePageTextLoaded;\n\n  function __getDebugInfo() {\n    var info = {};\n    atalaJquery.extend(true, info, {\n      data: _data,\n      pages: _pages,\n      viewport: _vp\n    });\n    return info;\n  }\n  /* jshint unused: false */\n\n\n  function __linkText() {}\n\n  function __clearText() {\n    _data.searchQuery = null;\n    _data.selectionCache = [];\n\n    _wdvInternals._controllers.document.initDocumentText({\n      pages: []\n    });\n\n    if (_pages) {\n      for (var i = 0; i < _pages.length; i++) {\n        __clearPage(_pages[i]);\n      }\n    }\n  }\n\n  function __setViewPort(obj) {\n    if (obj) {\n      if (!(obj instanceof atalaJquery)) {\n        obj = atalaJquery(obj);\n      }\n\n      _vp = obj;\n    }\n  }\n\n  function __clearSelection() {\n    for (var i = 0; i < _wdvInternals._controllers.document.getPageCount(); i++) {\n      var pageData = __getPageData(i);\n\n      if (pageData && pageData.selection) {\n        __clearSelectionUI(i, pageData, true);\n\n        pageData.selection = null;\n      }\n    }\n\n    _data.selectionCache.length = 0;\n  }\n  /** Clears the text selection */\n\n\n  function __clearSelectionUI(pageIndex, pageData, preserveSearch) {\n    for (var i = 0; i < _pages.length; i++) {\n      if (!isFinite(pageIndex) || _pages[i]._index === pageIndex) {\n        pageData = isFinite(pageIndex) && i === pageIndex ? pageData : __getPageData(_pages[i]._index);\n\n        var ctx = __getDrawContext(_pages[i], pageData);\n\n        if (ctx) {\n          var size = _wdvInternals.getSourcePageSize(_pages[i]._index, pageData ? pageData.rotation : 0);\n\n          ctx.clearRect(0, 0, size.width, size.height);\n\n          if (preserveSearch) {\n            __highlightPageSearchResults(ctx, pageData);\n          }\n        }\n      }\n    }\n  }\n\n  function __highlightPageSearchResults(ctx, pageData) {\n    if (pageData && pageData.searchResult) {\n      for (var s = 0; s < pageData.searchResult.length; s++) {\n        var rect = pageData.searchResult[s].bounds;\n\n        __highlightRegion(ctx, rect.x, rect.y, rect.width, rect.height, _config.highlight);\n      }\n    }\n  } // #endregion\n  // #region Events\n\n\n  function __onSelectionStart(e) {\n    var args = e.eventData;\n    var pageIndex = args.page;\n    var point = args.point;\n\n    __clearSelection();\n\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData) {\n      pageData.selection = __createEmptySelection(args.point, args.point);\n\n      if (args.interval && _data.origin && _data.originPage >= 0) {\n        __select(_data.originPage, _data.origin, pageIndex, point);\n\n        args.complete = true;\n      } else if ((args.line || args.word) && Math.abs(args.point.x - _data.origin.x) < 10 && Math.abs(args.point.y - _data.origin.y) < 10) {\n        // clicks counter have rather significant delay so check that double/triple click happens around same area.\n        __selectHitObject(pageIndex, point, args.line, args.word);\n\n        args.complete = true;\n      } else {\n        // taking viewport point for rectangular selection because pages could have different sizes, and we won't be able to draw\n        // single rectangle across multiple pages if points will be in first page coordinate space.\n        _data.origin = !args.rectangular ? args.point : args.viewerPoint;\n        _data.originPage = pageIndex;\n        _data.rectangular = args.rectangular;\n      }\n    }\n\n    args.handled = true;\n  }\n\n  var throttledSelect = __makeThrottleFunction(__select, _wdv.config.mousetool.text.throttlingtreshold);\n\n  function __onSelectionMove(e) {\n    var args = e.eventData;\n    var pageIndex = args.page;\n    var pt = !_data.rectangular ? args.point : args.viewerPoint;\n\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData) {\n      if (pageData.loading) {\n        args.cursor = MouseToolCursor.Wait;\n      } else {\n        if (pageData.regions.length === 0) {\n          args.handled = false;\n          return true;\n        }\n\n        var rotation = _wdvInternals.getPageRotation(pageIndex) + pageData.rotation;\n\n        if (pageData.rotatedRegions) {\n          for (var i = 0; i < pageData.rotatedRegions.length; i++) {\n            if (isWithinRect(args.point, pageData.rotatedRegions[i].bounds)) {\n              rotation += pageData.rotatedRegions[i].rotation;\n              break;\n            }\n          }\n        }\n\n        args.cursor = rotation % 180 === 0 ? MouseToolCursor.Text : MouseToolCursor.VerticalText;\n\n        if (args.selecting) {\n          throttledSelect(_data.originPage, atalaJquery.extend({}, _data.origin), pageIndex, pt, _data.rectangular);\n        }\n      }\n    }\n\n    args.handled = true;\n    return false;\n  }\n\n  function __onSelectionEnd(e) {\n    var args = e ? e.eventData : {}; //    pageIndex = args.page,\n    //    point = args.point;\n\n    var selected = false;\n\n    for (var i in _data.selectionCache) {\n      if (_data.selectionCache.hasOwnProperty(i) && _data.selectionCache[i].selection) {\n        if (_data.selectionCache[i].selection.regions.length) {\n          selected = true;\n          break;\n        }\n      }\n    }\n\n    if (selected) {\n      __triggerEvent({\n        type: 'textselected'\n      });\n    }\n\n    _data.rectangular = false;\n    args.handled = true;\n  }\n\n  function __onSelectionCopy() {\n    __copySelectedText();\n  } // #endregion\n  // #region copy selection\n\n\n  function __copySelectedText() {\n    var dummyEl = _wdvInternals.createDiv();\n\n    if (dummyEl[0]) {\n      var cb = new atalaClipboard('wdv-dummy-selection-trigger', {\n        text: function text() {\n          return __getSelectedText();\n        }\n      });\n      cb.on('success', function () {\n        cb.destroy();\n      });\n      cb.on('error', function () {\n        cb.destroy();\n\n        __throwError('TextCopyError');\n      });\n      cb.onClick({\n        currentTarget: dummyEl[0]\n      });\n    }\n  }\n\n  function __getSelectedText() {\n    var result = '';\n\n    for (var s = 0; s < _data.selectionCache.length; s++) {\n      if (_data.selectionCache[s]) {\n        var sel = _data.selectionCache[s].selection;\n\n        if (sel && sel.regions && sel.regions.length > 0) {\n          for (var i = 0; i < sel.regions.length; i++) {\n            var text = __getRegionText(sel.regions[i]);\n\n            if (text) {\n              result += text;\n            }\n          }\n        }\n      }\n    }\n\n    return result;\n  }\n\n  function __getLineText(line) {\n    var lineText = '';\n\n    for (var i = 0; line.words && i < line.words.length; i++) {\n      if (__wordsSeparated(line.words[i], i >= 1 ? line.words[i - 1] : null)) {\n        lineText += ' ';\n      }\n\n      if (line.words[i].text) {\n        lineText += line.words[i].text;\n      } else if (line.words[i].glyphs && line.words[i].glyphs.length) {\n        for (var j = 0; j < line.words[i].glyphs.length; j++) {\n          lineText += line.words[i].glyphs[j].text;\n        }\n      }\n    }\n\n    return lineText;\n  }\n\n  function __getRegionText(region) {\n    var result = '';\n\n    for (var i = 0; i < region.lines.length; i++) {\n      var line = __getLineText(region.lines[i]);\n\n      if (line) {\n        result += __appendNewLine(line);\n      }\n    }\n\n    return result;\n  }\n\n  function __appendNewLine(text) {\n    return text + '\\n';\n  } // #endregion copy selection\n  // #region Selection Model\n\n\n  function __selectHitObject(pageIndex, point, selectLine, selectWord) {\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData && (selectLine || selectWord)) {\n      for (var i = 0; i < pageData.regions.length; i++) {\n        var region = pageData.regions[i];\n\n        if (isWithinRect(point, region.bounds)) {\n          for (var j = 0; j < region.lines.length; j++) {\n            var line = region.lines[j];\n\n            if (isWithinRect(point, line.bounds)) {\n              var match = {\n                region: i,\n                line: j,\n                bounds: line.bounds\n              };\n\n              if (selectWord) {\n                for (var k = 0; k < line.words.length; k++) {\n                  if (isWithinRect(point, line.words[k].bounds)) {\n                    match.word = k;\n                    match.bounds = line.words[k].bounds;\n\n                    __selectExactMatch(pageIndex, match);\n\n                    return;\n                  }\n                }\n              } else if (selectLine) {\n                __selectExactMatch(pageIndex, match);\n\n                return;\n              }\n            }\n          }\n        }\n      }\n    }\n  } // match: region, line, word, glyph, endWord, endGlyph\n\n\n  function __selectExactMatch(pageIndex, match) {\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData && match) {\n      if (pageData.regions[match.region]) {\n        __clearSelection();\n\n        var region = pageData.regions[match.region];\n\n        var ctx = __getDrawContext(__findPage(pageIndex), pageData);\n\n        if (IsNumber(match.line) && region.lines[match.line]) {\n          var line = region.lines[match.line];\n          var selectionLine = {\n            words: []\n          };\n          var selectionRegion = {\n            lines: [selectionLine],\n            bounds: atalaJquery.extend({}, region.bounds)\n          };\n          var start = IsNumber(match.word) && line.words[match.word] ? match.word : 0;\n          var end = IsNumber(match.endWord) && line.words[match.endWord] ? match.endWord : IsNumber(match.word) ? start : line.words.length - 1;\n\n          for (var i = start; i <= end; ++i) {\n            var word = line.words[i];\n            var hasGlyphs = !!word.glyphs.length;\n\n            if (hasGlyphs && i === start && IsNumber(match.glyph)) {\n              word = __makePartialWord(word, match.glyph, start === end && IsNumber(match.endGlyph) ? match.endGlyph : word.glyphs.length - 1);\n            } else if (hasGlyphs && i === end && IsNumber(match.endGlyph)) {\n              word = __makePartialWord(word, 0, match.endGlyph);\n            }\n\n            selectionLine.words.push(atalaJquery.extend({}, word));\n\n            if (ctx) {\n              __highlightRegion(ctx, word.bounds.x, word.bounds.y, word.bounds.width, word.bounds.height);\n            }\n          }\n\n          pageData.selection = __createEmptySelection(__makePoint(match.bounds.x, match.bounds.y), __makePoint(match.bounds.right, match.bounds.bottom));\n\n          __insertSelectionRegion(pageData.selection.regions, selectionRegion);\n\n          _data.selectionCache[pageIndex] = pageData;\n        } else {\n          __selectSingleRegionText(pageIndex, match.region);\n        }\n      }\n    }\n  } // regions could overlap and inner text is not a single line,\n  // so it's not comfortable to select whole region since it's likely grab neighbor regions.\n  // Creating a separate method to confidently select region inner objects.\n\n\n  function __selectSingleRegionText(pageIndex, regionIndex) {\n    __clearSelection();\n\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData && pageData.regions[regionIndex]) {\n      var region = pageData.regions[regionIndex];\n\n      var ctx = __getDrawContext(__findPage(pageIndex), pageData);\n\n      pageData.selection = __createEmptySelection(__makePoint(region.bounds.x, region.bounds.y), __makePoint(region.bounds.right, region.bounds.bottom), false);\n\n      var sel = __selectRegionText(ctx, region, pageData.selection.origin, pageData.selection.point);\n\n      if (sel && sel.lines.length > 0) {\n        __insertSelectionRegion(pageData.selection.regions, sel);\n\n        _data.selectionCache[pageIndex] = pageData;\n      }\n    }\n  }\n\n  function __select(startPage, startPoint, endPage, endPoint, rectangular) {\n    var pageFrom = Math.min(startPage, endPage);\n    var pageTo = Math.max(startPage, endPage);\n\n    for (var k in _data.selectionCache) {\n      if (_data.selectionCache.hasOwnProperty(k)) {\n        var idx = parseInt(k, 10);\n\n        if (idx < pageFrom || idx > pageTo) {\n          __clearSelectionUI(idx, _data.selectionCache[idx], true);\n\n          _data.selectionCache[idx].selection = null;\n        }\n      }\n    }\n\n    var left = !rectangular ? 0 : Math.min(startPoint.x, endPoint.x);\n\n    var topLeft = __makePoint(left, 0);\n\n    for (var i = pageFrom; i <= pageTo; i++) {\n      var pageSize = _wdvInternals.getSourcePageSize(i);\n\n      if (rectangular) {\n        pageSize = atalaJquery.extend({}, _wdvInternals.getPageSize(i));\n        pageSize.width *= _wdvInternals.getPageScale(i);\n        pageSize.height *= _wdvInternals.getPageScale(i);\n      }\n\n      var right = !rectangular ? pageSize.width : Math.max(startPoint.x, endPoint.x);\n\n      var bottomRight = __makePoint(right, pageSize.height);\n\n      var start = void 0;\n      var end = void 0;\n\n      if (pageFrom === pageTo) {\n        start = startPoint;\n        end = endPoint;\n      } else if (i === startPage) {\n        start = startPoint; // ? selecting to subsequent pages : selecting to upper pages\n\n        end = i === pageFrom ? bottomRight : topLeft;\n      } else if (i === pageTo || i === pageFrom) {\n        // last page\n        end = endPoint;\n        start = i === pageFrom ? bottomRight : topLeft;\n      } else {\n        start = topLeft;\n        end = bottomRight;\n      }\n\n      var pg = __findPage(i);\n\n      if (!rectangular) {\n        __selectSinglePageText(i, start, end, pg);\n      } else {\n        __selectPageRectangularArea(i, __makePoint(left, start.y), __makePoint(right, end.y), pg);\n      }\n    }\n  }\n\n  function __selectSinglePageText(pageIndex, start, end, page) {\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData && __isSelectionChanged(pageData, start, end, false) && pageData.regions.length > 0) {\n      if (page && page._text) {\n        __clearSelectionUI(pageIndex, pageData, true);\n      }\n\n      pageData.selection = __createEmptySelection(start, end, false);\n\n      var regionsSelection = __findSelectionRegions(pageData, start, end);\n\n      if (regionsSelection && regionsSelection.start && regionsSelection.end) {\n        var ctx = __getDrawContext(page, pageData);\n\n        for (var j = 0; j < pageData.regions.length; j++) {\n          var region = pageData.regions[j];\n          var selectionRegion = null;\n\n          if (region === regionsSelection.start) {\n            if (region === regionsSelection.end) {\n              selectionRegion = __selectRegionText(ctx, region, regionsSelection.startPoint, regionsSelection.endPoint);\n            } else {\n              selectionRegion = __selectRegionText(ctx, region, regionsSelection.startPoint, __getRegionTextEnd(region));\n            }\n          } else if (region === regionsSelection.end) {\n            selectionRegion = __selectRegionText(ctx, region, __getRegionTextStart(region), regionsSelection.endPoint);\n          } else if (__isRegionWithinSelection(region, regionsSelection.start, regionsSelection.end)) {\n            selectionRegion = __selectRegionText(ctx, region, __getRegionTextStart(region), __getRegionTextEnd(region));\n          }\n\n          if (selectionRegion && selectionRegion.lines && selectionRegion.lines.length > 0) {\n            __insertSelectionRegion(pageData.selection.regions, selectionRegion);\n\n            _data.selectionCache[pageIndex] = pageData;\n          }\n        }\n      }\n    }\n  }\n\n  function __findSelectionRegions(pageData, point1, point2) {\n    // considering regions to have columns layout or at least behave like columns.\n    // at first we need to identify regions to select between.\n    // need to find  either regions that contain start and end point, or closest ones(since points could be outside all regions)\n    var topLeft = __makePoint(Math.min(point1.x, point2.x), Math.min(point1.y, point2.y));\n\n    var bottomRight = __makePoint(Math.max(point1.x, point2.x), Math.max(point1.y, point2.y));\n\n    var rect = __ensureRect({\n      x: topLeft.x,\n      y: topLeft.y,\n      width: bottomRight.x - topLeft.x,\n      height: bottomRight.y - topLeft.y\n    });\n\n    var pageLine = __ensureRect({\n      x: 0,\n      y: topLeft.y,\n      width: pageData.bounds.width,\n      height: bottomRight.y - topLeft.y\n    });\n\n    var start = point1,\n        end = point2,\n        startRegion = null,\n        endRegion = null,\n        firstRegion = null,\n        lastRegion = null; // the main problem here is the combination of the facts, that we are not guaranteed that points are ordered,\n    // i.e. we don't know which of them start(to find first subsequent region) and which of them is end(to find last previous region).\n    // we can't just compare points coordinates because of regions\n    // matching rules(for example lower left point, could be near short region, while right one is near other long region that spans through whole page)\n\n    for (var i = 0; i < pageData.regions.length && (!startRegion || !endRegion); i++) {\n      var bounds = pageData.regions[i].bounds;\n\n      if (isIntersects(pageLine, bounds)) {\n        firstRegion = !firstRegion || __isRegionBefore(pageData.regions[i], firstRegion) ? pageData.regions[i] : firstRegion;\n      }\n\n      if (isIntersects(rect, bounds)) {\n        startRegion = !startRegion && isWithinRect(start, pageData.regions[i].bounds) ? pageData.regions[i] : startRegion;\n        endRegion = !endRegion && isWithinRect(end, pageData.regions[i].bounds) ? pageData.regions[i] : endRegion;\n        lastRegion = !lastRegion || __isRegionAfter(pageData.regions[i], lastRegion) ? pageData.regions[i] : lastRegion;\n      }\n    }\n\n    if (startRegion && endRegion) {\n      if (__isRegionBefore(endRegion, startRegion)) {\n        var tmp = endRegion;\n        endRegion = startRegion;\n        startRegion = tmp;\n        start = point2;\n        end = point1;\n      }\n    } else if (firstRegion && lastRegion) {\n      var fakeRegion;\n\n      if (startRegion) {\n        fakeRegion = __makeFakeRegion(end);\n\n        if (__isRegionBefore(startRegion, fakeRegion)) {\n          endRegion = lastRegion;\n          end = null;\n        } else {\n          endRegion = startRegion;\n          end = start;\n          startRegion = firstRegion;\n          start = null;\n        }\n      } else if (endRegion) {\n        fakeRegion = __makeFakeRegion(start);\n\n        if (__isRegionAfter(endRegion, fakeRegion)) {\n          startRegion = firstRegion;\n          start = null;\n        } else {\n          startRegion = endRegion;\n          start = end;\n          endRegion = lastRegion;\n          end = null;\n        }\n      } else {\n        startRegion = firstRegion;\n        endRegion = lastRegion;\n        end = null;\n        start = null;\n      }\n\n      start = start || __getRegionTextStart(startRegion);\n      end = end || __getRegionTextEnd(endRegion);\n    }\n\n    return {\n      start: startRegion,\n      startPoint: start,\n      end: endRegion,\n      endPoint: end\n    };\n  }\n\n  function __selectRegionText(ctx, region, start, end) {\n    // start is expected to be the top point.\n    var selectionRegion = {\n      lines: [],\n      bounds: atalaJquery.extend({}, region.bounds)\n    };\n\n    var pageBounds = __getPageData(region.page).bounds;\n\n    if (region.rotation !== 0) {\n      // rotate all coordinates and make selection matching on 'virtual' region in normal orientation.\n      // but store original objects with right coordinates in selection cache.\n      start = rotatePoint(start, pageBounds, 360 - region.rotation);\n      end = rotatePoint(end, pageBounds, 360 - region.rotation);\n    }\n\n    if (greater(start.y, end.y)) {\n      var p = start;\n      start = end;\n      end = p;\n    }\n\n    for (var j = 0; j < region.lines.length; j++) {\n      var line = region.lines[j];\n      var selectionLine = {\n        words: []\n      };\n\n      var lineBounds = __getNormalizedBounds(line, pageBounds, region.rotation);\n\n      var midLine = greater(lineBounds.y, start.y) && less(lineBounds.bottom, end.y);\n      var topLine = !midLine && isBetween(start.y, lineBounds.y, lineBounds.bottom);\n      var bottomLine = !midLine && isBetween(end.y, lineBounds.y, lineBounds.bottom);\n\n      if (topLine && j > 1) {\n        var prevLineNormalBounds = __getNormalizedBounds(region.lines[j - 1], pageBounds, region.rotation);\n\n        topLine = !isBetween(start.y, prevLineNormalBounds.y, prevLineNormalBounds.bottom);\n        midLine = !topLine && !bottomLine;\n      }\n\n      if (bottomLine && j < region.lines.length - 1) {\n        var nextLineNormalBounds = __getNormalizedBounds(region.lines[j + 1], pageBounds, region.rotation);\n\n        bottomLine = !isBetween(end.y, nextLineNormalBounds.y, nextLineNormalBounds.bottom);\n        midLine = !topLine && !bottomLine;\n      }\n\n      if (midLine || topLine || bottomLine) {\n        for (var k = 0; line.words && k < line.words.length; k++) {\n          var word = line.words[k];\n\n          var wordBounds = __getNormalizedBounds(word, pageBounds, region.rotation);\n\n          var hasGlyphs = word.glyphs && word.glyphs.length;\n          var included = midLine;\n\n          if (!included) {\n            if (topLine && bottomLine) {\n              // single line, getting words between points.\n              // if we are on the same line, no matter where is the upper point.\n              if (greater(start.x, end.x)) {\n                var tmp = start;\n                start = end;\n                end = tmp;\n              }\n\n              included = greater(hasGlyphs ? wordBounds.x : wordBounds.right, start.x) && less(hasGlyphs ? wordBounds.right : wordBounds.x, end.x);\n            } else if (topLine) {\n              //   if there is no glyphs - select whole word if we hit into it. otherwise will check glyphs later.\n              included = greater(hasGlyphs ? wordBounds.x : wordBounds.right, start.x);\n            } else if (bottomLine) {\n              included = less(hasGlyphs ? wordBounds.right : wordBounds.x, end.x);\n            }\n\n            if (!included && hasGlyphs) {\n              var part = null;\n\n              if (topLine && isBetween(start.x, wordBounds.x, wordBounds.right)) {\n                var selectionEnd = bottomLine ? Math.min(wordBounds.right, end.x) : wordBounds.right;\n                part = __selectPartialWord(word, start.x, selectionEnd);\n              }\n\n              if (bottomLine && isBetween(end.x, wordBounds.x, wordBounds.right)) {\n                var selectionStart = topLine ? Math.max(wordBounds.x, start.x) : wordBounds.x;\n                part = __selectPartialWord(word, selectionStart, end.x);\n              }\n\n              if (part) {\n                word = part;\n                included = true;\n              }\n            }\n          }\n\n          if (included) {\n            selectionLine.words.push(atalaJquery.extend({}, word));\n\n            if (ctx) {\n              __highlightRegion(ctx, word.bounds.x, word.bounds.y, word.bounds.width, word.bounds.height);\n            }\n          }\n        }\n\n        if (selectionLine.words.length > 0) {\n          selectionRegion.lines.push(selectionLine);\n        }\n      }\n    }\n\n    return selectionRegion;\n  }\n\n  function __selectPartialWord(word, start, end) {\n    var startGlyph = null,\n        endGlyph = null;\n\n    for (var i = 0; i < word.glyphs.length; ++i) {\n      var glyphBounds = word.glyphs[i].normalizedBounds;\n\n      if (startGlyph === null && greater(glyphBounds.right, start)) {\n        startGlyph = i;\n      }\n\n      if (less(glyphBounds.x, end)) {\n        endGlyph = i;\n      } else {\n        break;\n      }\n    }\n\n    return startGlyph !== null && endGlyph !== null ? __makePartialWord(word, startGlyph, endGlyph) : null;\n  }\n\n  function __makePartialWord(word, startGlyph, endGlyph) {\n    var result = {\n      glyphs: [],\n      text: '',\n      omitSpace: word.omitSpace\n    };\n\n    if (startGlyph >= 0 && endGlyph >= startGlyph && word.glyphs[endGlyph]) {\n      result.glyphs = word.glyphs.slice(startGlyph, endGlyph + 1);\n      var first = word.glyphs[startGlyph].bounds;\n      var last = word.glyphs[endGlyph].bounds;\n      var x = Math.min(first.x, last.x);\n      var y = Math.min(first.y, last.y);\n      var right = Math.max(first.right, last.right);\n      var bottom = Math.max(first.bottom, last.bottom);\n      result.bounds = {\n        x: x,\n        y: y,\n        width: Math.abs(right - x),\n        height: Math.abs(bottom - y)\n      };\n\n      __ensureRect(result.bounds);\n\n      return result;\n    }\n\n    return null;\n  }\n\n  function __selectPageRectangularArea(pageIndex, start, end, page) {\n    var pageData = __getPageData(pageIndex);\n\n    if (pageData && __isSelectionChanged(pageData, start, end, true) && pageData.regions.length > 0) {\n      if (page && page._text) {\n        __clearSelectionUI(pageIndex, pageData, true);\n      }\n\n      var docSpaceStart = __getDocumentPoint(pageIndex, pageData, start);\n\n      var docSpaceEnd = __getDocumentPoint(pageIndex, pageData, end);\n\n      pageData.selection = __createEmptySelection(start, end, true);\n\n      var rect = __ensureRect({\n        x: Math.min(docSpaceStart.x, docSpaceEnd.x),\n        y: Math.min(docSpaceStart.y, docSpaceEnd.y),\n        width: Math.abs(docSpaceEnd.x - docSpaceStart.x),\n        height: Math.abs(docSpaceEnd.y - docSpaceStart.y)\n      });\n\n      rect = __intersect(rect, pageData.bounds);\n\n      if (rect) {\n        var ctx;\n\n        for (var i = 0; i < pageData.regions.length; i++) {\n          if (isIntersects(rect, pageData.regions[i].bounds)) {\n            ctx = ctx || __getDrawContext(page, pageData);\n            var selectionRegion = {\n              lines: [],\n              bounds: atalaJquery.extend({}, pageData.regions[i].bounds)\n            };\n\n            for (var j = 0; j < pageData.regions[i].lines.length; j++) {\n              var line = pageData.regions[i].lines[j];\n              var selectionLine = {\n                words: []\n              };\n\n              for (var k = 0; line.words && k < line.words.length; k++) {\n                var word = line.words[k];\n\n                if (isIntersects(rect, word.bounds)) {\n                  var normalizedRect = __ensureRect(rotateRect(rect, pageData.bounds, (360 - pageData.regions[i].rotation) % 360));\n\n                  var wordBounds = word.normalizedBounds;\n                  var startWithin = greater(wordBounds.x, normalizedRect.x);\n                  var endWithin = less(wordBounds.right, normalizedRect.right);\n\n                  if (!startWithin || !endWithin) {\n                    word = __selectPartialWord(word, Math.max(wordBounds.x, normalizedRect.x), Math.min(wordBounds.right, normalizedRect.right));\n                  }\n\n                  if (word) {\n                    selectionLine.words.push(atalaJquery.extend({}, word));\n\n                    if (ctx) {\n                      __highlightRegion(ctx, word.bounds.x, word.bounds.y, word.bounds.width, word.bounds.height);\n                    }\n                  }\n                }\n              }\n\n              if (selectionLine.words.length > 0) {\n                selectionRegion.lines.push(selectionLine);\n              }\n            }\n\n            if (selectionRegion.lines.length) {\n              __insertSelectionRegion(pageData.selection.regions, selectionRegion);\n            }\n          }\n        }\n\n        if (pageData.selection.regions.length) {\n          pageData.selection.bounds = rect;\n          _data.selectionCache[pageIndex] = pageData;\n        }\n      }\n    }\n  } // if we want to select some region on the page,\n  // it's easier to shrink it to the line -\n  // thus won't grab intersecting lines/regions and won't go out of bounds.\n\n\n  function __getMinimalSelectingRectangle(bounds, region) {\n    if (region) {\n      if (region.rotation % 180 === 0) {\n        var verticalCenter = (bounds.bottom + bounds.y) / 2;\n        return __ensureRect({\n          x: bounds.x,\n          y: verticalCenter,\n          width: bounds.width,\n          height: 0\n        });\n      } else {\n        var horizontalCenter = (bounds.right + bounds.x) / 2;\n        return __ensureRect({\n          x: horizontalCenter,\n          y: bounds.y,\n          width: 0,\n          height: bounds.height\n        });\n      }\n    }\n\n    return null;\n  }\n\n  function __highlightRegion(ctx, x, y, width, height, colorSettings) {\n    if (ctx) {\n      ctx.clearRect(x, y, width, height);\n      colorSettings = colorSettings || _config.selection;\n      ctx.fillStyle = colorSettings.color;\n      ctx.globalAlpha = colorSettings.alpha;\n      ctx.fillRect(x, y, width, height);\n    }\n  }\n\n  function __isSelectionChanged(pageData, start, end, rectangular) {\n    rectangular = !!rectangular;\n    return !pageData.selection || !__pointsEqual(pageData.selection.origin, start) || !__pointsEqual(pageData.selection.point, end) || rectangular !== pageData.selection.rectangular;\n  }\n\n  function __isRegionWithinSelection(region, startRegion, endRegion) {\n    return __isRegionAfter(region, startRegion) && __isRegionBefore(region, endRegion);\n  }\n\n  function __isRegionAfter(region, testRegion) {\n    if (greater(region.bounds.bottom, testRegion.bounds.y)) {\n      if (isContained(region.bounds, testRegion.bounds)) {\n        return region.bounds.x > testRegion.bounds.x;\n      } else {\n        var intersection = __intersect(region.bounds, testRegion.bounds);\n\n        if (intersection) {\n          // this is mostly for small incorrect intersections caused by overlapping extraction data.\n          return intersection.width / intersection.height >= 1 ? greater(region.bounds.y, testRegion.bounds.y) : greater(region.bounds.x, testRegion.bounds.x);\n        } else {\n          if (greater(region.bounds.y, testRegion.bounds.bottom)) {\n            return true;\n          } else if (less(region.bounds.bottom, testRegion.bounds.y)) {\n            return false;\n          }\n\n          if (greater(region.bounds.x, testRegion.bounds.x)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function __makeFakeRegion(point) {\n    var bounds = __ensureRect({\n      x: point.x,\n      y: point.y,\n      width: 0,\n      height: 0\n    });\n\n    return {\n      lines: [],\n      bounds: bounds\n    };\n  }\n\n  function __isRegionBefore(region, testRegion) {\n    return !__isRegionAfter(region, testRegion);\n  }\n\n  function __insertSelectionRegion(list, region) {\n    var i = 0;\n\n    for (; i < list.length; i++) {\n      if (__isRegionBefore(region, list[i])) {\n        break;\n      }\n    }\n\n    Array.prototype.splice.call(list, i, 0, region);\n  }\n\n  function __createEmptySelection(origin, point, rectangular) {\n    return {\n      origin: origin,\n      point: point,\n      rectangular: !!rectangular,\n      regions: []\n    };\n  } // #endregion Selection Model\n  // #region Search\n\n\n  function __search(text, startPage, callback) {\n    if (typeof startPage === 'function') {\n      callback = startPage;\n      startPage = 0;\n    }\n\n    return __searchOnPages(text, 0, _wdvInternals._controllers.document.getPageCount() - 1, startPage, callback);\n  }\n\n  function __searchOnPages(text, startPage, endPage, activePage, callback) {\n    var _this6 = this;\n\n    var pageCount = _wdvInternals._controllers.document.getPageCount();\n\n    var errorThrown = false;\n\n    if (typeof startPage === 'function') {\n      callback = startPage;\n      startPage = 0;\n      endPage = pageCount - 1;\n      activePage = startPage;\n    }\n\n    if (typeof endPage === 'function') {\n      callback = endPage;\n      endPage = pageCount - 1;\n      activePage = startPage;\n    }\n\n    if (typeof activePage === 'function') {\n      callback = activePage;\n      activePage = startPage;\n    }\n\n    var pageIdxCheck = function pageIdxCheck(idx, idxName) {\n      TextController_newArrowCheck(this, _this6);\n\n      if (errorThrown) {\n        return null;\n      }\n\n      var idxIsString = false;\n      var result = idx;\n\n      if (typeof idx === 'string') {\n        result = ParseInt(idx);\n        idxIsString = true;\n      }\n\n      if ((result !== null || idxIsString) && result !== undefined && typeof result !== 'number') {\n        __throwError('searchOnPages', idxName + \" page '\" + JSON.stringify(idx) + \"' is not a correct page index.\");\n\n        errorThrown = true;\n        return null;\n      }\n\n      return result;\n    }.bind(this);\n\n    var checkedStartPage = pageIdxCheck(startPage, 'Start');\n    var checkedEndPage = pageIdxCheck(endPage, 'End');\n    var checkedActivePage = pageIdxCheck(activePage, 'Active');\n\n    if (errorThrown) {\n      return null;\n    }\n\n    if (checkedStartPage === null || !IsInteger(checkedStartPage)) {\n      checkedStartPage = 0;\n    }\n\n    if (checkedEndPage === null || !IsInteger(checkedEndPage)) {\n      checkedEndPage = pageCount - 1;\n    }\n\n    if (checkedActivePage === null || !IsInteger(checkedActivePage)) {\n      checkedActivePage = checkedStartPage;\n    }\n\n    if (checkedStartPage < 0 || checkedStartPage >= pageCount) {\n      __throwError('searchOnPages', \"Start page \" + checkedStartPage + \" is out of range.\");\n\n      return null;\n    }\n\n    if (checkedEndPage < 0 || checkedEndPage >= pageCount) {\n      __throwError('searchOnPages', \"End page \" + checkedEndPage + \" is out of range.\");\n\n      return null;\n    }\n\n    if (checkedStartPage > checkedEndPage) {\n      __throwError('searchOnPages', 'Start page is greater than end page.');\n\n      return null;\n    }\n\n    if (checkedStartPage > checkedActivePage || checkedEndPage < checkedActivePage) {\n      __throwError('searchOnPages', \"Active page \" + checkedActivePage + \" is out of range.\");\n\n      return null;\n    }\n\n    if (text !== null && text !== undefined && typeof text !== 'string') {\n      __throwError('searchOnPages', \"Text to search value \" + JSON.stringify(text) + \" is not a valid text to search.\");\n\n      return null;\n    }\n\n    if (callback !== null && callback !== undefined && typeof callback !== 'function') {\n      __throwError('searchOnPages', \"Callback value \" + JSON.stringify(callback) + \" is not a valid callback function.\");\n\n      return null;\n    }\n\n    __clearSearchResults();\n\n    __clearSelection();\n\n    if (text && text.length > 2) {\n      var searchQuery = {\n        sourceQuery: text,\n        text: text.toLocaleLowerCase(),\n        start: checkedStartPage,\n        end: checkedEndPage,\n        active: checkedActivePage\n      };\n      _data.searchQuery = searchQuery;\n\n      if (callback) {\n        var iterator = new __CSearchIterator(searchQuery, callback);\n        _data.searchQuery.iterator = iterator;\n        return iterator;\n      } else {\n        callback = function callback(it, match) {\n          if (it.isValid() && match !== null) {\n            __selectPageText(match.page, match.region, match.line, match.word);\n          }\n        };\n\n        var _iterator = new __CSearchIterator(searchQuery, callback);\n\n        _data.searchQuery.iterator = _iterator;\n      }\n    } else {\n      _pages.forEach(function (page) {\n        TextController_newArrowCheck(this, _this6);\n\n        if (page._index >= checkedStartPage && page._index <= checkedEndPage) {\n          __showLayer(page._index, page);\n        }\n      }.bind(this));\n    }\n\n    return null;\n  }\n  /**\r\n   * Callback signature for {@link Atalasoft.Controls.WebDocumentViewer~TextController#searchOnPages|text.searchOnPages}, {@link Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#next|next}, {@link Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#prev|prev} methods.\r\n   * @callback TextSearchCallback\r\n   * @param {Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator} iterator - Current iterator instance.\r\n   *\r\n   * It's recommended to call {@link Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#isValid|isValid} method when callback is called, to check whether iterator is still active. In case if search is cancelled(new search started), callback on the obsolete iterator will be called once to indicate that search is finished for particular query.\r\n   *\r\n   * @param {TextSearchResult} [match] - Current search query match descriptor. If match argument is null, no subsequent result are found.\r\n   */\n\n  /**\r\n   * @typedef {Object} TextSearchResult - Represents single search result descriptor.\r\n   * @property {number} page - Page index of the match.\r\n   * @property {number} region - Index of the text region where match is occurred.\r\n   * @property {number} line - Index of the text line within region where match is occurred.\r\n   * @property {number} word - Index of the word within text line where match is occurred.\r\n   */\n\n  /**\r\n   * WebDocumentViewer Search Results Iterator.\r\n   * @class\r\n   * @inner\r\n   * @name TextSearchIterator\r\n   * @alias TextSearchIterator\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer~TextController\r\n   */\n\n\n  function __CSearchIterator(query, callback) {\n    var maxSearchAhead = 3;\n    var start = query.start;\n    var end = query.end;\n    var active = query.active;\n    var currentPage = -1;\n    var pageMatch = -1;\n    var pageTotal = 0;\n\n    var _this = this;\n\n    var unloadedPagesCache = [];\n    var awaitedPromise;\n    var requestsQueue = [];\n\n    var _current = __makeMatchInfo(-1);\n\n    __init();\n\n    function __init() {\n      /**\r\n       * Indicates whether search should be wrapped around when first or last document page is match is reached.\r\n       * @name Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#wrap\r\n       * @type {boolean}\r\n       */\n      _this.wrap = true;\n\n      _internalEvents.on('pagetextloaded', __onNewPageLoaded);\n\n      _wdv.bind({\n        pageshown: __searchPageShown\n      });\n\n      setTimeout(function () {\n        // highlight all occurrences on the visible pages.\n        for (var i = 0; i < _pages.length; i++) {\n          var pageIdx = _pages[i]._index;\n\n          if (pageIdx < start || pageIdx > end) {\n            continue;\n          }\n\n          var pageData = __getPageData(pageIdx);\n\n          if (pageData && !pageData.loading) {\n            pageData.searchResult = __searchPage(pageData, query.text);\n\n            if (pageData.searchResult.length) {\n              __showLayer(pageIdx, _pages[i]);\n\n              if (pageIdx === active) {\n                pageTotal = pageData.searchResult.length;\n                currentPage = active;\n              }\n            }\n          }\n        }\n\n        __next(callback);\n      }, 0);\n    }\n    /**\r\n     * Advances current item to the next query match or adds operation to the queue in case if next match is currently awaited.\r\n     * @param {TextSearchCallback} callback - function that that is called when next match is found.\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#next\r\n     */\n\n\n    _this.next = __next;\n\n    function __next(callback) {\n      requestsQueue.push({\n        action: __advancePosition,\n        args: [true, __makeStateShiftCallback(callback)]\n      });\n\n      __executeNextRequest();\n    }\n    /**\r\n     * Advances current item to the previous query match or adds operation to the queue in case if next match is currently awaited.\r\n     * @param {TextSearchCallback} callback - Function that that is called when previous match is found.\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#prev\r\n     */\n\n\n    _this.prev = __prev;\n\n    function __prev(callback) {\n      requestsQueue.push({\n        action: __advancePosition,\n        args: [false, __makeStateShiftCallback(callback)]\n      });\n\n      __executeNextRequest();\n    }\n\n    function __executeNextRequest() {\n      if (!awaitedPromise && requestsQueue.length) {\n        var request = requestsQueue.shift();\n\n        if (request && typeof request.action === 'function') {\n          request.action.apply(_this, request.args);\n        }\n      }\n    }\n\n    function __advancePosition(forward, callback) {\n      if (__isValid()) {\n        var offset = forward ? 1 : -1;\n\n        var pageData = __getPageData(currentPage);\n\n        var hasResult = pageData && pageData.searchResult && pageData.searchResult.length;\n        var hasNext = forward ? pageMatch >= -1 && pageMatch < pageTotal - 1 : pageMatch > 0 && pageMatch <= pageTotal;\n\n        if (hasResult && hasNext) {\n          pageMatch += offset;\n          var match = pageData.searchResult[pageMatch];\n          _current = __makeMatchInfo(currentPage, match);\n\n          __selectExactMatch(currentPage, match);\n\n          var textRotation = pageData ? pageData.rotation : 0;\n\n          var m = _wdvInternals.getViewerTransform(currentPage, textRotation);\n\n          var rect = __getMinimalSelectingRectangle(match.bounds, pageData.regions[match.region]);\n\n          var pagePoint = __makePoint(m.x(rect.x, rect.y), m.y(rect.x, rect.y));\n\n          _wdvInternals.showPagePoint(currentPage, pagePoint, PageSelection.Center, function () {\n            callback(_this, __makeMatchInfo(currentPage, match));\n          });\n        } else {\n          // if already search-in - just wait for previous results.\n          awaitedPromise = awaitedPromise || __findNextMatchPage(query.text, currentPage >= 0 ? currentPage + offset : active, forward).done(function (index, pageData) {\n            if (__isValid()) {\n              if (index >= 0 && pageData) {\n                currentPage = index;\n                pageTotal = pageData.searchResult.length;\n                pageMatch = forward ? -1 : pageTotal;\n\n                __advancePosition(forward, callback);\n              }\n            } else {\n              callback(_this, null);\n            }\n          }).fail(function () {\n            callback(_this, null);\n          });\n        }\n      } else {\n        callback(_this, null);\n      }\n    }\n    /**\r\n     * Gets the query text for this iterator.\r\n     * @returns {string}\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#getQuery\r\n     */\n\n\n    _this.getQuery = __getQueryText;\n\n    function __getQueryText() {\n      return query.sourceQuery;\n    }\n    /**\r\n     * Indicates whether this iterator corresponds to the active search.\r\n     *\r\n     * If `false`, next/prev methods are always returning `null` match.\r\n     * @returns {boolean}\r\n     *\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#isValid\r\n     */\n\n\n    _this.isValid = __isValid;\n\n    function __isValid() {\n      var isActive = _data.searchQuery === query;\n\n      if (!isActive) {\n        __disposeIterator();\n      }\n\n      return isActive;\n    }\n    /**\r\n     * Indicates whether this is executing background search.\r\n     * If `true`, subsequent next/prev calls are stored into the search queue.\r\n     *\r\n     * Method could be used, for example, to determine whether search will be continued after particular callback call, and thus to hide or preserve search loading mask.\r\n     *\r\n     * @returns {boolean}\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#isSearching\r\n     */\n\n\n    _this.isSearching = __isSearching;\n\n    function __isSearching() {\n      return __isValid() && (awaitedPromise || requestsQueue.length > 0);\n    }\n    /**\r\n     * Returns the formatted text for the whole line containing current match.\r\n     * @returns {string}\r\n     *\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#getCurrentLineText\r\n     */\n\n\n    _this.getCurrentLineText = __getCurrentLineText;\n\n    function __getCurrentLineText() {\n      if (__isValid() && _current && _current.page >= 0) {\n        var pageData = __getPageData(_current.page);\n\n        if (pageData && pageData.regions[_current.region] && pageData.regions[_current.region].lines[_current.line]) {\n          return __getLineText(pageData.regions[_current.region].lines[_current.line]);\n        }\n      }\n\n      return null;\n    }\n\n    function __findNextMatchPage(text, pageIndex, forward, deferred, wrapped) {\n      deferred = deferred || atalaJquery.Deferred();\n      var haveUnloaded;\n\n      if (__isValid()) {\n        // let's do everything async to not block browser.\n        setTimeout(function () {\n          for (; pageIndex >= start && pageIndex <= end; pageIndex += forward ? 1 : -1) {\n            var pageData = __getPageData(pageIndex);\n\n            if (pageData && !pageData.loading) {\n              pageData.searchResult = __searchPage(pageData, query.text);\n\n              if (pageData.searchResult.length > 0) {\n                deferred.resolve(pageIndex, pageData);\n                return;\n              }\n            } else if (pageData && pageData.loading && pageData.promise) {\n              __makeContinuationForLoadingPage(text, pageIndex, forward, deferred, wrapped, pageData);\n\n              return;\n            } else if (!pageData) {\n              // it's 99% impossible that we'll get here while page is being loaded. but even if we do - let's just threat it with server search.\n              if (unloadedPagesCache[pageIndex]) {\n                continue;\n              }\n\n              haveUnloaded = true;\n\n              __searchUnloadedPage(text, pageIndex, forward, deferred);\n\n              return;\n            }\n          }\n\n          if (_this.wrap && !haveUnloaded && !wrapped) {\n            if (pageIndex < start && !forward) {\n              pageIndex = end;\n            } else if (pageIndex > end && forward) {\n              pageIndex = start;\n            } // pass wrapped = true, so we'll exit infinite loop if no matches found. \n\n\n            __findNextMatchPage(text, pageIndex, forward, deferred, true);\n\n            return;\n          }\n\n          deferred.reject();\n        }, 0);\n      }\n\n      return deferred.promise();\n    }\n\n    function __makeContinuationForLoadingPage(text, index, forward, deferred, wrapped, pageData) {\n      pageData.promise.then(function () {\n        __findNextMatchPage(text, index, forward, deferred, wrapped);\n      });\n    }\n\n    function __searchUnloadedPage(text, pageIndex, forward, deferred) {\n      var searchInterval = __getServerSearchInterval(pageIndex, forward);\n\n      if (!searchInterval.pages.length) {\n        deferred.reject();\n      } else {\n        __serverSearchNextPage(text, searchInterval, maxSearchAhead).done(function (foundPage) {\n          if (foundPage === null) {\n            if (__isValid()) {\n              var pageRef = searchInterval.pages[searchInterval.pages.length - 1];\n              var docIndex = pageRef.hasOwnProperty('di') ? pageRef.di : pageRef.i;\n\n              __findNextMatchPage(text, docIndex, forward, deferred);\n            } else {\n              deferred.reject();\n            }\n          } else {\n            // todo: check if we came here with no results and stopped on nextLoadedPage\n            var foundPageData = __getPageData(foundPage);\n\n            deferred.resolve(foundPage, foundPageData);\n          }\n        }).fail(function () {\n          deferred.reject();\n        });\n      }\n    }\n\n    function __searchPage(pageData, text) {\n      var queryLength = text.length;\n      var result = [];\n\n      if (!pageData.searchResult) {\n        for (var i = 0; i < pageData.regions.length; i++) {\n          for (var j = 0; j < pageData.regions[i].lines.length; j++) {\n            var line = pageData.regions[i].lines[j];\n            var charPosition = 0;\n            var rectangles = [];\n            var lineText = '';\n\n            for (var k = 0; k < line.words.length; k++) {\n              var word = line.words[k];\n              var hasGlyphs = word.glyphs && word.glyphs.length;\n\n              if (__wordsSeparated(word, k >= 1 ? line.words[k - 1] : null)) {\n                lineText += ' ';\n                ++charPosition;\n              }\n\n              for (var l = 0; l < (hasGlyphs ? word.glyphs.length : word.text.length); l++) {\n                rectangles[charPosition++] = {\n                  bounds: hasGlyphs ? word.glyphs[l].bounds : word.bounds,\n                  region: i,\n                  line: j,\n                  word: k,\n                  glyph: __selectSingleRegionText ? l : -1\n                };\n                lineText += (hasGlyphs ? word.glyphs[l].text : word.text[l]).toLocaleLowerCase();\n              }\n            }\n\n            var idx = 0;\n\n            do {\n              idx = lineText.indexOf(text, idx);\n\n              if (idx >= 0) {\n                var startIdx = idx;\n\n                while (!rectangles[startIdx] && startIdx < idx + queryLength) {\n                  startIdx++;\n                }\n\n                var startRect = rectangles[startIdx];\n                var endIdx = Math.min(idx + queryLength - 1, rectangles.length);\n\n                while (!rectangles[endIdx] && endIdx > idx) {\n                  --endIdx;\n                }\n\n                var endRect = rectangles[endIdx];\n\n                var bounds = __ensureRect({\n                  x: startRect.bounds.x,\n                  y: startRect.bounds.y,\n                  width: Math.abs(endRect.bounds.right - startRect.bounds.x),\n                  height: Math.abs(endRect.bounds.bottom - startRect.bounds.y)\n                });\n\n                result.push({\n                  bounds: bounds,\n                  region: startRect.region,\n                  line: startRect.line,\n                  word: startRect.word,\n                  glyph: startRect.glyph,\n                  endWord: endRect.word,\n                  endGlyph: endRect.glyph\n                });\n              }\n            } while (idx++ >= 0);\n          }\n        }\n      } else {\n        result = pageData.searchResult;\n      }\n\n      return result;\n    }\n\n    function __getServerSearchInterval(startPageindex, forward) {\n      var pageIndex = startPageindex,\n          docTextUrl = null;\n      var pages = [];\n\n      for (; pageIndex >= start && pageIndex <= end && pages.length <= 20; pageIndex += forward ? 1 : -1) {\n        var textUrl = null;\n\n        var pageDef = _wdvInternals._controllers.document.getPageDefinition(pageIndex);\n\n        var sourceIndex = pageDef.index;\n\n        if (pageDef.uri) {\n          textUrl = pageDef.uri;\n        } // we want to search through continuous set of pages of the same file.\n\n\n        if (docTextUrl !== textUrl && pageIndex !== startPageindex) {\n          break;\n        }\n\n        docTextUrl = textUrl;\n        var queryItem = {\n          //index int the source file\n          i: sourceIndex\n        };\n\n        if (sourceIndex !== pageIndex) {\n          // index in the current document state.\n          queryItem.di = pageIndex;\n        }\n\n        pages.push(queryItem); // found the page that either loaded or loading. breaking the interval.\n\n        var pageData = __getPageData(pageIndex);\n\n        if (pageData && !pageData.loading) {\n          break;\n        }\n      }\n\n      var interval = {\n        textUrl: docTextUrl || _wdv.config.documenturl,\n        pages: pages\n      };\n      return interval;\n    }\n\n    function __serverSearchNextPage(text, searchInterval, searchLimit) {\n      var deferred = atalaJquery.Deferred();\n      var hRequest = {\n        type: 'pagetextsearch',\n        serverurl: _wdv.config.serverurl,\n        query: '?pagetextsearch=',\n        method: 'POST',\n        data: {\n          atala_query: text,\n          atala_docurl: searchInterval.textUrl,\n          atala_maxcount: searchLimit || maxSearchAhead,\n          atala_pages: JSON.stringify(searchInterval.pages)\n        },\n        cancel: false\n      };\n\n      var success = function success(response) {\n        if (__isValid()) {\n          var foundPage = -1;\n\n          if (response && response.searchResults && response.searchResults.length) {\n            // consume all preloaded text data. find matching page.\n            for (var i = 0; i < response.searchResults.length; i++) {\n              var page = response.searchResults[i];\n              var docIndex = page.hasOwnProperty('di') ? page.di : page.i;\n\n              var pageData = __getPageData(docIndex);\n\n              if (!pageData && page.text) {\n                _wdvInternals._controllers.document.updatePageText(docIndex, page.text);\n\n                __onPageTextLoaded({\n                  pageText: page.text,\n                  customData: response.customData\n                }, page.text, docIndex);\n              }\n\n              if (page.count <= 0 && foundPage < 0) {\n                if (pageData) {\n                  pageData.searchResult = [];\n                } else {\n                  unloadedPagesCache[docIndex] = [];\n                }\n              } else if (foundPage < 0 && page.count > 0) {\n                // requested pages order have sense, so we need to get exactly first match and not overwrite\n                foundPage = docIndex;\n              }\n            }\n          }\n\n          deferred.resolve(foundPage >= 0 ? foundPage : null);\n        } else {\n          deferred.reject();\n        }\n      };\n\n      var fail = function fail() {\n        deferred.reject();\n      };\n\n      _wdvInternals.makeHandlerRequest(hRequest, success, fail);\n\n      return deferred.promise();\n    }\n    /**\r\n     * Disposes the current iterator. Calling this method is optional. Abandoned iterators will be disposed automatically.\r\n     * @ignore\r\n     *\r\n     * @function Atalasoft.Controls.WebDocumentViewer~TextController~TextSearchIterator#dispose\r\n     */\n\n\n    _this.dispose = __disposeIterator;\n\n    function __disposeIterator() {\n      _internalEvents.off('pagetextloaded', __onNewPageLoaded);\n\n      _wdv.unbind({\n        pageshown: __searchPageShown\n      });\n\n      unloadedPagesCache = [];\n    }\n\n    function __onNewPageLoaded(evt) {\n      var pageData = evt.text;\n      var idx = evt.index;\n\n      if (__isValid() && pageData && idx >= start && idx <= end) {\n        pageData.searchResult = __searchPage(pageData, query.text);\n\n        if (unloadedPagesCache[idx]) {\n          Array.prototype.splice.call(unloadedPagesCache, idx, 1);\n        }\n\n        if (pageData.searchResult.length) {\n          var page = _wdvInternals.findPageFromIndex(idx);\n\n          if (page) {\n            __showLayer(idx, page);\n          }\n        }\n      }\n    }\n\n    function __searchPageShown(e) {\n      if (__isValid() && e.page && e.index >= start && e.index <= end) {\n        var pageData = __getPageData(e.index);\n\n        if (pageData && !pageData.loading && !pageData.searchResult) {\n          setTimeout(function () {\n            pageData.searchResult = __searchPage(pageData, query.text);\n\n            __showLayer(e.index, e.page);\n          }, 0);\n        }\n      }\n    }\n\n    function __makeStateShiftCallback(callback) {\n      return function () {\n        awaitedPromise = null;\n\n        if (callback) {\n          callback.apply(this, arguments);\n        }\n\n        __executeNextRequest();\n      };\n    }\n\n    function __makeMatchInfo(page, match) {\n      return {\n        page: page,\n        region: match ? match.region : 0,\n        line: match ? match.line : 0,\n        word: match ? match.word : 0\n      };\n    }\n  }\n\n  function __clearSearchResults() {\n    var matchPages = [];\n\n    for (var i = 0; i < _wdvInternals._controllers.document.getPageCount(); i++) {\n      var pageData = __getPageData(i);\n\n      if (pageData && pageData.searchResult) {\n        if (pageData.searchResult.length) {\n          matchPages[i] = true;\n        }\n\n        pageData.searchResult = null;\n      }\n    }\n\n    for (var j = 0; j < _pages.length; ++j) {\n      if (matchPages[j]) {\n        __showLayer(j, _pages[j]);\n      }\n    }\n\n    _data.searchQuery = null;\n  } // #endregion Search\n  // #region Ajax/Json Methods\n\n\n  _self.createHandlerRequest = __createHandlerRequest;\n\n  function __createHandlerRequest(serverUrl, textUrl) {\n    var hRequest = {\n      type: 'textdata',\n      serverurl: serverUrl,\n      query: '?atalatextdata=',\n      method: 'GET',\n      data: {\n        atala_docurl: textUrl\n      },\n      cancel: false,\n      info: {\n        ocr: {},\n        error: undefined\n      }\n    };\n    return hRequest;\n  }\n\n  _self.makeHandlerRequest = __makeHandlerRequestAsync;\n\n  function __makeHandlerRequestAsync(hRequest, callback) {\n    __clearText(); // this handler is not used right now - assuming that whole document text could be bigger than x86 browser could fit into memory. \n    // defined inline so we have a closure reference to callback\n\n\n    function __complete(info) {\n      // we assume that all requests made through this method are for fields\n      __onTextLoaded(info); // only execute the callback if it exists\n\n\n      if (typeof callback === 'function') {\n        callback.call();\n      }\n    }\n\n    _wdvInternals.makeHandlerRequest(hRequest, __complete, __complete);\n  }\n\n  _self.loadText = __onTextLoaded;\n\n  function __onTextLoaded(info) {\n    if (info) {\n      if (info.error) {\n        __throwError('TextLoadError', info.error);\n\n        __clearText();\n      }\n\n      if (info.text.pages) {\n        for (var i = 0; i < info.text.pages.length; ++i) {\n          __validateTextPage(info.text.pages[i], i);\n        }\n      }\n\n      _wdvInternals._controllers.document.initDocumentText(info.text);\n\n      __triggerEvent({\n        type: 'textloaded'\n      });\n    }\n  }\n\n  function __ensurePageTextLoaded(pageIndex) {\n    var deferred = atalaJquery.Deferred();\n\n    var pageData = __getPageData(pageIndex);\n\n    var pageDef = _wdvInternals._controllers.document.getPageDefinition(pageIndex);\n\n    if (!pageData && pageDef) {\n      pageData = {\n        loading: true,\n        regions: [],\n        promise: deferred\n      };\n\n      _wdvInternals._controllers.document.updatePageText(pageIndex, pageData);\n\n      var texturl = pageDef.uri || _wdv.config.documenturl;\n      var serverurl = _wdv.config.serverurl;\n      setTimeout(function () {\n        var hRequest = {\n          type: 'pagetextdata',\n          serverurl: serverurl,\n          query: '?atalapagetext=',\n          method: 'GET',\n          data: {\n            atala_docurl: texturl,\n            atala_index: pageDef.index\n          },\n          cancel: false,\n          info: {\n            page: pageData,\n            error: undefined\n          }\n        };\n\n        var handler = __makePageTextLoadedHandler(pageData, pageIndex, deferred);\n\n        _wdvInternals.makeHandlerRequest(hRequest, handler, handler);\n      }, 0);\n    } else {\n      deferred.resolve(pageIndex, pageData);\n    }\n\n    return deferred.promise();\n  }\n\n  _self.loadPageText = __loadPageTextAsync;\n\n  function __loadPageTextAsync(serverUrl, formUrl, callback) {\n    var hRequest = __createHandlerRequest(serverUrl, formUrl);\n\n    __makeHandlerRequestAsync(hRequest, callback);\n  } // #endregion\n  // #region Helper Methods\n\n\n  function __onPageTextLoaded(info, pageData, pageIndex, deferred) {\n    if (info && info.pageText) {\n      if (pageData.promise === deferred) {\n        pageData.loading = false;\n        pageData.promise = undefined;\n      }\n\n      if (info.error) {\n        __throwError('TextLoadError', info.error);\n\n        pageData.regions = [];\n\n        if (deferred && deferred.reject) {\n          deferred.reject(pageIndex);\n        }\n      } else {\n        __validateTextPage(info.pageText, pageIndex);\n\n        pageData.regions = info.pageText.regions ? info.pageText.regions : [];\n        atalaJquery.extend(pageData, info.pageText);\n        var args = {\n          type: 'pagetextloaded',\n          index: pageIndex,\n          text: pageData,\n          customData: info.customData\n        };\n\n        __triggerInternalEvent(args);\n\n        __triggerEvent(args);\n\n        if (deferred && deferred.resolve) {\n          deferred.resolve(pageIndex, pageData);\n        }\n      }\n    }\n  }\n\n  function __findPage(index) {\n    for (var i = 0; i < _pages.length; i++) {\n      if (_pages[i]._index === index) {\n        return _pages[i];\n      }\n    }\n\n    return null;\n  }\n\n  function __getDrawContext(page, pageData) {\n    if (page && page._text) {\n      var canvas = page._text[0];\n\n      if (canvas.getContext) {\n        var ctx = canvas.getContext('2d');\n        var textRotation = pageData ? pageData.rotation : 0;\n\n        var matrix = _wdvInternals.getViewerTransform(page._index, textRotation);\n\n        ctx.setTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.e, matrix.f);\n        return ctx;\n      }\n    }\n\n    return null;\n  }\n\n  function __makePageTextLoadedHandler(pageData, pageIndex, deferred) {\n    return function (info) {\n      __onPageTextLoaded(info, pageData, pageIndex, deferred);\n    };\n  }\n\n  function __validateTextPage(page, pageIndex) {\n    if (page) {\n      __validateTextObject(page);\n\n      page.regions = page.regions || []; // simple cache for rotated regions to quickly detect mouse cursor.\n\n      page.rotatedRegions = [];\n      page.rotation = page.rotation || 0;\n\n      for (var i = page.regions.length - 1; i >= 0; --i) {\n        page.regions[i].page = pageIndex;\n\n        if (!__validateTextRegion(page.regions[i], page.bounds)) {\n          Array.prototype.splice.call(page.regions, i, 1);\n        } else {\n          page.regions[i].index = i;\n\n          if (page.regions[i].rotation) {\n            page.rotatedRegions.push(page.regions[i]);\n          }\n        }\n      }\n\n      page.regions.sort(function (r1, r2) {\n        return __isRegionBefore(r1, r2) ? -1 : 1;\n      });\n    }\n  }\n\n  function __validateTextRegion(region, pageBounds) {\n    if (!__validateTextObject(region)) {\n      return false;\n    }\n\n    region.rotation = region.rotation || 0;\n    region.lines = region.lines || [];\n    var linesCount = region.lines.length;\n\n    for (var i = region.lines.length - 1; i >= 0; --i) {\n      if (!__validateLine(region.lines[i], pageBounds, region.rotation)) {\n        Array.prototype.splice.call(region.lines, i, 1);\n      }\n    }\n\n    if (linesCount > 0 && region.lines.length === 0) {\n      // if something is horribly bad and we're eliminated whole region data, let's report it.\n      __throwError('TextLoadError', 'Invalid region data received.');\n    }\n\n    return linesCount > 0 ? region.lines.length > 0 : true;\n  }\n\n  function __validateLine(line, pageBounds, regionRotation) {\n    if (!__validateTextObject(line, pageBounds, regionRotation)) {\n      return false;\n    }\n\n    line.words = line.words || [];\n    var count = line.words.length;\n\n    for (var i = line.words.length - 1; i >= 0; --i) {\n      if (!__validateWord(line.words[i], pageBounds, regionRotation)) {\n        Array.prototype.splice.call(line.words, i, 1);\n      }\n    }\n\n    return count > 0 ? line.words.length > 0 : true;\n  }\n\n  function __validateWord(word, pageBounds, regionRotation) {\n    if (!__validateTextObject(word, pageBounds, regionRotation)) {\n      return false;\n    }\n\n    word.glyphs = word.glyphs || [];\n    word.text = word.text || '';\n\n    if (word.os) {\n      word.omitSpace = word.os;\n      delete word.os;\n    }\n\n    for (var i = word.glyphs.length - 1; i >= 0; --i) {\n      var g = word.glyphs[i];\n\n      if (!__validateGlyph(g, pageBounds, regionRotation)) {\n        Array.prototype.splice.call(word.glyphs, i, 1);\n      }\n    }\n\n    return true;\n  }\n\n  function __validateGlyph(glyph, pageBounds, regionRotation) {\n    if (!__validateTextObject(glyph, pageBounds, regionRotation)) {\n      return false;\n    }\n\n    if (!glyph.text) {\n      return false;\n    }\n\n    return true;\n  }\n\n  function __validateTextObject(obj, pageBounds, regionRotation) {\n    var result = false;\n\n    if (obj) {\n      if (obj.b && typeof obj.b === 'string') {\n        var boundsData = obj.b.split(';');\n        obj.bounds = {\n          x: parseFloat(boundsData[0]),\n          y: parseFloat(boundsData[1]),\n          width: parseFloat(boundsData[2]),\n          height: parseFloat(boundsData[3])\n        };\n        delete obj.b;\n        result = true;\n      } else if (obj.bounds && obj.bounds.hasOwnProperty('x') && obj.bounds.hasOwnProperty('y') && obj.bounds.hasOwnProperty('width') && obj.bounds.hasOwnProperty('height')) {\n        __ensureRect(obj.bounds);\n\n        result = true;\n      }\n    } else {\n      obj = {};\n    }\n\n    if (!obj.bounds) {\n      obj.bounds = {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    __ensureRect(obj.bounds);\n\n    if (obj.bounds) {\n      obj.normalizedBounds = __getNormalizedBounds(obj, pageBounds, regionRotation);\n    }\n\n    return result;\n  } // gets the text object bounds counter-rotated to region rotation. This is used for selection matching:\n  // to compare all coordinates in a single TtoR-TtoB direction\n\n\n  function __getNormalizedBounds(pageObject, pageRect, rotation) {\n    if (!pageObject.normalizedBounds) {\n      if (rotation % 360 === 0) {\n        pageObject.normalizedBounds = pageObject.bounds;\n        return pageObject.normalizedBounds;\n      } else {\n        pageObject.normalizedBounds = __ensureRect(rotateRect(pageObject.bounds, pageRect, 360 - rotation));\n      }\n    }\n\n    return pageObject.normalizedBounds;\n  }\n\n  function __ensureRect(rect) {\n    rect.right = rect.x + rect.width;\n    rect.bottom = rect.y + rect.height;\n    return rect;\n  }\n\n  function less(a, b) {\n    return a < b + Tolerance;\n  }\n\n  function greater(a, b) {\n    return a > b - Tolerance;\n  }\n\n  function __pointsEqual(p1, p2) {\n    return p1 && p2 && p1.x === p2.x && p1.y === p2.y;\n  }\n\n  function isBetween(p, start, end) {\n    return greater(p, start) && less(p, end);\n  }\n\n  function isWithinRect(point, rect) {\n    if (!rect) {\n      return false;\n    }\n\n    return isBetween(point.x, rect.x, rect.right) && isBetween(point.y, rect.y, rect.bottom);\n  }\n\n  function isIntersects(r1, r2) {\n    if (!(r1 || r2)) {\n      return false;\n    }\n\n    var intersects = greater(r1.right, r2.x) && greater(r2.right, r1.x) && greater(r1.bottom, r2.y) && greater(r2.bottom, r1.y) || isContained(r1, r2);\n    return intersects;\n  }\n\n  function isContained(r1, r2) {\n    if (!(r1 || r2)) {\n      return false;\n    }\n\n    var container = r1.width > r2.width ? r1 : r2;\n    r2 = container === r1 ? r2 : r1;\n    return less(container.x, r2.x) && greater(container.right, r2.right) && less(container.y, r2.y) && greater(container.bottom, r2.bottom);\n  }\n\n  function __intersect(rect1, rect2) {\n    if (!isIntersects(rect1, rect2)) {\n      return null;\n    }\n\n    var result = {\n      x: Math.max(rect1.x, rect2.x),\n      y: Math.max(rect1.y, rect2.y),\n      right: Math.min(rect1.right, rect2.right),\n      bottom: Math.min(rect1.bottom, rect2.bottom)\n    };\n\n    if (result.x < result.right && result.y < result.bottom) {\n      result.width = Math.abs(result.right - result.x);\n      result.height = Math.abs(result.bottom - result.y);\n      return result;\n    }\n\n    return null;\n  }\n\n  function __getDocumentPoint(pageIndex, pageData, point) {\n    var matrix = _wdvInternals.getViewerTransform(pageIndex, pageData.rotation ? pageData.rotation : 0).invert();\n\n    return __makePoint(matrix.x(point.x, point.y), matrix.y(point.x, point.y));\n  }\n\n  function __wordsSeparated(word, prev) {\n    if (!word || !prev || prev.omitSpace) {\n      return false;\n    }\n\n    return true;\n  } // gets the bounds point where text semantically begins\n\n\n  function __getRegionTextStart(region) {\n    return __makePoint(region.bounds.x, region.bounds.y); //switch (( 360 + region.rotation) % 360) {\n    //    case 90:\n    //        return __makePoint(region.bounds.right, region.bounds.y);\n    //    case 270:\n    //        return __makePoint(region.bounds.x, region.bounds.bottom);\n    //    case 180:\n    //        return __makePoint(region.bounds.right, region.bounds.bottom);\n    //    default:\n    //        return __makePoint(region.bounds.x, region.bounds.y);\n    //}\n  } // gets the bounds point where text semantically ends\n\n\n  function __getRegionTextEnd(region) {\n    return __makePoint(region.bounds.right, region.bounds.bottom); //switch ((360 + region.rotation) % 360) {\n    //    case 90:\n    //        return __makePoint(region.bounds.x, region.bounds.bottom);\n    //    case 270:\n    //        return __makePoint(region.bounds.r, region.bounds.y);\n    //    case 180:\n    //        return __makePoint(region.bounds.x, region.bounds.y);\n    //    default:\n    //        return __makePoint(region.bounds.right, region.bounds.bottom);\n    //}\n  }\n\n  function __makePoint(x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  }\n\n  function __makeThrottleFunction(func, wait) {\n    var context, args, result;\n    var timeout;\n    var lastExecuted = 0;\n\n    var continuation = function continuation() {\n      lastExecuted = new Date().getTime();\n      timeout = null;\n      result = func.apply(context, args);\n\n      if (!timeout) {\n        context = args = null;\n      }\n    };\n\n    return function () {\n      var now = new Date().getTime();\n\n      if (!lastExecuted) {\n        lastExecuted = now - wait;\n      }\n\n      var remaining = wait - (now - lastExecuted);\n      context = this;\n      args = arguments;\n\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n\n        lastExecuted = now;\n        result = func.apply(context, args);\n\n        if (!timeout) {\n          context = args = null;\n        }\n      } else if (!timeout) {\n        timeout = setTimeout(continuation, remaining);\n      }\n\n      return result;\n    };\n  } // #endregion\n\n\n  __extendWDV();\n\n  __initTextLayer();\n};\n\n/* harmony default export */ var controller_TextController = (TextController_TextController);\n// CONCATENATED MODULE: ./src/mousetools/PointerTool.js\n//\n//  PointerTool Class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t08-31-12\tD. Cilley\t\tFile Created.\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t11-16-12\tD. Cilley\t\tFB 13793: Imported the pinch code from annotations, enabled pinch zoom.\n//\t11-26-12\tD. Cilley\t\tFB 13673: Fixed viewer scroll after annotation delete in iOS mobile.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t01-28-14\tD. Cilley\t\tBug 308677: Changed the buffer time from 10ms to 40ms to fix pinch slowness in iOS7.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t02-12-15\tD. Cilley\t\tBug 579500: Combined MouseTool and TouchTool for multi-input devices.\n//\t12-04-15\tD. Cilley\t\tBug 670919, 670924, 670938: Fixed several ZoomArea bugs.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\nvar PointerTool_PointerTool = function PointerTool() {\n  var _self = this;\n\n  var _jqe = atalaJquery({}); // jquery instance to bind tool events to\n\n\n  var _pointer = {\n    // Pointer data\n    tapped: false,\n    // double tap detected\n    touching: false,\n    // still touching\n    pinching: false,\n    // pinching\n    zooming: false,\n    // zooming\n    textselection: false,\n    // text selection performed\n    origin: {\n      x: 0,\n      y: 0\n    },\n    // origin position of touch\n    point: {\n      x: 0,\n      y: 0\n    },\n    // touch point\n    delta: {\n      x: 0,\n      y: 0\n    },\n    // scroll delta\n    drawing: false,\n    // annotation drawing\n    moves: 0,\n    // number of moves between start and end\n    prpt: 0 // pause / resume pointertool\n\n  };\n  var _pinch = null; // pinch data\n\n  var _priTool = MouseToolType.None;\n  var _secTool = MouseToolType.None;\n  var _boundTarget = null; // #region Lifecycle\n\n  __init();\n\n  function __init() {\n    // clear dom events\n    __resetMouseEvents(); // Dom event binds, to be bound by the controller\n\n\n    _self.events = {\n      viewport: {\n        click: __onClick,\n        dblclick: __onDblClick,\n        mousedown: __onMouseDown,\n        mousemove: __onMouseMove,\n        mouseout: __onMouseOut,\n        mouseover: __onMouseOver,\n        mouseup: __onMouseUp,\n        contextmenu: __onContextMenu,\n        mousewheel: __onMouseWheel,\n        keydown: __onKeyDown\n      }\n    };\n\n    if (Browser.Features.Touch) {\n      // Touch event binds, to be bound by the controller\n      atalaJquery.extend(true, _self.events, {\n        viewport: {\n          touchstart: __onTouchStart,\n          touchmove: __onTouchMove,\n          touchend: __onTouchEnd\n        },\n        wdv: {\n          annotationdrawstart: __onAnnotationDrawStart,\n          annotationdrawend: __onAnnotationDrawEnd,\n          annotationdragstart: __onAnnotationDrawStart,\n          annotationdragend: __onAnnotationDrawEnd\n        }\n      });\n    }\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    if (_pointer) {\n      _pointer = null;\n    }\n\n    if (_pinch) {\n      _pinch = null;\n    }\n\n    _self = null;\n  } // #endregion\n  // #region Public functions\n\n\n  _self.bind = __bindEvents;\n\n  function __bindEvents() {\n    _jqe.on.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  _self.unbind = __unbindEvents;\n\n  function __unbindEvents() {\n    _jqe.off.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  _self.trigger = __triggerEvent;\n\n  function __triggerEvent() {\n    _jqe.trigger.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  _self.setTool = __setTool;\n\n  function __setTool(tPri, tSec) {\n    _priTool = tPri;\n    _secTool = tSec;\n\n    __resetMouseEvents(); // Left Mouse Button\n\n\n    switch (_priTool) {\n      case MouseToolType.None:\n        __onClickEvent = __rf;\n        break;\n\n      case MouseToolType.Pan:\n        __onMouseDownLeft = __startPan;\n        break;\n\n      case MouseToolType.ZoomIn:\n        __onClickEvent = __clickZoomIn;\n        break;\n\n      case MouseToolType.ZoomOut:\n        __onClickEvent = __clickZoomOut;\n        break;\n\n      case MouseToolType.Selection:\n        __onMouseDownLeft = __startSelect;\n        break;\n\n      case MouseToolType.ZoomArea:\n        __onMouseDownLeft = __startSelect;\n        break;\n\n      case MouseToolType.PassThrough:\n        break;\n\n      case MouseToolType.Text:\n        __onMouseDownLeft = __startTextSelection;\n        __onMouseMoveEvent = __moveTextSelection;\n        __onKeyDownEvent = __copyTextSelection;\n        break;\n    } // Right Mouse Button\t\t\n\n\n    switch (_secTool) {\n      case MouseToolType.None:\n        break;\n\n      case MouseToolType.Pan:\n        __onMouseDownRight = __startPan;\n        break;\n\n      case MouseToolType.ZoomIn:\n        __onContextMenuEvent = __clickZoomIn;\n        break;\n\n      case MouseToolType.ZoomOut:\n        __onContextMenuEvent = __clickZoomOut;\n        break;\n\n      case MouseToolType.Selection:\n        __onMouseDownRight = __startSelect;\n        break;\n\n      case MouseToolType.ZoomArea:\n        __onMouseDownRight = __startSelect;\n        break;\n\n      case MouseToolType.PassThrough:\n        break;\n    }\n  }\n\n  _self.getTool = __getTool;\n\n  function __getTool() {\n    return {\n      primary: _priTool,\n      secondary: _secTool\n    };\n  } // tells the viewer to pause mousetool handling\n\n\n  _self.pauseTool = __pauseTool;\n\n  function __pauseTool() {\n    _pointer.prpt++;\n  } // tells the viewer to resume mousetool handling\n\n\n  _self.resumeTool = __resumeTool;\n\n  function __resumeTool() {\n    if (_pointer.prpt > 0) {\n      _pointer.prpt--;\n    }\n  } // #endregion\n  // #region Annotation Tool\n\n\n  function __onAnnotationDrawStart() {\n    if (_pointer) {\n      _pointer.drawing = true;\n    }\n  }\n\n  function __onAnnotationDrawEnd() {\n    if (_pointer) {\n      _pointer.drawing = false;\n    }\n  } // #endregion\n  // #region Pinch Tool\n\n\n  function __onPinchStart(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    e.stopPropagation();\n    _pointer.pinching = true;\n    var t1 = e.originalEvent.touches[0];\n    var t2 = e.originalEvent.touches[1];\n    _pinch = {\n      start: CalcDistance(t1.clientX, t1.clientY, t2.clientX, t2.clientY)\n    };\n\n    __triggerEvent({\n      type: 'zoomstart',\n      touches: e.originalEvent.touches\n    });\n  }\n\n  function __onPinchMove(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    e.stopPropagation(); // this event gets called repeatedly while pinching, and we slow it down with __onPinchBuffer\n\n    if (!_pointer.zooming) {\n      _pointer.zooming = true;\n      var t1 = e.originalEvent.touches[0];\n      var t2 = e.originalEvent.touches[1];\n      var dist = CalcDistance(t1.clientX, t1.clientY, t2.clientX, t2.clientY, _pinch.start);\n      var deltaScaleX = dist.x / _pinch.start.x;\n      var deltaScaleY = dist.y / _pinch.start.y;\n      setTimeout(__onPinchBuffer, 40);\n\n      __triggerEvent({\n        type: 'zoommove',\n        touches: e.originalEvent.touches,\n        scale: deltaScaleX,\n        scalex: deltaScaleX,\n        scaley: deltaScaleY,\n        dx: dist.dx,\n        dy: dist.dy\n      });\n    }\n  }\n\n  function __onPinchBuffer() {\n    _pointer.zooming = false;\n  }\n\n  function __onPinchEnd(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    e.stopPropagation();\n    _pointer.pinching = false;\n\n    __triggerEvent({\n      type: 'zoomend',\n      touches: e.originalEvent.touches\n    }); // still touching with one finger, need to start a new touch\n\n\n    if (e.originalEvent.touches.length === 1) {\n      __onTouchStart(e);\n    }\n  } // #endregion\n  // #region Pan Tool\n\n\n  function __startPan(e) {\n    if (_pointer.prmt) {\n      return;\n    }\n\n    __triggerEvent({\n      type: 'panstart',\n      x: e.clientX,\n      y: e.clientY\n    });\n\n    document.addEventListener('mousemove', __movePan);\n    document.addEventListener('mouseup', __stopPan);\n    document.addEventListener('ondrag', __rf);\n    return false;\n  }\n\n  function __movePan(e) {\n    e = e == null ? event : e;\n\n    if (_pointer.prpt) {\n      return;\n    } // this is in case someone mouses up after mousing out\t\t\n\n\n    if (e.which === 0) {\n      __stopPan();\n\n      return;\n    }\n\n    __triggerEvent({\n      type: 'panmove',\n      x: e.clientX,\n      y: e.clientY\n    });\n\n    return false;\n  }\n\n  function __stopPan() {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    document.removeEventListener('mousemove', __movePan);\n    document.removeEventListener('mouseup', __stopPan);\n    document.removeEventListener('ondrag', __rf);\n\n    __triggerEvent({\n      type: 'panend'\n    });\n\n    return false;\n  } // #endregion\n  // #region text selection\n\n\n  function __startTextSelection(e) {\n    if (_pointer.prmt) {\n      return false;\n    }\n\n    e.stopPropagation(); // placeholder for \"alternative action\". for example to fallback to Pan tool if mouse is not above text.\n\n    var args = {\n      handled: false,\n      complete: false\n    };\n\n    __triggerEvent({\n      type: 'textselectstart',\n      toolEvent: e,\n      eventData: args\n    });\n\n    if (!args.complete) {\n      _pointer.textselection = true;\n      document.addEventListener('mouseup', __stopTextSelection);\n      document.addEventListener('mousemove', __onDocMouseMove);\n      document.addEventListener('ondrag', __rf);\n    }\n\n    return false;\n  }\n\n  function __moveTextSelection(e) {\n    if (_pointer.prmt) {\n      return true;\n    } // this is in case someone mouses up after mousing out\t\t\n\n\n    if (e.charCode === 0 && !(e.touches && e.touches.length)) {\n      __stopTextSelection(e);\n\n      return true;\n    }\n\n    var args = {\n      handled: false,\n      selecting: _pointer.textselection\n    };\n\n    __triggerEvent({\n      type: 'textselectmove',\n      toolEvent: e,\n      eventData: args\n    });\n\n    return false;\n  }\n\n  function __stopTextSelection(e) {\n    if (_pointer.prmt || !_pointer.textselection) {\n      return false;\n    }\n\n    _pointer.textselection = false;\n    document.removeEventListener('mouseup', __stopTextSelection);\n    document.removeEventListener('mousemove', __onDocMouseMove);\n    document.removeEventListener('ondrag', __rf);\n    var args = {\n      handled: false\n    };\n\n    __triggerEvent({\n      type: 'textselectend',\n      toolEvent: e,\n      eventData: args\n    });\n\n    return false;\n  }\n\n  function __onDocMouseMove(e) {\n    if (_pointer.textselection) {\n      if (_pointer.prmt) {\n        return true;\n      } // this is in case someone mouses up after mousing out\t\t\n\n\n      if (e.charCode === 0 && !(e.touches && e.touches.length)) {\n        __stopTextSelection(e);\n\n        return true;\n      }\n\n      __triggerEvent({\n        type: 'textselectscroll',\n        toolEvent: e\n      });\n\n      return false;\n    }\n  }\n\n  function __copyTextSelection(e) {\n    if (e.keyCode === 67 && e.ctrlKey) {\n      // ctrl + c\n      __triggerEvent({\n        type: 'textselectcopy',\n        toolEvent: e\n      });\n    }\n  } // #endregion\n  // #region Select tool\n\n\n  function __startSelect(e) {\n    if (_pointer.prmt) {\n      return true;\n    }\n\n    __triggerEvent({\n      type: _priTool === MouseToolType.Selection ? 'selectstart' : 'zoomareastart',\n      x: e.clientX,\n      y: e.clientY,\n      toolEvent: e\n    });\n\n    _boundTarget = atalaJquery(e.target);\n    _boundTarget._binds = {\n      mousemove: __moveSelect,\n      mouseup: __stopSelect,\n      ondrag: __rf\n    };\n\n    _boundTarget.on(_boundTarget._binds);\n\n    return false;\n  }\n\n  function __moveSelect(e) {\n    e = e == null ? event : e;\n\n    if (_pointer.prpt) {\n      return true;\n    } // this is in case someone mouses up after mousing out\t\t\n\n\n    if (e.which === 0) {\n      __stopSelect();\n\n      return;\n    }\n\n    __triggerEvent({\n      type: _priTool === MouseToolType.Selection ? 'selectmove' : 'zoomareamove',\n      x: e.clientX,\n      y: e.clientY,\n      toolEvent: e\n    });\n\n    return false;\n  }\n\n  function __stopSelect(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    _boundTarget.off(_boundTarget._binds);\n\n    _boundTarget = null;\n\n    __triggerEvent({\n      type: _priTool === MouseToolType.Selection ? 'selectend' : 'zoomareaend',\n      toolEvent: e\n    });\n\n    return false;\n  } // #endregion\n  // #region Main Tool\n\n\n  function _MouseToolTypetart(e) {\n    if (_priTool === MouseToolType.Pan) {\n      e.type = 'panstart';\n\n      __triggerEvent(e);\n    }\n  }\n\n  function __toolMove(e) {\n    if (_priTool === MouseToolType.Pan) {\n      e.type = 'panmove';\n\n      __triggerEvent(e);\n    }\n  }\n\n  function __toolEnd(e) {\n    if (_priTool === MouseToolType.Pan) {\n      e.type = 'panend';\n\n      __triggerEvent(e);\n    }\n  }\n\n  function __toolHold(e) {\n    e.type = 'contextmenu';\n\n    __triggerEvent(e);\n  }\n\n  function __toolDoubleTap(e) {\n    e.type = 'fit';\n\n    __triggerEvent(e);\n  } // #endregion\n  // #region Mouse Events\n\n\n  function __onClick(e) {\n    //inner event to detect the click on viewport\n    atalaJquery('.atala_viewport').trigger('viewportclick');\n    e = e == null ? event : e;\n    return __onClickEvent(e);\n  }\n\n  function __onDblClick() {\n    //e = (e == null) ? event : e;\n    return; // double click isn't used by tools\n  }\n\n  function __onContextMenu(e) {\n    e = e == null ? event : e;\n    return __onContextMenuEvent(e);\n  }\n\n  function __onMouseDown(e) {\n    //close bookmark control\n    atalaJquery('.atala_viewport').trigger('viewportclick');\n    e = e == null ? event : e;\n\n    if (e.button === 2) {\n      __onMouseDownRight(e);\n    } else {\n      __onMouseDownLeft(e);\n    }\n\n    return __onMouseDownEvent(e);\n  }\n\n  function __onMouseMove(e) {\n    e = e == null ? event : e;\n    return __onMouseMoveEvent(e);\n  }\n\n  function __onKeyDown(e) {\n    e = e == null ? event : e;\n    return __onKeyDownEvent(e);\n  }\n\n  function __resetMouseEvents() {\n    __onClickEvent = _priTool === MouseToolType.PassThrough ? __ef : __rf;\n    __onContextMenuEvent = _secTool === MouseToolType.PassThrough ? __ef : __rf;\n    __onMouseDownEvent = __ef;\n    __onMouseDownLeft = __ef;\n    __onMouseDownRight = __ef;\n    __onMouseMoveEvent = __ef;\n    __onKeyDownEvent = __ef;\n  }\n\n  function __onMouseOut() {}\n\n  function __onMouseOver() {}\n\n  function __onMouseUp() {}\n\n  function __onMouseWheel() {} // internal event handlers for future use\n\n\n  var __onMouseMoveEvent = function __onMouseMoveEvent() {};\n\n  var __onClickEvent = function __onClickEvent() {};\n\n  var __onContextMenuEvent = function __onContextMenuEvent() {};\n\n  var __onMouseDownEvent = function __onMouseDownEvent() {};\n\n  var __onMouseDownLeft = function __onMouseDownLeft() {};\n\n  var __onMouseDownRight = function __onMouseDownRight() {};\n\n  var __onKeyDownEvent = function __onKeyDownEvent() {};\n\n  function __clickZoomIn(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    __clickZoom(e, false);\n\n    return false;\n  }\n\n  function __clickZoomOut(e) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    __clickZoom(e, true);\n\n    return false;\n  }\n\n  function __clickZoom(e, zoomOut) {\n    if (_pointer.prpt) {\n      return;\n    }\n\n    __triggerEvent({\n      type: 'clickzoom',\n      x: e.clientX,\n      y: e.clientY,\n      zoomout: zoomOut\n    });\n\n    return false;\n  } // #endregion\n  // #region Touch Events\n\n\n  function __onTouchStart(e) {\n    if (_pointer.prpt || _pointer.drawing || _pointer.pinching || atalaJquery(e.target).is('.ui-menu,.ui-menu-item,.ui-corner-all')) {\n      return;\n    }\n\n    e.preventDefault();\n    _pointer.e = e;\n\n    if (e.originalEvent.touches.length === 2 && __touchingSameObject(e.originalEvent.touches)) {\n      // need to clear the hold because the first touch started it\n      __clearHold(); // no touching!\n\n\n      _pointer.touching = false; // time to pinch\n\n      __onPinchStart(e);\n    } else if (_priTool === MouseToolType.Text) {\n      __startTextSelection(e);\n    } else if (e.originalEvent.touches.length === 1) {\n      _pointer.touching = true;\n      _pointer.point.x = e.originalEvent.touches[0].pageX;\n      _pointer.point.y = e.originalEvent.touches[0].pageY;\n      _pointer.hold = setTimeout(__detectHold, 1500);\n\n      _MouseToolTypetart({\n        x: _pointer.point.x,\n        y: _pointer.point.y\n      });\n    }\n  }\n\n  function __onTouchMove(e) {\n    if (_pointer.prpt || _pointer.drawing) {\n      return;\n    }\n\n    e.preventDefault();\n    _pointer.e = e;\n\n    if (_pointer.pinching) {\n      __onPinchMove(e);\n    } else if (_pointer.touching) {\n      var tPoint = e.originalEvent.touches[0];\n      _pointer.moves++;\n      _pointer.touching = true;\n\n      __toolMove({\n        x: tPoint.pageX,\n        y: tPoint.pageY\n      });\n    } else if (_pointer.textselection) {\n      __moveTextSelection(e);\n    }\n  }\n\n  function __onTouchEnd(e) {\n    if (_pointer.prpt || _pointer.drawing) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (_pointer.pinching) {\n      __onPinchEnd(e);\n    } else if (_pointer.textselection) {\n      __stopTextSelection(e);\n    } else {\n      _pointer.touching = false; // stop holding\n\n      __clearHold(); // reset moves\n\n\n      if (_pointer.moves > 0) {\n        _pointer.moves = 0;\n\n        __toolEnd({});\n      } else {\n        // check if we've tapped once before\n        if (_pointer.tapped) {\n          __onDoubleTap(e);\n        } else {\n          // tapped the first time\n          _pointer.tapped = true; // time between taps detected as a double tap\n\n          setTimeout(__detectDoubleTap, 300);\n        }\n      }\n    }\n  } // #endregion\n  // #region Tap and Hold\n\n\n  function __detectDoubleTap() {\n    // reset double tap\n    _pointer.tapped = false;\n  }\n\n  function __onDoubleTap(e) {\n    __toolDoubleTap(e);\n  }\n\n  function __detectHold() {\n    if (_pointer.moves > 0 && _pointer.e != null) {\n      var p = getMousePositionJquery(_pointer.e);\n\n      if (Math.abs(_pointer.point.x - p.x) < 5 && Math.abs(_pointer.point.y - p.y) < 5) {\n        // accidental drag\n        _pointer.moves = 0;\n      }\n    }\n\n    if (_pointer.moves === 0 && _pointer.touching) {\n      __toolHold({\n        x: _pointer.point.x,\n        y: _pointer.point.y\n      });\n    }\n  }\n\n  function __clearHold() {\n    if (_pointer.hold != null) {\n      clearTimeout(_pointer.hold);\n      _pointer.hold = null;\n    }\n  } // #endregion\n  // #region Helper Functions\n  // returns true if the touches have the same target (unless it's null)\n\n\n  function __touchingSameObject(touches) {\n    var target = null;\n\n    for (var i = 0; i < touches.length; i++) {\n      var obj = touches[i].target;\n\n      if (obj) {\n        if (target == null) {\n          target = obj;\n        } else if (target !== obj) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  } // #endregion\n\n\n  return _self;\n};\n\n/* harmony default export */ var mousetools_PointerTool = (PointerTool_PointerTool);\n// CONCATENATED MODULE: ./src/controller/ToolController.js\n//\n//  Tool Controller class\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t08-31-12\tD. Cilley\t\tFile Created.\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t10-25-12\tD. Cilley\t\tFB 13715: Added __getDebugInfo for testing.\n//\t11-16-12\tD. Cilley\t\tFB 13793: Made changes to help pinch zooming.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t11-06-13\tD. Cilley\t\tFB 14453: Added config to allow/disable flick scrolling.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t03-18-14\tD. Cilley\t\tBug 316222: Moved zoomStart zoomInstant and zoomEnd to _wdvInternals.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t12-04-15\tD. Cilley\t\tBug 670919, 670924, 670938: Fixed several ZoomArea bugs.\n//-------------------------------------------------------------------------------------------------\n\n\n\n // wdv: parent WebDocumentViewer object\n// internals: internal functions and objects from the WDV\n// eObject: jQuery object to attach events to\n// sObject: scrollable jQuery scrollable object (usually _scroller)\n\nvar ToolController_ToolController = function ToolController(wdv, internals, eObject, sObject, settings) {\n  // if (!eObject || !sObject){\n  //     Atalasoft.Event.Throw('Atalasoft.Controls.ToolController', 0, null, 'ToolController requires a WDV and two jQuery objects passed in as input, one for mouse events, the other for scrolling.');\n  //     return false;\n  // }\n  var _self = this;\n\n  var _wdv = wdv; // parent WebDocumentViewer\n\n  var _wdvInternals = internals;\n\n  var _jqeInternal = (internals ? internals._internalEvents : null) || atalaJquery({});\n\n  var SelectScrollTimeout = 50; // milliseconds timeout to detect that mouse is out of viewport so we need to scroll the document    \n\n  var _vp = eObject; // event viewport\n\n  var _scroller = sObject; // scrollable DOM object\n\n  var container = _vp.parents('.' + _wdv.domclasses.atala_main_container).first();\n\n  var _primaryToolBackup = MouseToolType.Pan;\n  var _secondaryToolBackup = MouseToolType.None;\n  var _tool = null;\n  var _zoom = 1;\n  var _rp = ''; // resource path\n\n  var _cursor = null;\n  var _custom = ''; // custom cursor\n\n  var _flickPoints = [];\n  var _scd = 1000;\n  var _activePage = null;\n\n  var _uses = -1;\n\n  var _scrollTimeout = null;\n  var _config = {\n    allowflick: true,\n    // will be passed from WDV. here is just for readability.\n    text: {\n      scrolltriggerarea: ScrollArea.Normal,\n      innerscrolldelta: 10,\n      outerscrolldelta: 20\n    }\n  };\n  /**\r\n   * Internal events for conditional input handling.\r\n   */\n\n  _self.events = _events;\n  var _events = {\n    textselectstart: 'textselectstart',\n    textselectmove: 'textselectmove',\n    textselectend: 'textselectend',\n    textselectcopy: 'textselectcopy'\n  }; // map settings onto config\n\n  if (settings) {\n    atalaJquery.extend(_config, settings);\n    _config.text.scrolltriggerarea = Math.max(0, Math.min(_config.text.scrolltriggerarea, 0.3));\n  }\n\n  __init();\n\n  function __init() {\n    _tool = new mousetools_PointerTool();\n\n    _vp.on(_tool.events.viewport);\n\n    if (_tool.events.wdv) {\n      _wdv.bind(_tool.events.wdv);\n    } // upper level tool events\n\n\n    _tool.bind({\n      clickzoom: __onClickZoom,\n      fit: __onFit,\n      panstart: __onPanStart,\n      panmove: __onPanMove,\n      panend: __onPanEnd,\n      zoomstart: __onZoomStart,\n      zoommove: __onZoomMove,\n      zoomend: __onZoomEnd,\n      selectstart: __onSelectStart,\n      selectmove: __onSelectMove,\n      selectend: __onSelectEnd,\n      zoomareastart: __onSelectStart,\n      zoomareamove: __onSelectMove,\n      zoomareaend: __onSelectEnd,\n      textselectstart: __onTextSelectStart,\n      textselectmove: __onTextSelectMove,\n      textselectend: __onTextSelectEnd,\n      textselectscroll: __onTextSelectScroll,\n      textselectcopy: __onTextSelectCopy,\n      viewportclick: __onViewPortClick\n    });\n  } //Transfer onClick event to parent elements to be able to hide bookmark control\n\n\n  function __onViewPortClick() {\n    __triggerEvent({\n      type: 'viewportclick'\n    });\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    if (_tool && _tool.events) {\n      if (_tool.events.wdv && _wdv && _wdv.unbind) {\n        _wdv.unbind(_tool.events.wdv);\n      }\n\n      if (_tool.events.viewport && _vp && _vp.off) {\n        _vp.off(_tool.events.viewport);\n      }\n    }\n\n    if (_flickPoints && _flickPoints.length > 0) {\n      _flickPoints.length = 0;\n    }\n\n    if (_tool && _tool.dispose) {\n      _tool.dispose();\n    }\n\n    _scroller = null;\n    _vp = null;\n    _wdv = null;\n    _self = null;\n  } // #region Events\n  // #region Public functions\n\n\n  _self.bind = __bindEvents;\n\n  function __bindEvents() {\n    _jqeInternal.on.apply(_jqeInternal, arguments);\n\n    return _self;\n  }\n\n  _self.unbind = __unbindEvents;\n\n  function __unbindEvents() {\n    _jqeInternal.off.apply(_jqeInternal, arguments);\n\n    return _self;\n  }\n\n  _self.trigger = __triggerEvent;\n\n  function __triggerEvent() {\n    _jqeInternal.trigger.apply(_jqeInternal, arguments);\n\n    return _self;\n  } // #endregion\n\n\n  _self.setTool = __setTool;\n\n  function __setTool(priTool, secTool) {\n    _tool.setTool(priTool, secTool);\n\n    __pushToolBackup(priTool, secTool);\n\n    switch (priTool) {\n      case MouseToolType.None:\n        __setCursor(MouseToolCursor.Arrow);\n\n        break;\n\n      case MouseToolType.Pan:\n        __setCursor(MouseToolCursor.Move);\n\n        break;\n\n      case MouseToolType.ZoomIn:\n        __setCursor(MouseToolCursor.ZoomIn);\n\n        break;\n\n      case MouseToolType.ZoomOut:\n        __setCursor(MouseToolCursor.ZoomOut);\n\n        break;\n\n      case MouseToolType.Selection:\n        if (!_wdv.config.showselecttools) {\n          throw 'The mouse tool type is incompatible with \\'showselecttools\\' flag value.' + ' Please change the tool type or enable selection tools.';\n        }\n\n        _wdvInternals.raiseDrawLayer();\n\n        _uses = 1;\n\n        __setCursor(MouseToolCursor.Crosshair);\n\n        break;\n\n      case MouseToolType.ZoomArea:\n        if (!_wdv.config.showselecttools) {\n          throw 'The mouse tool type is incompatible with \\'showselecttools\\' flag value.' + 'Please change the tool type or enable selection tools.';\n        }\n\n        _wdvInternals.raiseDrawLayer();\n\n        _uses = 1;\n\n        __setCursor(MouseToolCursor.Crosshair);\n\n        break;\n\n      case MouseToolType.Text:\n        if (!_wdv.config.showselecttools) {\n          throw 'The mouse tool type is incompatible with \\'showselecttools\\' flag value.' + ' Please change the tool type or enable selection tools.';\n        }\n\n        _wdvInternals.raiseDrawLayer();\n\n        __setCursor(MouseToolCursor.Text);\n\n        break;\n\n      default:\n        __setCursor(MouseToolCursor.Arrow);\n\n        break;\n    }\n  }\n\n  _self.__getDebugInfo = __getDebugInfo;\n\n  function __getDebugInfo() {\n    var info = {};\n    atalaJquery.extend(true, info, {\n      cursor: _cursor,\n      custom: _custom,\n      flick: _flickPoints,\n      resourcepath: _rp,\n      flickdelay: _scd,\n      scroller: _scroller,\n      tool: _tool,\n      toolcursors: MouseToolCursor,\n      tooltypes: MouseToolType,\n      viewport: _vp,\n      zoom: _zoom\n    });\n    return info;\n  }\n\n  _self.getTool = __getTool;\n\n  function __getTool() {\n    return _tool.getTool();\n  } // tells the viewer to pause tool handling\n\n\n  _self.pauseTool = __pauseTool;\n\n  function __pauseTool() {\n    return _tool.pauseTool();\n  } // tells the viewer to resume tool handling\n\n\n  _self.resumeTool = __resumeTool;\n\n  function __resumeTool() {\n    return _tool.resumeTool();\n  } // mtc: mouse tool cursor enum\n\n\n  _self.setCursor = __setCursor;\n\n  function __setCursor(mtc) {\n    _cursor = mtc === '%2' ? _cursor = _custom : mtc;\n\n    _vp.css({\n      'cursor': _cursor\n    });\n  }\n\n  _self.setCustomCursor = __setCustomCursor;\n\n  function __setCustomCursor(s) {\n    _custom = s;\n  } // #region tool events\n\n\n  function __onFit(e) {\n    _wdv.fit(e.fit);\n  }\n\n  function __onClickZoom(e) {\n    if (e.zoomout) {\n      // Zoom in or out\n      _wdv.zoomOut();\n    } else {\n      _wdv.zoomIn();\n    }\n  }\n\n  function __onPanStart(e) {\n    _scroller // keep track of click origin\n    .data('ox', _scroller.scrollLeft() + e.x).data('oy', _scroller.scrollTop() + e.y);\n\n    _scroller.stop();\n  }\n\n  function __onPanMove(e) {\n    // scroll to the new position\n    _scroller.scrollLeft(_scroller.data('ox') - e.x);\n\n    _scroller.scrollTop(_scroller.data('oy') - e.y);\n\n    if (_config.allowflick) {\n      _flickPoints.push({\n        x: e.x,\n        y: e.y,\n        time: new Date().getTime()\n      }); // only keep 10 points, and let the oldest one fall off\n\n\n      if (_flickPoints.length > 10) {\n        _flickPoints.shift();\n      }\n    }\n  }\n\n  function __onPanEnd() {\n    if (_config.allowflick) {\n      if (_flickPoints.length > 1) {\n        var now = new Date().getTime();\n\n        var last = _flickPoints.pop();\n\n        if (now - last.time < 100) {\n          var first = _flickPoints.shift();\n\n          var dt = -first.time + last.time;\n\n          _scroller.animate({\n            'scrollLeft': _scroller.scrollLeft() + Math.round((first.x - last.x) / dt * 250),\n            'scrollTop': _scroller.scrollTop() + Math.round((first.y - last.y) / dt * 250)\n          }, _scd, 'easeOutQuad');\n        }\n      } // we're done, keeping points around is bad\n\n\n      _flickPoints.length = 0;\n    }\n  }\n\n  function __onSelectStart(e) {\n    _activePage = _wdvInternals.getActivePage();\n\n    if (_activePage) {\n      _activePage._rubberband.startSelect(e);\n    }\n  }\n\n  function __onSelectMove(e) {\n    _activePage = _wdvInternals.getActivePage();\n\n    if (_activePage) {\n      _activePage._rubberband.moveSelect(e);\n    }\n  }\n\n  function __onSelectEnd(e) {\n    _activePage = _wdvInternals.getActivePage();\n\n    if (_activePage) {\n      _activePage._rubberband.endSelect(e);\n\n      if (e.type === 'zoomareaend') {\n        _activePage._rubberband.hide();\n\n        _activePage._rubberband.zoomToSelection();\n      }\n    }\n\n    _uses--;\n\n    if (_uses === 0) {\n      _uses = -1;\n\n      _wdvInternals.resetDrawLayer();\n\n      __setTool(_primaryToolBackup, _secondaryToolBackup);\n    }\n  }\n\n  function __onZoomStart() {\n    _wdvInternals.zoomStart();\n\n    _zoom = _wdv.getZoom();\n  }\n\n  function __onZoomMove(e) {\n    var z = _zoom * e.scale;\n\n    _wdvInternals.zoom(z);\n  }\n\n  function __onZoomEnd() {\n    _wdvInternals.zoomEnd();\n  }\n\n  function __onTextSelectStart(e) {\n    var args = __getMouseTextEventArgs(e);\n\n    if (args) {\n      var event = e.toolEvent && e.toolEvent.originalEvent ? e.toolEvent.originalEvent : e.toolEvent;\n      args.cursor = _cursor;\n      args.complete = false;\n      args.rectangular = event ? event.altKey : false;\n      args.interval = event ? event.shiftKey : false;\n\n      if (!args.rectangular && !args.interval) {\n        var clicks = event && event.detail ? event.detail % 3 : 1;\n\n        if (clicks !== 1) {\n          args.word = clicks === 2;\n          args.line = clicks === 0;\n        }\n      }\n\n      __triggerEvent({\n        type: _events.textselectstart,\n        eventData: args\n      });\n\n      e.eventData.handled = args.handled;\n\n      if (args.complete && args.handled) {\n        __onTextSelectEnd(e);\n\n        e.eventData.complete = true;\n      }\n    }\n  }\n\n  function __onTextSelectMove(e) {\n    __clearScrollTimeout();\n\n    var args = __getMouseTextEventArgs(e);\n\n    if (args) {\n      args.cursor = _cursor;\n      args.selecting = e.eventData.selecting;\n\n      __triggerEvent({\n        type: _events.textselectmove,\n        eventData: args\n      });\n\n      e.eventData.handled = args.handled;\n      var cursor = args.handled && args.cursor ? args.cursor : MouseToolCursor.Arrow;\n\n      if (cursor !== _cursor) {\n        __setCursor(cursor);\n      }\n\n      if (e.eventData.handled && e.eventData.selecting && e.toolEvent && e.toolEvent.target) {\n        __onSelectionScrollTimeout(e);\n      }\n    }\n  }\n\n  function __onTextSelectEnd(e) {\n    __clearScrollTimeout();\n\n    var args = __getMouseTextEventArgs(e);\n\n    if (args) {\n      __triggerEvent({\n        type: _events.textselectend,\n        eventData: args\n      });\n\n      e.eventData.handled = args.handled;\n    }\n  }\n\n  function __onTextSelectScroll(e) {\n    __clearScrollTimeout();\n\n    __onSelectionScrollTimeout(e);\n  }\n\n  function __onTextSelectCopy() {\n    if (_config.text.hookcopy) {\n      __triggerEvent({\n        type: _events.textselectcopy\n      });\n    }\n  } // #endregion\n  // #region helper methods\n\n\n  function __clearScrollTimeout() {\n    if (_scrollTimeout) {\n      clearTimeout(_scrollTimeout);\n      _scrollTimeout = null;\n    }\n  }\n\n  function __onSelectionScrollTimeout(e) {\n    __clearScrollTimeout();\n\n    if (e && e.toolEvent) {\n      var event = e.toolEvent.originalEvent ? e.toolEvent.originalEvent : e.toolEvent;\n      var viewportOffset = container.offset();\n      var positionContainer = null;\n\n      if (event.pageX !== undefined && event.pageY !== undefined) {\n        positionContainer = event;\n      } else if (event.touches && event.touches.length === 1) {\n        if (event.touches[0].pageX !== undefined && event.touches[0].pageY !== undefined) {\n          positionContainer = event.touches[0];\n        }\n      }\n\n      if (positionContainer) {\n        var pos = {\n          x: positionContainer.pageX - viewportOffset.left,\n          y: positionContainer.pageY - viewportOffset.top\n        };\n        var viewportWidth = container.width(),\n            viewportHeight = container.height();\n        var topDelta = 0,\n            leftDelta = 0;\n\n        if (pos.y < viewportHeight * _config.text.scrolltriggerarea && _scroller.scrollTop() > 0) {\n          topDelta = pos.y > 0 ? -_config.text.innerscrolldelta : -_config.text.outerscrolldelta;\n        } else if (pos.y > viewportHeight * (1 - _config.text.scrolltriggerarea)) {\n          topDelta = pos.y < viewportHeight ? _config.text.innerscrolldelta : _config.text.outerscrolldelta;\n        } else if (pos.x < viewportWidth * _config.text.scrolltriggerarea && _scroller.scrollLeft() > 0) {\n          leftDelta = pos.x > 0 ? -_config.text.innerscrolldelta : -_config.text.outerscrolldelta;\n        } else if (pos.x > viewportWidth * (1 - _config.text.scrolltriggerarea)) {\n          leftDelta = pos.x < viewportWidth ? _config.text.innerscrolldelta : _config.text.outerscrolldelta;\n        }\n\n        if ((topDelta || leftDelta) && _config.text.scrolltriggerarea !== ScrollArea.None) {\n          _scroller.scrollTop(_scroller.scrollTop() + topDelta);\n\n          _scroller.scrollLeft(_scroller.scrollLeft() + leftDelta);\n\n          _scrollTimeout = setTimeout(__onSelectionScrollTimeout, SelectScrollTimeout, e);\n        }\n      }\n    }\n  }\n\n  function __getMouseEventPageIndex(el) {\n    var pageDiv = atalaJquery(el).parents('.' + _wdv.domclasses.atala_page_div).first();\n\n    if (pageDiv) {\n      var idx = pageDiv.attr(_wdv.domattributes.atala_page_index);\n      return parseInt(idx, 10);\n    }\n\n    return null;\n  }\n\n  function __getMousePosition(e, page) {\n    var p = getMousePositionJquery(e.toolEvent ? e.toolEvent : e);\n\n    if (page && page._paper) {\n      var offset = getSVGOffset(page._paper.canvas, page);\n      p.x -= offset.left;\n      p.y -= offset.top;\n    }\n\n    return p;\n  }\n\n  function __getDocumentPoint(p, pageIndex) {\n    var textRotation = 0;\n\n    if (_wdvInternals._controllers.text) {\n      var pageData = _wdvInternals._controllers.document.getPageText(pageIndex);\n\n      if (pageData && isFinite(pageData.rotation)) {\n        textRotation = pageData.rotation;\n      }\n    }\n\n    var matrix = _wdvInternals.getViewerTransform(pageIndex, textRotation).invert();\n\n    return {\n      x: matrix.x(p.x, p.y),\n      y: matrix.y(p.x, p.y)\n    };\n  }\n\n  function __pushToolBackup(newPrimaryTool, newSecondaryTool) {\n    var isTextToolTurnoff = (_primaryToolBackup === MouseToolType.Text || _secondaryToolBackup === MouseToolType.Text) && newPrimaryTool !== MouseToolType.Text && newSecondaryTool !== MouseToolType.Text;\n\n    if (isTextToolTurnoff) {\n      _wdvInternals.resetDrawLayer();\n    }\n\n    if (newPrimaryTool !== MouseToolType.Selection && newPrimaryTool !== MouseToolType.ZoomArea) {\n      _primaryToolBackup = newPrimaryTool;\n    }\n\n    if (newSecondaryTool !== MouseToolType.Selection && newSecondaryTool !== MouseToolType.ZoomArea) {\n      _secondaryToolBackup = newSecondaryTool;\n    }\n  }\n\n  function __getMouseTextEventArgs(e) {\n    var args = {\n      cursor: null,\n      handled: false\n    };\n\n    if (e && e.toolEvent) {\n      var event = e.toolEvent.originalEvent ? e.toolEvent.originalEvent : e.toolEvent;\n      var isTouchInput = event.touches && event.touches.length === 1;\n      var target = isTouchInput ? document.elementFromPoint(event.touches[0].clientX, event.touches[0].clientY) : event.target;\n\n      var page = __getMouseEventPageIndex(target);\n\n      if (isFinite(page) && page >= 0) {\n        var viewerPoint = __getMousePosition(e);\n\n        var pos = __getDocumentPoint(viewerPoint, page);\n\n        atalaJquery.extend(args, {\n          page: page,\n          point: pos,\n          viewerPoint: viewerPoint\n        });\n      }\n    }\n\n    return args;\n  } // #endregion\n\n};\n\n/* harmony default export */ var controller_ToolController = (ToolController_ToolController);\n// CONCATENATED MODULE: ./src/mousetools/RubberBandTool.js\n//\n//  RubberBand Selection Tool for WDV\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t10-19-15\tD. Cilley\t\tFile Created.\n//\t12-04-15\tD. Cilley\t\tBug 670919, 670924, 670938: Fixed several ZoomArea bugs.\n//\t12-20-15\tD. Cilley\t\tBug 670911: Fixed rubberband conflicts with forcepagefit config option.\n//-------------------------------------------------------------------------------------------------\n\n // Controls the zoom level of each page depending on the configuration\n// wdv: parent WebDocumentViewer object\n// settings: config object for additional settings\n\nvar RubberBandTool_RubberBandTool = function RubberBandTool(wdv, settings, parent, internals) {\n  var RubberBandZindex = 3;\n\n  var _self = this;\n\n  var _jqe = atalaJquery({}); // jquery instance to bind tool events to\n\n\n  var _wdv = wdv;\n  var _data = {\n    // data object for rubberband properties\n    animated: false,\n    aspectratio: 0,\n    backcolor: 'fff',\n    forecolor: '000',\n    movable: true,\n    multicolor: true,\n    resizable: true,\n    showgrips: false,\n    showmask: false,\n    showtooltip: false,\n    visible: false,\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  };\n  var _dom = {\n    /** Main RubberBand dom object */\n    rect: null,\n\n    /** Dom object underneath Main RubberBand */\n    rectback: null,\n\n    /** Mask objects */\n    mask: {\n      top: null,\n      bottom: null,\n      left: null,\n      right: null\n    }\n  };\n  var _state = {\n    animating: false,\n    boundevents: null,\n    changing: false,\n    colorswap: 0,\n    origin: {\n      x: 0,\n      y: 0\n    },\n    pagesize: {\n      width: 0,\n      height: 0\n    },\n    pageoffset: {\n      x: 0,\n      y: 0\n    },\n    vert: false,\n    horiz: false,\n    zoom: 1\n  };\n  var _wdvInternals = internals;\n\n  var _grips; // Grips object\n\n\n  var _toolTip; // Tooltip\n\n\n  var _clipper = parent; // #region Lifecycle\n\n  function __init() {\n    if (settings) {\n      atalaJquery.extend(true, _data, settings);\n    }\n\n    _dom.rect = __createBand();\n    _dom.rectback = __createBand();\n    _dom.mask.top = __createMask();\n    _dom.mask.bottom = __createMask();\n    _dom.mask.left = __createMask();\n    _dom.mask.right = __createMask();\n    _toolTip = __createDOM('div');\n\n    _toolTip.addClass(_wdv.domclasses.atala_tool_selection_tooltip);\n\n    _toolTip.hide();\n\n    _toolTip.css({\n      fontFamily: 'Arial, helvetica, san-serif',\n      fontSize: '8pt',\n      padding: '1px',\n      backgroundColor: '#FFFFE1',\n      border: '1px solid #000000',\n      position: 'absolute',\n      zIndex: 999\n    });\n\n    _clipper.append(_dom.rectback);\n\n    _clipper.append(_dom.rect);\n\n    _clipper.append(_toolTip);\n\n    _clipper.append(_dom.mask.top);\n\n    _clipper.append(_dom.mask.bottom);\n\n    _clipper.append(_dom.mask.left);\n\n    _clipper.append(_dom.mask.right);\n\n    _grips = new __Grips();\n\n    __refreshStyle();\n\n    if (_data.visible) {\n      __show();\n    } else {\n      __hide();\n    }\n\n    _clipper.bind({\n      pageresize: __onPageSizeChanged,\n      pagezoom: __onPageZoomChanged\n    });\n  }\n\n  _self.dispose = __dispose;\n\n  function __dispose() {\n    if (_grips != null) {\n      _grips.dispose();\n\n      _grips = null;\n    }\n\n    _self = null;\n    _dom.rect = null;\n    _dom.rectback = null;\n    _toolTip = null;\n    _dom.mask.top = null;\n    _dom.mask.bottom = null;\n    _dom.mask.left = null;\n    _dom.mask.right = null;\n  } // #endregion\n  // #region Events\n\n\n  function __onPageSizeChanged() {\n    __updateState();\n\n    __updateRectangle();\n  }\n\n  function __onPageZoomChanged() {\n    __updateState();\n\n    __updateRectangle();\n  } // #endregion\n  // #region Grips\n\n\n  function __Grips() {\n    var _c = new Array('move', 'nw', 'n', 'ne', 'w', 'e', 'sw', 's', 'se');\n\n    var _g = [];\n    var _gva = []; // array used to indicate grip visibility before the show()\n\n    var _gsw = 0;\n    var _gsh = 0;\n\n    for (var i = 0; i < 9; i++) {\n      _g[i] = new __Grip(i);\n\n      _clipper.append(_g[i].grip);\n    }\n\n    this.dispose = __Gdispose;\n    this.setRectangle = __GsetRect;\n    this.resetColors = __GresetColors;\n    this.resetGrips = __GresetGrips;\n    this.hide = __Ghide;\n    this.show = __Gshow;\n    this.showGrips = __GshowGrips;\n    this.resetEvents = __GsetEvents;\n\n    function __Gdispose() {\n      for (var _i = 0; _i < 9; _i++) {\n        _g[_i].dispose();\n\n        _g[_i] = null;\n      }\n\n      _c = null;\n      _g = null;\n      _gva = null;\n    }\n\n    __GsetEvents(); // ax, ay, aw, ah = adjusted values\n\n\n    function __GsetRect(x, y, w, h) {\n      _gsw = w;\n      _gsh = h;\n\n      _g[0].setPos(x, y);\n\n      _g[1].setPos(x - 4, y - 4); // nw\n\n\n      _g[3].setPos(x + w - 4, y - 4); // ne\n\n\n      _g[6].setPos(x - 4, y + h - 4); // sw\n\n\n      _g[8].setPos(x + w - 4, y + h - 4); // se\n\n\n      _g[0].setSize(w, h);\n\n      if (_data.showgrips) {\n        _g[2].setPos(x + Math.round(w / 2) - 4, y - 4); // n\n\n\n        _g[4].setPos(x - 4, y + Math.round(h / 2) - 4); // w \n\n\n        _g[5].setPos(x + w - 4, y + Math.round(h / 2) - 4); // e\n\n\n        _g[7].setPos(x + Math.round(w / 2) - 4, y + h - 4); // s\n\n      } else {\n        _g[2].setPos(x + 4, y - 4); // n\n\n\n        _g[4].setPos(x - 4, y + 4); // w \n\n\n        _g[5].setPos(x + w - 4, y + 4); // e\n\n\n        _g[7].setPos(x + 4, y + h - 4); // s\n\n\n        _g[2].setSize(w - 8, 8);\n\n        _g[4].setSize(8, h - 8);\n\n        _g[5].setSize(8, h - 8);\n\n        _g[7].setSize(w - 8, 8);\n      }\n\n      __GshowGrips();\n    }\n\n    function __GresetColors() {\n      for (var _i2 = 0; _i2 < 9; _i2++) {\n        _g[_i2].resetColors();\n      }\n    }\n\n    function __GresetGrips() {\n      for (var _i3 = 0; _i3 < 9; _i3++) {\n        _g[_i3].resetGripSize();\n\n        _g[_i3].resetColors();\n      }\n    }\n\n    function __Ghide() {\n      for (var _i4 = 0; _i4 < 9; _i4++) {\n        _g[_i4].hide();\n      }\n    }\n\n    function __Gshow() {\n      for (var _i5 = 0; _i5 < 9; _i5++) {\n        if (_gva[_i5] === true) {\n          _g[_i5].show();\n        } else {\n          _g[_i5].hide();\n        }\n      }\n    }\n\n    function __GshowGrips() {\n      for (var _i6 = 0; _i6 < 9; _i6++) {\n        _gva[_i6] = true;\n      }\n\n      _gva[0] = true;\n\n      if (_gsw < 8 && _gsh < 8) {\n        _gva[1] = false; // nw\n      }\n\n      if (_gsw < 12 || _gsh < 12) {\n        _gva[3] = false; // ne\n\n        _gva[6] = false; // sw\n      }\n\n      if (_gsw < 16 || _gsh < 8) {\n        _gva[2] = false; // n\n\n        _gva[7] = false; // s\n      }\n\n      if (_gsh < 16 || _gsw < 8) {\n        _gva[4] = false; // w\n\n        _gva[5] = false; // e\n      }\n\n      __Gshow();\n    } // Sets the events for the grips and mover object\n\n\n    function __GsetEvents() {\n      if (__getMovable() === true) {\n        _g[0].grip.onmousedown = __move;\n        _g[0].grip.style.cursor = 'move';\n      } else {\n        _g[0].grip.onmousedown = __rf; // returns false\n\n        _g[0].grip.style.cursor = 'default';\n      }\n\n      for (var _i7 = 1; _i7 < 9; _i7++) {\n        if (__getResizable() === true) {\n          _g[_i7].bind({\n            mousedown: _g[_i7].onResize\n          });\n\n          _g[_i7].grip.style.cursor = _c[_i7] + '-resize';\n        } else {\n          _g[_i7].off({\n            mousedown: _g[_i7].onResize\n          });\n\n          _g[_i7].grip.style.cursor = 'default';\n        }\n      }\n    } // Grip object\n\n\n    function __Grip(i) {\n      var _Gself = this;\n\n      var _gr; // Html object\n\n\n      var _gs; // Style\n\n\n      var _di = _c[i]; // Compass direction\n\n      var _gv = false; // Visible\n\n      var _$grip;\n\n      _gr = document.createElement('div');\n      _gs = _gr.style;\n      _$grip = atalaJquery(_gr);\n\n      _$grip.addClass(_wdv.domclasses.atala_tool_selection_grip);\n\n      __GsetColors();\n\n      __GsetGripSize();\n\n      _Gself.grip = _gr;\n      _Gself.dispose = __GRdispose;\n      _Gself.setPos = __GsetPos;\n      _Gself.setSize = __GsetSize;\n      _Gself.hide = __GhideGrip;\n      _Gself.show = __GshowGrip;\n      _Gself.resetColors = __GsetColors;\n      _Gself.resetGripSize = __GsetGripSize;\n      _Gself.onResize = __Gresize;\n      _Gself.bind = __GRbind;\n      _Gself.unbind = __GRunbind;\n      _gs.display = 'block';\n      _gs.position = 'absolute';\n      _gs.visibility = 'hidden';\n      _gs.zIndex = RubberBandZindex;\n      _gr.onclick = __rf;\n      _gr.onselectstart = __rf;\n      _gr.onselect = __rf;\n      _gr.oncontextmenu = __rf;\n\n      function __GRdispose() {\n        _Gself = null;\n        _gr = null;\n        _gs = null;\n        _di = null;\n      }\n\n      function __GRbind() {\n        _$grip.on.apply(_$grip, arguments);\n\n        return _$grip;\n      }\n\n      function __GRunbind() {\n        _$grip.off.apply(_$grip, arguments);\n\n        return _$grip;\n      } // Sets position for this grip\n\n\n      function __GsetPos(x, y) {\n        _gs.left = x + 'px';\n        _gs.top = y + 'px';\n      } // Sets size for this grip\n\n\n      function __GsetSize(w, h) {\n        if (__getShowGrips() === true && _di !== 'move') {\n          w -= 2;\n          h -= 2;\n        }\n\n        if (w <= 0) {\n          w = 1;\n        }\n\n        if (h <= 0) {\n          h = 1;\n        }\n\n        _gs.width = w + 'px';\n        _gs.height = h + 'px';\n      } // Hides this grip\n\n\n      function __GhideGrip() {\n        if (_gv) {\n          _gs.visibility = 'hidden';\n          _gv = false;\n        }\n      } // Shows this grip\n\n\n      function __GshowGrip() {\n        if (!_gv) {\n          _gs.visibility = 'visible';\n          _gv = true;\n        }\n      } // Changes Background Color\n\n\n      function __GsetColors() {\n        if (_di !== 'move') {\n          if (_data.showgrips === true) {\n            if (__getMultiColor() === true) {\n              _gs.backgroundColor = '#' + __getBackColor();\n              _gs.border = '1px solid #' + __getForeColor();\n            } else {\n              _gs.backgroundColor = '#' + __getForeColor();\n              _gs.border = '1px solid #' + __getForeColor();\n            }\n          } else {\n            _gs.backgroundColor = '';\n            _gs.border = '';\n          }\n        }\n      }\n\n      function __GsetGripSize() {\n        if (_data.showgrips === true) {\n          _gs.width = '6px';\n          _gs.height = '6px';\n        } else {\n          _gs.width = '8px';\n          _gs.height = '8px';\n        }\n      }\n\n      function __Gresize(e) {\n        return __resize(e, _di);\n      }\n    }\n  } // #endregion\n  // #region Dom\n  // tag: string representing the type of tag\n  // p: jQuery parent object to append div to \n  // did: string representing the id of the div\n  // ihtml: string representing the inner html\n\n\n  function __createDOM(tag, p, did, ihtml) {\n    var dom = atalaJquery('<' + tag + '></' + tag + '>');\n\n    if (p && p.append) {\n      dom.appendTo(p);\n    }\n\n    if (did) {\n      dom.attr('id', did);\n    }\n\n    if (ihtml) {\n      dom.html(ihtml);\n    }\n\n    return dom;\n  }\n\n  function __createBand() {\n    var band = __createDOM('div');\n\n    band.addClass(_wdv.domclasses.atala_tool_selection_band);\n    band.css({\n      position: 'absolute',\n      zIndex: RubberBandZindex\n    });\n    return band;\n  }\n\n  function __createMask() {\n    var mask = __createDOM('div');\n\n    mask.addClass(_wdv.domclasses.atala_tool_selection_mask);\n    mask.hide();\n    mask.css({\n      left: '0px',\n      top: '0px',\n      width: '1px',\n      height: '1px',\n      position: 'absolute',\n      background: '#000',\n      opacity: '0.6',\n      zIndex: '0'\n    });\n    return mask;\n  } // #endregion\n  // #region Public Properties\n\n\n  _self.getAnimated = __getAnimated;\n  _self.getAspectRatio = __getAspectRatio;\n  _self.getBackColor = __getBackColor;\n  _self.getForeColor = __getForeColor;\n  _self.getHeight = __getHeight;\n  _self.getMovable = __getMovable;\n  _self.getMultiColor = __getMultiColor;\n  _self.getPosition = __getPosition;\n  _self.getRectangle = __getRectangle;\n  _self.getResizable = __getResizable;\n  _self.getShowGrips = __getShowGrips;\n  _self.getShowMask = __getShowMask;\n  _self.getShowTooltip = __getShowTooltip;\n  _self.getSize = __getSize;\n  _self.getVisible = __getVisible;\n  _self.getWidth = __getWidth;\n\n  function __getAnimated() {\n    return _data.animated;\n  }\n\n  function __getAspectRatio() {\n    return _data.aspectratio;\n  }\n\n  function __getBackColor() {\n    return _data.backcolor;\n  }\n\n  function __getForeColor() {\n    return _data.forecolor;\n  }\n\n  function __getHeight() {\n    return _data.height;\n  }\n\n  function __getMovable() {\n    return _data.movable;\n  }\n\n  function __getMultiColor() {\n    return _data.multicolor;\n  }\n\n  function __getPosition() {\n    return {\n      x: _data.x,\n      y: _data.y\n    };\n  }\n\n  function __getRectangle() {\n    return {\n      x: _data.x,\n      y: _data.y,\n      width: _data.width,\n      height: _data.height\n    };\n  }\n\n  function __getResizable() {\n    return _data.resizable;\n  }\n\n  function __getShowGrips() {\n    return _data.showgrips;\n  }\n\n  function __getShowMask() {\n    return _data.showmask;\n  }\n\n  function __getShowTooltip() {\n    return _data.showtooltip;\n  }\n\n  function __getSize() {\n    return {\n      width: _data.width,\n      height: _data.height\n    };\n  }\n\n  function __getVisible() {\n    return _data.visible;\n  }\n\n  function __getWidth() {\n    return _data.width;\n  }\n  /*\r\n  _self.setAnimated = __setAnimated;\r\n  // Boolean value, true or false\r\n  function __setAnimated(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getAnimated() !==  b) {\r\n              __setFormValue(_id + '_rsa', b);\r\n              if(b === true) {\r\n                  _data.animated = true;\r\n                  __animate();\r\n              }\r\n              else {\r\n                  _data.animated = false;}\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setAnimated', 5, b, '');\r\n      }\r\n  }\r\n      \r\n  _self.setAspectRatio = __setAspectRatio;\r\n  function __setAspectRatio(f) {\r\n      if (f >= 0) {\r\n          __setFormValue(_id + '_rsar', f);\r\n      }\r\n  }\r\n  \r\n  _self.setAutoPostBack = __setAutoPostBack;\r\n  function __setAutoPostBack(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getAutoPostBack() !==  b) {\r\n              __setFormValue(_id + '_rsp', b);\r\n              __updateEvents();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setAutoPostBack', 5, b, '');\r\n      }\r\n  }\r\n  \r\n  _self.setBackColor = __setBackColor;\r\n  function __setBackColor(s) {\r\n      __setFormValue(_id + '_rsbc', s);\r\n      __refreshStyle();\r\n  }\r\n      \r\n  _self.setShowMask = __setShowMask;\r\n  function __setShowMask(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getShowMask() !==  b) {\r\n              __setFormValue(_id + '_rsdm', b);\r\n              __update();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setShowMask', 5, b, '');\r\n      }\r\n  }\r\n      \r\n  _self.setForeColor = __setForeColor;\r\n  function __setForeColor(s) {\r\n      __setFormValue(_id + '_rsfc', s);\r\n      __refreshStyle();\r\n  }\r\n  \r\n  _self.setHeight = __setHeight;\r\n  function __setHeight(i) {\r\n      if (i >= 0) {\r\n          const oh = __getHeight();\r\n  \r\n          if (i > _state.pagesize.height)\r\n              i = _state.pagesize.height;\r\n                      \r\n          if (i !== oh) {\r\n              __setFormValue(_id + '_rsh', i);\r\n  \r\n              if(_state.changing) {\r\n                  try{\r\n                      _self.Changing();\r\n                  }\r\n                  catch(ex) {\r\n                      __throwError(_id + '.getSelection().Changing', -1, '\\n' + _self.Changing, ex.message, ex);\r\n                  }\r\n              }\r\n              else {\r\n                  try{\r\n                      _self.Changed();\r\n                  }\r\n                  catch(ex) {\r\n                      __throwError(_id + '.getSelection().Changed', -1, '\\n' + _self.Changed, ex.message, ex);\r\n                  }\r\n              \r\n                  if (__getAutoPostBack()) {\r\n                      __doPostBack('RubberBand');\r\n                  }\r\n              }\r\n                      \r\n              __update();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setHeight', 3, i, 'Valid values are greater than or equal to 0.');\r\n      }\r\n  }\r\n  \r\n  _self.setMovable = __setMovable;\r\n  function __setMovable(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getMovable() !==  b) {\r\n              __setFormValue(_id + '_rsm', b);\r\n              __updateEvents();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setMovable', 5, b, '');\r\n      }\r\n  }\r\n      \r\n  _self.setMultiColor = __setMultiColor;\r\n  function __setMultiColor(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          __setFormValue(_id + '_rsmc', b);\r\n          __refreshStyle();\r\n      }\r\n      else {\r\n          __throwError('Selection.setMultiColor', 5, b, '');\r\n      }\r\n  }\r\n    _self.setPosition = __setPosition;\r\n  function __setPosition(p) {\r\n      if (p.typeOf === 'atalaPoint') {\r\n          __setPos(p.x, p.y);\r\n      }\r\n      else {\r\n          __throwError('Selection.setPosition', 4, p.typeOf, 'atalaPoint expected.');\r\n      }\r\n  }\r\n    function __setPos(x, y) {\r\n      if (x >= 0 && y >= 0) {\r\n          _data.x = Math.round(x * _state.zoom);\r\n          _data.y = Math.round(y * _state.zoom);\r\n            __updateRectangle();\r\n      }\r\n  }\r\n    _self.setResizable = __setResizable;\r\n  function __setResizable(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getResizable() !==  b) {\r\n              __setFormValue(_id + '_rsr', b);\r\n              __updateEvents();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setResizable', 5, b, '');\r\n      }\r\n  }\r\n  \r\n  _self.setSize = __setSize;\r\n  function __setSize(s) {\r\n      if (s.typeOf === 'atalaSize') {\r\n          __setSizeO(s.width, s.height);\r\n      }\r\n      else {\r\n          __throwError('Selection.setSize', 4, s.typeOf, 'atalaSize expected.');\r\n      }\r\n  }\t\t\t\r\n    function __setSize(w, h) {\r\n      if (w >= 0 && h >= 0) {\r\n          const ow = _data.width;\r\n          const oh = _data.height;\r\n            if (w > _state.pagesize.width) {\r\n              w = _state.pagesize.width;\r\n          }\r\n            if (h > _state.pagesize.height) {\r\n              h = _state.pagesize.height;\r\n          }\r\n            if (w !== ow || h !== oh) {\r\n              _data.width = w;\r\n              _data.height = h;\r\n  \r\n              __update();\r\n          }\r\n      }\r\n  //\t\telse {\r\n  //\t\t\t__throwError('Selection.setSize', 3, w + 'x' + h, 'Size must be at least 0x0.');\r\n  //\t\t}\r\n  }\r\n    _self.setShowGrips = __setShowGrips;\r\n  function __setShowGrips(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getShowGrips() !==  b) {\r\n              __setFormValue(_id + '_rsg', b);\r\n              _grips.resetGrips();\r\n              if(b) {\r\n                  _grips.show();}\r\n              else {\r\n                  _grips.hide();}\r\n                      \r\n              __update();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setShowGrips', 5, b, '');\r\n      }\r\n  }\r\n    _self.setShowTooltip = __setShowTooltip;\r\n  function __setShowTooltip(b) {\r\n      if (Atalasoft.Utils.CheckBool(b) === true) {\r\n          if (__getShowTooltip() !==  b) {\r\n              __setFormValue(_id + '_rst', b);\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setShowTooltip', 5, b, '');\r\n      }\r\n  }\r\n  \r\n  _self.setVisibility = __setVisibility;\r\n  function __setVisibility(s) {\r\n      if (__getVisibility() !== s) {\r\n          if (s === 'visible') {\r\n              __setFormValue(_id + '_rsv', true);\r\n              __update();\r\n          }\r\n          else if (s === 'hidden') {\r\n              __setFormValue(_id + '_rsv', false);\r\n              __update();\r\n          }\r\n          else {\r\n              __throwError('Selection.setVisibility', 3, s, 'Valid values are \"hidden\" or \"visible\".');\r\n          }\r\n      }\r\n  }\r\n  \r\n  _self.setWidth = __setWidth;\r\n  function __setWidth(i) {\r\n      if (i >= 0) {\r\n          const ow = __getWidth();\r\n  \r\n          if (i > _state.pagesize.width)\r\n              i = _state.pagesize.width;\r\n            if (i !== ow) {\r\n              __setFormValue(_id + '_rsw', i);\r\n                if(_state.changing) {\r\n                  try{\r\n                      _self.Changing();\r\n                  }\r\n                  catch(ex) {\r\n                      __throwError(_id + '.getSelection().Changing', -1, '\\n' + _self.Changing, ex.message, ex);\r\n                  }\r\n              }\r\n              else {\r\n                  try{\r\n                      _self.Changed();\r\n                  }\r\n                  catch(ex) {\r\n                      __throwError(_id + '.getSelection().Changed', -1, '\\n' + _self.Changed, ex.message, ex);\r\n                  }\r\n                      \r\n                  if (__getAutoPostBack()) {\r\n                      __doPostBack('RubberBand');\r\n                  }\r\n              }\r\n                          \r\n              __update();\r\n          }\r\n      }\r\n      else {\r\n          __throwError('Selection.setWidth', 3, i, 'Valid values are greater than or equal to 0.');\r\n      }\r\n  }\r\n    function __updateEvents() {\r\n      _grips.resetEvents();\r\n  }\r\n    */\n  // #endregion\n  // #region Public Methods\n\n\n  _self.bind = __bindEvents;\n  _self.hide = __hide;\n  _self.reset = __reset;\n  _self.show = __show;\n  _self.synchronize = __update;\n  _self.trigger = __triggerEvent;\n  _self.unbind = __unbindEvents;\n  _self.zoomToSelection = __zoomToRectangle;\n\n  function __bindEvents() {\n    _jqe.on.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  function __unbindEvents() {\n    _jqe.off.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  function __triggerEvent() {\n    _jqe.trigger.apply(_jqe, arguments);\n\n    return _self;\n  }\n\n  function __reset() {\n    __hide();\n\n    _data.x = 0;\n    _data.y = 0;\n    _data.width = 0;\n    _data.height = 0;\n  } // #endregion\n  // #region Private Methods\n\n\n  _self.startSelect = __startRubberBand;\n  _self.moveSelect = __sizeRubberBand;\n  _self.endSelect = __finish;\n\n  function __hideMask() {\n    _dom.mask.left.hide();\n\n    _dom.mask.right.hide();\n\n    _dom.mask.top.hide();\n\n    _dom.mask.bottom.hide();\n  }\n\n  function __showMask(rx, ry, rw, rh) {\n    if (!_data.showmask) {\n      __hideMask();\n\n      return;\n    }\n\n    if (ry > 0) {\n      _dom.mask.top.css({\n        left: _state.pageoffset.x,\n        top: _state.pageoffset.y,\n        width: __getScaledPageWidth(),\n        height: ry\n      });\n\n      _dom.mask.top.show();\n    } else {\n      _dom.mask.top.hide();\n    }\n\n    if (ry + rh < __getScaledPageHeight()) {\n      _dom.mask.bottom.css({\n        left: _state.pageoffset.x,\n        top: _state.pageoffset.y + ry + rh,\n        width: __getScaledPageWidth(),\n        height: __getScaledPageHeight() - (ry + rh)\n      });\n\n      _dom.mask.bottom.show();\n    } else {\n      _dom.mask.bottom.hide();\n    }\n\n    if (rx > 0) {\n      _dom.mask.left.css({\n        left: _state.pageoffset.x,\n        top: _state.pageoffset.y + ry,\n        width: rx,\n        height: rh\n      });\n\n      _dom.mask.left.show();\n    } else {\n      _dom.mask.left.hide();\n    }\n\n    if (rx + rw < __getScaledPageWidth()) {\n      _dom.mask.right.css({\n        left: _state.pageoffset.x + rx + rw,\n        top: _state.pageoffset.y + ry,\n        width: __getScaledPageWidth() - (rx + rw),\n        height: rh\n      });\n\n      _dom.mask.right.show();\n    } else {\n      _dom.mask.right.hide();\n    }\n  }\n\n  function __drawTooltip() {\n    _toolTip.css({\n      left: (_data.x + _data.width) * _state.zoom + 8 + 'px',\n      top: (_data.y + _data.height) * _state.zoom + 4 + 'px'\n    });\n\n    _toolTip.text(Math.round(_data.width / _state.zoom) + 'x' + Math.round(_data.height / _state.zoom));\n\n    if (_toolTip.is(':hidden')) {\n      _toolTip.show();\n    }\n  }\n\n  function __show() {\n    _data.visible = true;\n\n    _dom.rectback.show();\n\n    _dom.rect.show();\n\n    if (__getAnimated() === true && __getMultiColor() === true) {\n      __animate();\n    }\n  }\n\n  function __hide() {\n    _data.visible = false;\n\n    __hideMask();\n\n    _grips.hide();\n\n    _dom.rectback.hide();\n\n    _dom.rect.hide();\n  }\n\n  function __refreshStyle() {\n    var s = _data.multicolor ? 'dashed' : 'solid';\n    var bg = '1px solid #' + _data.backcolor;\n    var fg = '1px ' + s + ' #' + _data.forecolor;\n\n    _dom.rectback.css('border', bg);\n\n    _dom.rect.css('border', fg);\n\n    _grips.resetColors();\n  }\n\n  function __update() {\n    __updateRectangle();\n  }\n\n  function __updateRectangle() {\n    var nx = _data.x;\n    var ny = _data.y;\n    var iw = _state.pagesize.width;\n    var ih = _state.pagesize.height;\n\n    if (nx >= iw || nx + _data.width > iw) {\n      nx = iw - _data.width;\n\n      if (nx < 0) {\n        nx = 0;\n      }\n    }\n\n    if (ny >= ih || ny + _data.height > ih) {\n      ny = ih - _data.height;\n\n      if (ny < 0) {\n        ny = 0;\n      }\n    }\n\n    if (nx !== _data.x) {\n      _data.x = nx;\n    }\n\n    if (ny !== _data.y) {\n      _data.y = ny;\n    }\n\n    var rx = Math.round(_data.x * _state.zoom);\n    var ry = Math.round(_data.y * _state.zoom);\n    var rw = Math.round(_data.width * _state.zoom);\n    var rh = Math.round(_data.height * _state.zoom);\n\n    __setClientPos(rx, ry);\n\n    __setClientSize(rw, rh);\n\n    _grips.setRectangle(rx, ry, rw, rh);\n\n    if (_data.visible) {\n      __show();\n\n      __showMask(rx, ry, rw, rh);\n    } else {\n      __hide();\n    }\n  }\n\n  function __setClientPos(x, y) {\n    _dom.rectback.css({\n      left: x + 'px',\n      top: y + 'px'\n    });\n\n    _dom.rect.css({\n      left: x + 'px',\n      top: y + 'px'\n    });\n  }\n\n  function __setClientSize(w, h) {\n    if (w === 0) {\n      w = 1;\n    }\n\n    _dom.rectback.css({\n      width: w + 'px',\n      height: h + 'px'\n    });\n\n    _dom.rect.css({\n      width: w + 'px',\n      height: h + 'px'\n    });\n  }\n\n  function __startRubberBand(e) {\n    e.stopPropagation();\n    e.preventDefault();\n\n    __updateState();\n\n    var p = __getMousePosition(e);\n\n    __show();\n\n    _state.origin.x = p.x;\n    _state.origin.y = p.y;\n    _data.x = Math.round(p.x / _state.zoom);\n    _data.y = Math.round(p.y / _state.zoom);\n    _data.width = 1;\n    _data.height = 1;\n    _state.changing = true;\n    _state.vert = 0;\n    _state.horiz = 0;\n\n    __updateRectangle();\n\n    if (_data.showtooltip === true) {\n      __drawTooltip();\n    }\n\n    return false;\n  }\n\n  function __sizeRubberBand(e, p) {\n    e.stopPropagation();\n    e.preventDefault();\n    var ep = p ? p : __getMousePosition(e);\n    var nx = Math.round(_state.origin.x / _state.zoom);\n    var ny = Math.round(_state.origin.y / _state.zoom);\n    var nw = Math.abs((ep.x - _state.origin.x) / _state.zoom);\n    var nh = Math.abs((ep.y - _state.origin.y) / _state.zoom);\n\n    if (_data.aspectratio > 0) {\n      var r = Math.abs((ep.y - _state.origin.y) / (ep.x - _state.origin.x));\n\n      if (r > 1 / _data.aspectratio && _state.horiz === 0 || _state.vert === 1) {\n        // base the width off the height\n        nw = Math.round(nh * _data.aspectratio);\n      } else {\n        // base the height off the width\n        nh = Math.round(nw / _data.aspectratio);\n      }\n    }\n\n    if (ep.x < _state.origin.x) {\n      nx = nx - nw;\n\n      if (nx - _state.pageoffset.x < 0) {\n        nw = _state.origin.x - _state.pageoffset.x;\n\n        if (_data.aspectratio > 0) {\n          nh = Math.round(nw / _data.aspectratio);\n        }\n\n        nx = _state.origin.x - nw;\n      }\n    } else if (nx + nw > _state.pagesize.width + _state.pageoffset.x) {\n      nw = _state.pagesize.width - nx + _state.pageoffset.x;\n\n      if (_data.aspectratio > 0) {\n        nh = Math.round(nw / _data.aspectratio);\n      }\n    }\n\n    if (ep.y < _state.origin.y) {\n      ny = ny - nh;\n\n      if (ny - _state.pageoffset.y < 0) {\n        nh = _state.origin.y - _state.pageoffset.y;\n\n        if (_data.aspectratio > 0) {\n          nw = Math.round(nh * _data.aspectratio);\n        }\n\n        ny = _state.origin.y - nh;\n\n        if (ep.x < _state.origin.x) {\n          nx = _state.origin.x - nw;\n        }\n      }\n    } else if (ny + nh > _state.pagesize.height + _state.pageoffset.y) {\n      nh = _state.pagesize.height - ny + _state.pageoffset.y;\n\n      if (_data.aspectratio > 0) {\n        nw = Math.round(nh * _data.aspectratio);\n      }\n\n      if (ep.x < _state.origin.x) {\n        nx = _state.origin.x - nw;\n      }\n    }\n\n    if (_state.vert === 0 || _data.aspectratio > 0) {\n      _data.x = nx - _state.pageoffset.x;\n      _data.width = nw;\n    }\n\n    if (_state.horiz === 0 || _data.aspectratio > 0) {\n      _data.y = ny - _state.pageoffset.y;\n      _data.height = nh;\n    }\n\n    __updateRectangle();\n\n    if (_data.showtooltip === true) {\n      __drawTooltip();\n    }\n\n    return false;\n  }\n\n  function __resizeRubberBand(e) {\n    return __sizeRubberBand(e, getMousePositionJquery(e, null, true));\n  }\n\n  function __resize(e, d) {\n    e = e || event;\n\n    __stopPropagation(e);\n\n    _state.vert = 0;\n    _state.horiz = 0;\n    _state.changing = true;\n    var np = {\n      x: 0,\n      y: 0\n    };\n\n    switch (d) {\n      case 'nw':\n        np.x = _data.x + _data.width;\n        np.y = _data.y + _data.height;\n        break;\n\n      case 'n':\n        np.x = _data.x;\n        np.y = _data.y + _data.height;\n        _state.vert = 1;\n        break;\n\n      case 'ne':\n        np.x = _data.x;\n        np.y = _data.y + _data.height;\n        break;\n\n      case 'w':\n        np.x = _data.x + _data.width;\n        np.y = _data.y + _data.height;\n        _state.horiz = 1;\n        break;\n\n      case 'e':\n        np.x = _data.x;\n        np.y = _data.y + _data.height;\n        _state.horiz = 1;\n        break;\n\n      case 'sw':\n        np.x = _data.x + _data.width;\n        np.y = _data.y;\n        break;\n\n      case 's':\n        np.x = _data.x;\n        np.y = _data.y;\n        _state.vert = 1;\n        break;\n\n      case 'se':\n        np.x = _data.x;\n        np.y = _data.y;\n        break;\n    }\n\n    _state.origin.x = Math.round(np.x * _state.zoom) + _state.pageoffset.x;\n    _state.origin.y = Math.round(np.y * _state.zoom) + _state.pageoffset.y;\n\n    _wdvInternals.raiseDrawLayer();\n\n    var resizebinds = {\n      mousemove: __resizeRubberBand,\n      mouseup: __finish\n    };\n\n    if (_state.boundevents !== null) {\n      atalaJquery.extend(_state.boundevents, resizebinds);\n    } else {\n      _state.boundevents = resizebinds;\n    } // don't want to rebind already bound events\n\n\n    _clipper.bind(resizebinds);\n\n    return false;\n  }\n\n  function __move(e) {\n    e = e || event;\n\n    __stopPropagation(e);\n\n    var p = getMousePosition(e, null, _clipper);\n    _state.origin.x = p.x - Math.round(_data.x * _state.zoom);\n    _state.origin.y = p.y - Math.round(_data.y * _state.zoom);\n    _state.changing = true;\n    var movebinds = {\n      mousemove: __moving,\n      mouseup: __finish,\n      ondrag: __rf\n    };\n\n    if (_state.boundevents !== null) {\n      atalaJquery.extend(_state.boundevents, movebinds);\n    } else {\n      _state.boundevents = movebinds;\n    } // don't want to rebind already bound events\n\n\n    _clipper.bind(movebinds);\n\n    return false;\n  }\n\n  function __moving(e) {\n    e = e || event;\n\n    __stopPropagation(e); //TFS 1442868: jQuery wraps original mousemove event\n\n\n    var mp;\n\n    if (e.type === 'mousemove') {\n      mp = getMousePosition(e.originalEvent, null, _clipper);\n    } else {\n      mp = getMousePosition(e);\n    }\n\n    var np = {\n      x: 0,\n      y: 0\n    };\n    np.x = Math.round((mp.x - _state.origin.x) / _state.zoom);\n    np.y = Math.round((mp.y - _state.origin.y) / _state.zoom);\n\n    if (np.x > _state.pagesize.width - _data.width) {\n      np.x = _state.pagesize.width - _data.width;\n    }\n\n    if (np.x < 0) {\n      np.x = 0;\n    }\n\n    if (np.y > _state.pagesize.height - _data.height) {\n      np.y = _state.pagesize.height - _data.height;\n    }\n\n    if (np.y < 0) {\n      np.y = 0;\n    }\n\n    _data.x = np.x;\n    _data.y = np.y;\n\n    __updateRectangle();\n\n    return false;\n  }\n\n  function __finish(e) {\n    e = e || event;\n\n    __stopPropagation(e);\n\n    _state.changing = false;\n\n    if (_data.showtooltip === true) {\n      _toolTip.hide();\n    }\n\n    if (_state.changing) {\n      _state.changing = false;\n\n      __triggerEvent('changed');\n    }\n\n    if (_state.boundevents !== null) {\n      _clipper.unbind(_state.boundevents);\n\n      _state.boundevents = null;\n\n      _wdvInternals.resetDrawLayer();\n    }\n\n    return false;\n  }\n\n  function __animate() {\n    if (_data.animated === true && _state.colorswap === 0) {\n      _dom.rect.css('border', '1px dashed #' + __getBackColor());\n\n      _dom.rectback.css('border', '1px solid #' + __getForeColor());\n\n      _state.colorswap = 1;\n    } else {\n      _dom.rect.css('border', '1px dashed #' + __getForeColor());\n\n      _dom.rectback.css('border', '1px solid #' + __getBackColor());\n\n      _state.colorswap = 0;\n    }\n\n    if (_data.animated === true && !_dom.rect.is(':hidden') && !_state.animating) {\n      _state.animating = setTimeout(function () {\n        _state.animating = false;\n\n        __animate();\n      }, 250);\n    }\n  } // #endregion\n  // #region Helper Methods\n\n\n  function __getMousePosition(e) {\n    var p = getMousePositionJquery(e.toolEvent ? e.toolEvent : e);\n\n    if (_clipper._paper) {\n      var offset = getSVGOffset(_clipper._paper.canvas, _clipper);\n      p.x -= offset.left;\n      p.y -= offset.top;\n    }\n\n    return p;\n  }\n\n  function __getScaledPageHeight() {\n    return Math.round(_state.pagesize.height * _state.zoom);\n  }\n\n  function __getScaledPageWidth() {\n    return Math.round(_state.pagesize.width * _state.zoom);\n  }\n\n  function __stopPropagation(e) {\n    if (e.stopPropagation !== undefined) {\n      e.stopPropagation();\n    } else {\n      e.cancelBubble = true;\n    }\n  }\n\n  function __updateState() {\n    // used for when centering the image is enabled\n    //\t\tconst offset = _clipper._img.offset();\n    //\t\t_state.pageoffset.x = offset.left;\n    //\t\t_state.pageoffset.y = offset.top;\n    var size = _clipper._img.getSize();\n\n    _state.zoom = _clipper._img.getFitZoom();\n    _state.pagesize.width = size.width;\n    _state.pagesize.height = size.height;\n  }\n\n  function __zoomToRectangle() {\n    var maxZoom = _wdvInternals.getMaxZoom();\n\n    if (_wdv.getZoom() < maxZoom) {\n      var newZoom;\n\n      var vps = _wdvInternals.getViewportSize();\n\n      var fitzoom = _clipper._img.getFitMultiplier();\n\n      var fullzoom = 1;\n      var npx = 0;\n      var npy = 0; // Zooms to the best fit of the Selection area\n\n      if (vps.width / _data.width === vps.height / _data.height) {\n        // the unusual case when the ratio of the control is the same as the selection, need to use the minimum due to round off error\n        newZoom = Math.min(vps.width / (_data.width * fitzoom), vps.height / (_data.height * fitzoom), maxZoom);\n      } else if (vps.width / _data.width < vps.height / _data.height) {\n        // base the new zoom on the width of the selection\n        newZoom = Math.min(vps.width / (_data.width * fitzoom), maxZoom);\n      } else {\n        // base the new zoom on the height of the selection\n        newZoom = Math.min(vps.height / (_data.height * fitzoom), maxZoom);\n      }\n\n      fullzoom = fitzoom * newZoom;\n      npx = Math.round(_data.x * fullzoom);\n      npy = Math.round(_data.y * fullzoom); // we are trying to zoom to fit one side of viewport. but due to maxZoom it could be not possible. so center the area.\n\n      npy -= Math.max(0, Math.round((vps.height - _data.height * fullzoom) / 2));\n      npx -= Math.max(0, Math.round((vps.width - _data.width * fullzoom) / 2));\n\n      var offset = _wdvInternals.getPageOffsets(_clipper._index, null, null, newZoom);\n\n      _wdv.zoom(newZoom, function () {\n        _wdv.scrollTo(offset.width + npx, offset.height + npy);\n      });\n    }\n  } // #endregion\n\n\n  __init();\n\n  return _self;\n};\n\n/* harmony default export */ var mousetools_RubberBandTool = (RubberBandTool_RubberBandTool);\n// CONCATENATED MODULE: ./src/controls/WebDocumentViewer.js\n\n\n\n\n\n\n\n\n\n\n\nfunction WebDocumentViewer_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2015 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n//\tChange History:\n//\t11-04-10\t*********\t\tFile Created.\n//\t08-23-11\tD. Cilley\t\tFB 12456: Added maxdpi for allowing codec DPI changes while zoomed out.\n//\t08-29-11\tD. Cilley\t\tFB 12458: Fixed js errors when scrolling a blank viewer.\n//\t11-18-11\tD. Cilley\t\tFB 12690: Removed DPI settings, and added fixed page widths.\n//\t02-22-12\tD. Cilley\t\tFB 12934: Fixed Stamp and Image saving.\n//\t02-24-12\tD. Cilley\t\tFB 12940: Fixed annotation loading from openUrl.\n//\t03-01-12\tD. Cilley\t\tFB 13030, FB 13031: Removed unusable buttons depending on options given.\n//\t03-13-12\tD. Cilley\t\tFB 13073: Fixed a bug that would allow negative pages to show.\n//\t04-02-12\tD. Cilley\t\tTidied up some of the error and event handler code.\n//\t04-19-12\tD. Cilley\t\tFB 13176: Fixed page load event firing after page recycle.\n//\t05-03-12\tD. Cilley\t\tStopped removing everything from recycled pages to maintain events.\n//\t09-11-12\tD. Cilley\t\tFB 13589: Improved architecture to allow for easier editing.\n//\t10-02-12\tD. Cilley\t\tFB 13625: Fixed a bug with jQuery 1.8.x compatibility.\n//\t10-18-12\tD. Cilley\t\tFB 13674, 13676: Fixed clicks in menu when using touch devices.\n//\t10-25-12\tD. Cilley\t\tFB 13715: Refactored internal vars, and added __getDebugInfo for testing.\n//\t11-01-12\tJ. Burch\t\tFB 13732, 13733: Created methods to get document information and deselect all annos.\n//\t11-05-12\tD. Cilley\t\tFB 13742, 13744: Fixed bugs in creating annotations.\n//\t11-06-12\tD. Cilley\t\tFB 13751: Fixed a bug with annotation zoom level after loading.\n//\t11-07-12\tJ. Burch\t\tFB 13748: Added public deleteAnnotationOnPageAtIndex method.\n//\t11-09-12\tD. Cilley\t\tFB 13757: Added callbacks and 'async' on several methods to help with firing events.\n//\t11-12-12\tD. Cilley\t\tFB 13713: Fixed some problems with showPage callbacks.\n//\t11-15-12\tD. Cilley\t\tFB 13716: Fixed a bug with getCurrentPageIndex.\n//\t11-16-12\tD. Cilley\t\tFB 13794: Fixed a problem with menu item clicks in some iOS devices.\n//\t11-16-12\tD. Cilley\t\tFB 13793: Fixed a problem with loading images while zooming.\n//\t11-20-12\tD. Cilley\t\tFB 13803: Added reflow and image loading callbacks to fix overscroll.\n//\t11-26-12\tD. Cilley\t\tFB 13673: Fixed viewer scroll after annotation delete in iOS mobile.\n//\t12-10-12\tD. Cilley\t\tFB 13852: Fixed a bug that would allow controller access even if it was null.\n//\t02-06-12\tD. Cilley\t\tFB 13957: Fixed missing script checking, and added config option for script resource url.\n//\t02-15-13\tD. Cilley\t\tFB 13971: Fixed scope problem in __loadDependency.\n//\t02-21-13\tD. Cilley\t\tFB 14065: Added JSHint options and fixes to comply with JSHint warnings.\n//\t03-01-13\tD. Cilley\t\tFB 14066: TextAnnotations now use HTML rendering for all browsers.\n//\t03-14-13\tD. Cilley\t\tFB 14067: Fixed showNext and showPrevious endless event firing.\n//\t05-07-13\tD. Cilley\t\tFB 14119: Fixed AnnotationController initialization if scripts were already loaded.\n//\t06-14-13\tD. Cilley\t\tFB 14194: Fixed a bug that would initially load the first few pages twice.\n//\t07-15-13\tD. Cilley\t\tFB 14215: Added beforehandlerrequest and handlerreturned events.\n//\t08-30-13\tD. Cilley\t\tFB 14274: Added Thumbnailer functionality.\n//\t08-30-13\tD. Cilley\t\tFB 14275: Fixed multi-loading scripts when there's more than one WDV.\n//\t08-30-13\tD. Cilley\t\tFB 14276: Fixed visual fitting problem.\n//\t09-12-13\tD. Cilley\t\tFB 14305: Removed unnecessary scrollbar resizes for overscroll in WDT.\n//\t09-16-13\tD. Cilley\t\tFB 14333: Fixed annotation paper centering on thumbs.\n//\t09-19-13\tD. Cilley\t\tFB 14345: Fixed annotation paper sizing on page zoom.\n//\t11-06-13\tD. Cilley\t\tFB 14453: Added config to allow/disable flick scrolling.\n//\t11-06-13\tD. Cilley\t\tFB 14454: Added config to change the number of pages in buffer.\n//\t11-12-13\tD. Cilley\t\tFB 14186: Added ability to cancel or switch annotation drawing.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t12-17-13\tD. Cilley\t\tFB 14478: Fixed overscroll after scrolling to the bottom with the scrollbar thumb.\n//\t01-16-14\tD. Cilley\t\tBug 293573: Fixed scroll position calculations while zooming.\n//\t01-24-14\tD. Cilley\t\tBug 293565, 282529, 282620, 293575, 293574: Fixed bugs when paper was sized improperly.\n//\t01-28-14\tD. Cilley\t\tBug 293824: Removed need for trailing slash on config.scripturl.\n//\t02-06-14\tD. Cilley\t\tBug 309834: Fixed openUrl hang, and added public empty function.\n//\t03-18-14\tD. Cilley\t\tBug 316222: Moved zoomStart zoomInstant and zoomEnd to _wdvInternals.\n//\t03-18-14\tD. Cilley\t\tBug 316083: Fixed Fitting.Best config option.\n//\t08-12-14\tD. Cilley\t\tBug 367422: Fixed a bug that would cause an error when a pageref was undefined.\n//\t08-14-14\tD. Cilley\t\tBug 345109: Added framework for horizontal scrolling and grid layout.\n//\t08-27-14\tD. Cilley\t\tBug 367422: Fixed a bug that would use old mapping for newly opened documents.\n//\t09-29-14\tD. Cilley\t\tBug 369024: Fixed scrolling to page indicated on tooltip after scroll thumb was grabbed.\n//\t09-30-14\tD. Cilley\t\tBug 367012: Added support for multiple page view, and differing sizes.\n//\t10-01-14\tD. Cilley\t\tBug 369093: Fixed mouse wheel scrolling scrollbar desync.\n//\t10-02-14\tD. Cilley\t\tBug 369053: Fixed initial clicking of the scrollbar.\n//\t11-07-14\tD. Cilley\t\tBug 374493: Fixed a bug that would make too many image requests while scrolling after a zoom.\n//\t11-12-14\tD. Cilley\t\tBug 403851: Added tracking of image resources to accommodate low memory machines.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t01-16-15\tD. Cilley\t\tBug 556294: Added image dispose to help with mapsto exceptions.\n//\t01-28-15\tD. Cilley\t\tTask 568577: Added Jpeg property.\n//\t01-29-15\tD. Cilley\t\tBug 562652: Fixed poor performance when scrolling fast.\n//\t02-03-15\tD. Cilley\t\tBug 571361: Fixed first page refresh after loading new document.\n//\t02-04-15\tD. Cilley\t\tBug 549465: Fixed scrollTo and scrollBy when scrolling past available space.\n//\t02-18-15\tD. Cilley\t\tBug 583364: Fixed a couple bugs that let the viewer scroll past last page.\n//\t02-19-15\tD. Cilley\t\tBug 560725: Fixed multiple bugs that caused thumbnails not to be displayed.\n//\t02-26-15\tD. Cilley\t\tBug 560686: Fixed multiple problems with navigation when scrolling.\n//\t03-11-15\tD. Cilley\t\tBug 588639: Fixed off by one bugs in showPage and showPageAsync.\n//\t03-11-15\tD. Cilley\t\tBug 587585: Fixed showPage() when requested to advance one page.\n//\t03-18-15\tD. Cilley\t\tBug 589812: Fixed showPage() call that requests too many next pages.\n//\t04-06-15\tD. Cilley\t\tBug 593013: Fixed column sizing when thumbs are scrolled quickly.\n//\t04-10-15\tD. Cilley\t\tBug 596029: Fixed a bug in showPage() when used in a callback from openUrl.\n//\t05-01-15\tD. Cilley\t\tBug 608515: Added vector flag for enabling zoom past 1.\n//\t06-04-15\tA. Huck\t\t\tBug\t610232: Removed call to __redrawVisiblePages in __onScroll.\n//\t06-17-15\tD. Cilley\t\tBug 607631: Added config property to change page selection location.\n//\t06-24-15\tD. Cilley\t\tBug 622231: Fixed secondary scrollbar when both are needed.\n//\t07-01-15\tD. Cilley\t\tBug 561087: Fixed config.zoom initial setting.\n//\t07-02-15\tD. Cilley\t\tBug 625845: Exposed dispose method.\n//\t07-08-15\tD. Cilley\t\tBug 625900: Fixed zoom past 100%.\n//\t07-10-15\tD. Cilley\t\tBug 629656: Added pagenumberchanged event.\n//\t07-16-15\tG. Ermakov\t\tBug 618782: Incorrect scrolling when wrong image size detected. __CPimgUpdateSize to use naturalWidth/Height props.\n//\t08-14-15\tD. Cilley\t\tBug 635773: Fixed thumbnailer not clickable after opening a second image.\n//\t09-01-15\tD. Cilley\t\tTask 630965: Added event bind tracking and intellisense.\n//\t09-15-15\tD. Cilley\t\tBug 627869: Added support for forcing all pages to be fit into the same size.\n//\t09-21-15\tD. Cilley\t\tBug 635949: Fixed multiple scroll related issues, and page number label location.\n//\t09-22-15\tD. Cilley\t\tBug 647639, 647645: Fixed more scroll related issues.\n//\t09-23-15\tD. Cilley\t\tBug 647643: Fixed zooming to 1:1 with forcepagefit.\n//\t09-30-15\tD. Cilley\t\tBug 610232: Fixed __redrawVisiblePages so that it would stop unnecessarily redrawing annotation and form layers.\n//\t10-01-15\tD. Cilley\t\tBug 649407: Fixed toolbar page number after loading a new doc.\n//\t10-02-15\tD. Cilley\t\tBug 649406: Fixed fitting while forcepagefit == true.\n//\t10-07-15\tD. Cilley\t\tBug 649408: Fixed scrollbar not able to scroll past a certain point after loading a new doc.\n//\t10-08-15\tD. Cilley\t\tBug 652306: Fixed __showNext and __showPrev when increment of zero was passed in.\n//\t11-02-15\tD. Cilley\t\tBug 656878: Fixed a bug that would cause multiple images to be displayed on a page.\n//\t11-18-15\tD. Cilley\t\tBug 664373, 665129: Fixed a bug that would cause too many image requests when scrolling up.\n//\t11-19-15\tD. Cilley\t\tBug 656878: Fixed a bug that would cause multiple images to be displayed on a page.\n//\t12-04-15\tD. Cilley\t\tBug 670919, 670924, 670938: Fixed several ZoomArea bugs.\n//\t12-20-15\tD. Cilley\t\tBug 670911: Fixed rubberband conflicts with forcepagefit config option.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\r\n * Control that views, modifies, and saves documents, annotations and forms.\r\n * @param {WebDocumentViewerConfig} [settings] Object of key value pairs representing initial settings\r\n * @param {OpenUrlCallback} [openCallback] callback that is called when document load complete(if {@link WebDocumentViewerConfig.documenturl| documenturl} is specified).\r\n * @class\r\n * @returns {WebDocumentViewer} A new control with the given settings.\r\n * @memberof Atalasoft.Controls\r\n */\n\nvar WebDocumentViewer_WebDocumentViewer = function WebDocumentViewer(settings, openCallback) {\n  if (!checkJQueryDependency()) return null;\n  var _self = {\n    typeOf: settings.type || 'Atalasoft.Controls.WebDocumentViewer'\n  };\n\n  var _isThumbnailer = _self.typeOf === 'Atalasoft.Controls.WebDocumentThumbnailer';\n\n  var _isSinglePageMode = settings.singlepage;\n  var _id = '';\n  var _zmd = 150; // zoom animation duration (ms)\n\n  var _scd = 500; // scroll animation duration (ms)\n\n  var _iconClass = 'atala-ui-icon';\n\n  var _garbage = document.createElement('div');\n\n  var maxTilesPerEdge = 4;\n  var tilingThreshold = 1500;\n\n  var _jqe = atalaJquery({}); // jquery instance to bind events to\n\n\n  var _internalEvents = atalaJquery({}); //internal events instance for private communications.\n\n\n  var _stateManager = new DocumentStateManager(__getStateManagerApi());\n  /**\r\n   * Internal jQuery DOM objects\r\n   * @private\r\n   */\n\n\n  var _dom = {\n    /** Main outer object that holds the scrollbars */\n    main: null,\n\n    /** Toolbar wrapper object */\n    toolbar: null,\n\n    /** Inner object that controls scrolling */\n    scroller: null,\n\n    /** Inner object that defines the viewable area */\n    viewport: null,\n\n    /** Inner content container object */\n    content: null,\n\n    /** Inner horizontal scroll bar object */\n    scrollH: null,\n\n    /** Inner vertical scroll bar object */\n    scrollV: null,\n\n    /** Edge objects of viewable area */\n    edges: [],\n\n    /** Image objects already requested */\n    loadedImgs: [],\n\n    /** Page wrapper objects recycle pool */\n    pageDivs: [],\n\n    /** Span tag containing the page number */\n    pageLabel: null,\n\n    /** Status div */\n    status: null,\n\n    /** Upload control*/\n    uploadCtrl: null\n  }; // Atalasoft Objects\n\n  var _controllers = {\n    annotations: null,\n    // annotation controller\n    document: null,\n    // document manipulation controller\n    forms: null,\n    // form controller\n    mouseTool: null,\n    // mousetool controller\n    memory: null,\n    // memory controller\n    text: null,\n    // text controller\n    upload: null // upload controller\n\n  }; // page values\n\n  var _page = __createEmptyPageDataObject(); // state values\n\n\n  var _state = __createEmptyStateObject(); //bookmark control state\n\n\n  var _bookmarkState = {\n    top: 0,\n    left: 0,\n    expanded: []\n  }; // events\n\n  /**\r\n   * @lends Atalasoft.Controls.WebDocumentViewer\r\n   */\n\n  var _events = {\n    /**\r\n     * @typedef {Object} Request\r\n     * @property {string} method - The request HTTP method.\r\n     * @property {Object} data - The request parameters that will be send to server.\r\n     * @property {string} type - The request type identifier.\r\n     * Supported request types are:\r\n     *\r\n     * |Identifier| Description|\r\n     * | ----- | ------- |\r\n     * |`docinfo` | Document info request. Maps to `DocumentInfoRequested` server event.|\r\n     * |`docpage` | Document page request. Could be issued multiple times - it's expected that page will be served from browser cache for the same query. Maps to `ImageRequested` server event.|\r\n     * |`docsave` | Document save request. Maps to `DocumentSave` server event.|\r\n     * |`annodata` | Annotation data request. Maps to `AnnotationDataRequested` server event.|\r\n     * |`formdata` | Forms data request. Maps to `PdfFormRequested` server event.|\r\n     * |`pagetextdata` | Maps to `PageTextRequested` server event.|\r\n     * |`fileupload`| User file upload. Maps to `FileUpload` and `FileUploaded` server events.|\r\n     */\n\n    /**\r\n     * @typedef {Object} DocumentInfo\r\n     * @property {number} count - The document pages count.\r\n     * @property {number} dpi - The document pages dpi.\r\n     * @property {Object} size - The document pages size.\r\n     * @property {number} size.height - The document pages height.\r\n     * @property {number} size.width - The document pages width.\r\n     * @property {boolean} vector - Flag indicating whether or not document is vector graphic.\r\n     */\n\n    /**\r\n     * @typedef {Object} UploadFileInfo - The upload file information structure.\r\n     * @property {string} filename - Name of the file for upload.\r\n     * @property {number} size - Size of the file for upload in bytes.\r\n     * @property {boolean} cancel - Flag indicating whether or not upload should be canceled by the client.\r\n     */\n\n    /**\r\n     * @typedef {Object} UploadFileErrorInfo - The upload error information structure.\r\n     * @property {string} filename - Name of the file for upload.\r\n     * @property {string} error - Error message contains the cause why file upload has failed.\r\n     * @property {boolean} canceled - Flag indicating whether or not upload was canceled by the client or server.\r\n     * @property {Object} event.customData - The event customer data from server. This property is set in case when error has occurred on server or file was rejected on server-side.\r\n     */\n\n    /**\r\n     * @typedef {Object} UploadingFileInfo - The uploading file information structure.\r\n     * @property {string} filename - Name of the file for upload.\r\n     * @property {number} uploadedbytes - Uploaded bytes count.\r\n     * @property {number} totalbytes - Total bytes count.\r\n     * @property {boolean} cancel - Flag indicating whether or not upload should be canceled by the client.\r\n     */\n\n    /**\r\n     * @typedef {Object} UploadStartInfo - The upload start information structure.\r\n     * @property {boolean} cancel - Flag indicating whether or not upload should be canceled by the client.\r\n     */\n\n    /**\r\n     * Callback signature for\r\n     * @callback BeforeHandlerRequestCallback {@link Atalasoft.Controls.WebDocumentViewer#event:beforehandlerrequest} event.\r\n     * @param {Object} event - The event object.\r\n     * @param {Request} event.request - The request object.\r\n     */\n\n    /**\r\n     * Triggers before a request is sent to the server.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#beforehandlerrequest\r\n     * @type {BeforeHandlerRequestCallback}\r\n     * @param {Object} event - The event object.\r\n     * @param {Request} event.request - The request object.\r\n     *\r\n     * This event could be used to override or extend request parameters which is exposed through `event.request.data`.\r\n     * Requests could be distinguished using `event.request.type` field. For supported request types see {@link Request} structure.\r\n     */\n    beforehandlerrequest: null,\n\n    /**\r\n     *  Triggers when the document info has changed, usually after a new document is opened.\r\n     *  @event Atalasoft.Controls.WebDocumentViewer#documentinfochanged\r\n     *  @param {Object} event - The event object.\r\n     *  @param {DocumentInfo} event.info - The event document info.\r\n     *  @param {Object} event.customData - The event customer data from server.\r\n     */\n    documentinfochanged: null,\n\n    /** Triggers when the document is done loading.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#documentloaded\r\n     * @param {Object} event - The event object.\r\n     * @param {Object} event.customData - The event customer data from server.\r\n     */\n    documentloaded: null,\n\n    /**\r\n     * Triggers when viewer has been activated by another thumbnailer or reactivated by the same thumbnailer with changed document data.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#activedocumentchanged\r\n     * @type {NotificationCallback}\r\n     */\n    activedocumentchanged: null,\n\n    /** Triggers after a response from the server while saving the document.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#documentsaved\r\n     * @param {Object} event - The event object.\r\n     * @param {boolean} event.success - Flag indicating whether or not save were successful.\r\n     * @param {string} event.fileName - File path to the saved file. By default it represents a path to the file relative to application path. However, if 'DocumentStream' property  was initialized or 'PreventDefaultSaving' flag is used on server-side, then this property contains a value of 'DocumentStreamName' property.\r\n     * @param {Object} event.customData - The event customer data from server.\r\n     */\n    documentsaved: null,\n\n    /**\r\n     * Triggers when the document has been unloaded from the control.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#documentunloaded\r\n     * @type {NotificationCallback}\r\n     */\n    documentunloaded: null,\n\n    /**\r\n     * Callback signature for {@link Atalasoft.Controls.WebDocumentViewer#event:error} event.\r\n     * @callback ErrorCallback\r\n     * @param {Object} event - The event object.\r\n     * @param {string} event.name - The error type identifier.\r\n     * @param {string} event.message - The error clarification message.\r\n     */\n\n    /** Triggers when the control has encountered and error. Populated keys: e.name, e.message\r\n     * @event Atalasoft.Controls.WebDocumentViewer#error\r\n     * @param {Object} event - The event object.\r\n     * @param {string} event.name - The error type identifier.\r\n     * @param {string} event.message - The error clarification message.\r\n     * @type {ErrorCallback}\r\n     */\n    error: null,\n\n    /** Triggers when the control has completed asynchronous initialization.\r\n     *\r\n     * Asynchronous initialization happens when some dependent scripts are not included to web page and control trying to load them on background.\r\n     * In case of synchronous initialization, this event won't be fired. {@link Atalasoft.Controls.WebDocumentViewer#isReady| isReady} method could be used after construction to check whether control is initialized.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#initialized\r\n     * @type {NotificationCallback}\r\n     */\n    initialized: null,\n\n    /**\r\n     * Triggers when the page number has changed. Populated keys: e.number\r\n     * @event Atalasoft.Controls.WebDocumentViewer#pagenumberchanged\r\n     * @param {Object} event - The event object.\r\n     */\n    pagenumberchanged: null,\n\n    /** Triggers when the control has recycled a pageDiv object.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#pagerecycled\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the recycled page.\r\n     */\n    pagerecycled: null,\n\n    /**\r\n     * Triggers when the control has resized a pageDiv object.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#pageresize\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the resized page.\r\n     * @param {number} event.width - Width of the page after resize.\r\n     * @param {number} event.height - Height of the recycled page.\r\n     */\n    pageresize: null,\n\n    /** Triggers when the control has shown a page in the viewable area.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#pageshown\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the page.\r\n     */\n    pageshown: null,\n\n    /** Triggers when the page size returned from the server is different than expected. The expected page size is the size returned from server along with other document info.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#pagesizechanged\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the resized page.\r\n     * @param {number} event.width - Width of the page after resize.\r\n     * @param {number} event.height - Height of the recycled page.\r\n     * @param {number} event.dx - Difference with the previous(expected) page width. Scaled images are compared.\r\n     * @param {number} event.dy - Difference with the previous(expected) page height. Scaled images are compared.\r\n     */\n    pagesizechanged: null,\n\n    /** Triggers for every pixel movement registered by the scrollable area.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#scroll\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.x - Horizontal scroll position.\r\n     * @param {number} event.y - Vertical scroll position.\r\n     * @param {number} event.dx - Distance scrolled horizontally.\r\n     * @param {number} event.dy - Distance scrolled vertically.\r\n     */\n    scroll: null,\n\n    /** Triggers when dependencies have finished loading.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#scriptsloaded\r\n     * @type {NotificationCallback}\r\n     */\n    scriptsloaded: null,\n\n    /** Triggers when the control has updated the status bar.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#statusmessage\r\n     * @param {Object} event - The event object.\r\n     * @param {string} event.message - The status message.\r\n     */\n    statusmessage: null,\n\n    /** Triggers when a zoom operation has been started.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#zoomstarted\r\n     * @type {NotificationCallback}\r\n     */\n    zoomstarted: null,\n\n    /** Triggers when the zoom level of the control has changed.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#zoomchanged\r\n     * @param {Object} event - The event object.\r\n     * @param {number} zoom - Current document zoom value.\r\n     */\n    zoomchanged: null,\n\n    /**\r\n     * Triggers when file upload is started\r\n     * @event Atalasoft.Controls.WebDocumentViewer#fileuploadstarted\r\n     * @param {Object} event - The event object.\r\n     * @param {UploadFileInfo} event.fileinfo - The file information.\r\n     */\n    fileuploadstarted: null,\n\n    /**\r\n     * Triggers when file upload has failed or was canceled.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#fileuploaderror\r\n     * @param {Object} event - The event object.\r\n     * @param {UploadFileErrorInfo} event.errorinfo - The error information.\r\n     */\n    fileuploaderror: null,\n\n    /**\r\n     * Triggers when file upload has finished successfully.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#fileuploadfinished\r\n     * @param {Object} event - The event object.\r\n     * @param {string} event.filename - Name of the file for upload.\r\n     * @param {string} event.filepath - Relative path on server to the uploaded file.\r\n     * @param {Object} event.customData - The event customer data from server.\r\n     */\n    fileuploadfinished: null,\n\n    /**\r\n     * Triggers during file upload process. Can be used to track upload progress.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#fileuploading\r\n     * @param {Object} event - The event object.\r\n     * @param {UploadingFileInfo} event.uploadinfo - The progress information.\r\n     */\n    fileuploading: null,\n\n    /**\r\n     * Triggers when the files upload is started.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#uploadstarted\r\n     * @param {Object} event - The event object.\r\n     * @param {UploadStartInfo} event.info - The upload information.\r\n     */\n    uploadstarted: null,\n\n    /**\r\n     * Triggers when the files upload is finished\r\n     * @event Atalasoft.Controls.WebDocumentViewer#uploadfinished\r\n     * @param {Object} event - The event object.\r\n     * @param {boolean} event.success - Flag indicating whether or not upload was completed without errors.\r\n     * @param {boolean} event.canceled - Flag indicating whether or not upload was canceled.\r\n     */\n    uploadfinished: null,\n\n    /**\r\n     * Triggers when the file added to upload files through UI controls.\r\n     * @event Atalasoft.Controls.WebDocumentViewer#fileaddedtoupload\r\n     * @param {object} event - The event object.\r\n     * @param {string} event.filename - Name of the file for upload.\r\n     * @param {Atalasoft.Utils.FileUploadRejectReason} event.reason - The reason of why file was rejected from the adding to upload.\r\n     * @param {boolean} event.success - Flag indicating whether or not file has passed filtering.\r\n     */\n    fileaddedtoupload: null\n  }; // config object\n\n  /**\r\n   * Represents {@link Atalasoft.Controls.WebDocumentViewer|WebDocumentViewer} configuration.\r\n   * @atalaconfig\r\n   * @alias WebDocumentViewerConfig\r\n   */\n\n  var _config = {\n    /**\r\n     * @property {boolean} [allowannotations=false] - Turns annotation support on or off.\r\n     * This affects both UI annotations toolbar appearance and corresponding API methods behavior.\r\n     * If set to `false`, {@link Atalasoft.Controls.WebDocumentViewer#annotations|WebDocumentViewer.annotations} will be set to `null` and annotation-related methods of {@link Atalasoft.Controls.WebDocumentViewer |WebDocumentViewer} will throw errors.\r\n     */\n    allowannotations: false,\n\n    /**\r\n     * @property {array} [textAnnotationEditorIgnoredKeyCodes=[]] - Sets key codes ignored by text annotation editor.\r\n     */\n    textAnnotationEditorIgnoredKeyCodes: [],\n\n    /**\r\n     * @property {boolean} [allowflick=true] - Turns flick scrolling support on or off.\r\n     */\n    allowflick: true,\n\n    /**\r\n     * @property {boolean} [allowforms=false] - Turns forms support on or off.\r\n     */\n    allowforms: false,\n\n    /**\r\n     * @property {boolean} [allowtext=false] - Turns text selection support on or off.\r\n     */\n    allowtext: false,\n\n    /**\r\n     * @property {AnnotationsConfig} [annotations] - Annotations specific config options, including predefined configurations for particular annotation types.\r\n     */\n    annotations: {\n      /**\r\n       * Represents default configuration for various types of annotations.\r\n       * @typedef {Object} AnnotationsConfig\r\n       * @property {AnnotationData[]} [defaults] - Pre defined annotations to be drawn with the mouse.\r\n       * @property {AnnotationData[]} [stamps] - Pre defined stamp annotations to be drawn with the mouse.\r\n       * @property {AnnotationData[]} [images] - Pre defined image annotations to be drawn with the mouse.\r\n       * @property {boolean} [saveusername] - Indicates whether the server handler will save the username property when saving all\r\n       */\n      //TODO: set link to custom annotations tutorial\n\n      /**\r\n       * Predefined annotations to be drawn with the mouse.\r\n       */\n      defaults: null,\n\n      /**\r\n       * Predefined stamp annotations to be drawn with the mouse.\r\n       */\n      stamps: null,\n\n      /**\r\n       * Pre defined image annotations to be drawn with the mouse.\r\n       */\n      images: null,\n\n      /**\r\n       * Indicates whether the server handler will save the username property when saving all annotations.\r\n       */\n      saveusername: false\n    },\n\n    /**\r\n     * @property {number} [columns] - Number of columns to show when displaying tabular pages, -1 is automatic. */\n    columns: -1,\n\n    /** @property {Atalasoft.Utils.ScrollDirection} [direction = Vertical] - Scroll direction of the viewer.\r\n     *\r\n     * i.e. controls whether document pages positioned in vertical or horizontal direction.\r\n     */\n    direction: ScrollDirection.Vertical,\n\n    /**\r\n     * @property {string} [documenturl] - Identifier of the document (that is on the server) to be displayed when the document is first opened.\r\n     *\r\n     * By default `documenturl` is treated as an url to the image file on server. Application could customize server behavior and in this case `documenturl` could contain arbitrary string.\r\n     * If this parameter is specified, document will be opened right after viewer initialization completes. Otherwise document should be opened using {@link Atalasoft.Controls.WebDocumentViewer.openUrl | openUrl} method.\r\n     *\r\n     * This property on the {@link Atalasoft.Controls.WebDocumentViewer#config|viewer.config} is updated internally each time new document is opened.\r\n     */\n    documenturl: '',\n\n    /**\r\n     *  @property {string} [annotationsurl] Identifier of the annotation data (an .xmp file on the server) that should be displayed along with the displayed document.\r\n     *\r\n     *  By default `annotationsurl` is treated as an url to the serialized annotations data file on server(usually .xmp). Application could customize server behavior and in this case `annotationsurl` could contain arbitrary string.\r\n     *\r\n     *  This property on the {@link Atalasoft.Controls.WebDocumentViewer#config|viewer.config} is updated internally each time new document is opened.\r\n     */\n    annotationsurl: '',\n\n    /**\r\n     * @property {string} [formurl] - Identifier of the annotation data PDF form data (.pdf file on the server) that should be displayed along with the displayed document.\r\n     *\r\n     * In most cases this option should be omitted, so forms will be loaded from the PDF document specified by {@link WebDocumentViewerConfig.documenturl | documenturl}\r\n     *\r\n     * This property on the {@link Atalasoft.Controls.WebDocumentViewer#config|viewer.config} is updated internally each time new document is opened.\r\n     */\n    formurl: '',\n\n    /**\r\n     * @property {Atalasoft.Utils.Fitting} [fitting = Width] - Specifies the initial page image fit when document is opened in the viewer.\r\n     *\r\n     * Usually it makes sense to set initial fit to viewer width for vertical scrolling {@link WebDocumentViewerConfig.direction|direction} and to height for horizontal.\r\n     */\n    fitting: Fitting.Width,\n\n    /**\r\n     * @property {boolean} [forcepagefit=false] - Specifies whether document pages should be unified basing on the expected document page size.\r\n     *\r\n     * Expected page size is sent by server when opening new document. By default it's the size of the first page in document, but any values could be provided when default behavior is overridden by application.\r\n     *\r\n     * It's recommended to set this option to `true` for most documents.\r\n     *\r\n     * Setting this property to true have following benefits:\r\n     * - Pages looks similar even for documents containing pages with having different sizes(or different DPI). Aspect ratio is preserved when calculating unification zoom ratio, so pages are not completely same. But in most cases they would have same width or height.\r\n     *\r\n     * - Pages are requested on demand, so size of each individual page is not known until it's loaded from server. Thus when pages having different sizes are inserted into DOM, their sizes are different from expected. This would cause resizing of the DOM elements and thus cause visual shifts of the images. Especially such effect could be noticeable on big images, when rendering and load time is bigger then usual.\r\n     *\r\n     * Setting this option to false is helpful when document having pages both \"small\" and \"big\" pages and those pages should be displayed as is, without additional zoom. For example, when driver license and scanned pages are displayed as a single document.\r\n     */\n    forcepagefit: false,\n\n    /**\r\n     * @property [forcepagesize] - Allows a custom page size to be used for force fitting all pages to. Ignored if {@link WebDocumentViewerConfig.forcepagefit|forcepagefit} is false.\r\n     * @private\r\n     */\n    forcepagesize: {\n      height: -1,\n      width: -1\n    },\n\n    /**\r\n     *  @property {boolean} [jpeg=false] - Allows page images to be returned as jpeg instead of png.\r\n     */\n    jpeg: false,\n\n    /**\r\n     *  @property {number} [maxwidth=3000] - Specifies the maximum amount of pixel width allowed for zooming in.\r\n     *\r\n     *  This property is intended to limit size of the images data transferred over the wire on big zoom values.\r\n     */\n    maxwidth: 3000,\n\n    /**\r\n     *  @property {number} [memorythreshold=500000000] - Maximum number of bytes in memory before larger memory objects are recycled.\r\n     *\r\n     *  DOM image objects are cached internally. This option allows to control memory usage on the browser page. Note, that estimated image sizes are not exactly match actual values - estimation is based on the expected document images color format and size. So actual memory usage in browser process could differ from the configured value.\r\n     */\n    memorythreshold: 500000000,\n\n    /**\r\n     *  @property {number} [minwidth=150] - Specifies the minimum amount of pixel width allowed for zooming out.\r\n     */\n    minwidth: 150,\n\n    /**\r\n     *  @property {number} [pageborderwidth=1] - Specifies the pixel border width around each page in a document.\r\n     *  */\n    pageborderwidth: 1,\n\n    /**\r\n     * @property {number} [pagebuffersize] - The number of pages to keep in memory while scrolling. Negative values will automatically calculate the optimal number based on available screen space. Values lower than can be displayed will be ignored, and higher values will cause a degradation in performance.\r\n     * */\n    pagebuffersize: -1,\n\n    /**\r\n     * @property {number} [maxpagebuffersize] - The maximum number of pages to keep in memory while scrolling. Should be greater then pagebuffersize value. It can helps to avoid loading too many pages if automatically calculated value is big. It is not recommended to set small values (less then viewer can fit).\r\n     * */\n    maxpagebuffersize: 50,\n\n    /**\r\n     *  @property {number} [pagespacing=4] - Specifies the distance (in pixels) between pages displayed.\r\n     */\n    pagespacing: 4,\n\n    /**\r\n     * @property {Atalasoft.Utils.PageSelection} [pageselectlocation] - Specifies the location to determine the current page number.\r\n     *\r\n     * Current page number is displayed on the document toolbar, and also current page is used in some operation in default UI, like page rotation is applied to the current page or in {@link Atalasoft.Controls.WebDocumentViewer.next | next}, {@link Atalasoft.Controls.WebDocumentViewer.previous | previous}, {@link Atalasoft.Controls.WebDocumentViewer.showPage | showPage} methods.\r\n     */\n    pageselectlocation: atalaJquery.extend({}, PageSelection.TopLeft),\n\n    /**\r\n     * @property {Object} parent - jQuery object that the control will contain the control. */\n    parent: null,\n\n    /** @property {number} [rows] - Number of rows to show when displaying tabular pages, -1 is automatic.\r\n     * @deprecated tabular horizontal layout is not consistent with horizontal scrolling and will be removed. Use tabular layout with vertical scrolling and columns configuration. The value of this property will be ignored.\r\n     * @ignore\r\n     */\n    rows: -1,\n\n    /**\r\n     * @property {string} [savefileformat] - Specifies the default file format for the document that will be used when saving multipage document to the server.\r\n     *\r\n     * The following formats are supported: pdf, tiff (or tif), jpeg (or jpg), png, bmp, tga, pcx, psd, tla, wbmp, emf, wmf.\r\n     *\r\n     * If set, this value is used when document save is performed using default UI or when {@link Atalasoft.Controls.WebDocumentViewer.save | save} is called without save format parameter passed.\r\n     *\r\n     * If not specified, document is saved in it's own format. Note that it's not possible to save multipage documents(for example when document pages was added using JavaScript API) to the single page image format by default. Server behavior on save could be highly customized.\r\n     */\n    savefileformat: '',\n\n    /**\r\n     * @property {string} [savepath] - Specifies the path that the document, annotation data, and form data will be saved to on the server.\r\n     */\n    savepath: '',\n\n    /**\r\n     * @property {boolean} [savepreviouslysigneddocument = false] - If set to true and the opened document is signed, calling Save will not throw an exception, but will create an invalid PDF which may still render correctly.\r\n     */\n    savepreviouslysigneddocument: false,\n\n    /**\r\n     *  @property {string} [scripturl] - Url location to the server where all JavaScript files are put when not in the default location.\r\n     */\n    scripturl: '',\n\n    /**\r\n     *  @property {string} serverurl - Url location to the server handler.\r\n     */\n    serverurl: '',\n\n    /**\r\n    *  @property {boolean} [showbookmarks=false] - Specifies whether native PDF bookmarks should be shown.\r\n    */\n    showbookmarks: false,\n\n    /**\r\n     *  @property {boolean} [showbuttontext=true] - If the toolbar is displayed, this can be used to hide or show the button text for the toolbar items.\r\n     */\n    showbuttontext: true,\n\n    /**\r\n     * @property {boolean} [showpageborder=true] - Specifies whether a black border will be added around each page in the displayed document. */\n    showpageborder: true,\n\n    /**\r\n     * @property {boolean} [showpagenumber=true] - Specifies whether a page number will be added to the bottom left of each page. */\n    showpagenumber: true,\n\n    /**\r\n     * @property {boolean} [showpagenumbertooltip=true] - Specifies whether a tooltip containing estimated current page number should be shown during fast scrolling. */\n    showpagenumbertooltip: true,\n\n    /**\r\n     * @property {boolean} [showerrors=false] - Specifies whether error messages are allowed to show up in the console instead of being caught. */\n    showerrors: false,\n\n    /**\r\n     * @property {boolean} [showstatus=false] - Specifies whether status messages will be output to an area in the toolbar. */\n    showstatus: false,\n\n    /**\r\n     * @property {boolean} [showscrollbars=true] - Specifies whether scrollbars will be shown. */\n    showscrollbars: true,\n\n    /**\r\n     * @property {boolean} [showselecttools=false] - Specifies whether rubberband selection tools are shown in the toolbar. */\n    showselecttools: false,\n\n    /**\r\n     * @property {boolean} [singlepage=false] - Specifies whether pages should be displayed in a single page fashion, rather than one row or column. Takes precedence over {@link WebDocumentViewerConfig.tabular|tabular} flag. */\n    singlepage: false,\n\n    /**\r\n     * @property {boolean} [tabular=false] - Specifies whether pages should be displayed in a tabular(grid) fashion, rather than one row or column. Ignored if {@link WebDocumentViewerConfig.singlepage|singlepage} flag is set. */\n    tabular: false,\n\n    /**\r\n     * @property {Object} [toolbarparent] - Specifies the jQuery object where the toolbar will be created. */\n    toolbarparent: null,\n\n    /** @property {number} [zoom] - Sets the initial zoom level of the document. Ignored when fitting set to anything besides Fitting.None. */\n    zoom: 1,\n\n    /**\r\n     * @property {boolean} [textannomobilezoom=true] - Specifies whether text annotation  */\n    textannomobilezoom: true,\n\n    /**\r\n     * @ignore\r\n     */\n    showthumbcaption: false,\n\n    /**\r\n     * @ignore\r\n     */\n    thumbcaptionformat: '',\n\n    /**\r\n     * @property {boolean} [persistrotation=true] - Specifies whether to persist page rotation on document save.\r\n     *\r\n     * I.e of set to `false`, rotation applied in 'view-only' mode and ignored when document is saved.\r\n     */\n    persistrotation: true,\n\n    /**\r\n     * @property {boolean} [showrotatetools=true] - Specifies whether page and annotations rotation UI handles and buttons are shown.\r\n     *\r\n     * Annotation rotation could be explicitly enabled or disabled for individual types of annotations using {@link WebDocumentViewerConfig.annotations|annotations.defaults}. */\n    showrotatetools: true,\n\n    /** @property {MouseToolConfig|Atalasoft.Utils.MouseToolType} [mousetool] - Specifies the mouse tools settings. Could be set to Atalasoft.Utils.MouseToolType if no advanced settings specified.\r\n     *\r\n     * Mouse tool identifies how user mouse or touch actions ar interpreted. For example, this could be Pan tool to scroll pages, Zoom-Area tool to select image region and zoom to it, Text tool to select and copy document text, etc.\r\n     *\r\n     * Active mouse tool could be changed using {@link Atalasoft.Controls.WebDocumentViewer.setMouseTool | setMouseTool} method.\r\n     */\n    mousetool: {\n      /**\r\n       * @typedef {Object} MouseToolConfig\r\n       *\r\n       * @property {Atalasoft.Utils.MouseToolType} [type = Pan] - default mouse tool. This tool is enabled each time new document is loaded.\r\n       * @property {TextMouseToolConfig} [text] - Text selection behavior configuration.\r\n       */\n      type: MouseToolType.Pan,\n\n      /** Specifies the default text selection settings*/\n      text: {\n        /**\r\n         * @typedef {Object} TextMouseToolConfig\r\n         *\r\n         * @property {Atalasoft.Utils.ScrollArea} [scrolltriggerarea = Normal] - Specifies the percentage of type of scroll trigger area. When selecting text in that area around page bounds scrolling will be triggered for corresponding direction.\r\n         *\r\n         * @property {number} [throttlingtreshold=40] - Milliseconds throttling threshold for text selection UI operations. 0 performs selection without throttling barrier, most CPU intensive. I.e. setting this to 0 causes selection calculation on each corresponding browser mouse event.\r\n         *\r\n         * @property {Object} [selection] - Specifies the text selection highlight settings.\r\n         * @property {string} [selection.color='blue'] - Specifies the fill color for selected text.\r\n         * @property {number} [selection.alpha = 0.25] - Specifies the selected text highlighting transparency level.\r\n         *\r\n         * @property {Object} [highlight] - Specifies the search results highlight settings.\r\n         * @property {string} [highlight.color='yellow'] - Specifies the fill color for search results highlight.\r\n         * @property {number} [highlight.alpha = 0.7] - Specifies the transparency level for search results highlight.\r\n         *\r\n         * @property {boolean} [hookcopy=false] - Control subscribes to ctrl+c key combination. If so, selected text will be copied to clipboard when uses press ctrl+c.\r\n         *\r\n         * Alternatively application could apply it's own logic for ctrl+c - for example, grab selected text using {Atalasoft.Controls.WebDocumentViewer~TextController#getSelected| getSelected} method and let user to edit it before copying.\r\n         *\r\n         * @property {boolean} [allowsearch=true] - Specifies whether to show default search UI.\r\n         *\r\n         * @property {boolean} [wrapsearch=true] - Specifies whether default text search is wrapped.\r\n         *\r\n         * @property {number} [searchdelay=400] - Specifies the milliseconds timeout before triggering text search when text is modified in search textbox.\r\n         *\r\n         * This allows to delay potentially search operation start while user still types query text.\r\n         */\n        scrolltriggerarea: ScrollArea.Normal,\n\n        /**\r\n         *  Specifies scroll delta in pixels that are applied when selecting text within viewport scroll trigger area\r\n         *  @private\r\n         */\n        innerscrolldelta: 10,\n\n        /**\r\n         * Specifies scroll delta in pixels that are applied when selecting text and mouse goes out of viewport.\r\n         * @private\r\n         */\n        outerscrolldelta: 20,\n\n        /** Specifies  */\n        throttlingtreshold: 40,\n        selection: {\n          color: 'blue',\n          alpha: 0.25\n        },\n        highlight: {\n          color: 'yellow',\n          alpha: 0.7\n        },\n        hookcopy: false,\n        allowsearch: true,\n        wrapsearch: true,\n        searchdelay: 400\n      }\n    },\n\n    /**\r\n     * @typedef {Object} FileUploadConfig\r\n     *\r\n     * @property {boolean} [enabled] - a flag indicating whether or not upload functionality should be enabled. Provides a possibility to explicitly disable upload functionality even if upload section is presented.\r\n     * @property {string} uploadpath - represents a relative path where an uploaded file should be saved. This path must be a path to an application subfolder, otherwise upload operation will not work correctly and exception about incorrect path will be returned to the client.\r\n     * @property {string} allowedfiletypes - represents a comma-separated list of file types and MIME-types that are allowed to be selected and uploaded.\r\n     * @property {number} allowedmaxfilesize - represents a file size in bytes.\r\n     * @property {boolean} allowmultiplefiles - a flag indicating whether or not it is allowed to perform multiple files upload.\r\n     * @property {boolean} allowdragdrop - a flag indicating whether or not it is allowed to upload files using drag-and-drop.\r\n     * @property {number} filesuploadconcurrency - represents a number of concurrent uploading files, by default all files loads sequentially.\r\n     * Note, this property doesn't affect on maximum allowed connections per host, that defined by each browser internally. If this value is\r\n     * bigger than number of default persistent connections per server/proxy, than WDV puts the request in queue and fires event {@link Atalasoft.Controls.WebDocumentViewer#event:fileuploadstarted|fileuploadstarted},\r\n     * but the real file upload stats only when browser allow this request to be sent.\r\n     * @property {boolean} closeuiafterupload - a flag indicating whether or not UI will be closed automatically right after upload finished. By default this flag set to `true` value.\r\n     * @example <caption>Upload section of Web Document Viewer config</caption>\r\n     * upload: {\r\n     *   uploadpath: 'Upload/Viewer',\r\n     *   allowedfiletypes: '.jpg,.raw,image/tiff', // Allowed JPG, RAW and TIFF files.\r\n     *   allowedmaxfilesize: 10 * 1024 * 1024, // 10MB\r\n     *   allowmultiplefiles: true,\r\n     *   allowdragdrop: true\r\n     * }\r\n     */\n\n    /**\r\n     * @property {FileUploadConfig} [upload] - Specifies the file upload settings. If this section is not specified, the upload functionality is disabled.\r\n     */\n    upload: null,\n\n    /**\r\n     * @typedef {Object} ToolbarButtonConfig\r\n     * \r\n     * @property {string} id - represents a button HTML id.\r\n     * @property {string} [class] - represents a button CSS class.\r\n     * @property {string} icon - represents a button icon CSS class where button image stored.\r\n     * @property {string} [tooltip] - represents a button text. This text is visible when {@link @link WebDocumentViewerConfig.showbuttontext|showbuttontext} is set to `true`.\r\n     * @property {NotificationCallback} [onclick] - represents a function to call when button was clicked.\r\n     */\n\n    /**\r\n     * @property {Array<ToolbarButtonConfig>} [toolbarbuttons] - Specifies the custom toolbar buttons that should be added at the beginning of the main toolbar.\r\n     */\n    toolbarbuttons: null,\n\n    /**\r\n     * @property {Atalasoft.Utils.LocalizationStrings} [localization] - this object provides a translation table for all potentially user-visible strings used by Atalasoft Web Document Viewer.\r\n    *   See {@link Atalasoft.Utils.LocalizationStrings} for all possible strings.\r\n    * \r\n    *   **Default value**: {} - which selects the default American English localization.\r\n    */\n    localization: LocalizationStrings,\n\n    /**\r\n     * @property {boolean} [tiling=false] - Specifies whether the PDF document pages should be loading using tiling\r\n     * */\n    tiling: false\n  }; // map settings onto config\n\n  if (settings) {\n    var mousetool = settings.mousetool;\n\n    if (settings.mousetool && typeof settings.mousetool !== 'object') {\n      settings.mousetool = atalaJquery.extend({}, _config.mousetool, {\n        type: mousetool\n      });\n    } // horizontal tabular layout with rows > 1 is deprecated and vertical tabular layout with columns == 1 doesn't have sense but have bugs.\n\n\n    if (settings.tabular && (settings.direction === ScrollDirection.Horizontal || settings.columns === 1)) {\n      settings.tabular = false;\n    }\n\n    atalaJquery.extend(true, _config, settings);\n    settings.mousetool = mousetool;\n    if (settings.localization) LocalizationManager.SetLocalizationStrings(settings.localization);\n  }\n\n  __validateConfig();\n\n  if (!checkViewerDependencies(_config.allowannotations, _config.allowtext)) {\n    return null;\n  }\n\n  __generateID(); // #region Exposed Internals\n\n  /**\r\n   * @member {WebDocumentViewerConfig} config - Current control configuration.\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @instance\r\n   * @alias config\r\n   */\n\n\n  _self.config = _config;\n  /** WARNING: Changing values from these references can cause instability.*/\n\n  _self.events = _events;\n  /** WARNING: Changing values from these references can cause instability.*/\n\n  _self.domclasses = domclasses;\n  /** WARNING: Changing values from these references can cause instability.*/\n\n  _self.domattributes = domattributes;\n  /**\r\n   * @member {Atalasoft.Controls.WebDocumentViewer~AnnotationController} annotations - Annotations API. Will be available if {@link WebDocumentViewerConfig.allowannotations| config.allowannotations} is set to `true`. Otherwise will be `undefined`\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   */\n\n  /**\r\n   * @member {Atalasoft.Controls.WebDocumentViewer~DocumentController} document - Document operations API.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   */\n\n  /**\r\n   * @member {Atalasoft.Controls.WebDocumentViewer~TextController} text - Text selection API.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   */\n  // #endregion\n  // gets the IViewerApi object to initialize state manager.\n\n  function __getStateManagerApi() {\n    return {\n      get: function get() {\n        return _self;\n      },\n      isInitialized: __isReady,\n      switchDocument: __switchDocument,\n      closeDocument: __closeDocument\n    };\n  } // #region Control LifeCycle\n\n\n  function __preInit() {\n    if (!__isReady()) {\n      _page = __createEmptyPageDataObject();\n      _state = __createEmptyStateObject();\n    }\n\n    var internals = {\n      _config: _config,\n      _id: _id,\n      _dom: _dom,\n      _document: _dom.loadedImgs,\n      _pages: _dom.pageDivs,\n      _state: _state,\n      _internalEvents: _internalEvents,\n      _controllers: _controllers,\n      createDOM: __createDOM,\n      createDiv: __createDiv,\n      createDialog: __createDialog,\n      createDropDownButton: __createDropDownButton,\n      createDropDownMenu: __createDropDownMenu,\n      createMenu: __createMenu,\n      drawAnnotation: __drawAnnotation,\n      redrawVisiblePages: __redrawVisiblePages,\n      adjustVisiblePages: __adjustVisiblePages,\n      startDomManipulation: __startDomManipulation,\n      endDomManipulation: __endDomManipulation,\n      redrawPageFromIndex: __redrawPageFromIndex,\n      makeHandlerRequest: __makeHandlerRequest,\n      getPageScale: __getPageScale,\n      getPageSize: __getPageSize,\n      getSourcePageSize: __getServerPageSize,\n      getPageRotation: __getPageRotation,\n      getViewerTransform: __getViewerTransform,\n      isPageInView: __isPageInView,\n      findPageFromIndex: __findPageFromIndex,\n      showPagePoint: __showPagePoint,\n      disableBookmarkButton: __disableBookmarkButton\n    };\n    _controllers.document = new DocumentController(_self, internals, _id); // re-set public api functions, so internal and external api points to the same data.\n\n    _self.document = _controllers.document.__exposedApi;\n\n    if (_config.allowannotations) {\n      _controllers.annotations = new controller_AnnotationController(_self, internals, _isThumbnailer);\n      _self.annotations = _controllers.annotations.__exposedApi;\n    } else {\n      // annotation methods need to exist to throw an error\n      _self.deselectAll = __annotationsAllowed;\n      _self.createAnnotationOnPage = __annotationsAllowed;\n      _self.getAnnotationsFromPage = __annotationsAllowed;\n      _self.deleteAnnotationOnPageAtIndex = __annotationsAllowed;\n      _self.setAnnotationDefaults = __annotationsAllowed;\n      _self.setImages = __annotationsAllowed;\n      _self.setStamps = __annotationsAllowed;\n    }\n\n    if (_config.allowforms && !_controllers.forms) {\n      _controllers.forms = new controller_FormController(_self, internals);\n      _self.forms = _controllers.forms.__exposedApi;\n    }\n\n    if (_config.allowtext) {\n      _controllers.text = new controller_TextController(_self, internals, _config.mousetool ? _config.mousetool.text : {});\n      _self.text = _controllers.text.__exposedApi;\n    }\n\n    _controllers.upload = new UploadController_UploadController(_self, internals);\n\n    __init();\n  }\n\n  function __createEmptyPageDataObject() {\n    return {\n      size: {\n        width: 0,\n        height: 0\n      },\n      sizes: [{\n        width: 0,\n        height: 0\n      }],\n      smallest: {\n        width: 0,\n        height: 0\n      },\n      // smallest height and width seen so far, used to calculate page buffer size\n      count: 0,\n      number: -1,\n      numberoutof: -1,\n      buffer: 3,\n      dpi: 96,\n      vector: false,\n      caption: '',\n      customData: null\n    };\n  }\n\n  function __createEmptyStateObject() {\n    return {\n      prpr: 0,\n      // pause/resume page refresh\n      batchoperation: 0,\n      loading: false,\n      zooming: false,\n      initialized: false,\n      newpagedivsize: null,\n      newpagedivfullzoom: 1,\n      scrollPos: {\n        // scroll position, used for deltas\n        x: 0,\n        y: 0,\n        t: 0 // time of the scroll position from Date.getTime()\n\n      },\n      scrollBuffer: null,\n      // timer for buffering scroll events\n      scrollTimeout: null,\n      // timer for detecting when scrolling is finished\n      activepage: null,\n      nextImageCacheIndex: 0,\n      scrollTarget: {\n        Page: 0,\n        dx: 0,\n        dy: 0\n      },\n      hidden: false,\n      itch: false //interrupt further tile loading\n\n    };\n  }\n\n  function __init() {\n    if (_state.initialized === false) {\n      _state.initialized = true;\n    } else {\n      return;\n    } // handles errors from child objects (such as AnnotationController)\n\n\n    __bindEvents({\n      throwerror: __throwErrorChild,\n      pagedivsresized: __onPageDivsResized,\n      documentchanged: __onDocumentChanged,\n      pagesizechanged: __onPageSizeChanged\n    }); // check parent element\n\n\n    if (_config.parent) {\n      if (!(_config.parent instanceof atalaJquery)) {\n        _config.parent = atalaJquery(_config.parent);\n      }\n\n      if (!_config.parent.length) {\n        __throwError('InitError', 'Parent element not found.');\n      }\n    } else {\n      // TODO: floating window?\n      __throwError('InitError', 'No parent element given.');\n    } // create and style main container objects\n\n\n    _dom.toolbar = __createToolbars(_config.toolbarparent || _config.parent);\n\n    _dom.toolbar.addClass(domclasses.atala_toolbar);\n\n    _dom.main = __createDiv(_config.parent);\n\n    _dom.main.addClass(domclasses.atala_main_container);\n\n    _dom.scroller = __createDiv(_dom.main);\n\n    _dom.scroller.addClass(domclasses.atala_scroller); // removes text selection from the top level, we make exceptions for text annos\n\n\n    _dom.main.on({\n      selectstart: __onSelectStart\n    });\n\n    _dom.toolbar.attr('id', _id + '_toolbar');\n\n    _dom.main.attr('id', _id + '_main');\n\n    _dom.scroller.attr('id', _id + '_scroller');\n\n    _dom.main.css({\n      'height': '100%',\n      'width': '100%',\n      'position': 'relative'\n    });\n\n    _dom.scroller.css({\n      'height': '100%',\n      'width': '100%',\n      'position': 'relative'\n    }); // main viewport object\n\n\n    _dom.viewport = __createDiv(_dom.scroller, _id + '_vp');\n\n    _dom.viewport.css({\n      'overflow': 'hidden',\n      fontSize: 0,\n      'touch-action': 'none'\n    });\n\n    _dom.viewport.addClass(domclasses.atala_viewport);\n\n    _dom.viewport.attr('tabindex', -1); // main content\n\n\n    _dom.edges[0] = __createEdge(_dom.viewport, _id + '_e0');\n\n    _dom.edges[0].addClass(domclasses.atala_dom_edge_first);\n\n    _dom.content = __createDiv(_dom.viewport, _id + '_ct');\n\n    _dom.content.addClass(domclasses.atala_content);\n\n    _dom.content.attr('tabindex', -1);\n\n    _dom.content.attr('role', 'figure');\n\n    if (Browser.Explorer) {\n      _dom.content.attr('aria-label', _isThumbnailer ? 'Thumbnailer' : 'Viewer');\n    }\n\n    _dom.content.css({\n      '-ms-touch-action': 'none',\n      // stop default touch behavior in IE 10+\n      fontSize: 0,\n      // inline-block page divs(for tabular layout) could give additional spaces that are not calculated by our code. remove them with such font size.\n      overflow: 'hidden'\n    });\n\n    if (_config.direction === ScrollDirection.Horizontal) {\n      _dom.content.css({\n        'display': 'inline-block'\n      });\n    }\n\n    _dom.edges[1] = __createEdge(_dom.viewport, _id + '_e1');\n\n    _dom.edges[1].addClass(domclasses.atala_dom_edge_last);\n\n    if (Browser.Features.Compatibility) {\n      __throwError('InitError', 'Compatibility Mode is not supported.');\n    }\n\n    if (_config.upload.enabled !== false && !_isThumbnailer) {\n      _dom.uploadCtrl = _controllers.upload.getUploadControl();\n    } // don't bother showing scrollbars on mobile devices, since they don't show anyway\n\n\n    if (!Browser.Mobile.Any()) {\n      if (_config.showscrollbars) {\n        if (_isSinglePageMode) {\n          _dom.scroller.css({\n            'overflow': 'scroll'\n          });\n        } else {\n          _dom.scroller.css({\n            'overflow': 'auto'\n          });\n        }\n\n        _dom.scrollH = __createScrollbar(_dom.main, ScrollDirection.Horizontal);\n\n        _dom.scrollH.attr('id', _id + '_sH');\n\n        _dom.scrollH.addClass(domclasses.atala_scroll_horizontal); //Accessibility attributes\n\n\n        _dom.scrollH.attr('role', 'scrollbar');\n\n        _dom.scrollH.attr('aria-controls', _id + '_scroller');\n\n        _dom.scrollH.attr('aria-orientation', 'horizontal');\n\n        _dom.scrollH.attr('aria-valuemin', '0');\n\n        _dom.scrollH.attr('aria-valuemax', '1');\n\n        _dom.scrollH.attr('aria-valuenow', '0');\n\n        _dom.scrollV = __createScrollbar(_dom.main, ScrollDirection.Vertical);\n\n        _dom.scrollV.attr('id', _id + '_sV');\n\n        _dom.scrollV.addClass(domclasses.atala_scroll_vertical); //Accessibility attributes\n\n\n        _dom.scrollV.attr('role', 'scrollbar');\n\n        _dom.scrollV.attr('aria-controls', _id + '_scroller');\n\n        _dom.scrollV.attr('aria-orientation', 'vertical');\n\n        _dom.scrollV.attr('aria-valuemin', '0');\n\n        _dom.scrollV.attr('aria-valuemax', '1');\n\n        _dom.scrollV.attr('aria-valuenow', '0');\n      } else {\n        _dom.scroller.css({\n          'overflow': 'hidden'\n        });\n      }\n    } else {\n      // we use 'auto' to tell the mobile browser that this is scrollable with touch\n      // but it breaks Android native 'Browser' programmatic scrolling, so we need\n      // to use 'hidden' to scroll it programmatically\n      _dom.scroller.css({\n        'overflow': 'hidden'\n      });\n    } // mouse tool\n\n\n    _controllers.mouseTool = new controller_ToolController(_self, {\n      _internalEvents: _internalEvents,\n      _controllers: _controllers,\n      zoomStart: __zoomStart,\n      zoom: __zoomInstant,\n      zoomEnd: __zoomEnd,\n      getActivePage: __getActivePage,\n      raiseDrawLayer: __raiseDrawLayer,\n      resetDrawLayer: __resetDrawLayer,\n      getViewerTransform: __getViewerTransform\n    }, _dom.viewport, _dom.scroller, atalaJquery.extend({\n      allowflick: _config.allowflick\n    }, _config.mousetool));\n    _controllers.memory = new MemoryTracker_MemoryTracker({\n      highWaterMark: _config.memorythreshold\n    });\n\n    _controllers.memory.bind({\n      exceededhighwatermark: __onMemoryUsageExceeded\n    }); // set the viewport for the annotation controller\n\n\n    if (_controllers.annotations) {\n      _controllers.annotations.setViewPort(_dom.viewport);\n    }\n\n    __triggerEvent('initialized');\n\n    __load();\n\n    atalaJquery(__onReady);\n  } // generates a prefix id for all of the sub elements, based on the parent\n\n\n  function __generateID() {\n    var tmpId = _config.parent.attr('id') + '_wdv';\n    ++Statics.instanceCounter;\n\n    while (document.getElementById(tmpId + Statics.instanceCounter)) {\n      ++Statics.instanceCounter;\n    }\n\n    _id = tmpId + Statics.instanceCounter;\n  }\n\n  function __load() {\n    if (_config.direction === ScrollDirection.Horizontal) {\n      _dom.viewport.css({\n        'white-space': 'nowrap'\n      });\n    }\n\n    _dom.viewport.css({\n      'display': 'table-cell'\n    });\n\n    __extendScroller(_dom.scroller);\n\n    if (_dom.scrollH) {\n      _dom.edges[1].height(_dom.scrollH.scrollbarHeight());\n    } // sets the mouse tool\n\n\n    _controllers.mouseTool.setTool(MouseToolType.Pan, MouseToolType.None); // async call, should be last\n\n\n    if (_config.documenturl || _config.annotationsurl || _config.formurl) {\n      __openUrlAsync(_config.documenturl, _config.annotationsurl, _config.formurl, openCallback);\n    }\n  }\n  /**\r\n   * Removes all DOM elements, internal references, and empties memory intensive objects.\r\n   * The WebDocumentViewer will no longer function after a call to this method.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function dispose\r\n   */\n\n\n  function __dispose() {\n    if (!_isThumbnailer && _stateManager) {\n      _stateManager.closeDocument();\n    }\n\n    __clearUI();\n\n    if (_dom.main) {\n      _dom.main.remove();\n    }\n\n    if (_dom.toolbar) {\n      _dom.toolbar.controlgroup('destroy');\n\n      _dom.toolbar.remove();\n\n      if (_dom.toolbar.annoToolbar) {\n        _dom.toolbar.annoToolbar.controlgroup('destroy');\n\n        _dom.toolbar.annoToolbar.remove();\n      }\n    }\n\n    if (_dom.search) {\n      _dom.search.dispose();\n    }\n\n    if (_dom.uploadCtrl) {\n      _dom.uploadCtrl.remove();\n    }\n\n    _dom.main = null;\n    _dom.toolbar = null;\n    _dom.scroller = null;\n    _dom.viewport = null;\n    _dom.content = null;\n    _dom.scrollH = null;\n    _dom.scrollV = null;\n    _dom.loadedImgs.length = 0;\n    _dom.pageDivs.length = 0;\n    _dom.pageLabel = null;\n    _dom.status = null;\n    _dom.search = null;\n    _dom.uploadCtrl = null;\n\n    if (_dom.edges) {\n      for (var i = 0; i < _dom.edges.length; i++) {\n        _dom.edges[i] = null;\n      }\n\n      _dom.edges = [];\n    }\n\n    for (var p in _controllers) {\n      if (_controllers.hasOwnProperty(p)) {\n        if (_controllers[p] !== null) {\n          _controllers[p].dispose();\n\n          _controllers[p] = null;\n        }\n      }\n    }\n\n    _page = __createEmptyPageDataObject();\n    _state = __createEmptyStateObject();\n  } // #endregion\n  // #region Internal events\n\n\n  function __onMemoryUsageExceeded() {\n    var img = _controllers.memory.deallocateOldestEntry();\n\n    __garbageCollectObject(img[0]);\n\n    if (img._cacheIndex >= 0) {\n      _dom.loadedImgs[img._cacheIndex] = null;\n      img._cacheIndex = -1;\n    }\n\n    img.remove();\n    img.length = 0;\n    img = null;\n  } // triggered by the Thumbnailer when it resizes the page divs\n\n\n  function __onPageDivsResized(e) {\n    _state.newpagedivsize = {\n      height: e.height,\n      width: e.width\n    };\n    _state.newpagedivfullzoom = e.fullzoom;\n    _config.minwidth = e.minwidth;\n    _config.zoom = e.fullzoom;\n\n    __onDocumentChanged();\n  }\n\n  function __onPageSizeChanged(e) {\n    var sizechanged = false;\n\n    if (_page.smallest.width <= 0 || e.width < _page.smallest.width) {\n      _page.smallest.width = e.width;\n      sizechanged = true;\n    }\n\n    if (_page.smallest.height <= 0 || e.height < _page.smallest.height) {\n      _page.smallest.height = e.height;\n      sizechanged = true;\n    }\n\n    if (!_isThumbnailer) {\n      if (_isSinglePageMode) {\n        __resizeScrollBars(e.dx, e.dy);\n      } else {\n        //Check if is it necessary to update the scroll position.\n        var refPage = _state.scrollTarget.Page - 1;\n\n        if (e.index <= refPage) {\n          if (_config.direction === ScrollDirection.Vertical && Math.abs(e.dy) > 0) {\n            var newSH = __getPageOffsets(_dom.pageDivs[0]._index).height;\n\n            _dom.edges[0].height(newSH);\n\n            __adjustEdgeHeights(_dom.pageDivs[0]._index, null);\n\n            __setScrollPositionAsync(null, __getPageOffsets(refPage).height + _state.scrollTarget.dy, false);\n          } else if (_config.direction === ScrollDirection.Horizontal && Math.abs(e.dx) > 1) {\n            var newSW = __getPageOffsets(_dom.pageDivs[0]._index).width;\n\n            _dom.edges[0].width(newSW);\n\n            __adjustEdgeHeights(_dom.pageDivs[0]._index, null);\n\n            __adjustEdgeWidths();\n\n            __setScrollPositionAsync(__getPageOffsets(refPage).width + _state.scrollTarget.dy, null, false);\n          }\n        }\n\n        __resizeScrollBars(e.dx, e.dy);\n\n        __recalculateMaxDocumentSize(); //Correct inner scroller position here, because some scroll event can be missed.\n\n\n        var nx = _dom.scroller[0].scrollLeft;\n        var ny = _dom.scroller[0].scrollTop;\n\n        if (!_dom.scroller.propagationPaused() && _dom.scrollH && _dom.scrollV) {\n          var horiz = Math.round(nx / _dom.scrollH._ratio);\n          var vert = Math.round(ny / _dom.scrollV._ratio); // scroll doesn't fire if it's already at that point\n\n          if (horiz !== _dom.scrollH.scrollLeft()) {\n            // pause event propagation, and resume once the scroll event fires\n            _dom.scrollH.pauseEventPropagation(true); // set horizontal scrollbar position\n\n\n            _dom.scrollH.scrollLeft(horiz);\n          }\n\n          if (vert !== _dom.scrollV.scrollTop()) {\n            // pause event propagation, and resume once the scroll event fires\n            _dom.scrollV.pauseEventPropagation(true); // set vertical scrollbar position\n\n\n            _dom.scrollV.scrollTop(vert);\n          }\n        }\n      } // smaller size found?\n\n\n      if (sizechanged) {\n        if (__calculatePageDivCount(__getMinZoom()) > _dom.pageDivs.length) {\n          __onDocumentChanged(e);\n        }\n      }\n    }\n  } // called when page is loaded in thumbnailer and thus shared size changed within document controller.\n  // documentController: controller is passed from thumbnailer, since different thumbnailer could control viewer, so only thumbnailer holds the state which should be updated.\n  // fitSize: target size for fitzoom calculation\n  // updateView: indicates whether we have to update UI. generally it shows whether calling thumbnailer is attached to viewer.\n\n\n  function __onSharedPageSizeChanged(e, documentController, fitSize, updateView) {\n    var oldSize = documentController.getPageSize(e.index, _id);\n\n    if (!oldSize) {\n      var oldFit = documentController.getPageFitMultiplier(e.index, _id);\n      var scale = oldFit;\n      var newSize = {\n        width: e.width,\n        height: e.height\n      }; // if there were no fit zoom, i.e. page wasn't loaded in viewer.\n\n      if (scale === 1 && _config.forcepagefit && (newSize.width !== fitSize.width || newSize.height !== fitSize.height) && newSize.width > 0 && newSize.height > 0) {\n        if (newSize.width / fitSize.width > newSize.height / fitSize.height) {\n          // size to the width\n          scale = fitSize.width / newSize.width;\n        } else {\n          // size to the height\n          scale = fitSize.height / newSize.height;\n        }\n\n        documentController.setPageFitMultiplier(e.index, scale, _id);\n      }\n\n      documentController.setPageSize(e.index, atalaJquery.extend({}, newSize), _id);\n\n      if (updateView) {\n        newSize.width *= _config.zoom * scale;\n        newSize.height *= _config.zoom * scale;\n        oldSize = atalaJquery.extend({}, _page.size);\n        oldSize.width *= _config.zoom * oldFit;\n        oldSize.height *= _config.zoom * oldFit;\n        e.dx = newSize.width - oldSize.width;\n        e.dy = newSize.height - oldSize.height;\n\n        __onPageSizeChanged(e);\n      }\n    }\n  }\n\n  function __onReady() {\n    if (Browser.Mobile.Any()) {\n      window.addEventListener('orientationchange', __onResize); // commented out disposing on page reload, since browser should clear us from memory himself.\n      //window.addEventListener('beforeunload',__dispose);\n    } else {\n      window.addEventListener('resize', __onResize); // commented out disposing on page reload, since browser should clear us from memory himself.\n      //window.addEventListener('beforeunload',__dispose);\n    }\n\n    _dom.scroller.scroll(__onScroll); // Since the document info is most likely still loading, we can't\n    // accurately calculate the number of page divs that we need.\n    // Set it to 3 to start with, and we'll modify it once the image info is loaded.\n\n\n    __createPageDivs(_page.buffer);\n  } // function to remove selections from everything except textarea boxes\n\n\n  function __onSelectStart(e) {\n    var src = e.target || e.srcElement;\n\n    if (src.nodeName !== 'TEXTAREA' && src.nodeName !== 'INPUT' && src.type !== 'text') {\n      return __rf();\n    } else if (src.attributes.selectable && src.attributes.selectable.value === 'false' || src.attributes.hasOwnProperty('readonly') && src.attributes.readonly.value === 'true') {\n      // this is a textarea box, but we've marked it not selectable\n      return __rf();\n    }\n  } // prevents the default button click from happening\n\n\n  function __buttonClickWrapper(evtTrigger) {\n    return function (e) {\n      e.preventDefault();\n\n      __triggerEvent(evtTrigger, arguments);\n    };\n  }\n\n  function __toolbarTriggerWrapper(f, context) {\n    return function (e) {\n      try {\n        e.currentTarget = context && context.length > 0 ? context[0] : e.currentTarget;\n\n        if (f) {\n          f(e);\n        }\n      } catch (ex) {\n        __status(ex.message);\n      }\n    };\n  } // shows an error message if the config allows, otherwise logs a status message and triggers an event\n  // name: string, name of the error\n  // msg: string, error message\n\n\n  function __throwError(name, msg) {\n    if (_config.showerrors) {\n      throw msg === undefined ? name : name + ': ' + msg;\n    }\n\n    __status(name + ': ' + msg);\n\n    __triggerEvent({\n      type: 'error',\n      name: name,\n      message: msg\n    });\n  } // jquery event bound to 'throwerror' so child objects can all throw through the WDV's throw method\n  // e: event object\n\n\n  function __throwErrorChild(e) {\n    __throwError(e.name, e.msg);\n  } // #endregion\n  // #region Create functions\n  // tag: string representing the type of tag\n  // p: jQuery parent object to append div to\n  // did: string representing the id of the div\n  // ihtml: string representing the inner html\n\n\n  function __createDOM(tag, p, did, ihtml) {\n    var dom = atalaJquery(\"<\" + tag + \"></\" + tag + \">\");\n\n    if (p && p.append) {\n      dom.appendTo(p);\n    }\n\n    if (did) {\n      dom.attr('id', did);\n    }\n\n    if (ihtml) {\n      dom.html(ihtml);\n    }\n\n    return dom;\n  } // p: jQuery parent object to append div to\n  // did: string representing the id of the div\n  // ihtml: string representing the inner html\n\n\n  function __createDiv(p, did, ihtml) {\n    return __createDOM('div', p, did, ihtml);\n  } // object to catch drawing and select events\n  // p: jQuery parent object to prepend draw layer to\n\n\n  function __createDrawLayer(p) {\n    var draw = atalaJquery('<div div class=\"atala_draw_layer\"></div>');\n\n    draw.toFront = function () {\n      draw.css({\n        'z-index': '10'\n      });\n\n      if (draw.reflow) {\n        draw.reflow();\n      }\n    };\n\n    draw.reset = function () {\n      draw.css({\n        'z-index': ''\n      });\n\n      if (draw.reflow) {\n        draw.reflow();\n      }\n    };\n\n    if (p) {\n      p.prepend(draw);\n    }\n\n    return draw;\n  } // Creates the toolbars for this control, and appends them to the given object\n  // p: jQuery parent object to append toolbars to\n\n\n  function __createToolbars(p) {\n    var mainToolbar = __createMainToolbar(p);\n\n    mainToolbar.controlgroup();\n\n    if (_config.allowannotations) {\n      mainToolbar.annoToolbar = __createAnnoToolbar(p);\n      mainToolbar.annoToolbar.addClass(domclasses.atala_annotation_toolbar);\n      mainToolbar.annoToolbar.controlgroup();\n    }\n\n    if (_config.showstatus) {\n      _dom.status = atalaJquery('<div id=\"' + _id + '_status\"></div>');\n\n      _dom.status.addClass(domclasses.atala_statusbar);\n\n      _dom.status.css('display', 'inline');\n\n      mainToolbar.append('Status:');\n      mainToolbar.append(_dom.status);\n    }\n\n    if (_config.allowtext && _config.mousetool.text.allowsearch) {\n      _dom.search = new __CSearchBox({\n        parent: mainToolbar\n      });\n    }\n\n    return mainToolbar;\n  } // Creates the main document toolbar for this control, and appends them to the given object\n  // p: jQuery parent object to append toolbar to\n\n\n  function __createMainToolbar(p) {\n    var _this = this;\n\n    // config object\n    var tconfig = {\n      id: _id + '_toolbar',\n      parent: p,\n      children: [{\n        type: 'button',\n        id: 'Button_PagePrev',\n        cls: domclasses.atala_tool_button_page_prev,\n        icon: 'page-prev',\n        tooltip: 'Previous Page',\n        text: null,\n        onclick: function onclick() {\n          if (_isSinglePageMode) {\n            __showPrevious();\n          } else {\n            __scrollPreviousAsync();\n          }\n        }\n      }, {\n        type: 'pagelabel',\n        id: 'Label_PageNumber',\n        cls: domclasses.atala_page_label\n      }, {\n        type: 'button',\n        id: 'Button_PageNext',\n        cls: domclasses.atala_tool_button_page_next,\n        icon: 'page-next',\n        tooltip: 'Next Page',\n        text: null,\n        onclick: function onclick() {\n          if (_isSinglePageMode) {\n            __showNext();\n          } else {\n            __scrollNextAsync();\n          }\n        }\n      }, {\n        type: 'button',\n        id: 'Button_ZoomOut',\n        cls: domclasses.atala_tool_button_zoom_out,\n        icon: 'zoom-out',\n        tooltip: 'Zoom Out',\n        text: '',\n        onclick: function onclick() {\n          __zoomOutAsync();\n        }\n      }, {\n        type: 'button',\n        id: 'Button_ZoomIn',\n        cls: domclasses.atala_tool_button_zoom_in,\n        icon: 'zoom-in',\n        tooltip: 'Zoom In',\n        text: '',\n        onclick: function onclick() {\n          __zoomInAsync();\n        }\n      }, {\n        type: 'button',\n        id: 'Button_FitNone',\n        cls: domclasses.atala_tool_button_fit_none,\n        icon: 'zoom-full',\n        tooltip: 'Full Size',\n        text: '',\n        onclick: function onclick() {\n          __setZoomAsync(1);\n        }\n      }, {\n        type: 'button',\n        id: 'Button_FitBest',\n        cls: domclasses.atala_tool_button_fit_best,\n        icon: 'fit-best',\n        tooltip: 'Best Fit',\n        text: '',\n        onclick: function onclick() {\n          __fitAsync(Fitting.Best);\n        }\n      }, {\n        type: 'button',\n        id: 'Button_FitWidth',\n        cls: domclasses.atala_tool_button_fit_width,\n        icon: 'fit-width',\n        tooltip: 'Fit To Width',\n        text: '',\n        onclick: function onclick() {\n          __fitAsync(Fitting.Width);\n        }\n      }]\n    };\n\n    if (_config.showselecttools) {\n      tconfig.children.splice(5, 0, {\n        type: 'button',\n        id: 'Button_ZoomArea',\n        cls: domclasses.atala_tool_button_zoom_area,\n        icon: 'zoom-area',\n        tooltip: 'Zoom Area',\n        text: '',\n        onclick: __enableZoomAreaTool\n      }); //tconfig.children.splice(3, 0, { type: 'button', id: 'Button_Selection', cls: domclasses.atala_tool_button_selection, icon: 'selection', tooltip: 'Selection', text: '', onclick: function() { _controllers.mouseTool.setTool(MouseToolType.Selection); } });\n    }\n\n    if (_config.allowtext) {\n      tconfig.children.splice(3, 0, {\n        type: 'button',\n        id: 'Button_Text',\n        cls: domclasses.atala_tool_button_text_tool,\n        icon: 'text-tool',\n        tooltip: 'Text Selection',\n        text: '',\n        onclick: function onclick() {\n          _controllers.mouseTool.setTool(MouseToolType.Text);\n        }\n      });\n      tconfig.children.splice(3, 0, {\n        type: 'button',\n        id: 'Button_Pan',\n        cls: domclasses.atala_tool_button_pan_tool,\n        icon: 'pan-tool',\n        tooltip: 'Pan',\n        text: '',\n        onclick: function onclick() {\n          _controllers.mouseTool.setTool(MouseToolType.Pan);\n        }\n      });\n    }\n\n    if (_config.showrotatetools) {\n      tconfig.children.push({\n        type: 'button',\n        id: 'Button_RotateLeft',\n        cls: domclasses.atala_tool_button_rotate_left,\n        icon: 'rotate-left',\n        tooltip: 'Rotate Left',\n        text: '',\n        onclick: __createRotateHandler(270)\n      });\n      tconfig.children.push({\n        type: 'button',\n        id: 'Button_RotateRight',\n        cls: domclasses.atala_tool_button_rotate_right,\n        icon: 'rotate-right',\n        tooltip: 'Rotate Right',\n        text: '',\n        onclick: __createRotateHandler(90)\n      });\n    } // add the save button is the save path exists\n\n\n    if (_config.savepath.length > 0) {\n      tconfig.children.unshift({\n        type: 'button',\n        id: 'Button_Save',\n        cls: domclasses.atala_tool_button_save,\n        icon: 'save',\n        tooltip: 'Save Changes',\n        text: null,\n        onclick: function onclick() {\n          __saveChanges();\n        }\n      });\n    }\n\n    if (_config.upload.enabled !== false) {\n      tconfig.children.unshift({\n        type: 'button',\n        id: 'Button_Upload',\n        cls: domclasses.atala_tool_button_upload,\n        icon: 'upload',\n        tooltip: 'Upload document',\n        text: null,\n        onclick: function onclick() {\n          __showUploadUi();\n        }\n      });\n    }\n\n    if (_config.showbookmarks !== false) {\n      tconfig.children.unshift({\n        type: 'button',\n        id: 'Button_Bookmarks',\n        cls: domclasses.atala_tool_button_bookmarks,\n        icon: 'bookmarks',\n        tooltip: 'Show bookmarks',\n        text: null,\n        onclick: function onclick() {\n          __showBookmarksUI();\n        }\n      });\n    }\n\n    if (_config.toolbarbuttons) {\n      _config.toolbarbuttons.reverse().forEach(function (tlbBtn) {\n        WebDocumentViewer_newArrowCheck(this, _this);\n\n        tconfig.children.unshift({\n          type: 'button',\n          id: tlbBtn.id,\n          cls: tlbBtn[\"class\"],\n          tooltip: tlbBtn.tooltip,\n          onclick: tlbBtn.onclick,\n          text: null,\n          icon: tlbBtn.icon,\n          custom: true\n        });\n      }.bind(this));\n    }\n\n    return __createToolbar(tconfig);\n  } // Creates the annotation toolbar for this control, and appends them to the given object\n  // p: jQuery parent object to append toolbar to\n\n\n  function __createAnnoToolbar(p) {\n    // config object\n    var tconfig = {\n      id: _id + '_toolbar',\n      parent: p,\n      children: [{\n        type: 'button',\n        id: 'Button_Ellipse',\n        cls: domclasses.atala_tool_button_ellipse_anno,\n        icon: 'ellipse',\n        tooltip: 'Draw Ellipse',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Highlight',\n        cls: domclasses.atala_tool_button_highlight_anno,\n        icon: 'highlight',\n        tooltip: 'Draw Highlight',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Line',\n        cls: domclasses.atala_tool_button_line_anno,\n        icon: 'line',\n        tooltip: 'Draw Line',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Lines',\n        cls: domclasses.atala_tool_button_lines_anno,\n        icon: 'lines',\n        tooltip: 'Draw Poly Lines',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Freehand',\n        cls: domclasses.atala_tool_button_freehand_anno,\n        icon: 'freehand',\n        tooltip: 'Draw Freehand',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Polygon',\n        cls: domclasses.atala_tool_button_polygon_anno,\n        icon: 'polygon',\n        tooltip: 'Draw Polygon',\n        text: '',\n        onclick: __drawAnnotation\n      }, {\n        type: 'button',\n        id: 'Button_Rectangle',\n        cls: domclasses.atala_tool_button_rect_anno,\n        icon: 'rectangle',\n        tooltip: 'Draw Rectangle',\n        text: '',\n        onclick: __drawAnnotation\n      }, //\t\t\t\t{ type: 'button', id: 'Button_FillRect',    cls: domclasses.atala_tool_button_fillrect_anno,\ticon: 'fillrect',\ttooltip: 'Filled Rectangle',text: '', onclick: __drawAnnotation },\n      {\n        type: 'button',\n        id: 'Button_Text_Anno',\n        cls: domclasses.atala_tool_button_text_anno,\n        icon: 'text',\n        tooltip: 'Draw Text',\n        text: '',\n        onclick: __drawAnnotation //,\n        //\t\t\t\t{ type: 'button', id: 'Button_Stamp',       cls: domclasses.atala_tool_button_stamp_anno,\t    icon: 'stamp',\t\ttooltip: 'Add a Stamp',\t\ttext: '', onclick: __addAnnotation },\n        //\t\t\t\t{ type: 'button', id: 'Button_Note',        cls: domclasses.atala_tool_button_note_anno,\t\ticon: 'note',\t\ttooltip: 'Add a Sticky Note',text: '',onclick: __addAnnotation },\n        //\t\t\t\t{ type: 'button', id: 'Button_Comment',     cls: domclasses.atala_tool_button_comment_anno,\ticon: 'comment',\ttooltip: 'Add a Comment',\ttext: '', onclick: __addAnnotation }\n\n      }]\n    };\n    return __createToolbar(tconfig);\n  } // creates a toolbar based on the config options passed in\n  // tConfig: options object\n\n\n  function __createToolbar(tConfig) {\n    var tray = __createDiv(tConfig.parent);\n\n    var trayid = _id + '_toolbar';\n    tray.buttons = [];\n\n    for (var i = 0; tConfig.children && i < tConfig.children.length; i++) {\n      var element = null;\n\n      switch (tConfig.children[i].type) {\n        case 'button':\n          // touch events don't play nice with polyline or polygon\n          if (Browser.Features.Touch && (tConfig.children[i].icon === 'lines' || tConfig.children[i].icon === 'polygon')) continue;\n          tConfig.children[i].id = trayid + '_' + tConfig.children[i].id;\n          element = __createButtonFromConfig(tConfig.children[i], tray);\n          element.addClass(domclasses.atala_toolbar_button);\n          tray.buttons.push(element);\n          break;\n\n        case 'pagelabel':\n          _dom.pageLabel = __createDOM('span', tray, trayid + '_' + tConfig.children[i].id);\n          element = _dom.pageLabel;\n          element.addClass('ui-controlgroup-item');\n          break;\n      }\n\n      if (element && tConfig.children[i].cls) {\n        element.addClass(tConfig.children[i].cls);\n      }\n    }\n\n    return tray;\n  } // creates a jQuery UI menu using the given options\n  // mConfig: key value pairs, where the key is the menu text, value is a function\n\n\n  function __createMenu(mConfig) {\n    var ul = atalaJquery('<ul/>');\n    ul.css({\n      fontSize: 'medium'\n    });\n    ul.addClass(domclasses.atala_context_menu);\n\n    for (var i in mConfig) {\n      if (mConfig.hasOwnProperty(i)) {\n        var li = atalaJquery(\"<li><div href=\\\"#\\\"> \" + i + \" </div></li>\");\n\n        if (Browser.Features.Touch) {\n          li.on({\n            touchend: mConfig[i]\n          });\n        }\n\n        li.click(mConfig[i]);\n        li.appendTo(ul);\n      }\n    }\n\n    ul.menu();\n    return ul;\n  } // creates a jQuery UI dialog box\n  // p: jQuery parent object to append toolbar to\n  // title: string, text to display on the title bar\n  // content: string or jQuery object\n\n\n  function __createDialog(p, title, content) {\n    var div = atalaJquery(\"<div title=\\\"\" + title + \"\\\" />\");\n\n    if (content) {\n      div.append(content);\n    }\n\n    div.dialog();\n    return div;\n  } // creates a jQuery UI button set dropdown\n  // p: jQuery parent object to append toolbar to\n  // bConfig: key value pairs, where the key is the menu text, value is a function\n\n\n  function __createDropDownButton(bConfig) {\n    var span = __createDOM('span', _dom.toolbar.annoToolbar).addClass('ui-controlgroup-item');\n\n    __createButtonFromConfig(bConfig, span);\n\n    __createButton(span, bConfig.id + '_Drop', 'ui-icon-triangle-1-s', 'Click To Choose', null, function () {\n      var menu = atalaJquery(this).next();\n\n      if (menu.is(':visible')) {\n        menu.hide();\n        return false;\n      }\n\n      var btnAbove = menu.prev().prev().parent();\n      menu.menu().show().css({\n        'position': 'absolute',\n        'top': 0,\n        'left': 0,\n        'min-width': btnAbove.width() + 'px',\n        'z-index': 11\n      }).position({\n        my: 'left top',\n        at: 'left bottom',\n        of: btnAbove\n      }); //TODO: make menu hide on click outside of menu\n      //$(document).one('click', function(){\n      //\tmenu.hide();\n      //});\n\n      return false;\n    });\n\n    span.controlgroup();\n\n    _dom.toolbar.annoToolbar.controlgroup('refresh');\n\n    return span;\n  } // creates a jQuery UI drop menu\n  // elm: jQuery instance of the DOM object where the drop-down button lives\n  // fClick: function to execute when button is clicked on\n  // btncfg: button config options\n  // config: array of objects user wants in the menu\n\n\n  function __createDropDownMenu(elm, btncfg, config) {\n    var btn = atalaJquery(elm.children().first());\n    var menuList = {};\n\n    for (var i = 0; i < config.length; i++) {\n      //__createMenu takes in a key/value pair of menu item text and function to be executed on click event\n      menuList[config[i].name] = __createMenuClickFunc(btn, btncfg, config[i]);\n    } // need to create a reference to the menu so that we can hide it on the click\n\n\n    btn.menu = __createMenu(menuList); //\t\tbtn.menu.addClass('atala-ui-button');\n\n    elm.append(btn.menu);\n    btn.menu.hide();\n  } // creates a wrapper for a jQuery UI menu click function\n  // btn: jQuery UI button object\n  // btncfg: button config options\n  // config: array of objects user wants in the menu\n\n\n  function __createMenuClickFunc(btn, btncfg, config) {\n    var toolbarEventTrigger = 'menuselect' + btncfg.icon + config.name;\n\n    var clickEvent = function clickEvent() {\n      btn.button('option', 'label', 'Draw ' + config.name);\n      btn.data('_annoConfig', config);\n      btn.click(btncfg.onclick);\n      btn.menu.hide();\n      btn.trigger('click');\n      return false;\n    };\n\n    __bindEvents(toolbarEventTrigger, __toolbarTriggerWrapper(clickEvent, btn));\n\n    return clickEvent;\n  } // creates a jQuery UI button with the given properties\n  // p: jQuery parent object to append to\n  // bid: string, button id\n  // bc: string, button icon class\n  // btt: string, button tool tip\n  // btxt: string, button text\n  // fnc: function, click event function\n\n\n  function __createButton(p, bid, bc, btt, btxt, fnc) {\n    var btn = atalaJquery('<button id=\"' + bid + '\" title=\"' + btt + '\">' + (btxt || btt) + '</button>');\n\n    if (fnc) {\n      btn.click(fnc);\n    }\n\n    btn.button({\n      icon: bc,\n      showLabel: btxt != null && _config.showbuttontext\n    });\n    btn.addClass('atala-ui-button');\n\n    if (p) {\n      btn.appendTo(p);\n    }\n\n    return btn;\n  } // creates a button that follows the same convention as the toolbar buttons\n  // bConfig: key value pairs represented below\n  //\t.id:\t\tstring, button id\n  //\t.icon:\t\tstring, button icon class suffix\n  //\t.tooltip:\tstring, hover text\n  //\t.text:\t\tstring, button text\n  //\t.onclick:\tfunction, button click function\n\n\n  function __createButtonFromConfig(bConfig, p) {\n    var toolbarEventTrigger = 'menuclick' + (bConfig.custom ? bConfig.id : bConfig.icon);\n\n    var btn = __createButton(p, bConfig.id, bConfig.custom ? bConfig.icon : _iconClass + ' ' + _iconClass + '-' + bConfig.icon, bConfig.tooltip, bConfig.text, __buttonClickWrapper(toolbarEventTrigger)); // this data is used by click events in order to figure out what button was pressed\n\n\n    btn.data('_config', bConfig);\n\n    __bindEvents(toolbarEventTrigger, __toolbarTriggerWrapper(bConfig.onclick, btn));\n\n    return btn;\n  }\n\n  function __CSearchBox(config) {\n    var styles = {\n      clearable: 'atala_search_input_clearable',\n      onclear: 'atala_search_input_clear_hover',\n      inputEmpty: 'atala_search_input_empty',\n      loading: 'atala_search_input_loading'\n    };\n    var parent = config.parent || _dom.toolbar;\n    var iterator = null;\n    var searchTimeout = null; // timeout to trigger search when user finished typing in search box.\n\n    var container, inputBox;\n\n    __initDom();\n\n    function __initDom() {\n      container = __createDiv().addClass(domclasses.atala_search_container).addClass('ui-controlgroup-item');\n      inputBox = atalaJquery('<input type=\"text\" placeholder=\"Search...\" />').addClass(domclasses.atala_search_input).addClass('ui-widget');\n      inputBox.on({\n        keydown: __onInputKeyUp,\n        'input propertychange': __onInputChange\n      });\n\n      var inputSpan = __createDOM('span', container).css({\n        width: '100%'\n      });\n\n      inputSpan.append(inputBox);\n\n      var buttonsSpan = __createDOM('span', container);\n\n      __createButton(buttonsSpan, _id + '_toolbar_search_button_next', _iconClass + ' ' + _iconClass + '-search-next', 'Next', null, __makeButtonHandler(__onSearchNext)).addClass(domclasses.atala_search_next).addClass(domclasses.atala_toolbar_button);\n\n      __createButton(buttonsSpan, _id + '_toolbar_search_button_prev', _iconClass + ' ' + _iconClass + '-search-prev', 'Previous', null, __makeButtonHandler(__onSearchPrev)).addClass(domclasses.atala_search_prev).addClass(domclasses.atala_toolbar_button);\n\n      container.on('mousemove', '.' + styles.clearable, __togglePointer).on('touchstart click', '.' + styles.onclear, __onClearClick);\n      parent.append(container);\n      parent.append(atalaJquery('<div/>').css('clear', 'both'));\n    }\n\n    this.dispose = __disposeSearchBox;\n\n    function __disposeSearchBox() {\n      inputBox.off({\n        keypress: __onInputKeyUp,\n        'input propertychange': __onInputChange\n      });\n      container.off('mousemove', '.' + styles.clearable, __togglePointer).off('touchstart click', '.' + styles.onclear, __onClearClick);\n\n      if (iterator) {\n        iterator.dispose();\n      }\n\n      container.remove();\n    }\n\n    function __onInputChange() {\n      var text = inputBox.val();\n\n      if (text) {\n        inputBox.addClass(styles.clearable);\n      } else {\n        inputBox.removeClass(styles.clearable);\n      }\n\n      if (text && iterator && iterator.isValid() && text === iterator.getQuery()) {\n        return true;\n      }\n\n      clearTimeout(searchTimeout);\n      iterator = null;\n\n      if (text && text.length >= 3) {\n        __updateMatchIndicator(true);\n\n        searchTimeout = setTimeout(function () {\n          iterator = _controllers.text.search(text, __getCurrIndex(), __onNextMatch);\n\n          __suspendUI(true);\n        }, _config.mousetool.text.searchdelay);\n        return false;\n      } else {\n        __onClearSearch();\n      }\n    }\n\n    function __onInputKeyUp(e) {\n      var text = inputBox.val();\n\n      if (e.keyCode === 13 && iterator && text && iterator.isValid() && iterator.getQuery() === text) {\n        if (!e.shiftKey) {\n          __onSearchNext();\n        } else {\n          __onSearchPrev();\n        }\n\n        return false;\n      } else if (e.keyCode === 13 && (!iterator || !iterator.isValid())) {\n        __onInputChange();\n\n        return false;\n      } else if (e.keyCode === 27) {\n        __ClearSearch();\n\n        return false;\n      }\n    }\n\n    function __onSearchNext() {\n      if (iterator) {\n        __suspendUI(true);\n\n        iterator.next(__onNextMatch);\n      }\n    }\n\n    function __onSearchPrev() {\n      if (iterator) {\n        __suspendUI(true);\n\n        iterator.prev(__onNextMatch);\n      }\n    }\n\n    this.ClearSearch = __ClearSearch;\n\n    function __ClearSearch() {\n      __onClearSearch();\n\n      __onClearClick();\n    }\n\n    function __onClearSearch() {\n      iterator = null;\n\n      _controllers.text.search('');\n\n      _controllers.text.clearSelection();\n\n      __suspendUI(false);\n\n      __updateMatchIndicator(true);\n    }\n\n    function __onNextMatch(iterator, match) {\n      if (iterator.isValid()) {\n        __suspendUI(false);\n\n        iterator.wrap = _config.mousetool.text.wrapsearch;\n\n        if (!match) {\n          __updateMatchIndicator(match);\n        }\n      }\n    }\n\n    function __suspendUI(suspended) {\n      __toggleStyle(styles.loading, suspended);\n    }\n\n    function __updateMatchIndicator(match) {\n      __toggleStyle(styles.inputEmpty, !match);\n    }\n\n    function __makeButtonHandler(fn) {\n      return function (e) {\n        e.preventDefault();\n\n        if (fn) {\n          fn();\n        }\n      };\n    }\n\n    function __toggleStyle(style, enabled) {\n      if (enabled) {\n        inputBox.addClass(style);\n      } else {\n        inputBox.removeClass(style);\n      }\n    }\n\n    function __togglePointer(e) {\n      __toggleStyle(styles.onclear, this.offsetWidth - 18 < e.clientX - this.getBoundingClientRect().left);\n    }\n\n    function __onClearClick(e) {\n      if (e) {\n        e.preventDefault();\n      }\n\n      inputBox.removeClass(styles.clearable).removeClass(styles.onclear).val('').change();\n\n      __onInputChange();\n    }\n  }\n\n  function __enableZoomAreaTool() {\n    if (_config.allowannotations) {\n      _self.annotations.cancelDraw();\n    }\n\n    _controllers.mouseTool.setTool(MouseToolType.ZoomArea);\n  }\n\n  function __createRotateHandler(angle) {\n    return function () {\n      var _this2 = this;\n\n      var selectedPages = __getSelectedPagesIndices(_page);\n\n      var pageIndex = selectedPages[0];\n      var pageRotations = [];\n      selectedPages.forEach(function (currentValue) {\n        WebDocumentViewer_newArrowCheck(this, _this2);\n\n        return pageRotations.push(_controllers.document.getPageRotation(currentValue) + angle);\n      }.bind(this));\n\n      _controllers.document.rotatePages(selectedPages, pageRotations, function () {\n        var scale = __getPageScale(pageIndex);\n\n        var pageSize = __getPageSize(pageIndex); // for horizontal scrolling align to the beginning of the page.\n\n\n        var offset = _config.direction === ScrollDirection.Vertical ? pageSize.height * scale : 0; // location object is not the same, so compare by value.\n\n        if (__isLocationEquals(_config.pageselectlocation, PageSelection.Center) || __isLocationEquals(_config.pageselectlocation, PageSelection.MiddleLeft)) {\n          offset = offset / 2;\n        } else if (__isLocationEquals(_config.pageselectlocation, PageSelection.TopLeft)) {\n          offset = 0;\n        }\n\n        var anchor = {\n          x: _config.direction === ScrollDirection.Vertical ? 0 : offset,\n          y: _config.direction === ScrollDirection.Vertical ? offset : 0\n        };\n\n        __showPagePoint(pageIndex, anchor, _config.pageselectlocation, true);\n      });\n    };\n  }\n\n  var __getSelectedPagesIndices = function __getSelectedPagesIndices(page) {\n    return [page.number - 1];\n  }; // creates an edge object used to mark and pad the viewable edges\n  // p: jQuery parent object to append to\n  // eid: string, edge id\n\n\n  function __createEdge(p, eid) {\n    var cont = __createDiv(p, eid);\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      cont.height(1);\n      cont.css({\n        display: 'block'\n      });\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      cont.width(1);\n      cont.css({\n        display: 'inline-block',\n        overflow: 'hidden'\n      });\n    }\n\n    cont._zoom = 1;\n\n    if (_config.backcolor) {\n      cont.css({\n        backgroundColor: _config.backcolor\n      });\n    }\n\n    return cont;\n  } // creates a set of div tags used to show pages\n  // i: int, number of divs to create\n\n\n  function __createPageDivs(i) {\n    if (i === undefined) {\n      var minBuffer = __calculatePageDivCount(_isThumbnailer && _state.newpagedivsize && _config.zoom > 0 && isFinite(_config.zoom) ? _config.zoom : __getMinZoom());\n\n      if (minBuffer > _config.maxpagebuffersize) {\n        minBuffer = _config.maxpagebuffersize;\n      }\n\n      if (_page.buffer < minBuffer) {\n        // having less pages than needed tends to make scrolling unusable when zoomed out\n        _page.buffer = minBuffer;\n      }\n\n      _page.buffer = Math.min(_page.buffer, _controllers.document.getPageCount());\n      i = _page.buffer;\n    }\n\n    function pgSetActivePage(pg) {\n      return function () {\n        __setActivePage(pg);\n      };\n    }\n\n    if (_dom.pageDivs.length < i) {\n      for (var j = _dom.pageDivs.length; j < i; j++) {\n        _dom.pageDivs[j] = __createDiv();\n\n        _dom.pageDivs[j].addClass(domclasses.atala_page_div);\n\n        if (_config.showselecttools) {\n          _dom.pageDivs[j]._rubberband = new mousetools_RubberBandTool(_self, {}, _dom.pageDivs[j], {\n            getViewportSize: __getViewportSize,\n            getMaxZoom: __getMaxZoom,\n            getPageOffsets: __getPageOffsets,\n            raiseDrawLayer: __raiseDrawLayer,\n            resetDrawLayer: __resetDrawLayer\n          });\n        }\n\n        _dom.pageDivs[j].on({\n          'touchstart': pgSetActivePage(_dom.pageDivs[j]),\n          'mousedown': pgSetActivePage(_dom.pageDivs[j])\n        });\n\n        _dom.pageDivs[j].attr('tabindex', 0);\n\n        if (_controllers.annotations) {\n          _controllers.annotations.addDrawingSurface(_dom.pageDivs[j]);\n        }\n\n        if (_config.showselecttools || _config.allowannotations || _config.allowforms || _config.allowtext) {\n          _dom.pageDivs[j]._draw = __createDrawLayer(_dom.pageDivs[j]);\n        }\n\n        if (_controllers.forms && !_isThumbnailer) {\n          _controllers.forms.addFormLayer(_dom.pageDivs[j]);\n        }\n\n        if (_controllers.text && !_isThumbnailer) {\n          _controllers.text.addTextLayer(_dom.pageDivs[j]);\n        }\n      }\n    } else if (_dom.pageDivs.length > i) {\n      // too many page divs, length must equal given value\n      while (_dom.pageDivs.length > i && _dom.pageDivs.length !== 0) {\n        var pg = _dom.pageDivs.pop();\n\n        if (pg._rubberband) {\n          pg._rubberband.dispose();\n        }\n\n        if (_controllers.annotations) {\n          _controllers.annotations.removeDrawingSurface(pg);\n        }\n\n        if (_controllers.forms && !_isThumbnailer) {\n          _controllers.forms.removeFormLayer(pg);\n        }\n\n        if (_controllers.text && !_isThumbnailer) {\n          _controllers.text.removeTextLayer(pg);\n        }\n\n        if (pg) {\n          __deletePage(pg);\n        }\n\n        pg = null;\n      }\n    }\n  } // creates and asynchronously loads the image representing the page at the given index\n  // i: int, frame index\n  // pageref: object, represents page reference on another document\n  // callback: function to execute when the image is finished loading\n\n\n  function __createPageImageAsync(i, pageref, params, callback) {\n    if (typeof params === 'function') {\n      callback = params;\n      params = undefined;\n    }\n\n    var _CPcallback = typeof callback === 'function' ? [callback] : [];\n\n    var _CPimg;\n\n    _CPimg = atalaJquery(new Image()); // we've loaded image with fit zoom, but turns out that size is different from expected and we gor blur effect. need to rezoom.\n\n    var reZoomThreshold = 0.9;\n\n    var _loadParams = atalaJquery.extend(true, {\n      atala_cb: undefined\n    }, params || {});\n\n    _CPimg._domEl = __createDiv();\n\n    _CPimg._domEl.addClass(domclasses.atala_page_image_anchor);\n\n    _CPimg.addClass(domclasses.atala_page_image);\n\n    _CPimg._domEl.append(_CPimg);\n\n    var _CPbinds = {\n      load: __CPimgLoaded,\n      error: __CPimgError,\n      inserted: __CPimgInserted\n    };\n    _CPimg._binds = _CPbinds; //  cache documenturl on image creations, since viewer could show different docs, but image should stay same.\n\n    _CPimg.documenturl = _config.documenturl;\n    _CPimg._index = pageref ? pageref.mapsto : i;\n    _CPimg._loaded = false;\n    _CPimg._size = {\n      width: 0,\n      height: 0,\n      isEmpty: function isEmpty() {\n        return this.width === 0 && this.height === 0;\n      }\n    };\n    _CPimg._zoom = -1;\n    _CPimg._prevzoom = _CPimg._zoom;\n    _CPimg._scaledzoom = -1; // physical image rotation done by server\n\n    _CPimg._rotation = 0; // view image rotation done by client until image is updated by server\n\n    _CPimg._viewrotation = 0;\n    _CPimg._tiled = false;\n    _CPimg._tilesV = 1;\n    _CPimg._tilesH = 1; // added functions\n\n    _CPimg.dispose = __CPimgDispose;\n    _CPimg.zoom = __CPimgZoomAsync;\n    _CPimg.needsZoom = __CPimgNeedsZoom;\n    _CPimg.getSize = __CPgetSize;\n    _CPimg.getScaledSize = __CPgetScaledSize;\n    _CPimg.getFitZoom = __CPgetFitZoom;\n    _CPimg.getFitMultiplier = __CPgetFitMultiplier;\n    _CPimg.needsRotate = __CPimgNeedsRotate;\n    _CPimg.rotate = __CPimgRotateAsync;\n    _CPimg.getDomElement = __CPimgGetDom;\n    _CPimg.invalidate = __CPimgInvalidate;\n    _CPimg.naturalHeight = __CPimgNaturalHeight;\n    _CPimg.naturalWidth = __CPimgNaturalWidth;\n\n    __CPimgInit();\n\n    function __getPageIndex() {\n      return _CPimg._page ? _CPimg._page._index : _controllers.document.getPageIndexByImageIndex(_CPimg._index);\n    }\n\n    function __CPimgGetDom() {\n      return _CPimg._domEl;\n    } // multiplier to fit image into forcefit bounds\n\n\n    function __CPgetFitMultiplier(index) {\n      return _controllers.document.getPageFitMultiplier(index !== undefined ? index : __getPageIndex());\n    }\n\n    function __CPgetFitZoom(z, index) {\n      z = z === undefined ? _config.zoom : z;\n      return z * __CPgetFitMultiplier(index);\n    }\n\n    function __CPsetFitMultiplier(m) {\n      return _controllers.document.setPageFitMultiplier(__getPageIndex(), m);\n    }\n\n    function __CPgetSize() {\n      var size = __getPageSize(__getPageIndex()) || _page.size;\n\n      return {\n        height: size.height,\n        width: size.width\n      };\n    }\n    /**\r\n     * Returns physical size of the image without client transformations applied(like view rotation)\r\n     */\n\n\n    function __CPgetSourceSize() {\n      var size = __CPgetSize();\n\n      return _CPimg._viewrotation === 90 || _CPimg._viewrotation === 270 ? __CPimgSwapSizeSides(size) : size;\n    }\n\n    function __CPgetScaledSize(z, size) {\n      size = size || __CPgetSize();\n      return {\n        height: Math.round(size.height * __CPgetFitZoom(z)),\n        width: Math.round(size.width * __CPgetFitZoom(z))\n      };\n    }\n\n    function __shouldBeTiled(i, zoom) {\n      var res = false;\n      var reducedThreshold = tilingThreshold * _page.dpi / 96;\n\n      if (_config.tiling && !_isThumbnailer && __pageCanBeTiled(reducedThreshold, i)) {\n        var vps = __getViewportSize();\n\n        var srs = __getPageSize(i); //Require tiling images which has big enough source and mapped to big result image   \n\n\n        if (srs.height > reducedThreshold && srs.width > reducedThreshold && (srs.height * zoom / vps.height > 2 || srs.width * zoom / vps.width > 2)) {\n          res = true;\n        }\n      }\n\n      return res;\n    }\n\n    function __CPimgNaturalHeight() {\n      var _this3 = this;\n\n      if (!_CPimg._tiled) {\n        return _CPimg.prop('naturalHeight');\n      } else {\n        var result = 0;\n\n        var images = _CPimg.find('.' + domclasses.atala_tile_column).first().find('img');\n\n        images.each(function (index, img) {\n          WebDocumentViewer_newArrowCheck(this, _this3);\n\n          result += img.naturalHeight;\n        }.bind(this));\n        return result;\n      }\n    }\n\n    function __CPimgNaturalWidth() {\n      var _this4 = this;\n\n      if (!_CPimg._tiled) {\n        return _CPimg.prop('naturalWidth');\n      } else {\n        var result = 0;\n\n        var columns = _CPimg.find('.' + domclasses.atala_tile_column);\n\n        columns.each(function () {\n          WebDocumentViewer_newArrowCheck(this, _this4);\n\n          result += atalaJquery(this).find('img').first().prop('naturalWidth');\n        }.bind(this));\n        return result;\n      }\n    }\n\n    function __CPimgInit() {\n      _CPimg.on(_CPbinds);\n\n      var bSize = _config.pageborderwidth;\n      var margins = {\n        'bottom': 0,\n        'top': 0,\n        'right': 0,\n        'left': 0\n      };\n      _CPimg._loaded = false;\n      _CPimg._reqzoom = -1;\n      _CPimg._needToInsert = true;\n\n      if (_config.direction === ScrollDirection.Vertical || _config.tabular) {\n        margins.bottom = _config.pagespacing;\n      }\n\n      if (_config.direction === ScrollDirection.Horizontal || _config.tabular) {\n        margins.right = _config.pagespacing;\n      }\n\n      var domAnchor = __CPimgGetDom();\n\n      if (_config.showpageborder) {\n        domAnchor.css({\n          'border-bottom': bSize + 'px solid black',\n          'border-right': bSize + 'px solid black',\n          'border-top': bSize + 'px solid silver',\n          'border-left': bSize + 'px solid silver',\n          'margin-bottom': margins.bottom + 'px',\n          'margin-right': margins.right + 'px'\n        });\n      }\n\n      domAnchor.css({\n        display: 'inline-block'\n      });\n      domAnchor.addClass(domclasses.atala_page_loading);\n\n      __CPimgLoad();\n    }\n\n    function __CPimgLoad(force) {\n      var _this5 = this;\n\n      var pageindex = __getPageIndex(); // inserted from other document pages we assume non-vector\n\n\n      var isVector = _page.vector && (!pageref || !pageref.uri);\n      var reqZoom = isVector ? __CPgetFitZoom() : Math.min(__CPgetFitZoom(), 1);\n\n      var reqAngle = _controllers.document.getPageRotation(pageindex);\n\n      if (force || reqZoom !== _CPimg._zoom || _CPimg._rotation !== reqAngle) {\n        var _params = atalaJquery.extend({\n          'atala_docurl': pageref ? pageref.uri : _CPimg.documenturl,\n          'atala_doczoom': reqZoom,\n          // TODO: remove atala_thumbpadding\n          'atala_thumbpadding': false\n        }, _loadParams);\n\n        if (reqAngle) {\n          _params.atala_angle = reqAngle;\n        }\n\n        if (_config.jpeg) {\n          _params.atala_jpeg = true;\n        }\n\n        if (_config.tiling && _config.forcepagefit && !_CPimg._loaded) {\n          var reducedThreshold = tilingThreshold * _page.dpi / 96;\n\n          if (__pageCanBeTiled(reducedThreshold, pageindex)) {\n            var reqZoom1;\n\n            var vps = __getViewportSize();\n\n            var sourceSize = __getPageSize(pageindex);\n\n            if (sourceSize.width > sourceSize.height) {\n              reqZoom1 = vps.width / sourceSize.width;\n            } else {\n              reqZoom1 = vps.height / sourceSize.height;\n            }\n\n            if (!__closeToEqual(reqZoom, reqZoom1)) {\n              reqZoom = reqZoom1;\n              _params.atala_doczoom = reqZoom;\n            }\n          }\n        }\n\n        _CPimg._tiled = __shouldBeTiled(pageindex, reqZoom);\n\n        if (!_CPimg._tiled) {\n          if (_CPimg._tilesV > 1 || _CPimg._tilesH > 1) {\n            //Image was tiled. Return to simple Image object\n            var domAnchor = __CPimgGetDom();\n\n            var oldCPimg = _CPimg;\n            _CPimg = atalaJquery(new Image());\n            domAnchor.children().replaceWith(_CPimg);\n\n            __CPcopyPropsFrom(oldCPimg);\n\n            _CPimg.addClass(domclasses.atala_page_image);\n\n            domAnchor.addClass(domclasses.atala_page_loading);\n            _CPimg._tilesV = 1;\n            _CPimg._tilesH = 1;\n            _CPimg.__tilesArray = [];\n            _dom.loadedImgs[_CPimg._cacheIndex] = _CPimg;\n            _CPimg._needToInsert = false;\n          }\n\n          var hRequest = {\n            type: 'docpage',\n            serverurl: _config.serverurl,\n            query: '?ataladocpage=' + (pageref === null ? _CPimg._index : pageref.index !== undefined ? pageref.index : pageref),\n            method: 'GET',\n            data: _params,\n            cancel: false,\n            info: _CPimg\n          };\n          _CPimg._reqzoom = reqZoom;\n          _CPimg._reqangle = reqAngle; // rotation could change while image is loading. tell success handler what was requested by received request.\n\n          __makeHandlerRequest(hRequest, __CPimgLoaded, __CPimgLoaded);\n        } else {\n          //split to tiles\n          var pageSize = __getPageSize(pageindex);\n\n          var reqSize = __CPgetScaledSize();\n\n          var _vps = __getViewportSize();\n\n          var numOfTilesV = Math.min(maxTilesPerEdge, Math.floor(reqSize.height / _vps.height));\n          var numOfTilesH = Math.min(maxTilesPerEdge, Math.floor(reqSize.width / _vps.width));\n          var tileSize = {\n            width: Math.ceil(pageSize.width / numOfTilesH),\n            height: Math.ceil(pageSize.height / numOfTilesV)\n          };\n\n          if (numOfTilesV !== _CPimg._tilesV || numOfTilesH !== _CPimg._tilesH) //not necessary to destroy and create a new grid\n            {\n              __interruptFurtherTiling();\n\n              var _domAnchor = __CPimgGetDom();\n\n              var _oldCPimg = _CPimg;\n              _CPimg = __createDiv();\n\n              _domAnchor.children().replaceWith(_CPimg);\n\n              __CPcopyPropsFrom(_oldCPimg);\n\n              _CPimg.addClass(domclasses.atala_tiled_page_image);\n\n              for (var _i = 0; _i < numOfTilesH; _i++) {\n                var column = __createDiv(_CPimg);\n\n                column.addClass(domclasses.atala_tile_column);\n\n                for (var j = 0; j < numOfTilesV; j++) {\n                  var tileplace = __createDiv(column);\n\n                  tileplace.attr('tile_index_h', _i).attr('tile_index_v', j);\n                  tileplace.width(tileSize.width * reqZoom);\n                  tileplace.height(tileSize.height * reqZoom);\n                  tileplace.addClass(domclasses.atala_page_loading);\n                  var tileimg = atalaJquery(new Image());\n                  tileimg.css('display', 'none');\n                  tileplace.append(tileimg);\n                } // end of vertical group\n\n              } //end of horizontal loop\n\n\n              _CPimg._tilesH = numOfTilesH;\n              _CPimg._tilesV = numOfTilesV;\n            }\n\n          _dom.loadedImgs[_CPimg._cacheIndex] = _CPimg;\n          _CPimg._needToInsert = false;\n          _CPimg.__tileRequests = [];\n          _CPimg.__tilesArray = [];\n\n          for (var _i2 = 0; _i2 < numOfTilesH; _i2++) {\n            for (var _j = 0; _j < numOfTilesV; _j++) {\n              _CPimg.__tilesArray.push({\n                x: _i2,\n                y: _j\n              });\n            }\n          }\n\n          var startTile = {\n            x: 0,\n            y: 0\n          }; //sort tiles by the distance to the start tile\n\n          var sqDist = function sqDist(pointa, pointb) {\n            WebDocumentViewer_newArrowCheck(this, _this5);\n\n            return Math.pow(pointa.x - pointb.x, 2) + Math.pow(pointa.y - pointb.y, 2);\n          }.bind(this);\n\n          _CPimg.__tilesArray.sort(function (pointa, pointb) {\n            WebDocumentViewer_newArrowCheck(this, _this5);\n\n            return sqDist(startTile, pointa) - sqDist(startTile, pointb);\n          }.bind(this));\n\n          _CPimg.__tilesArray.forEach(function (tile) {\n            var X = tile.x;\n            var Y = tile.y;\n            var tilestartx, tilestarty, tilewidth, tileheight;\n\n            switch (reqAngle) {\n              case 0:\n                tilestartx = Math.ceil(X * tileSize.width);\n                tilestarty = Math.ceil(Y * tileSize.height);\n                tilewidth = X < numOfTilesH - 1 ? tileSize.width : pageSize.width - tilestartx;\n                tileheight = Y < numOfTilesV - 1 ? tileSize.height : pageSize.height - tilestarty;\n                break;\n\n              case 90:\n                tilestartx = Math.ceil(Y * tileSize.height);\n                tilestarty = Math.ceil((numOfTilesH - 1 - X) * tileSize.width);\n                tilewidth = Y < numOfTilesV - 1 ? tileSize.height : pageSize.height - tilestartx;\n                tileheight = X !== 0 ? tileSize.width : pageSize.width - tilestarty;\n                break;\n\n              case 270:\n                tilestartx = Math.ceil((numOfTilesV - 1 - Y) * tileSize.height);\n                tilestarty = Math.ceil(X * tileSize.width);\n                tilewidth = Y !== 0 ? tileSize.height : pageSize.height - tilestartx;\n                tileheight = X < numOfTilesH - 1 ? tileSize.width : pageSize.width - tilestarty;\n                break;\n\n              case 180:\n                tilestartx = Math.ceil((numOfTilesH - 1 - X) * tileSize.width);\n                tilestarty = Math.ceil((numOfTilesV - 1 - Y) * tileSize.height);\n                tilewidth = X !== 0 ? tileSize.width : pageSize.width - tilestartx;\n                tileheight = Y !== 0 ? tileSize.height : pageSize.height - tilestarty;\n                break;\n\n              default:\n                __throwError('ImageError', 'Invalid rotation angle: ' + reqAngle);\n\n            }\n\n            var newparams = atalaJquery.extend(true, {}, _params, {\n              'atala_tilestart': tilestartx + 'x' + tilestarty,\n              'atala_pagesize': tilewidth + 'x' + tileheight\n            });\n            newparams.atala_doczoom = reqZoom;\n\n            _CPimg.__tileRequests.push({\n              type: 'docpage',\n              serverurl: _config.serverurl,\n              query: '?ataladocpage=' + (pageref === null ? _CPimg._index : pageref.index !== undefined ? pageref.index : pageref),\n              method: 'GET',\n              data: newparams,\n              cancel: false\n            });\n          }); //request images tile by tile\n\n\n          _CPimg._reqzoom = reqZoom;\n          _CPimg._reqangle = reqAngle;\n          setTimeout(function () {\n            WebDocumentViewer_newArrowCheck(this, _this5);\n\n            __resumeFurtherTiling();\n\n            __loadTiledImage(0, tileSize);\n          }.bind(this), 0);\n        }\n      } //end if\n\n    } //end __CPimgLoad function\n\n\n    function __loadTiledImage(tileindex, tilesize) {\n      //Tile grid was modified. Do not load unnecessary tiles\n      if (_state.itch || _CPimg._reqzoom !== __CPgetFitZoom() //another zoom was applied while some tiles were loaded \n      || _CPimg._reqangle !== _controllers.document.getPageRotation(__getPageIndex()) //it does not sense to load other tiles \n      || typeof _CPimg.__tileRequests[tileindex] === 'undefined' || typeof _CPimg.__tilesArray[tileindex] === 'undefined') {\n        __CPimgLoad();\n      } else {\n        var tileRequest = _CPimg.__tileRequests[tileindex];\n        var hIndex = _CPimg.__tilesArray[tileindex].x;\n        var vIndex = _CPimg.__tilesArray[tileindex].y;\n\n        var img = _CPimg.find(\"div[tile_index_h=\\\"\" + hIndex + \"\\\"][tile_index_v=\\\"\" + vIndex + \"\\\"]\").find('img');\n\n        img.attr('tile_index', tileindex);\n        img.attr('src', tileRequest.serverurl + tileRequest.query + '&' + atalaJquery.param(tileRequest.data));\n\n        img[0].onload = function () {\n          if (_CPimg) {\n            //possible that result is not longer necessary\n            img.css('display', 'block');\n            img.parent().css({\n              width: 'auto',\n              height: 'auto'\n            });\n            img.parent().removeClass(domclasses.atala_page_loading); //update svg size after the first tile load completion.\n\n            if (tileindex === 0) {\n              var scaledSize = __CPgetScaledSize();\n\n              _CPimg.trigger({\n                type: 'pageresize',\n                image: _CPimg,\n                index: __getPageIndex(),\n                width: scaledSize.width,\n                height: scaledSize.height\n              });\n            } //Update loaded image size\n\n\n            if (img.width() === 0 && img.height() === 0) {\n              img.css({\n                width: 'auto',\n                height: 'auto'\n              });\n            }\n\n            if (tileindex < _CPimg.__tilesArray.length - 1) {\n              __loadTiledImage(tileindex + 1, tilesize);\n            } else {\n              __CPimgLoaded();\n            }\n          }\n        };\n      }\n    }\n\n    function __CPimgLoaded() {\n      if (!_CPimg._loaded) {\n        _CPimg._domEl.removeClass(domclasses.atala_page_loading);\n      }\n\n      if (_CPimg._tiled && _state.zooming) {\n        __zoomFinished();\n      }\n\n      _CPimg._loaded = true;\n      _CPimg._zoom = _CPimg._reqzoom;\n      _CPimg._rotation = _CPimg._reqangle;\n\n      var pageindex = __getPageIndex();\n\n      if (pageindex >= 0) {\n        // reload page if it was rotated while load request\n        if (_CPimg._rotation !== _controllers.document.getPageRotation(pageindex)) {\n          __CPimgLoad();\n\n          return;\n        } // need to drop view rotation value, so sizes will be correctly recalculated for new image.\n\n\n        __CPimgResetViewRotationValue(); // if image doesn't have a parent yet, then it will have no height and width\n        // in webkit based browsers, even though it has finished loading\n\n\n        if (_CPimg.parent().length > 0) {\n          __CPimgUpdateSize();\n        }\n\n        __CPimgRotateView(_CPimg._viewrotation);\n\n        var fitZoom = _page.vector ? __CPgetFitZoom() : Math.min(__CPgetFitZoom(), 1);\n\n        if (__CPimgNeedsZoom() && _CPimg._zoom < fitZoom * reZoomThreshold && !__closeToEqual(_CPimg._zoom, fitZoom)) {\n          // we've go the image with smaller zoom so to avoid blur effect r   e-request image with correct zoom.\n          // most likely this happens when image is requested first time with forcepagefit set,\n          // so we don't know exact fit zoom for images different then first page.\n          __CPimgZoomAsync(false);\n        }\n      }\n\n      __CPcompleted();\n    }\n\n    function __CPcopyPropsFrom(oldCP) {\n      //possible there is more elegant way to copy all CPimg properties, but I have not found it\n      _CPimg._loaded = oldCP._loaded;\n      _CPimg._zoom = oldCP._zoom;\n      _CPimg._rotation = oldCP._rotation;\n      _CPimg._prevzoom = oldCP._prevzoom;\n      _CPimg._scaledzoom = oldCP._scaledzoom;\n      _CPimg._binds = oldCP._binds;\n      _CPimg.documenturl = oldCP.documenturl;\n      _CPimg._index = oldCP._index;\n      _CPimg._size = oldCP._size;\n      _CPimg._viewrotation = oldCP._viewrotation;\n      _CPimg._tiled = oldCP._tiled;\n      _CPimg._page = oldCP._page;\n      _CPimg._reqzoom = oldCP._reqzoom;\n      _CPimg._domEl = oldCP._domEl;\n      _CPimg._cacheIndex = oldCP._cacheIndex; // add functions\n\n      _CPimg.dispose = __CPimgDispose;\n      _CPimg.zoom = __CPimgZoomAsync;\n      _CPimg.needsZoom = __CPimgNeedsZoom;\n      _CPimg.getSize = __CPgetSize;\n      _CPimg.getScaledSize = __CPgetScaledSize;\n      _CPimg.getFitZoom = __CPgetFitZoom;\n      _CPimg.getFitMultiplier = __CPgetFitMultiplier;\n      _CPimg.needsRotate = __CPimgNeedsRotate;\n      _CPimg.rotate = __CPimgRotateAsync;\n      _CPimg.getDomElement = __CPimgGetDom;\n      _CPimg.invalidate = __CPimgInvalidate;\n      _CPimg.naturalHeight = __CPimgNaturalHeight;\n      _CPimg.naturalWidth = __CPimgNaturalWidth;\n\n      _CPimg.on(_CPbinds);\n    } // called after the image is inserted, so that we can update the size\n\n\n    function __CPimgInserted() {\n      if (_CPimg._loaded) {\n        __CPimgUpdateSize();\n      }\n    }\n\n    function __CPimgResetDomSize(el) {\n      if (el) {\n        el.removeAttr('width height');\n        el.css({\n          width: 'auto',\n          height: 'auto'\n        });\n      }\n    }\n\n    function __CPimgUpdateSize() {\n      __CPimgResetDomSize(_CPimg); // IE11 could return incorrect image size if it wasn't resized till this time.\n\n\n      var naturalWidth = _CPimg.naturalWidth() || 0,\n          naturalHeight = _CPimg.naturalHeight() || 0,\n          width = naturalWidth || _CPimg.width(),\n          height = naturalHeight || _CPimg.height();\n\n      var oldSize = __CPgetSize();\n\n      var oldZoom = __CPgetFitZoom();\n\n      var sizechanged = false;\n\n      if (Browser.Explorer && !_isThumbnailer && width < 40 && _CPimg._zoom > __getMinZoom()) {\n        //Looks like that IE returned incorrect image size. Try to use old values.\n        width = oldSize.width * oldZoom;\n        height = oldSize.height * oldZoom;\n      }\n\n      if (width === 0 || height === 0) {\n        return;\n      }\n\n      if (!_CPimg._tiled) {\n        _CPimg._size.width = Math.round(width / _CPimg._zoom);\n        _CPimg._size.height = Math.round(height / _CPimg._zoom);\n      }\n\n      if (_CPimg._viewrotation === 90 || _CPimg._viewrotation === 270) {\n        _CPimg._size = __CPimgSwapSizeSides(_CPimg._size);\n      }\n\n      if (_CPimg._size.width !== _page.size.width || _CPimg._size.height !== _page.size.height) {\n        if (!__closeToEqual(_CPimg._size.width, oldSize.width) || !__closeToEqual(_CPimg._size.height, oldSize.height)) {\n          sizechanged = true;\n\n          _controllers.document.setPageSize(__getPageIndex(), _CPimg._size);\n        }\n      } //HACK for Edge browser. See details in TFS-1135567\n\n\n      if (_controllers.document.getPageSize(__getPageIndex()) === null) {\n        sizechanged = true;\n\n        _controllers.document.setPageSize(__getPageIndex(), _CPimg._size);\n      }\n\n      if (_config.forcepagefit) {\n        __CPimgFit();\n      } else {\n        // one last scale if the image returned from the server still isn't the right size\n        if (_CPimg._zoom !== _config.zoom || sizechanged || _CPimg._viewrotation !== 0) {\n          __CPimgScale();\n        }\n      }\n\n      var scaledSize = __CPgetScaledSize();\n\n      if (sizechanged) {\n        _CPimg.trigger({\n          type: 'pagesizechanged',\n          image: _CPimg,\n          index: __getPageIndex(),\n          width: _CPimg._size.width,\n          height: _CPimg._size.height,\n          dx: Math.round(scaledSize.width - oldSize.width * oldZoom),\n          dy: Math.round(scaledSize.height - oldSize.height * oldZoom)\n        });\n      }\n\n      _CPimg.trigger({\n        type: 'pageresize',\n        image: _CPimg,\n        index: __getPageIndex(),\n        width: scaledSize.width,\n        height: scaledSize.height\n      });\n    }\n\n    function __CPimgDispose() {\n      _CPimg.off(_CPbinds);\n\n      _CPimg._page = null;\n      _CPimg = null;\n    }\n\n    function __CPimgZoomAsync(ani, callback) {\n      if (__CPimgNeedsZoom() && (!_CPimg._size.isEmpty() || _CPimg._tiled)) {\n        if (typeof callback === 'function') {\n          _CPcallback.push(callback);\n        }\n\n        _CPimg._prevzoom = _CPimg._reqzoom;\n\n        if (ani && !_state.loading) {\n          // don't add the callback call to the animation because we\n          // need to wait until the image is finished loading to call it\n          if (_CPimg._tiled) {\n            _CPimg.find('img').each(function () {\n              var img = atalaJquery(this);\n              img.animate({\n                'height': Math.round(img.height() / _CPimg._reqzoom * __CPgetFitZoom()),\n                'width': Math.round(img.width() / _CPimg._reqzoom * __CPgetFitZoom())\n              }, {\n                duration: _zmd,\n                easing: 'easeOutQuad',\n                complete: __CPimgZoomed,\n                queue: false\n              }); //end of animate method\n            });\n          } else {\n            _CPimg.animate({\n              'height': Math.round(_CPimg._size.height * __CPgetFitZoom()),\n              'width': Math.round(_CPimg._size.width * __CPgetFitZoom())\n            }, {\n              duration: _zmd,\n              easing: 'easeOutQuad',\n              complete: __CPimgZoomed,\n              queue: false\n            });\n          }\n        } else {\n          __CPimgScale();\n\n          __CPimgZoomed();\n        }\n      } else {\n        if (typeof callback === 'function') {\n          callback.call(this, _CPimg);\n        }\n      }\n    }\n\n    function __CPimgNeedsZoom() {\n      if (!_CPimg._loaded && !_CPimg._tiled) {\n        return false;\n      } // we are not scaling scalar images past one, so fitzoom is never close to _reqzoom if > 1. compensate that to avoid unnecessary work.\n\n\n      var alreadyScaled = !_page.vector && _CPimg._reqzoom === 1 && _CPimg._prevzoom === 1 && __CPgetFitZoom() > 1;\n      var close = __closeToEqual(_CPimg._reqzoom, __CPgetFitZoom()) || alreadyScaled;\n\n      if (!close) {\n        // sometimes the zoom changes are so close that the image will round to the same size\n        var dw = Math.abs(_CPimg._reqzoom * _CPimg._size.width - __CPgetFitZoom() * _CPimg._size.width);\n        var dh = Math.abs(_CPimg._reqzoom * _CPimg._size.height - __CPgetFitZoom() * _CPimg._size.height); // is the delta of the change smaller than one pixel?\n\n        if (dw < 1 && dh < 1) {\n          close = true;\n        }\n      }\n\n      return !close || __CPimgNeedsScale();\n    }\n\n    function __CPimgNeedsScale() {\n      return !__closeToEqual(_CPimg._scaledzoom, __CPgetFitZoom());\n    }\n\n    function __CPimgZoomed() {\n      var fitZoom = __CPgetFitZoom();\n\n      _CPimg.trigger({\n        type: 'pagezoom',\n        index: __getPageIndex(),\n        height: Math.round(_CPimg._size.height * fitZoom),\n        width: Math.round(_CPimg._size.width * fitZoom),\n        prevzoom: _CPimg._prevzoom,\n        zoom: fitZoom\n      });\n\n      if (_state.prpr === 0) {\n        __CPimgLoad();\n      } else {\n        __CPcompleted();\n      }\n    }\n\n    function __CPimgScale() {\n      var naturalSizeThreshold = 0.01;\n\n      var physicalSize = __CPgetScaledSize(undefined, __CPgetSourceSize());\n\n      var viewSize = __CPgetScaledSize();\n\n      var naturalWidth = _CPimg.naturalWidth() || 0;\n      var naturalHeight = _CPimg.naturalHeight() || 0; // explicit size could cause image corruption if it's not exactly corresponds to natural size.\n      // due to floating point calculations, expected and received from server size of the image not always exactly same.\n      // even one pixel differences in size could cause blur effect on image. So if there is really minor differences\n      // in expected and natural sizes, then it's better to leave image as is.\n\n      var widthPreserved = naturalWidth && Math.abs(naturalWidth - physicalSize.width) / physicalSize.width < naturalSizeThreshold;\n      var heightPreserved = naturalHeight && Math.abs(naturalHeight - physicalSize.height) / physicalSize.height < naturalSizeThreshold;\n\n      if (!widthPreserved || !heightPreserved) {\n        //Scale each subimages\n        if (_CPimg._tiled && naturalHeight !== 0 && naturalWidth !== 0) {\n          _CPimg.find('img').each(function () {\n            var img = atalaJquery(this);\n            var iheight = img.prop('naturalHeight');\n            var iwidth = img.prop('naturalWidth');\n\n            if (iheight !== 0 && iwidth !== 0) {\n              img.height(iheight * __CPgetFitZoom());\n              img.width(iwidth * __CPgetFitZoom());\n            }\n          });\n        } else {\n          _CPimg.height(physicalSize.height);\n\n          _CPimg.width(physicalSize.width);\n        }\n      }\n\n      _CPimg._domEl.width(viewSize.width);\n\n      _CPimg._domEl.height(viewSize.height);\n\n      _CPimg._scaledzoom = __CPgetFitZoom();\n\n      if (_CPimg._tiled) {\n        __CPimgRotateTiledView(_CPimg._viewrotation);\n      } else {\n        __CPimgRotateView(_CPimg._viewrotation);\n      }\n\n      __repositionPageNumber(__getPageIndex(), viewSize.width, viewSize.height);\n    }\n\n    function __CPimgError() {\n      // TODO: attempt to reload image\n      __CPcompleted();\n\n      var pageindex = __getPageIndex();\n\n      __throwError('ImageError', 'Image at frameIndex ' + pageindex + ' failed to load.');\n    }\n\n    function __CPimgFit() {\n      var scale = __CPimgCalculateFit();\n\n      __CPsetFitMultiplier(scale / _config.zoom);\n\n      __CPimgScale();\n    }\n\n    function __CPimgCalculateFit(size) {\n      var scale = 1;\n      size = size || _CPimg._size;\n      var destSize = {\n        width: _config.forcepagesize.width * (_isThumbnailer ? 1 : _config.zoom),\n        height: _config.forcepagesize.height * (_isThumbnailer ? 1 : _config.zoom)\n      };\n\n      if (destSize.width < 1 || destSize.height < 1) {\n        destSize.width = _page.size.width * _config.zoom;\n        destSize.height = _page.size.height * _config.zoom;\n      }\n\n      if (size.width / destSize.width > size.height / destSize.height) {\n        // size to the width\n        scale = destSize.width / size.width;\n      } else {\n        // size to the height\n        scale = destSize.height / size.height;\n      }\n\n      return scale;\n    } // loading completed (regardless of errors), call the callback(s)\n\n\n    function __CPcompleted() {\n      if (_CPcallback.length > 0) {\n        __callFunctionArray(_CPcallback, _CPimg);\n      }\n    }\n\n    function __CPimgNeedsRotate() {\n      // reqangle - is specified relative to the server source image.\n      // checks whether need to execute rotation in general - either view rotation or image reload.\n      var reqangle = _controllers.document.getPageRotation(__getPageIndex());\n\n      return _CPimg._viewrotation === 0 && reqangle !== _CPimg._rotation || _CPimg._viewrotation !== 0;\n    }\n\n    function __CPimgNeedsViewRotate() {\n      // reqangle - is specified relative to the server source image.\n      // if no view rotation - just check whether we already have what we want from server\n      // else check if current _CPimg._viewrotation + _CPimg._rotation already gives us required angle\n      var reqangle = _controllers.document.getPageRotation(__getPageIndex());\n\n      return _CPimg._viewrotation === 0 && reqangle !== _CPimg._rotation || _CPimg._viewrotation !== 0 && (_CPimg._viewrotation + _CPimg._rotation) % 360 !== reqangle;\n    }\n\n    function __CPimgRotateAsync(callback) {\n      if (typeof callback === 'function') {\n        _CPcallback.push(callback);\n      }\n\n      if (__CPimgNeedsRotate()) {\n        var angle = _controllers.document.getPageRotation(__getPageIndex());\n\n        if (__CPimgNeedsViewRotate()) {\n          if (_CPimg && _CPimg._page) {\n            angle = (360 + angle - _CPimg._rotation) % 360;\n\n            if (!_CPimg._tiled && _CPimg._loaded) {\n              __CPimgRotateView(angle);\n\n              __CPimgUpdateSize();\n            } else if (_CPimg._tiled) {\n              //Allow rotation for partially loaded tiled image\n              __CPimgRotateTiledView(angle);\n\n              __CPimgTiledUpdateSize();\n\n              __CPimgClearTilesAtRotate(angle);\n            }\n          }\n        }\n\n        if (_state.prpr === 0 && _CPimg._loaded) {\n          __CPimgLoad();\n\n          return;\n        }\n      }\n\n      __CPcompleted();\n    }\n\n    function __CPimgResetViewRotationValue() {\n      _CPimg._viewrotation = 0;\n    }\n\n    function __CPimgTiledUpdateSize() {\n      __CPimgResetDomSize(_CPimg);\n\n      var pindex = __getPageIndex();\n\n      var size = _controllers.document.getPageSize(pindex);\n\n      if (_CPimg._viewrotation === 90 || _CPimg._viewrotation === 270) {\n        var newSize = __CPimgSwapSizeSides(size);\n\n        _CPimg._size.width = newSize.width;\n        _CPimg._size.height = newSize.height;\n\n        _controllers.document.setPageSize(pindex, _CPimg._size);\n      }\n\n      if (_config.forcepagefit) {\n        __CPimgFit();\n      } else {\n        // one last scale if the image returned from the server still isn't the right size\n        if (_CPimg._zoom !== _config.zoom || _CPimg._viewrotation !== 0) {\n          __CPimgScale();\n        }\n      }\n    }\n\n    function __CPimgClearTilesAtRotate(angle) {\n      if (angle !== 0) {\n        _CPimg.find('img').each(function () {\n          var oldImg = atalaJquery(this);\n          var isize = {\n            width: oldImg.width(),\n            height: oldImg.height()\n          };\n\n          if (angle === 90 || angle === 270) {\n            isize = __CPimgSwapSizeSides(isize);\n          }\n\n          var tileplace = oldImg.parent();\n\n          if (isize.width !== 0 && isize.height !== 0) {\n            tileplace.width(isize.width);\n            tileplace.height(isize.height);\n          }\n\n          tileplace.addClass(domclasses.atala_page_loading);\n          var ni = atalaJquery(new Image());\n          ni.css('display', 'none');\n          tileplace.children().replaceWith(ni);\n        });\n      }\n    }\n\n    function __CPimgRotateView(angle) {\n      var srcSize = __CPgetSourceSize();\n\n      var size = __CPgetScaledSize(undefined, srcSize);\n\n      var dx = 0,\n          dy = 0,\n          transform = '';\n\n      if (angle === 90 || angle === 270) {\n        dx = (size.height - size.width) / 2;\n\n        if (_isThumbnailer && srcSize.width < srcSize.height) {\n          dx = 0;\n        }\n\n        dy = (size.width - size.height) / 2;\n        size = __CPimgSwapSizeSides(size);\n      }\n\n      if (angle !== 0) {\n        transform += ' translate(' + dx + 'px,' + dy + 'px)';\n        transform += 'rotate(' + angle + 'deg)';\n\n        _CPimg.css(__htmlTransformStyle(transform));\n      } else {\n        _CPimg.css(__htmlTransformStyle(''));\n      }\n\n      __CPimgGetDom().css({\n        width: size.width,\n        height: size.height\n      });\n\n      _CPimg._viewrotation = angle;\n    }\n\n    function __CPimgRotateTiledView(angle) {\n      //Swap Size Sides\n      var srcSize = __CPgetSourceSize();\n\n      var size = __CPgetScaledSize(undefined, srcSize);\n\n      if (angle === 90 || angle === 270) {\n        size = __CPimgSwapSizeSides(size);\n      }\n\n      __CPimgGetDom().css({\n        width: size.width,\n        height: size.height\n      });\n\n      _CPimg._viewrotation = angle;\n    }\n\n    function __CPimgInvalidate(params, callback) {\n      if (typeof params === 'function') {\n        callback = params;\n        params = {};\n      }\n\n      _loadParams = atalaJquery.extend(true, {}, params);\n      _loadParams.atala_cb = Math.floor(Math.random() * 1000000000);\n\n      if (typeof callback === 'function') {\n        _CPcallback.push(callback);\n      }\n\n      __CPimgLoad(true);\n    }\n\n    function __CPimgSwapSizeSides(size) {\n      var w = size.width;\n      size.width = size.height;\n      size.height = w;\n      return size;\n    }\n\n    return _CPimg;\n  } // creates a vertical or horizontal scrollbar with tray to mimic real scrollbars\n  // p: jQuery parent object to append div to\n  // sd: ScrollDirection enum indicating direction\n\n\n  function __createScrollbar(p, sd) {\n    var baseStyle = 'overflow:scroll; position:absolute; background-color:Transparent;';\n\n    var scrollTip = __createDiv(p);\n\n    scrollTip.css({\n      'position': 'absolute',\n      'display': 'none',\n      'background-color': 'white'\n    });\n    var scrollbar = null;\n    var explicitSize = false;\n\n    if (sd === ScrollDirection.Horizontal) {\n      if (Browser.Firefox) {\n        scrollbar = atalaJquery('<div class=\"atala_scrollbar_firefox_x\"></div>').appendTo(p);\n      } else {\n        scrollbar = atalaJquery('<div class=\"atala_scrollbar_x\"></div>').appendTo(p);\n      }\n\n      scrollbar._tray = atalaJquery('<div/>').css('height', '1px').appendTo(scrollbar);\n    } else {\n      // Seems like FF needs width for the vertical bar (it creates scrollbar from the right of the 1px-width div, and not expanding it)\n      if (Browser.Firefox) {\n        scrollbar = atalaJquery('<div class=\"atala_scrollbar_firefox_y\"></div>').css('width', __getScrollbarWidth() + 1 + 'px;').appendTo(p);\n        explicitSize = true;\n      } else {\n        scrollbar = atalaJquery('<div class=\"atala_scrollbar_y\"></div>').appendTo(p);\n      }\n\n      scrollbar._explicitSize = explicitSize;\n      scrollbar._tray = atalaJquery('<div/>').css('width', '1px').appendTo(scrollbar);\n    }\n\n    __extendScroller(scrollbar);\n\n    scrollbar._ratio = 1;\n    scrollbar.ScrollDirection = sd;\n    scrollbar._tooltip = scrollTip;\n    scrollbar._pagenum = -1;\n    scrollbar._scrollSize = 0;\n    scrollbar.pageNum = __SBsetPageNum;\n    scrollbar.scrollbarHeight = __SBgetRealHeight;\n    scrollbar.scrollSize = __SBsetScrollSize;\n    scrollbar.ratio = __SBsetRatio;\n\n    function __SBsetPageNum(i) {\n      scrollbar._pagenum = i;\n    }\n\n    function __SBgetRealHeight() {\n      return scrollbar.height() - scrollbar[0].clientHeight;\n    }\n\n    function __SBsetScrollSize(n) {\n      scrollbar._scrollSize = n;\n    }\n\n    function __SBsetRatio(r) {\n      scrollbar._ratio = r;\n    }\n\n    function __SBonScroll() {\n      if (!scrollbar.propagationPaused()) {\n        clearTimeout(scrollbar._tooltip._timeout);\n\n        _dom.scroller.stop();\n\n        _dom.scroller.pauseEventPropagation(true);\n\n        var tooltipCss = {};\n\n        if (scrollbar.ScrollDirection === ScrollDirection.Vertical) {\n          _dom.scroller.scrollTop(scrollbar[0].scrollTop * scrollbar._ratio);\n\n          if (_isSinglePageMode) {\n            scrollbar._pagenum = __getCurrIndex() + 1;\n          } else {\n            scrollbar._pagenum = __SBpageNumberFromPos(scrollbar, scrollbar[0].scrollTop);\n          }\n\n          tooltipCss.right = scrollbar.outerWidth() + 10 + 'px';\n          tooltipCss.top = 16 + Math.round((scrollbar[0].offsetHeight - 48) / scrollbar[0].scrollHeight * scrollbar[0].scrollTop) + 'px';\n          scrollbar.attr('aria-valuenow', scrollbar.scrollTop() / scrollbar._max);\n        } else if (scrollbar.ScrollDirection === ScrollDirection.Horizontal) {\n          _dom.scroller.scrollLeft(scrollbar[0].scrollLeft * scrollbar._ratio);\n\n          if (_isSinglePageMode) {\n            scrollbar._pagenum = __getCurrIndex() + 1;\n          } else {\n            scrollbar._pagenum = __SBpageNumberFromPos(scrollbar, scrollbar[0].scrollLeft);\n          }\n\n          tooltipCss.bottom = scrollbar.outerHeight() + 10 + 'px';\n          tooltipCss.left = 16 + Math.round((scrollbar[0].offsetWidth - 48) / scrollbar[0].scrollWidth * scrollbar[0].scrollLeft) + 'px';\n          scrollbar.attr('aria-valuenow', scrollbar.scrollLeft() / scrollbar._max);\n        } // only show the tooltip on the main scrolling direction\n\n\n        if (scrollbar.ScrollDirection === _config.direction && _config.showpagenumbertooltip) {\n          if (scrollbar._tooltip.css('display') === 'none') {\n            scrollbar._tooltip.css(tooltipCss);\n\n            scrollbar._tooltip.show();\n          }\n\n          if (_config.showpagenumbertooltip) {\n            scrollbar._tooltip.html('Page ' + scrollbar._pagenum);\n          }\n\n          scrollbar._tooltip._timeout = setTimeout(__SBhideToolTip, 1000);\n        }\n      }\n    }\n\n    function __SBhideToolTip() {\n      scrollbar._tooltip.hide();\n\n      if (_page.number !== scrollbar._pagenum && !__isPageInView(scrollbar._pagenum)) {\n        __showPage(scrollbar._pagenum);\n      }\n\n      __redrawVisiblePages();\n    }\n\n    function __SBpageNumberFromPos(scrollbar, pos) {\n      if (_config.forcepagefit) {\n        // if we are sure all pages fit in scrollable area, it's possible to synchronize page index on toolbar and tooltip value.\n        pos *= scrollbar._ratio;\n        var point = scrollbar.ScrollDirection === ScrollDirection.Vertical ? {\n          x: 0,\n          y: pos\n        } : {\n          x: pos,\n          y: 0\n        };\n        return __getUIIndexFromPos(point.x, point.y) + 1;\n      } else {\n        return Math.floor(pos / (scrollbar._max / _controllers.document.getPageCount())) + 1;\n      }\n    }\n\n    scrollbar.on({\n      scroll: __SBonScroll\n    });\n    return scrollbar;\n  } // removes _tooltip._timeout for scrollbar. It could be needed when reinitializing viewer.\n\n\n  function __resetScrollbarTimeout(scrollbar) {\n    if (scrollbar && scrollbar._tooltip) {\n      clearTimeout(scrollbar._tooltip._timeout);\n\n      scrollbar._tooltip.hide();\n    }\n  } // adds new functionality to the given scroller\n  // obj: jQuery scrollable object to append functions to\n\n\n  function __extendScroller(obj) {\n    function __scrollFinished() {\n      obj.off(sEvent);\n      obj.resumeEventPropagation();\n    }\n\n    var sEvent = {\n      scroll: __scrollFinished\n    };\n    obj._pauseEP = 0;\n\n    obj.propagationPaused = function () {\n      return obj._pauseEP > 0;\n    };\n\n    obj.pauseEventPropagation = function (resumeAfterScroll) {\n      obj._pauseEP++;\n\n      if (resumeAfterScroll) {\n        obj.on(sEvent);\n      }\n    };\n\n    obj.resumeEventPropagation = function () {\n      if (obj._pauseEP > 0) {\n        obj._pauseEP--;\n      }\n    };\n  } // #endregion\n  // #region Helper functions\n  // gets the number of page divs needed to correctly display the current\n  // document when at the minimum zoom level.\n\n\n  function __calculatePageDivCount(z) {\n    var vps = __getViewportSize();\n\n    var psz = __getClientPageDivSize(0, z); //TFS 1491650 If viewport size is zero (or less in the case of FF), it is assumed that it is hidden\n\n\n    if (!_state.hidden && vps.height <= 0 && vps.width <= 0) {\n      _state.hidden = true;\n\n      __startObserver();\n    } // calculate smallest page size that user could achieve. For WDT size is fixed and forcepagefit enabled, so we could assume first page as constant.\n\n\n    psz.width = _page.smallest.width > 0 && _page.smallest.width < psz.width && !_isThumbnailer ? _page.smallest.width : psz.width;\n    psz.height = _page.smallest.height > 0 && _page.smallest.height < psz.height && !_isThumbnailer ? _page.smallest.height : psz.height;\n    var hdc = Math.ceil(vps.width / psz.width) + 2; // add two more for edges\n\n    var vdc = Math.ceil(vps.height / psz.height) + 2; // add two more for edges\n\n    var pdc;\n\n    if (_config.tabular) {\n      if (_config.direction === ScrollDirection.Vertical && _config.columns > 0) {\n        hdc = _config.columns;\n      } else if (_config.direction === ScrollDirection.Horizontal && _config.rows > 0) {\n        vdc = _config.rows;\n      }\n\n      pdc = hdc * vdc;\n    } else if (_config.direction === ScrollDirection.Vertical) {\n      pdc = vdc;\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      pdc = hdc;\n    }\n\n    return pdc;\n  } // determines if two numbers are close enough to equal\n\n\n  function __closeToEqual(n1, n2) {\n    return n1 + 0.001 > n2 && n1 - 0.001 < n2;\n  } // attempts to throw away a dom element by removing it from its parent\n  // then adding it to a div, and clearing that div\n\n\n  function __garbageCollectObject(o) {\n    try {\n      if (o.parentNode) {\n        o.parentNode.removeChild(o);\n      }\n\n      _garbage.appendChild(o);\n\n      _garbage.innerHTML = ''; // eslint-disable-next-line no-empty\n    } catch (e) {}\n  } // calls each function within an array of functions\n  // arr: array of functions\n\n\n  function __callFunctionArray(arr) {\n    var args = Array.prototype.slice.call(arguments, 1);\n\n    while (arr.length) {\n      arr.shift().apply(this, args);\n    }\n  } // gets the minimum zoom level based on the minimum page width\n\n\n  function __getMinZoom() {\n    return _page.size.width !== 0 ? _config.minwidth / _page.size.width : 1;\n  } // gets the maximum zoom level based on the maximum page width\n\n\n  function __getMaxZoom() {\n    return _page.size.width !== 0 ? _config.maxwidth / _page.size.width : 1;\n  } // gets the client based page size, ignoring zoom when something else has changed it\n  // i: integer, frame index\n  // z: float, desired zoom to calculate the size with [optional]\n  // b: bool, add borders\n\n\n  function __getClientPageDivSize(i, z, b) {\n    if (_controllers.document.getPageCount() <= 0) {\n      return {\n        width: 0,\n        height: 0\n      };\n    }\n\n    b = b === undefined ? true : b;\n\n    if (_state.newpagedivsize) {\n      // we ignore index when the pagedivs have been resized\n      var cps = {\n        width: _state.newpagedivsize.width,\n        height: _state.newpagedivsize.height\n      };\n      var bSize = _config.showpageborder && b ? _config.pageborderwidth * 2 : 0;\n      var scale = (z || _config.zoom) / _state.newpagedivfullzoom;\n      cps.height = Math.round(cps.height * scale) + bSize;\n      cps.width = Math.round(cps.width * scale) + bSize;\n      return cps;\n    } else {\n      return __getClientPageSize(i, z || _config.zoom, _config.showpageborder && b);\n    }\n  } // gets the page size of the given frame index, including borders and zoom\n  // i: integer, frame index\n  // z: float, desired zoom to calculate the size with\n  // b: bool, add borders\n\n\n  function __getClientPageSize(i, z, b) {\n    // creates a size object clone so we don't modify the original size\n    var cps = atalaJquery.extend({}, __getPageSize(i));\n    var bSize = b ? _config.pageborderwidth * 2 : 0;\n    z = z * __getPageFitMultiplier(i);\n    cps.height = Math.round(cps.height * z) + bSize;\n    cps.width = Math.round(cps.width * z) + bSize;\n    return cps;\n  } // gets the frame index that should be located at the given coordinates\n  // x: integer, position on the x-axis\n  // y: integer, position on the y-axis\n\n\n  function __getIndexFromPos(x, y) {\n    return __getPageOffsets(null, x, y).index;\n  } // gets the frame index that should be located at the given coordinates\n  // taking into account current _config.pageselectlocation setting\n  // x: integer, position on the x-axis\n  // y: integer, position on the y-axis\n\n\n  function __getUIIndexFromPos(x, y) {\n    //Bug 1457056: If scroller reached the end of document, return the target page number\n    var maxSize = __getMaxDocumentSize();\n\n    var vs = __getViewportSize();\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      var dy = 0;\n\n      if (_dom.scrollH) {\n        dy = 1; //If scroller is disabled viewer can scroll under it\n\n        if (_dom.scrollH.find('div').css('display') === 'none' && !Browser.Firefox) {\n          dy = _dom.scrollH.outerHeight(true);\n        }\n      }\n\n      if (y >= maxSize.height - vs.height - dy && _state.scrollTarget.Page > 0) {\n        return _state.scrollTarget.Page - 1;\n      }\n    }\n\n    var dx = _dom.scrollV && _dom.scrollV.find('div').css('display') !== 'none' ? 1 : 0;\n\n    if (_config.direction === ScrollDirection.Horizontal) {\n      if (x === maxSize.width - vs.width - dx && _state.scrollTarget.Page > 0) {\n        return _state.scrollTarget.Page - 1;\n      }\n    }\n\n    var select = {\n      x: x + _config.pageselectlocation.x * vs.width,\n      y: y + _config.pageselectlocation.y * vs.height\n    };\n    return __getIndexFromPos(select.x, select.y);\n  } // gets the DOM offsets of a DOM object\n  // o: DOM object\n  // stop: DOM object to get relative position to\n\n\n  function __getDomOffsets(o, stop) {\n    var ret = {\n      left: 0,\n      top: 0\n    };\n\n    for (var obj = o; obj != null && obj !== stop; obj = obj.offsetParent) {\n      ret.left += obj.offsetLeft;\n      ret.top += obj.offsetTop;\n    }\n\n    return ret;\n  }\n\n  var _maxDocSize = {\n    height: 0,\n    isEmpty: function isEmpty() {\n      return this.width === 0 && this.height === 0;\n    },\n    width: 0,\n    zero: function zero() {\n      this.width = 0;\n      this.height = 0;\n    },\n    zoom: 1\n  }; // gets the maximum document size at the current zoom level by calculating it once\n\n  function __getMaxDocumentSize() {\n    if (_maxDocSize.isEmpty() || _maxDocSize.zoom !== _config.zoom) {\n      var offsets = __getPageOffsets(null, null, null, _config.zoom);\n\n      _maxDocSize.height = offsets.height;\n      _maxDocSize.width = offsets.width;\n      _maxDocSize.zoom = _config.zoom;\n    }\n\n    return _maxDocSize;\n  }\n\n  function __recalculateMaxDocumentSize() {\n    _maxDocSize.zero();\n\n    __getMaxDocumentSize();\n  } // gets the offsets of the page at the given index or at the given position}\n\n\n  function __getPageOffsets(i, x, y, z) {\n    return __getPageRangeOffsets(0, i, x, y, z);\n  } // gets the offsets of the page range at the given index or at the given position\n  // i: integer, frame index [nullable]\n  // x: integer, position on the x-axis [nullable]\n  // y: integer, position on the y-axis [nullable]\n  // z: float, desired zoom to calculate the offsets with [optional]\n\n\n  function __getPageRangeOffsets(start, end, x, y, z) {\n    if (_config.tabular) {\n      return __getTabularPageRangeOffsets(start, end, x, y, z);\n    }\n\n    var pgcount = _controllers.document.getPageCount();\n\n    start = start ? start : 0;\n    end = !!end || end === 0 ? end : pgcount;\n\n    if (_isSinglePageMode) {\n      pgcount = 1; // _controllers.document.getPageCount();\n\n      start = 0; // start ? start : 0;\n\n      end = 0; //!!end || end === 0 ? end : pgcount;\n    }\n\n    var retSize = {\n      'height': 0,\n      'width': 0,\n      'index': start\n    };\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      var tmpH = null;\n\n      for (var j = start; j < pgcount && j < end && (retSize.height + (tmpH = __getClientPageDivSize(j, z).height) <= y || y == null); j++) {\n        retSize.height += tmpH + _config.pagespacing;\n        retSize.index++;\n      }\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      var tmpW = null;\n\n      for (var k = start; k < pgcount && k < end && (retSize.width + (tmpW = __getClientPageDivSize(k, z).width) <= x || x == null); k++) {\n        retSize.width += tmpW + _config.pagespacing;\n        retSize.index++;\n      }\n    }\n\n    if (retSize.index >= pgcount && pgcount > 0) {\n      retSize.index = pgcount - 1;\n    }\n\n    return retSize;\n  }\n\n  function __getTabularPageRangeOffsets(start, end, x, y, z) {\n    if (start > end) return {\n      width: 0,\n      height: 0,\n      index: end\n    };\n\n    var startOffset = __getTabularPageOffsets(start, x, y, z);\n\n    var endOffset = __getTabularPageOffsets(end, x, y, z);\n\n    endOffset.height = _config.direction === ScrollDirection.Vertical ? endOffset.height - startOffset.height : endOffset.height;\n    endOffset.width = _config.direction === ScrollDirection.Horizontal ? endOffset.width - startOffset.width : endOffset.width;\n    return endOffset;\n  } // gets the offsets of the page at the given index or at the given position\n  // i: integer, frame index [nullable]\n  // x: integer, position on the x-axis [nullable]\n  // y: integer, position on the y-axis [nullable]\n  // z: float, desired zoom to calculate the offsets with [optional]\n\n\n  function __getTabularPageOffsets(i, x, y, z) {\n    var pgcount = _controllers.document.getPageCount();\n\n    var retSize = {\n      'height': 0,\n      'width': 0,\n      'index': 0\n    };\n\n    var offset = __getTabularIndexOffset(z);\n\n    i = i == null ? i = pgcount : i;\n    var cols, rows;\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      cols = offset || 1;\n      rows = Math.ceil(pgcount / cols);\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      rows = offset || 1;\n      cols = Math.ceil(pgcount / rows);\n    } //\t\tconst tmpW = 0;\n    //\t\tconst tmpH = 0;\n\n\n    var size = __getClientPageDivSize(0, z);\n\n    size.width += _config.pagespacing;\n    size.height += _config.pagespacing;\n    var row = y == null ? Math.floor(i / cols) : Math.floor(y / size.height);\n    var col = x == null ? i % cols : Math.ceil(x / size.width);\n    retSize.height = row * size.height;\n    retSize.width = col * size.width;\n    retSize.index = row * cols + col;\n\n    if (retSize.index >= pgcount && pgcount > 0) {\n      retSize.index = pgcount - 1;\n    }\n\n    return retSize;\n  } // gets the number of pages that are skipped over when scrolling by rows or columns\n  // z: float, desired zoom to calculate the offsets with [optional]\n\n\n  function __getTabularIndexOffset(z) {\n    if (_isSinglePageMode) {\n      return 1;\n    }\n\n    var offset = 1;\n\n    if (_config.tabular) {\n      var pageSpacing = _config.pagespacing || 0;\n\n      var pageSize = __getClientPageDivSize(0, z);\n\n      if (_config.direction === ScrollDirection.Vertical) {\n        offset = Math.floor(_dom.content.width() / pageSize.width); // check if pages are not fit because of page div margins\n\n        offset = Math.min(offset, Math.floor((_dom.content.width() - offset * pageSpacing) / pageSize.width));\n      } else if (_config.direction === ScrollDirection.Horizontal) {\n        offset = Math.floor(_dom.content.height() / pageSize.height);\n        offset = Math.min(offset, Math.floor((_dom.content.height() - offset * pageSpacing) / pageSize.height));\n      }\n    }\n\n    return offset || 1;\n  }\n\n  function __getServerPageSize(i, extraRotation) {\n    var size = __getPageSize(i);\n\n    var angle = __getPageRotation(i) + (extraRotation || 0);\n    return angle % 180 === 0 ? size : {\n      width: size.height,\n      height: size.width\n    };\n  } // gets the page size of the given frame index, if available\n  // i: integer, frame index\n\n\n  function __getPageSize(i) {\n    var size = _controllers.document.getPageSize(i);\n\n    return size ? size : _page.size;\n  } //Currently we realize tiling for pdf documents only.\n  //If document can be tiled (i.e. is PDF and tiling.enabled setting is true), if getDocInfo have returned pagesizes array.\n\n\n  function __pageCanBeTiled(threshold, index) {\n    return _controllers.document.canBeTiled(threshold, index);\n  } // calculates the width of native browser scrollbars (used for older browsers)\n\n\n  function __getScrollbarWidth() {\n    var div = __createDiv(atalaJquery('body'));\n\n    var idiv = __createDiv(div);\n\n    div.css({\n      'width': '50px',\n      'height': '50px',\n      'overflow': 'hidden',\n      'position': 'absolute',\n      'visibility': 'hidden'\n    });\n    idiv.css({\n      'width': '100px',\n      'height': '100px'\n    });\n    var w = div.width();\n    div.css({\n      'overflow-y': 'scroll'\n    });\n    var rv = w - div[0].clientWidth;\n    atalaJquery(div).remove();\n    return rv;\n  } // gets the viewable area size, minus scrollbars\n\n\n  function __getViewportSize() {\n    return {\n      'width': _dom.scrollV ? _dom.main.width() - _dom.scrollV.outerWidth() : _dom.main.width(),\n      'height': _dom.scrollH ? _dom.main.height() - _dom.scrollH.outerHeight() : _dom.main.height()\n    };\n  } // returns size of individual stripe in viewport grid\n\n\n  function __getViewportGridStripeSize() {\n    var vs = __getViewportSize();\n\n    var bSize = _config.showpageborder ? _config.pageborderwidth * 2 : 0;\n    var stripeSize = {\n      width: vs.width - bSize,\n      height: vs.height - bSize\n    };\n\n    if (_config.tabular) {\n      if (_config.columns > 1) {\n        stripeSize.width = Math.floor((vs.width - (_config.pagespacing + bSize) * _config.columns) / _config.columns);\n      }\n\n      if (_config.rows > 1) {\n        stripeSize.height = Math.floor((vs.height - (_config.pagespacing + bSize) * _config.rows) / _config.rows);\n      }\n    }\n\n    return stripeSize;\n  }\n\n  function __failStartAsync(reason, callback) {\n    var failed = {\n      status: 'fail',\n      started: false,\n      reason: reason\n    }; // only execute the callback if it exists\n\n    if (typeof callback === 'function') {\n      callback.call();\n    }\n\n    return failed;\n  } // o: DOM object\n  // stop: DOM object to get relative position to\n  // le: int, left edge\n  // te: int, top edge\n  // re: int, right edge\n  // be: int, bottom edge\n\n\n  function __isObjectInRect(o, stop, le, te, re, be) {\n    var pos = __getDomOffsets(o, stop);\n\n    return pos.left <= re && pos.left + o.clientWidth >= le && pos.top <= be && pos.top + o.clientHeight >= te;\n  } // a: Array object\n  // i: index to move from\n  // dest: destination index\n\n\n  function __moveArrayIndexTo(a, i, dest) {\n    if (i < a.length) {\n      a.splice(dest, 0, a.splice(i, 1)[0]);\n      return true;\n    } else {\n      return false;\n    }\n  } // logs status messages to the status div, if present\n  // s: string, message to display\n\n\n  function __status(s) {\n    if (_config.showstatus && _dom.status) {\n      _dom.status.html(s);\n    }\n\n    __triggerEvent({\n      type: 'statusmessage',\n      message: s\n    });\n  } // makes a reference to all events bound using _self.bind\n  // bindargs: arguments object passed into __bindEvents\n  // append: bool, whether the event is being added\n\n\n  function __trackEventBinds(bindargs, append) {\n    var evtDictionary;\n\n    if (bindargs.length === 1 && typeof bindargs[0] === 'object') {\n      // object notation\n      evtDictionary = bindargs[0];\n    } else if (typeof bindargs[0] === 'string') {\n      // string notation\n      evtDictionary = {};\n      var fcn = null;\n\n      if (bindargs.length === 3) {\n        fcn = bindargs[2];\n      } else if (bindargs.length === 2) {\n        fcn = bindargs[1];\n      }\n\n      var keys = bindargs[0].indexOf(' ') > -1 ? bindargs[0].split(' ') : [bindargs[0]];\n\n      for (var i = 0; i < keys.length; i++) {\n        evtDictionary[keys[i]] = fcn;\n      }\n    }\n\n    for (var key in evtDictionary) {\n      if (evtDictionary.hasOwnProperty(key)) {\n        var evtParent = null; // find the right controller parent\n\n        if (key in _events) {\n          evtParent = _events;\n        } else if (_self && key in _self.annotations.events) {\n          evtParent = _self.annotations.events;\n        } else if (_self && key in _self.forms.events) {\n          evtParent = _self.forms.events;\n        } else if (_self && key in _self.document.events) {\n          evtParent = _self.document.events;\n        }\n\n        if (evtParent == null) {\n          // custom event added by user, add to base\n          evtParent = _events;\n        }\n\n        if (evtParent[key] == null) {\n          if (append) {\n            evtParent[key] = [evtDictionary[key]];\n          }\n        } else {\n          if (append) {\n            // bind called\n            evtParent[key].push(evtDictionary[key]);\n          } else {\n            // unbind called\n            if (evtDictionary[key]) {\n              // look for function by reference\n              for (var f = 0; f < evtParent[key].length; f++) {\n                if (evtParent[key][f] === evtDictionary[key]) {\n                  // remove if found\n                  evtParent[key].splice(f, 1);\n                }\n              }\n            } else {\n              evtParent[key].length = 0;\n            }\n          }\n        }\n      }\n    }\n  } // validates (and fixes if possible) the config so we don't have to check the inputs every time we need them\n\n\n  function __validateConfig() {\n    if (_isSinglePageMode) {\n      _config.direction = ScrollDirection.Vertical;\n      _config.tabular = false;\n    } else {\n      _config.direction = _config.direction === ScrollDirection.Vertical || _config.direction === ScrollDirection.Horizontal ? _config.direction : ScrollDirection.Vertical;\n    }\n\n    _config.fitting = _config.fitting === Fitting.None || _config.fitting === Fitting.Best || _config.fitting === Fitting.Width || _config.fitting === Fitting.Height ? _config.fitting : Fitting.Width;\n    _config.pageborderwidth = __validateNumber(_config.pageborderwidth) ? parseInt(_config.pageborderwidth, 10) : 1;\n    _config.pagespacing = __validateNumber(_config.pagespacing) ? parseInt(_config.pagespacing, 10) : 4;\n    _config.showpageborder = _config.showpageborder ? true : false;\n    _config.showpagenumber = _config.showpagenumber ? true : false;\n    _config.showstatus = _config.showstatus ? true : false;\n    _config.zoom = __validateNumber(_config.zoom, true) ? parseFloat(_config.zoom) : 1;\n    _config.scripturl = __validateScriptUrl(_config.scripturl) ? _config.scripturl : _config.scripturl + '/';\n    _config.maxpagebuffersize = _config.maxpagebuffersize > 0 && _config.pagebuffersize < _config.maxpagebuffersize ? _config.maxpagebuffersize : _config.pagebuffersize > 0 ? _config.pagebuffersize + 10 : 50;\n\n    __validateMouseToolConfig();\n\n    __validateUploadConfig();\n  }\n\n  function __validateMouseToolConfig() {\n    if ((_config.mousetool.type === MouseToolType.ZoomArea || _config.mousetool.type === MouseToolType.Selection || _config.mousetool.type === MouseToolType.Text) && !_config.showselecttools) {\n      if (settings.showselecttools === null || settings.showselecttools === undefined) {\n        _config.showselecttools = true;\n      } else {\n        throw 'The mouse tool type is incompatible with \\'showselecttools\\' flag value.' + 'Please change the tool type or enable selection tools.';\n      }\n    }\n  }\n\n  function __validateUploadConfig() {\n    if (!_config.upload) {\n      _config.upload = {\n        enabled: false\n      };\n    }\n\n    var upload = _config.upload;\n\n    if (upload.enabled !== false) {\n      upload.allowedmaxfilesize = IsInteger(upload.allowedmaxfilesize) ? upload.allowedmaxfilesize : Number.MAX_VALUE;\n      upload.allowdragdrop = upload.allowdragdrop ? true : false;\n      upload.allowmultiplefiles = upload.allowmultiplefiles ? true : false;\n      upload.allowedfiletypes = typeof upload.allowedfiletypes === 'string' ? upload.allowedfiletypes : '';\n      upload.uploadpath = typeof upload.uploadpath === 'string' ? upload.uploadpath : '.';\n      upload.filesuploadconcurrency = IsInteger(upload.filesuploadconcurrency) ? upload.filesuploadconcurrency : 1;\n      upload.closeuiafterupload = upload.closeuiafterupload !== false ? true : false;\n    }\n  }\n\n  function __validateScriptUrl(s) {\n    if (s.length > 0) {\n      if (s.indexOf('/', s.length - 1) !== -1 || s.indexOf('\\\\', s.length - 1) !== -1) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return true;\n    }\n  } // checks a number\n  // n: value to check\n  // f: bool, indicates whether to check float\n\n\n  function __validateNumber(n, f) {\n    if (f) {\n      return isFinite(parseFloat(n));\n    } else {\n      return isFinite(parseInt(n, 10));\n    }\n  } // #endregion\n  // #region Scrolling\n  // asynchronously sets the scroll position to the given coordinates\n  // x: integer, scroll position on the x-axis\n  // y: integer, scroll position on the y-axis\n  // ani: bool, indicates whether this scroll should animate\n  // dur: int, the length of time for the animation, in milliseconds\n  // callback: function to execute after the scroll is done animating\n\n\n  function __setScrollPositionAsync(x, y, ani, dur, callback) {\n    if (callback == null && typeof dur === 'function') {\n      callback = dur;\n      dur = null;\n    }\n\n    x = x == null ? _dom.scroller.scrollLeft() : x;\n    y = y == null ? _dom.scroller.scrollTop() : y; // this fills the edge div with enough space to allow scrolling there\n\n    if (_config.direction === ScrollDirection.Horizontal) {\n      if (x > _dom.viewport.width()) {\n        var maxSize = __getMaxDocumentSize();\n\n        if (x < maxSize.width && _dom.content.width() > 0) {\n          var fillSize = maxSize.width - (_dom.edges[0].width() + _dom.content.width());\n\n          _dom.edges[1].width(fillSize);\n        }\n      }\n    } else if (_config.direction === ScrollDirection.Vertical) {\n      if (y > _dom.viewport.height()) {\n        var mSize = __getMaxDocumentSize();\n\n        if (y < mSize.height && _dom.content.height() > 0) {\n          var fSize = mSize.height - (_dom.edges[0].height() + _dom.content.height());\n\n          _dom.edges[1].height(fSize);\n        }\n      }\n    } // we use 'auto' to tell the mobile browser that this is scrollable with touch\n    // but it breaks Android native 'Browser' programmatic scrolling, so we need\n    // to switch it to 'hidden' before we scroll it programmatically\n    //\t\tif (Browser.Mobile.Android){\n    //\t\t\tconst resetOverflow = function(){\n    //\t\t\t\t_dom.scroller.css({'overflow' : 'auto'});\n    //\t\t\t};\n    //\n    //\t\t\t_dom.scroller.css({'overflow' : 'hidden'});\n    //\n    //\t\t\tcallback = (typeof(callback) === 'function') ? functionFromArray([resetOverflow, callback]) : resetOverflow;\n    //\t\t\tani = false;\n    //\t\t}\n\n\n    _dom.scroller.stop();\n\n    if (ani && !_state.loading && (_state.scrollPos.x !== x || _state.scrollPos.y !== y)) {\n      atalaJquery.when(_dom.scroller.animate({\n        'scrollLeft': x,\n        'scrollTop': y\n      }, {\n        duration: dur || _scd,\n        easing: 'easeOutQuad',\n        queue: false\n      })).done(callback);\n    } else {\n      _dom.scroller.scrollLeft(x);\n\n      _dom.scroller.scrollTop(y);\n\n      if (typeof callback === 'function') {\n        callback.call();\n      }\n    }\n  } // asynchronously scrolls by the given deltas\n  // dx: integer, delta to scroll on the x-axis\n  // dy: integer, delta to scroll on the y-axis\n  // ani: bool, indicates whether this scroll should animate\n  // dur: int, the length of time for the animation, in milliseconds\n  // callback: function to execute after the scroll is done animating\n\n\n  function __setScrollPositionByAsync(dx, dy, ani, dur, callback) {\n    var x = _dom.scroller.scrollLeft() + dx;\n    var y = _dom.scroller.scrollTop() + dy;\n\n    __setScrollPositionAsync(x, y, ani, dur, callback);\n  } // asynchronously scrolls to the next or previous page\n  // inc: incremental amount, positive or negative\n  // callback: function to execute after the scroll is done animating\n\n\n  function __scrollNextPrevAsync(inc, callback) {\n    if (!_dom.scroller.is(':animated')) {\n      //Incorrect offset calculation occurs when  the scroll is called immediately after a file opening.\n      var offsets = __getPageOffsets(_page.number + inc - 1);\n\n      __setScrollPositionAsync(offsets.width, offsets.height, true, callback);\n    } else {\n      // animation couldn't start because one was already going\n      return __failStartAsync('scrolling', callback);\n    }\n  } // adjusts the scrollbar tray height/widths, so that they accurately indicate the size of the document\n\n\n  function __adjustScrollBars() {\n    if (_dom.scrollH && _dom.scrollV) {\n      var maxSize = 30000;\n      var pgcount = _isSinglePageMode ? 1 : _controllers.document.getPageCount(); // When the scrollbars resize, scroll events can happen\n      // pausing event propagation will stop them from setting the main scroller position\n\n      _dom.scrollH.pauseEventPropagation();\n\n      _dom.scrollV.pauseEventPropagation();\n\n      if (_config.direction === ScrollDirection.Vertical) {\n        __adjustSecondaryScrollbar(_dom.scrollH, 'width');\n\n        var pnarg = _isSinglePageMode ? __getCurrIndex() : pgcount - 1;\n        var newH = Math.round(__getPageOffsets(pgcount - 1).height + __getClientPageDivSize(pnarg).height);\n        if (Browser.Firefox) //This code fix several FF issues when scrollbar length counts incorrectly.\n          newH += Math.round(_dom.scrollH.scrollbarHeight());\n\n        _dom.scrollV.scrollSize(newH - (_dom.scrollV.height() - _dom.scrollH.scrollbarHeight() - 1));\n\n        if (newH > maxSize) {\n          _dom.scrollV.ratio(newH / (maxSize - (_dom.scrollV.height() - _dom.scrollH.scrollbarHeight() - 1)));\n\n          _dom.scrollV._tray.height(maxSize);\n        } else {\n          _dom.scrollV._tray.height(newH);\n\n          _dom.scrollV.ratio(1);\n        }\n\n        __adjustScrollbarVisibility(_dom.scrollV);\n      } else if (_config.direction === ScrollDirection.Horizontal) {\n        __adjustSecondaryScrollbar(_dom.scrollV, 'height');\n\n        var _pnarg = _isSinglePageMode ? __getCurrIndex() : pgcount - 1;\n\n        var newW = Math.round(__getPageOffsets(pgcount - 1).width + __getClientPageDivSize(_pnarg).width);\n\n        _dom.scrollH.scrollSize(newW);\n\n        if (newW > maxSize) {\n          _dom.scrollH.ratio(newW / (maxSize - (_dom.scrollH.width() - _dom.scrollV.width() - 1)));\n\n          _dom.scrollH._tray.width(maxSize);\n        } else {\n          _dom.scrollH._tray.width(newW);\n\n          _dom.scrollH.ratio(1);\n        }\n\n        __adjustScrollbarVisibility(_dom.scrollH);\n\n        __adjustEdgeHeights(_pnarg, null);\n      } // calculate max scroll positions\n\n\n      _dom.scrollV._max = Math.max(_dom.scrollV._tray.height() - _dom.scrollV.height(), 0) + 1;\n      _dom.scrollH._max = Math.max(_dom.scrollH._tray.width() - _dom.scrollH.width(), 0) + 1; // done resizing, allow propagation\n\n      _dom.scrollH.resumeEventPropagation();\n\n      _dom.scrollV.resumeEventPropagation();\n    }\n  } // less calculation scrollbar adjust\n\n\n  function __resizeScrollBars(dx, dy) {\n    var maxSize = 30000;\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      if (_dom.scrollV) {\n        _dom.scrollV.scrollSize(Math.max(_dom.scrollV._scrollSize + dy, 0));\n\n        if (_dom.scrollV._ratio === 1 && _dom.scrollV._scrollSize + dy < maxSize) {\n          _dom.scrollV._tray.height(_dom.scrollV._tray.height() + dy);\n\n          _dom.scrollV._max = Math.max(_dom.scrollV._tray.height() - _dom.scrollV[0].clientHeight, 0) + 1;\n        } else {\n          var viewportHeight = _dom.scrollV.height() - _dom.scrollH.scrollbarHeight() - 1;\n          var height = (maxSize - viewportHeight) * _dom.scrollV._ratio;\n\n          if (height + dy > maxSize) {\n            _dom.scrollV.ratio((height + dy) / (maxSize - viewportHeight));\n          } else {\n            __adjustScrollBars();\n          }\n        }\n      }\n\n      __adjustScrollbarVisibility(_dom.scrollV);\n\n      __adjustSecondaryScrollbar(_dom.scrollH, 'width');\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      if (_dom.scrollH) {\n        _dom.scrollH.scrollSize(Math.max(_dom.scrollH._scrollSize + dx, 0));\n\n        if (_dom.scrollH._ratio === 1 && _dom.scrollH._scrollSize + dx < maxSize) {\n          _dom.scrollH._tray.width(_dom.scrollH._tray.width() + dx);\n\n          _dom.scrollH._max = Math.max(_dom.scrollH._tray.width() - _dom.scrollH[0].clientWidth, 0) + 1;\n\n          _dom.scrollH.ratio(_dom.scrollH._scrollSize / _dom.scrollH._max);\n        } else {\n          var viewportWidth = _dom.scrollH.width() - _dom.scrollV.width() - 1;\n          var width = (maxSize - viewportWidth) * _dom.scrollH._ratio;\n\n          if (width + dx > maxSize) {\n            _dom.scrollH.ratio((width + dx) / (maxSize - viewportWidth));\n          } else {\n            __adjustScrollBars();\n          }\n        }\n      }\n\n      __adjustScrollbarVisibility(_dom.scrollH);\n\n      __adjustSecondaryScrollbar(_dom.scrollV, 'height');\n    }\n\n    if (dx !== 0 || dy !== 0) {\n      if (dy !== 0) {\n        var x = _dom.scroller[0].scrollLeft;\n        var y = _dom.scroller[0].scrollTop;\n\n        if (_isSinglePageMode) {\n          __setPageNumber(__getCurrIndex() + 1);\n        } else {\n          __setPageNumber(__getUIIndexFromPos(x, y) + 1);\n        }\n\n        __triggerEvent({\n          type: 'scroll',\n          x: x,\n          y: y,\n          dx: 0,\n          dy: 0\n        });\n      }\n    }\n  }\n\n  function __adjustSecondaryScrollbar(scrollbar, key) {\n    if (!scrollbar || !_dom.pageDivs.length) {\n      return;\n    }\n\n    var cs = Math.round(_page.size[key] * _config.zoom);\n\n    if (_config.tabular) {\n      cs = _dom.content[key]();\n    } else {\n      var plength = _isSinglePageMode ? 1 : _dom.pageDivs.length;\n\n      for (var i = 0; i < plength; i++) {\n        if (_dom.pageDivs[i]._index != null) {\n          cs = Math.max(__getClientPageDivSize(_dom.pageDivs[i]._index)[key], cs);\n        }\n      }\n    } // scrollbar tray is 1:1\n\n\n    scrollbar._tray[key](cs);\n\n    scrollbar.scrollSize(cs - scrollbar[key]());\n\n    __adjustScrollbarVisibility(scrollbar);\n\n    scrollbar.ratio(1);\n  }\n\n  function __adjustScrollbarVisibility(scrollbar) {\n    if (!scrollbar) {\n      return;\n    } // calculated size is just a little too much for fit\n\n\n    if (scrollbar._scrollSize <= 0) {\n      // hide the scroll tray\n      scrollbar._tray.hide();\n    } else {\n      scrollbar._tray.show();\n    }\n  }\n\n  var scrollShifted = false; // scroll event that fires from the browser when the scroller object changes scroll position\n  // e: event object\n\n  function __onScroll(e) {\n    if (_state.zooming || _state.scrollBuffer || !_dom.pageDivs.length) {\n      return;\n    }\n\n    var t = new Date().getTime();\n    var x = _dom.scroller[0].scrollLeft;\n    var y = _dom.scroller[0].scrollTop;\n\n    if (!_state.loading) {\n      if (!_isSinglePageMode) {\n        var x1 = x + _dom.scroller[0].clientWidth;\n        var y1 = y + _dom.scroller[0].clientHeight;\n        var n = __getIndexFromPos(x, y) + 1; // show prev/next is written to shift whole lines/rows in grid layout(otherwise shownext will stuck, since scrolling in non-main direction never changes _page.number now).\n\n        var dn = Math.abs(n - _page.number) / __getTabularIndexOffset();\n\n        var pageCount = _controllers.document.getPageCount(),\n            startIndex = _dom.pageDivs[0]._index,\n            endIndex = _dom.pageDivs[_dom.pageDivs.length - 1]._index;\n\n        var pagesOutOfSync = dn === 0 && (_page.number - 1 < startIndex || _page.number - 1 > endIndex);\n\n        if (dn < _dom.pageDivs.length && !pagesOutOfSync) {\n          if (__isObjectInRect(_dom.edges[1][0], _dom.scroller[0], x, y, x1, y1) && endIndex < pageCount - 1) {\n            __showNext(dn);\n          } else if (__isObjectInRect(_dom.edges[0][0], _dom.scroller[0], x, y, x1, y1) && startIndex > 0) {\n            __showPrevious(dn);\n          } else if (n !== _page.number && __findPageFromIndex(n - 1) === null) {\n            __showPage(n);\n          }\n        } else {\n          //It is possible that __showPageAsync can change scroller position to 0.\n          var px = _dom.scroller[0].scrollLeft;\n          var py = _dom.scroller[0].scrollTop;\n          scrollShifted = false;\n\n          __showPageAsync(n, false, null);\n\n          if (_config.direction === ScrollDirection.Vertical) {\n            if (px !== _dom.scroller[0].scrollLeft) {\n              _dom.scroller.scrollLeft(px);\n\n              scrollShifted = true;\n            }\n          }\n\n          if (_config.direction === ScrollDirection.Horizontal) {\n            if (py !== _dom.scroller[0].scrollTop) {\n              _dom.scroller.scrollTop(py);\n\n              scrollShifted = true;\n            }\n          }\n        }\n      }\n\n      __adjustVisiblePages();\n    }\n\n    if (_isSinglePageMode) {\n      __setPageNumber(_page.number);\n    } else {\n      __setPageNumber(__getUIIndexFromPos(x, y) + 1);\n    }\n\n    if (!_dom.scroller.propagationPaused() && _dom.scrollH && _dom.scrollV) {\n      var horiz = Math.round(x / _dom.scrollH._ratio);\n      var vert = Math.round(y / _dom.scrollV._ratio); // scroll doesn't fire if it's already at that point\n\n      if (horiz !== _dom.scrollH.scrollLeft()) {\n        // pause event propagation, and resume once the scroll event fires\n        _dom.scrollH.pauseEventPropagation(true); // set horizontal scrollbar position\n\n\n        _dom.scrollH.scrollLeft(horiz);\n      }\n\n      if (vert !== _dom.scrollV.scrollTop()) {\n        // pause event propagation, and resume once the scroll event fires\n        _dom.scrollV.pauseEventPropagation(true); // set vertical scrollbar position\n\n\n        _dom.scrollV.scrollTop(vert);\n      }\n    }\n\n    __triggerEvent({\n      type: 'scroll',\n      x: x,\n      y: y,\n      dx: x - _state.scrollPos.x,\n      dy: y - _state.scrollPos.y\n    });\n\n    if (e) {\n      if (_state.scrollTimeout) {\n        clearTimeout(_state.scrollTimeout);\n      }\n\n      _state.scrollTimeout = setTimeout(function () {\n        __onScrollTimeout(x, y);\n      }, 500); // in chrome canary(17-01-2017), scrollTop & scrollLeft could change during this method and differ from x & y\n      // get most recent scrollbar values\n\n      _state.scrollPos.x = _dom.scroller[0].scrollLeft;\n      _state.scrollPos.y = _dom.scroller[0].scrollTop;\n      _state.scrollPos.t = t;\n    }\n\n    _state.scrollBuffer = e ? setTimeout(__scrollBuffer, 50) : null;\n  } // called after onscroll to figure out when scrolling has stopped and redraw pages\n\n\n  function __onScrollTimeout(ox, oy) {\n    var sbX = _dom.scroller[0].scrollLeft;\n    var sbY = _dom.scroller[0].scrollTop;\n    var scrollComplete = sbX === _state.scrollPos.x && sbY === _state.scrollPos.y;\n\n    if (ox === _state.scrollPos.x && oy === _state.scrollPos.y && scrollComplete) {\n      // this is the last timeout among created ones and there were no scroll attempts.\n      __redrawVisiblePages();\n\n      _state.scrollTimeout = null;\n\n      if (!_state.loading) {\n        // it's possible that pages are not inserted into dom when scrolling(showPage as an example).\n        // in such case adjusting on scroll is ignored. need to make sure state is correct after load.\n        __adjustVisiblePages();\n      }\n    } else if (!scrollComplete) {\n      // we miss some scroll events. probably due to scrollBuffer - force __onScroll with setting new __onScrollTimeout\n      __onScroll({});\n\n      _state.scrollTimeout = null;\n    } else if (scrollComplete && scrollShifted) {\n      //scroll position was changed inside onScroll even handler but was not restored due to it is too small.\n      if (Math.abs(ox - _state.scrollPos.x) < 3 && Math.abs(oy - _state.scrollPos.y) < 3) {\n        __redrawVisiblePages();\n\n        _state.scrollTimeout = null;\n\n        if (!_state.loading) {\n          __adjustVisiblePages();\n        }\n      }\n    } else if (scrollComplete && _isThumbnailer && _page.buffer === _config.maxpagebuffersize) //For too small page.buffer size scrolling has incorrect behavior. Force redraw page\n      {\n        __redrawVisiblePages();\n\n        _state.scrollTimeout = null;\n\n        if (!_state.loading) {\n          __adjustVisiblePages();\n        }\n      }\n  }\n\n  function __scrollBuffer() {\n    if (_state.scrollBuffer !== null) {\n      clearTimeout(_state.scrollBuffer);\n      _state.scrollBuffer = null;\n    }\n  } // #endregion\n  // #region Page functions\n  // adjusts the trailing and leading edge div widths, so that they occupy the right amount of space\n\n\n  function __adjustEdgeWidths() {\n    if (_config.direction === ScrollDirection.Horizontal) {\n      // not use page div size or page size, because it's asynchronously changing right now during zoom.\n      // on thumbnailer page div is square having side length as max image side size.\n      var height = _dom.pageDivs.length ? (!_isThumbnailer ? _page.size.height : Math.max(_page.size.height, _page.size.width)) * _config.zoom : 0;\n\n      if (_config.thumbpadding && typeof _config.thumbpadding === 'number') {\n        height += _config.thumbpadding * 2;\n      }\n\n      _dom.edges[0].height(height);\n\n      _dom.edges[1].height(height);\n    }\n  } // adjusts the trailing and leading edge div heights, so that they occupy the right amount of space\n  // sIndex: int, starting frame index\n  // eIndex: int, ending frame index\n\n\n  function __adjustEdgeHeights(sIndex, eIndex) {\n    eIndex = !eIndex && eIndex !== 0 ? sIndex + _dom.pageDivs.length - 1 : eIndex;\n    eIndex = Math.max(sIndex, eIndex);\n    var tabularOffset = _config.tabular ? __getTabularIndexOffset() : 1; // number of row/columns to move to the next row/column.\n\n    var inc = _config.tabular ? (Math.floor(eIndex / tabularOffset) + 1) * tabularOffset - eIndex : 1;\n\n    var startEdgeOffset = __getPageOffsets(sIndex);\n\n    var pageCount = _isSinglePageMode ? 1 : _controllers.document.getPageCount();\n\n    if (_isSinglePageMode) {\n      eIndex = sIndex = 0;\n    } // need to add last div size, since offsets calculates to the beginning of the page.\n\n\n    var lastVisibleDivSize = eIndex < pageCount ? __getClientPageDivSize(eIndex) : {\n      width: 0,\n      height: 0\n    };\n    var clientPageDivSizeArg = _isSinglePageMode ? __getCurrIndex() : pageCount - 1;\n    var lastDocumentPageSize = eIndex < pageCount - tabularOffset ? __getClientPageDivSize(clientPageDivSizeArg) : {\n      width: 0,\n      height: 0\n    };\n\n    var visiblePagesOffset = __getPageRangeOffsets(sIndex, eIndex);\n\n    visiblePagesOffset.width += lastVisibleDivSize.width;\n    visiblePagesOffset.height += lastVisibleDivSize.height;\n\n    var endEdgeOffset = __getPageRangeOffsets(eIndex + 1, pageCount - 1);\n\n    endEdgeOffset.width += lastDocumentPageSize.width;\n    endEdgeOffset.height += lastDocumentPageSize.height;\n\n    if (_config.direction === ScrollDirection.Vertical) {\n      _dom.edges[0].height(startEdgeOffset.height);\n\n      var pcount = _isSinglePageMode ? pageCount : _controllers.document.getPageCount();\n\n      if (eIndex + inc >= pcount) {\n        //const docHeight = startEdgeOffset.height + visiblePagesOffset.height + endEdgeOffset.height;\n        //if (_dom.scrollH &&\n        //    docHeight > _dom.scroller[0].clientHeight &&\n        //    _dom.content.width() <= _dom.scroller[0].clientWidth) {\n        //    // set edge to cover our  virtual bottom horizontal scroll bar.  if content width is bigger then viewport, browser will add scrollbar to dom.scroller\n        //    _dom.edges[1].height(_dom.scrollH.scrollbarHeight());\n        //} else {\n        //    _dom.edges[1].height(0);\n        //}\n        // set edge to cover our  virtual bottom horizontal scroll bar.  if content width is bigger then viewport, browser will add scrollbar to dom.scroller\n        if (_dom.scrollH && _dom.scrollH._tray[0].offsetWidth === 0) {\n          _dom.edges[1].height(_dom.scrollH[0].offsetHeight - 1);\n        } else {\n          _dom.edges[1].height(0);\n        }\n      } else {\n        _dom.edges[1].height(endEdgeOffset.height); // set height back to no value\n\n\n        if (Browser.Chrome) {\n          _dom.content.height('');\n        }\n      }\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      _dom.edges[0].width(startEdgeOffset.width);\n\n      var _pcount = _isSinglePageMode ? pageCount : _controllers.document.getPageCount();\n\n      if (eIndex + inc >= _pcount) {\n        var docWidth = startEdgeOffset.width + visiblePagesOffset.width + endEdgeOffset.width;\n\n        if (_dom.scrollV && docWidth > _dom.scroller[0].clientWidth && _dom.content.height() <= _dom.scroller[0].clientHeight) {\n          if (!_dom.scrollV._explicitSize) {\n            _dom.edges[1].width(_dom.scrollV.width());\n          } else {\n            // we could have explicit vertical scrollbar size, for example in FF. So need to check whether it's actually something to scroll.\n            _dom.edges[1].width(_dom.scrollV.height() < _dom.scrollV._tray.height() ? _dom.scrollV.width() : 0);\n          }\n        } else {\n          _dom.edges[1].width(0);\n        }\n      } else {\n        _dom.edges[1].width(endEdgeOffset.width);\n\n        _dom.edges[1].height(1);\n      }\n    }\n  }\n\n  function __getActivePage() {\n    return _state.activepage;\n  } // recycles a page out of view and shows the previous page\n  // n: int, number representing how many pages to show\n\n\n  function __showPrevious(n) {\n    n = n ? n : 1;\n\n    if (_isSinglePageMode) {\n      var prev = __getCurrIndex() - n;\n\n      __showPageAtIndex(prev);\n    } else {\n      if (_state.prpr === 0 && _dom.pageDivs.length > 0) {\n        var tabularOffset = __getTabularIndexOffset(_config.zoom); // how many pages per row or column\n\n\n        __pausePageRequests();\n\n        for (var c = n; c > 0; c--) {\n          var newIndex = _dom.pageDivs[0]._index - tabularOffset;\n\n          if (newIndex >= 0 && newIndex < _controllers.document.getPageCount()) {\n            // loop through rows or columns backwards\n            for (var i = tabularOffset - 1; i >= 0; i--) {\n              var pg = __getRecycledPage(-1);\n\n              __removePageContents(pg);\n\n              _dom.content.prepend(pg);\n\n              __insertPageContents(pg, __requestPageAsync(newIndex + i), newIndex + i);\n            }\n\n            __adjustEdgeHeights(newIndex, null);\n\n            __adjustEdgeWidths();\n          }\n        }\n\n        setTimeout(__resumePageRequests, 10);\n      }\n    }\n  } // recycles a page out of view and shows the next page\n  // n: int, number representing how many pages to show\n\n\n  function __showNext(n) {\n    n = n ? n : 1;\n\n    if (_isSinglePageMode) {\n      var next = __getCurrIndex() + n;\n\n      __showPageAtIndex(next);\n    } else {\n      var _next = _dom.pageDivs[_dom.pageDivs.length - 1]._index + 1;\n\n      if (_state.prpr === 0 && _dom.pageDivs.length > 0 && _next < _controllers.document.getPageCount()) {\n        __pausePageRequests(); // how many pages per row or column\n\n\n        var tabularOffset = __getTabularIndexOffset(_config.zoom);\n\n        var pageCount = _controllers.document.getPageCount();\n\n        for (var c = n; c > 0; c--) {\n          var newIndex = _dom.pageDivs[_dom.pageDivs.length - 1]._index + 1;\n\n          if (newIndex < pageCount) {\n            // assume that page divs are always aligned to the end of row/column\n            var trailing = newIndex + tabularOffset - 1 - _dom.pageDivs.length;\n\n            for (var i = 0; i < tabularOffset; i++) {\n              var pg = __getRecycledPage(1);\n\n              __removePageContents(pg);\n\n              _dom.content.append(pg);\n\n              __insertPageContents(pg, __requestPageAsync(newIndex + i), newIndex + i);\n            }\n\n            __adjustEdgeHeights(trailing + 1, newIndex);\n\n            __adjustEdgeWidths();\n          }\n        }\n\n        setTimeout(__resumePageRequests, 10);\n      }\n    }\n  }\n  /**\r\n   * Scrolls the viewer to the given page index and executes the callback when finished.\r\n   * @param {number} index - Index of the page to show.\r\n   * @param {NotificationCallback} [callback] - Function to execute after this operation is done.\r\n   *  @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function showPage\r\n   */\n\n\n  function __showPageAtIndex(index, callback) {\n    __showPage(index + 1, callback);\n  }\n  /**\r\n   * Scrolls the viewer to the given page number and executes the callback when finished.\r\n   * @param {number} pageNumber - Number of the page to show. Note that page number is expected 1-based.\r\n   * @param {NotificationCallback} [callback]: function to execute after this operation is done\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function showPageNumber\r\n   * @deprecated Please use {@link Atalasoft.Controls.WebDocumentViewer#showPage|showPage} instead.\r\n   */\n\n\n  function __showPage(pageNumber, callback) {\n    var _this6 = this;\n\n    // Remove delayed scroll to 0,0 which can be remained after the emptying the previous document. \n    if (_config.direction === ScrollDirection.Vertical) {\n      if (_dom.scrollV) {\n        clearTimeout(_dom.scrollV._tooltip._timeout);\n      }\n    } else if (_config.direction === ScrollDirection.Horizontal) {\n      if (_dom.scrollH) {\n        clearTimeout(_dom.scrollH._tooltip._timeout);\n      }\n    }\n\n    pageNumber = Math.max(1, pageNumber); // make sure pageNumber >= 1\n\n    pageNumber = Math.min(_controllers.document.getPageCount(), pageNumber); // make sure pageNumber <= pagecount\n\n    if (_isSinglePageMode) {\n      __showPageAsync(pageNumber, false, callback);\n    } else {\n      //Store target page number to use it in the scroll position correct actions.  \n      if (!_isThumbnailer && !_state.zooming) {\n        _state.scrollTarget.Page = pageNumber;\n      }\n\n      if (_page.number !== pageNumber) {\n        var delta = pageNumber - _page.number;\n\n        if (Math.abs(delta) < _dom.pageDivs.length) {\n          __scrollNextPrevAsync(delta, callback);\n        } else {\n          __showPageAsync(pageNumber, true, callback);\n        }\n      } else {\n        __scrollNextPrevAsync(0, callback);\n      }\n\n      setTimeout(function () {\n        WebDocumentViewer_newArrowCheck(this, _this6);\n\n        return _state.scrollTarget.Page = 0;\n      }.bind(this), 10000);\n    }\n  } // recycles all viewed pages, sets the current page to the given index, and loads other viewable pages\n  // pagenum: int, page number (1 based)\n  // scrollNeeded: bool, whether to scroll to the page\n  // callback: function to execute after this operation is done\n\n\n  function __showPageAsync(pagenum, scrollNeeded, callback) {\n    var pgcount = _controllers.document.getPageCount();\n\n    var i = pagenum - 1; // frame index (zero based)\n\n    if (_state.prpr === 0 && pgcount > 0) {\n      var resumecallback = function resumecallback() {\n        if (_isSinglePageMode) {\n          __adjustScrollBars();\n\n          __resumePageRequests();\n        } else {\n          __resumePageRequests(!scrollNeeded);\n        }\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n      }; //end of resumeCallback function declaration\n\n\n      __pausePageRequests();\n\n      if (_isSinglePageMode) {\n        if (_config.direction === ScrollDirection.Vertical) {\n          var sH = __getPageOffsets(0).height;\n\n          _dom.edges[0].height(sH); // sets the top edge offset height\n\n        } else if (_config.direction === ScrollDirection.Horizontal) {\n          var sW = __getPageOffsets(0).width;\n\n          _dom.edges[0].width(sW); // sets the top edge offset height\n\n        }\n\n        __adjustEdgeHeights(0, null);\n\n        __adjustEdgeWidths(); // adjusts the widths of the edges to fit\n        // recycles all the page content\n\n\n        __emptyPages(); // inserts images for the new location\n\n\n        for (var j = 0; j < _dom.pageDivs.length; j++) {\n          __insertPageContents(_dom.pageDivs[j], null, i + j);\n        }\n\n        _dom.content.append(_dom.pageDivs[0]);\n\n        __redrawVisiblePages();\n\n        __setPageNumber(i + 1);\n\n        __adjustVisiblePages(false, resumecallback);\n      } else {\n        var _sH = 0; // scroll offset height\n\n        var _sW = 0; // scroll offset width\n\n        var si = i <= 0 ? 0 : i; // start index (zero based)\n\n        if (si + _dom.pageDivs.length >= pgcount) {\n          // move the start index to the max, accounting for room, and making sure not to go under 0\n          si = pgcount - _dom.pageDivs.length;\n\n          if (_config.tabular) {\n            var tabularOffset = __getTabularIndexOffset(); // shift forward to the end of row to have whole last row shown(not existing pages won't be rendered). if we shift backward, last row wont fit.\n\n\n            si = Math.ceil(si / tabularOffset) * tabularOffset;\n          }\n\n          si = Math.max(si, 0);\n        }\n\n        if (_config.direction === ScrollDirection.Vertical) {\n          _sH = __getPageOffsets(si).height;\n\n          _dom.edges[0].height(_sH); // sets the top edge offset height\n\n\n          __adjustEdgeHeights(si, null);\n\n          __adjustEdgeWidths(); // adjusts the widths of the edges to fit\n          // recycles all the page content\n\n\n          __emptyPages(); // inserts images for the new location\n\n\n          for (var _j2 = 0; _j2 < _dom.pageDivs.length; _j2++) {\n            _dom.content.append(_dom.pageDivs[_j2]);\n\n            __insertPageContents(_dom.pageDivs[_j2], null, si + _j2);\n          }\n\n          var ny = __getPageOffsets(Math.max(i, 0)).height; // vertical location of the page to show\n\n\n          var inc = _page.number < pagenum ? -_page.size.height : _page.size.height;\n\n          if (scrollNeeded && ny !== _state.scrollPos.y) {\n            __setScrollPositionAsync(null, ny + inc, false);\n\n            __setScrollPositionAsync(null, ny, true, resumecallback);\n          } else {\n            resumecallback.call();\n          }\n        } else if (_config.direction === ScrollDirection.Horizontal) {\n          _sW = __getPageOffsets(si).width;\n\n          _dom.edges[0].width(_sW); // sets the top edge offset height\n\n\n          __adjustEdgeHeights(si, null);\n\n          __adjustEdgeWidths(); // adjusts the widths of the edges to fit\n          // recycles all the page content\n\n\n          __emptyPages(); // inserts images for the new location\n\n\n          for (var h = 0; h < _dom.pageDivs.length; h++) {\n            _dom.content.append(_dom.pageDivs[h]);\n\n            __insertPageContents(_dom.pageDivs[h], null, si + h);\n          }\n\n          var nx = __getPageOffsets(Math.max(i, 0)).width; // horizontal location of the page to show\n\n\n          var incH = _page.number < pagenum ? -_page.size.width : _page.size.width;\n\n          if (scrollNeeded && nx !== _state.scrollPos.x) {\n            __setScrollPositionAsync(nx + incH, null, false);\n\n            __setScrollPositionAsync(nx, null, true, resumecallback);\n          } else {\n            resumecallback.call();\n          }\n        }\n      }\n    } else {\n      __failStartAsync('paused', callback);\n    }\n  }\n\n  function __setActivePage(pg) {\n    _state.activepage = pg;\n  } // sets the page number indicator to the given index\n  // i: int, frame index + 1\n\n\n  function __setPageNumber(i) {\n    var count = _controllers.document.getPageCount();\n\n    if (i > 0 && i <= count) {\n      if (_page.number !== i || _page.numberoutof !== count) {\n        _dom.pageLabel.html(i + ' / ' + count);\n\n        if (_page.number !== i) {\n          _page.number = i;\n\n          for (var j = 0; j < _dom.pageDivs.length; j++) {\n            var div = _dom.pageDivs[j];\n\n            if (div._index === i - 1) {\n              div.addClass(domclasses.atala_active_page);\n            } else {\n              div.removeClass(domclasses.atala_active_page);\n            }\n          }\n\n          __triggerEvent({\n            type: 'pagenumberchanged',\n            number: _page.number\n          });\n        }\n\n        if (_page.numberoutof !== count) {\n          _page.numberoutof = count;\n        }\n      }\n    } else {\n      _dom.pageLabel.html('');\n\n      _dom.viewport.find('.' + domclasses.atala_active_page).removeClass(domclasses.atala_active_page);\n\n      _page.numberoutof = 0;\n    }\n  } // empties the contents of the page holder divs\n\n\n  function __emptyPages() {\n    for (var i = _dom.pageDivs.length - 1; i >= 0; i--) {\n      __removePageContents(_dom.pageDivs[i]);\n    }\n  } // removes the loaded images from the dom\n\n\n  function __emptyImages() {\n    for (var i = 0; i < _dom.loadedImgs.length; i++) {\n      if (_dom.loadedImgs[i]) {\n        _dom.loadedImgs[i].dispose();\n\n        _dom.loadedImgs[i].remove();\n      }\n    }\n\n    _dom.loadedImgs.length = 0;\n  } // removes the contents of the given page div\n  // pg: jQuery page div object\n\n\n  function __removePageContents(pg) {\n    if (Browser.Explorer && document.activeElement && pg.has(document.activeElement).length) {\n      // Workaround for keyboard scrolling in IE - if page get recycled we have to preserve focus to let user scroll further.\n      _dom.scroller.focus();\n    }\n\n    if (_config.allowannotations && (Browser.Firefox || Browser.Edge)) {\n      //Hack for FF and Edge browsers to disable all editors in removed page\n      _controllers.annotations.__clearAllSelection(pg);\n    } //Clear reload property in the cached image object\n\n\n    if (_config.tiling && pg._img && pg._img._cacheIndex >= 0) {\n      _dom.loadedImgs[pg._img._cacheIndex]._needToInsert = true;\n    } // detach the given page from the parent object\n\n\n    pg.detach(); // we only need to detach the image from the page, since all of the other objects can be reused\n\n    if (pg._img != null) {\n      pg._img._page = null;\n\n      pg._img.getDomElement().detach();\n\n      pg._img = null;\n    }\n\n    __triggerEvent({\n      type: 'pagerecycled',\n      index: pg._index,\n      page: pg\n    });\n\n    pg.removeAttr(domattributes.atala_page_index);\n  } // deletes the given page div\n  // pg: jQuery page div object\n\n\n  function __deletePage(pg) {\n    // clear div first so we won't lose event bindings for dom images while they are in cache.\n    __removePageContents(pg);\n\n    pg._index = -1;\n    pg.removeAttr(domattributes.atala_page_index);\n    pg._img = null;\n    pg.remove();\n  } // inserts the given image into the given page div, adding page number if necessary\n  // pg: jQuery page div object\n  // img: jQuery image object\n  // index: page index\n  // delayInsert: indicates whether to reset image into page.\n\n\n  function __insertPageContents(pg, img, index, delayInsert) {\n    if (pg._index === index && pg._img === img && !delayInsert) {\n      return false; // this page doesn't need to be requested\n    } else if (delayInsert && !pg.nullinserted && index < 0) {\n      // image wasn't added to dom when created because it wasn't loaded.\n      // now it's finally loaded, but need to skip it if page were already reused for other image,\n      // i.e. is already have other index and thus corresponds to other image.\n      return false;\n    } else if (img && pg._index === index && !img._needToInsert) {\n      //for tiled images we do not insert image again because it was inserted by CP imgLoad function\n      return false;\n    }\n\n    pg._index = index;\n    pg.attr(domattributes.atala_page_index, index);\n\n    var __ariaLabel = _isThumbnailer ? 'Thumbnailer page number ' + (index + 1) : 'Viewer page number ' + (index + 1);\n\n    pg.attr('role', 'img').attr('aria-label', __ariaLabel);\n\n    if (pg._paper) {\n      //Svg object can hide aria labels from narrators\n      var svg = atalaJquery(pg._paper.canvas);\n      svg.attr('aria-hidden', 'true');\n    }\n\n    if (index >= _controllers.document.getPageCount()) {\n      // this covers tabular layout case when last row of images is not fully filled because last document image is not last image in a row or column.\n      pg.hide();\n      return false;\n    }\n\n    if (pg._img && pg._img !== img) {\n      pg._img._page = null;\n\n      if (pg.has(pg._img.getDomElement()).length > 0) {\n        pg._img.getDomElement().detach(undefined, true);\n      }\n    }\n\n    if (pg._rubberband) {\n      pg._rubberband.reset();\n    }\n\n    pg._img = img;\n\n    if (pg._img) {\n      pg._img._page = pg;\n\n      pg._img.attr('alt', __ariaLabel);\n\n      if (Browser.Firefox && _isThumbnailer) {\n        pg._img.attr('aria-hidden', 'true');\n      }\n    }\n\n    pg.css({\n      display: _config.tabular || _config.direction === ScrollDirection.Horizontal ? 'inline-block' : 'block',\n      position: 'relative'\n    });\n\n    if (_config.showpagenumber) {\n      if (!pg._num) {\n        pg._num = atalaJquery('<div class=\"atala_pg_num\"/>');\n\n        pg._num.addClass(domclasses.atala_page_number);\n\n        pg.append(pg._num);\n      }\n\n      pg._num.text(pg._index + 1);\n    }\n\n    if (pg._img && pg._img._binds) {\n      if (!pg._img._binds.pageresize) {\n        pg._img._binds.pageresize = function (e) {\n          __triggerEvent({\n            type: 'pageresize',\n            page: e.image._page,\n            image: e.image,\n            index: e.image._page ? e.image._page._index : _controllers.document.getPageIndexByImageIndex(e.image._index),\n            width: e.width,\n            height: e.height\n          });\n        };\n\n        pg._img.on({\n          pageresize: pg._img._binds.pageresize\n        });\n      }\n\n      if (!pg._img._binds.pagesizechanged) {\n        pg._img._binds.pagesizechanged = function (e) {\n          __triggerEvent({\n            type: 'pagesizechanged',\n            page: pg,\n            image: e.image,\n            index: e.index,\n            width: e.width,\n            height: e.height,\n            dx: e.dx,\n            dy: e.dy\n          });\n        };\n\n        pg._img.on({\n          pagesizechanged: pg._img._binds.pagesizechanged\n        });\n      }\n    }\n\n    if (pg._img) {\n      var pageAnchor = pg._img.getDomElement(); // intermediate div used to explicitly size page when view transforms is applied to the image.\n\n\n      pg.append(pageAnchor);\n\n      pg._img.trigger({\n        type: 'inserted',\n        page: pg\n      }); // at this point the image has been added to the page, but has no size until the server returns it\n      // so we transfer the base size of the div to the image, so we can remove the size from the page\n\n\n      if (!pg._img._loaded) {\n        // indicates whether we've preloaded the div a base size already\n        if (pg.nullinserted) {\n          if (!_isThumbnailer && _config.tiling && _config.forcepagefit) {\n            //Set the page size as for first page\n            var destWidth = pg.width();\n            var destHeight = pg.height();\n            var scale;\n\n            if (_config.fitting === Fitting.Width) {\n              destWidth = Math.ceil(_page.size.width * _config.zoom);\n              scale = destWidth / pg.width();\n              destHeight = Math.ceil(pg.height() * scale);\n            } else if (_config.fitting === Fitting.Height) {\n              destHeight = Math.ceil(_page.size.height * _config.zoom);\n              scale = destHeight / pg.height();\n              destWidth = Math.ceil(pg.width() * scale);\n            }\n\n            pg._img.css({\n              width: destWidth,\n              height: destHeight\n            });\n\n            _controllers.document.setPageFitMultiplier(pg._index, scale);\n          } else {\n            pg._img.css({\n              width: pg.width(),\n              height: pg.height()\n            });\n          }\n        } else {\n          __initializeObjectToPageSize(pg._img, pg._index);\n        }\n      } // if the page div already has a new size, don't remove it\n\n\n      if (!_state.newpagedivsize) {\n        pg.css({\n          width: '',\n          height: ''\n        });\n      }\n\n      pg.nullinserted = false;\n    } else {\n      // marker to indicate that we've preloaded the div with null, and given it a base size\n      pg.nullinserted = true; // at this point the image hasn't been added to the page yet, so the we need to\n      // give the page div some size so that it can be scrolled smoothly\n\n      if (!_state.newpagedivsize) {\n        __initializeObjectToPageSize(pg, pg._index);\n      }\n    }\n\n    __triggerEvent({\n      type: 'pageshown',\n      page: pg,\n      index: pg._index\n    });\n\n    return true;\n  }\n\n  function __initializeObjectToPageSize(obj, i) {\n    var pagesize = __getClientPageDivSize(i, null, false);\n\n    obj.css({\n      width: pagesize.width,\n      height: pagesize.height\n    });\n  } // tells the viewer not to load more images until resume is called\n\n\n  function __pausePageRequests() {\n    _state.prpr++;\n  } // tells the viewer to resume loading images\n\n\n  function __resumePageRequests(suppressScroll) {\n    if (_state.prpr === 0) {\n      return;\n    } else {\n      _state.prpr--;\n\n      if (_state.prpr === 0 && !suppressScroll) {\n        __onScroll();\n      }\n    }\n  } //tells viewer do not load remaining tiles\n\n\n  function __interruptFurtherTiling() {\n    _state.itch = true;\n  }\n\n  function __resumeFurtherTiling() {\n    _state.itch = false;\n  } // recycles a page div at the beginning or end of the array\n  // i: int, positive to move forward, negative to move backward\n\n\n  function __getRecycledPage(i) {\n    if (i > 0) {\n      // moving forward\n      __moveArrayIndexTo(_dom.pageDivs, 0, _dom.pageDivs.length - 1);\n\n      return _dom.pageDivs[_dom.pageDivs.length - 1];\n    } else {\n      // moving backward\n      __moveArrayIndexTo(_dom.pageDivs, _dom.pageDivs.length - 1, 0);\n\n      return _dom.pageDivs[0];\n    }\n  }\n  /**\r\n   * Checks whether specified document page have been loaded.\r\n   * @param {number} index - Page index.\r\n   * @returns {boolean} `true` if page have already been loaded; `false` otherwise.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function isPageLoaded\r\n   */\n\n\n  function __isPageLoaded(index) {\n    var pageInfo = _controllers.document.getPageDefinition(index);\n\n    return pageInfo.cacheIndex >= 0 && _dom.loadedImgs[pageInfo.cacheIndex] && _dom.loadedImgs[pageInfo.cacheIndex]._loaded;\n  }\n  /**\r\n   * Reloads the specified page.\r\n   * @param {number} index - The index of the page to reload.\r\n   * @param {string|boolean} [annotations=false] - Url of the annotation xmp file or flag indicating whether to reload annotations of boolean flag indicating whether to load annotations data.\r\n   * @param {string|boolean} [forms] - Url of the form file or flag indicating whether to reload forms of boolean flag indicating whether to load forms data.\r\n   * @param {object} [params] - A plain object containing optional parameters that will be passed to server.\r\n   *\r\n   * Params could contain any application specific information that should be passed to server.\r\n   * For example, this could be the aggregated list of the parameters that was used in {@link Atalasoft.Controls.WebDocumentViewer#reloadPage|reloadPage} calls for different pages.\r\n   * @param {NotificationCallback} [callback] - function that is called when page have been loaded.\r\n   *\r\n   * This object will be available on the server side handler as an key-values collection. This allows to pass specific load options for individual pages.\r\n   * @function Atalasoft.Controls.WebDocumentViewer#reloadPage\r\n   */\n\n\n  function __reloadPage(index, annotations, forms, params, callback) {\n    var deferred = atalaJquery.Deferred(),\n        annotationDeferred = atalaJquery.Deferred(),\n        formsDeferred = atalaJquery.Deferred();\n    var pageDeferred = atalaJquery.Deferred();\n\n    if (typeof params === 'function') {\n      callback = params;\n      params = undefined;\n    }\n\n    if (typeof forms === 'function') {\n      callback = forms;\n      forms = false;\n    }\n\n    if (typeof annotations === 'function') {\n      callback = annotations;\n      annotations = false;\n    }\n\n    if (typeof callback === 'function') {\n      deferred.done(callback);\n    }\n\n    var pageInfo = _controllers.document.getPageDefinition(index);\n\n    if (!pageInfo) {\n      deferred.resolve();\n      return deferred.promise();\n    }\n\n    if (pageInfo.cacheIndex >= 0 && _dom.loadedImgs[pageInfo.cacheIndex]) {\n      pageDeferred = __silentReloadPage(pageInfo, params);\n    } else {\n      __requestPageAsync(index, params, function () {\n        pageDeferred.resolve();\n      });\n    }\n\n    var annotationsUrl = typeof annotations === 'string' ? annotations : !pageInfo.uri ? _config.annotationsurl : null;\n\n    if (_config.allowannotations && !!annotations && (annotationsUrl || pageInfo.uri)) {\n      // _config.annotationsurl means that some annotations have been loaded for document\n      _controllers.annotations.loadAnnotationsUrl(_config.serverurl, annotationsUrl, pageInfo.uri, pageInfo.index, 1, index, function () {\n        annotationDeferred.resolve(true);\n      });\n    } else {\n      if (annotations) {\n        // clear all annotations on the page if there were no annotations for the document.\n        _controllers.annotations.loadAnnotations({\n          layers: [[]],\n          offset: index\n        });\n      }\n\n      annotationDeferred.resolve(!!annotations);\n    }\n\n    var formsUrl = typeof forms === 'string' ? forms : !pageInfo.uri ? _config.formsurl : null;\n\n    if (_config.allowforms && !!forms && (_config.formsurl || formsUrl)) {\n      _controllers.forms.loadFormUrl(_config.serverurl, formsUrl, pageInfo.uri, pageInfo.index, 1, index, function () {\n        formsDeferred.resolve(true);\n      });\n    } else {\n      formsDeferred.resolve();\n    }\n\n    atalaJquery.when(pageDeferred, annotationDeferred, formsDeferred).done(function (page, annotations, forms) {\n      if (annotations || forms) {\n        __redrawPageFromIndex(index, true);\n      }\n\n      deferred.resolve(index);\n    });\n    return deferred.promise();\n  }\n  /**\r\n   * Silently reloads the specified page if it has already been loaded before. Not creates new page.\r\n   * @private\r\n   * @return {object} page reload promise\r\n   */\n\n\n  function __silentReloadPage(pageDefinition, params) {\n    var pageDeferred = atalaJquery.Deferred();\n\n    if (pageDefinition.cacheIndex >= 0 && _dom.loadedImgs[pageDefinition.cacheIndex]) {\n      var img = _dom.loadedImgs[pageDefinition.cacheIndex];\n      img.invalidate(params, function () {\n        pageDeferred.resolve();\n      });\n    } else {\n      pageDeferred.resolve();\n    }\n\n    return pageDeferred.promise();\n  } // asynchronously requests the image at the given index\n  // i: int, frame index\n  // params {object}, optional image request params.\n  // callback: function to execute after the image is done loading\n\n\n  function __requestPageAsync(i, params, callback) {\n    if (typeof params === 'function') {\n      callback = params;\n      params = undefined;\n    }\n\n    var pageInfo = _controllers.document.getPageDefinition(i);\n\n    if (!pageInfo) {\n      return;\n    } // when the document has inserted pages, this may not be the best way to get a page\n\n\n    if (pageInfo.cacheIndex < 0 || !_dom.loadedImgs[pageInfo.cacheIndex]) {\n      var cacheIndex = _state.nextImageCacheIndex++;\n      pageInfo.cacheIndex = cacheIndex;\n\n      _controllers.document.setPageCacheIndex(i, cacheIndex);\n\n      _dom.loadedImgs[cacheIndex] = __createPageImageAsync(pageInfo.index, pageInfo.ref, params, function (cimg) {\n        if (cimg) {\n          // sometimes when image already been loaded, IE8 could call callback synchronously, i.e. before __createPageImageAsync returns.\n          _dom.loadedImgs[cacheIndex] = cimg;\n          cimg._cacheIndex = cacheIndex;\n\n          _controllers.memory.allocate(cimg);\n        }\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n      });\n\n      if (_config.allowtext && _controllers.text && !_isThumbnailer) {\n        // async(inside called method) request to prevent page images blocking.\n        _controllers.text.ensurePageTextLoaded(i);\n      }\n    } else {\n      if (typeof callback === 'function') {\n        callback.call();\n      }\n    }\n\n    return _dom.loadedImgs[pageInfo.cacheIndex];\n  } // determines whether the page is in the viewable area\n  // pg: jQuery page div object\n\n\n  function __isPageInView(index) {\n    var pg = __findPageFromIndex(index);\n\n    if (pg) {\n      var le = _dom.scroller[0].scrollLeft;\n      var te = _dom.scroller[0].scrollTop;\n      return __isObjectInRect(pg[0], _dom.scroller[0], le, te, le + _dom.scroller[0].clientWidth, te + _dom.scroller[0].clientHeight);\n    } else {\n      return false;\n    }\n  } // finds the page if it's in the loaded pageDivs, returns null if it's not found\n  // i: int, frame index\n\n\n  function __findPageFromIndex(i) {\n    var retPage = null;\n\n    for (var j = 0; j < _dom.pageDivs.length && retPage === null; j++) {\n      if (_dom.pageDivs[j]._index === i) {\n        retPage = _dom.pageDivs[j];\n      }\n    }\n\n    return retPage;\n  }\n\n  function __showPagePoint(pageIndex, point, location, force, callback) {\n    var _this7 = this;\n\n    if (force && typeof force === 'function') {\n      callback = force;\n      force = false;\n    }\n\n    var showPagePointImpl = function showPagePointImpl() {\n      var _this8 = this;\n\n      WebDocumentViewer_newArrowCheck(this, _this7);\n\n      var pg = _isSinglePageMode ? _dom.pageDivs[0] : __findPageFromIndex(pageIndex);\n      var offset;\n\n      if (pg) {\n        var le = _dom.scroller[0].scrollLeft;\n        var te = _dom.scroller[0].scrollTop;\n        offset = __getDomOffsets(pg[0], _dom.scroller[0]);\n        offset.left += point.x;\n        offset.top += point.y;\n\n        if (!force && offset.left >= le && offset.left <= le + _dom.scroller[0].clientWidth && offset.top >= te && offset.top <= te + _dom.scroller[0].clientHeight) {\n          // page is already in viewport.\n          if (callback) {\n            callback();\n          }\n\n          return;\n        }\n      } else {\n        offset = _isSinglePageMode ? __getPageOffsets(0) : __getPageOffsets(pageIndex);\n        offset.left = offset.width + point.x;\n        offset.top = offset.height + point.y;\n      }\n\n      var locationOffset = {\n        x: _dom.scroller[0].clientWidth / 2,\n        y: _dom.scroller[0].clientHeight / 2\n      }; // location object is not the same, so compare by value.\n\n      if (__isLocationEquals(location, PageSelection.BottomLeft)) {\n        locationOffset.x = _dom.scroller[0].clientWidth;\n        locationOffset.y = _dom.scroller[0].clientHeight;\n      } else if (__isLocationEquals(location, PageSelection.TopLeft)) {\n        locationOffset.x = 0;\n        locationOffset.y = 0;\n      } //Save point's offset value to the case of pages with different sizes.\n\n\n      _state.scrollTarget.Page = pageIndex + 1;\n      _state.scrollTarget.dx = point.x - locationOffset.x;\n      _state.scrollTarget.dy = point.y - locationOffset.y;\n\n      __setScrollPositionAsync(offset.left - locationOffset.x, offset.top - locationOffset.y, true, callback); //discard point's offset\n\n\n      setTimeout(function () {\n        WebDocumentViewer_newArrowCheck(this, _this8);\n\n        _state.scrollTarget.Page = 0;\n        _state.scrollTarget.dx = 0;\n        _state.scrollTarget.dy = 0;\n      }.bind(this), 10000);\n    }.bind(this);\n\n    if (_isSinglePageMode) {\n      if (pageIndex !== __getCurrIndex()) __showPageAsync(pageIndex + 1, false, showPagePointImpl);else showPagePointImpl();\n    } else {\n      showPagePointImpl();\n    }\n  }\n\n  function __isLocationEquals(first, second) {\n    return first && second && first.x === second.x && first.y === second.y;\n  } // puts the page number in a new spot based on the width and the index of the image\n  // i: int, frame index of the page\n  // width: int, width of the image on the page\n\n\n  function __repositionPageNumber(i, width) {\n    var pg = __findPageFromIndex(i);\n\n    if (pg != null && pg._num != null) {\n      pg._num.css({\n        left: width - 20,\n        right: 0\n      });\n    }\n  } // #endregion\n  // #region Resize and Zoom\n  // fires when the browser window is resized\n\n\n  var resizeTimeout = null;\n\n  function __onResize() {\n    // TODO: need to slow this down with a timeout at maybe 1-2 times/sec\n    if (resizeTimeout) {\n      clearTimeout(resizeTimeout);\n    }\n\n    resizeTimeout = setTimeout(function () {\n      __triggerEvent('documentchanged');\n    }, 200);\n  } // force reflow of the content div\n\n\n  function __reflow() {\n    if (_state.prpr === 0) {\n      if (Browser.Safari || Browser.Chrome) {\n        _dom.edges[1].hide().show();\n      }\n    }\n  }\n\n  function __startDomManipulation() {\n    _dom.scroller.stop();\n\n    _dom.scroller.pauseEventPropagation();\n\n    __pausePageRequests();\n\n    if (_config.tiling) {\n      __interruptFurtherTiling();\n    }\n  }\n\n  function __endDomManipulation() {\n    __adjustScrollBars();\n\n    var pgInViewIndex = _isSinglePageMode ? __getCurrIndex() : _controllers.document.getPageCount() - 1;\n\n    if (_dom.pageDivs.length > 0 && __isPageInView(pgInViewIndex)) {\n      // workaround to fix bottom document edge behind last page if it comes into view after dom manipulations(zoom, rotate).\n      __adjustEdgeHeights(_dom.pageDivs[0]._index);\n    }\n\n    __adjustEdgeWidths();\n\n    _dom.scroller.resumeEventPropagation();\n\n    __resumePageRequests();\n  } // start event to enable pinch zoom\n\n\n  function __zoomStart() {\n    _state.zooming = true;\n\n    __startDomManipulation();\n\n    __triggerEvent('zoomstarted');\n  } // instant zoom to enable pinch zoom\n  // z: new zoom level\n\n\n  function __zoomInstant(z) {\n    z = Math.min(z, __getMaxZoom());\n    z = Math.max(z, __getMinZoom());\n\n    __zoomScrollPositionAsync(z, false);\n\n    _config.zoom = z;\n\n    __adjustVisiblePages(false);\n\n    __zoomOffsetEdgeAsync(z, false);\n  } // end event to enable pinch zoom\n\n\n  function __zoomEnd() {\n    _state.zooming = false;\n\n    __endDomManipulation();\n\n    __triggerEvent({\n      type: 'zoomchanged',\n      zoom: _config.zoom\n    });\n  }\n  /**\r\n   * Asynchronously zooms the viewer to the given zoom over the default zoom duration\r\n   * @param {number} zoom - Desired zoom level to zoom to.\r\n   * @param {NotificationCallback} [callback] - function to execute after the zoom is finished animating.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function zoom\r\n   */\n\n\n  function __setZoomAsync(zoom, callback) {\n    var _this9 = this;\n\n    if (!_state.zooming) {\n      _state.zooming = true;\n\n      __startDomManipulation();\n\n      __triggerEvent('zoomstarted');\n\n      if (zoom !== _config.zoom) {\n        zoom = Math.min(zoom, __getMaxZoom());\n        zoom = Math.max(zoom, __getMinZoom());\n        var pn = _isSinglePageMode ? 0 : _page.number;\n\n        var cpo = __getPageOffsets(pn, null, null);\n\n        var cpoz = __getPageOffsets(pn, null, null, zoom); // relative scaled page coordinates\n\n\n        var rpx = (_dom.scroller.scrollLeft() - cpo.width) / _config.zoom * zoom;\n        var rpy = (_dom.scroller.scrollTop() - cpo.height) / _config.zoom * zoom;\n        _config.zoom = zoom;\n\n        __adjustVisiblePages(true, function () {\n          var _this10 = this;\n\n          WebDocumentViewer_newArrowCheck(this, _this9);\n\n          // this should be the last animation, so we can use it to callback\n          __zoomOffsetEdgeAsync(zoom, true, function () {\n            var _this11 = this;\n\n            WebDocumentViewer_newArrowCheck(this, _this10);\n\n            __zoomFinished();\n\n            __setScrollPositionAsync(cpoz.width + rpx, cpoz.height + rpy, false, _zmd, function () {\n              WebDocumentViewer_newArrowCheck(this, _this11);\n\n              //Scrollbar FIXUPS\n              if (_dom.scrollH) _dom.scrollH.scrollLeft(_dom.scroller.scrollLeft());\n              if (_dom.scrollV) _dom.scrollV.scrollTop(_dom.scroller.scrollTop());\n              if (callback !== null && callback !== undefined) callback();\n            }.bind(this));\n          }.bind(this));\n        }.bind(this));\n      } else {\n        __zoomFinished(); // no need to zoom, still need to call the callback\n\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n      }\n    } else {\n      // currently in a zoom animation call the callback\n      __failStartAsync('zooming', callback);\n    }\n  } // callback for setZoomAsync, fires after a zoom is done animating\n\n\n  function __zoomFinished() {\n    _state.zooming = false;\n\n    __endDomManipulation();\n\n    __triggerEvent({\n      type: 'zoomchanged',\n      zoom: _config.zoom\n    });\n  } // zooms in or out depending on the given value\n  // zoomout: bool, zooms out if true, zooms in otherwise\n  // callback: function to execute when the zoom is done\n\n\n  function __zoomAsync(zoomOut, callback) {\n    var z = _config.zoom + (zoomOut ? -1 : 1) * _config.zoom * 0.3;\n\n    __setZoomAsync(z, callback);\n  } // zooms the current scroll position to the given zoom level\n  // ani: bool, indicates whether the zoom should animate\n  // callback: function to execute when the zoom is done\n\n\n  function __zoomScrollPositionAsync(z, ani, callback) {\n    var cpo = __getPageOffsets(_page.number, null, null);\n\n    var cpoz = __getPageOffsets(_page.number, null, null, z); // relative scaled page coordinates\n\n\n    var rpx = (_dom.scroller.scrollLeft() - cpo.width) / _config.zoom * z;\n    var rpy = (_dom.scroller.scrollTop() - cpo.height) / _config.zoom * z;\n\n    __setScrollPositionAsync(cpoz.width + rpx, cpoz.height + rpy, ani, _zmd, callback);\n  } // fires after the trailing edge has finished zooming\n\n\n  function __edgeZoomed() {\n    _dom.edges[0]._z = _config.zoom;\n  } // asynchronously zooms the trailing edge to the given zoom level\n  // z: float, desired zoom level to zoom to\n  // ani: bool, indicates whether the zoom should animate\n  // callback: function to execute when the zoom is done animating\n\n\n  function __zoomOffsetEdgeAsync(z, ani, callback) {\n    if (_dom.edges.length > 0) {\n      callback = typeof callback === 'function' ? __functionFromArray([__edgeZoomed, callback]) : __edgeZoomed;\n      var vert = _config.direction === ScrollDirection.Vertical; // TODO: need to change this to support horizontal as well\n\n      var pi = _dom.pageDivs[0] && _dom.pageDivs[0]._img ? _dom.pageDivs[0]._index : 0;\n\n      if (_isSinglePageMode) {\n        pi = 0;\n      }\n\n      var offset = __getPageOffsets(pi, null, null, z);\n\n      var nv = vert ? offset.height : offset.width;\n\n      if (ani && !_state.loading) {\n        var aniCfg = vert ? {\n          'height': nv\n        } : {\n          'width': nv\n        };\n\n        _dom.edges[0].animate(aniCfg, {\n          duration: _zmd,\n          easing: 'easeOutQuad',\n          complete: callback,\n          queue: false\n        });\n      } else {\n        if (vert) {\n          _dom.edges[0].height(nv);\n        } else {\n          _dom.edges[0].width(nv);\n        }\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n      }\n\n      __updateEdgeBackgroundPlaceholders();\n    }\n  }\n\n  function __updateEdgeBackgroundPlaceholders(zoom) {\n    setTimeout(function () {\n      var canvas = atalaJquery('<canvas/>');\n      zoom = zoom || _config.zoom;\n      var isVertical = _config.direction === ScrollDirection.Vertical;\n      var cellSize = _state.newpagedivsize ? _state.newpagedivsize : {\n        width: _page.size.width * zoom,\n        height: _page.size.height * zoom\n      };\n      var pageSpacing = Math.max(1, _config.pagespacing);\n\n      var tabularOffset = __getTabularIndexOffset();\n\n      canvas[0].width = (cellSize.width + pageSpacing) * (isVertical ? tabularOffset : 1);\n      canvas[0].height = cellSize.height * (isVertical ? 1 : tabularOffset);\n      var ctx = canvas[0].getContext('2d');\n      ctx.lineWidth = _config.pageborderwidth;\n\n      if (_config.backcolor) {\n        ctx.fillStyle = _config.backcolor;\n      } // get a pixel offset so border will visible on result rendered image.\n\n\n      var backgroundMargin = 1;\n\n      for (var i = 0; i < tabularOffset; ++i) {\n        var x = isVertical ? backgroundMargin + i * cellSize.width : backgroundMargin;\n        var y = isVertical ? backgroundMargin : backgroundMargin + i * cellSize.height;\n        ctx.strokeRect(x, y, cellSize.width - backgroundMargin * 2, cellSize.height - backgroundMargin * 2);\n\n        if (_config.backcolor) {\n          ctx.fillRect(x + ctx.lineWidth, y + ctx.lineWidth, cellSize.width - (backgroundMargin + ctx.lineWidth) * 2, cellSize.height - (backgroundMargin + ctx.lineWidth) * 2);\n        }\n      } //const base64 = canvas[0].toDataURL();\n\n\n      var style = {\n        //backgroundImage: 'url(' + base64 + ')',\n        backgroundSize: 'auto auto',\n        backgroundRepeat: isVertical ? 'repeat-y' : 'repeat-x'\n      };\n\n      _dom.edges[0].css(style);\n\n      _dom.edges[1].css(style);\n    }, 0);\n  }\n\n  function __clearEdgesBackground() {\n    var style = {\n      backgroundImage: '',\n      backgroundSize: '',\n      backgroundRepeat: '',\n      backgroundColor: ''\n    };\n\n    _dom.edges[0].css(style);\n\n    _dom.edges[1].css(style);\n  } // adjusts the visible pages to the current zoom level\n  // ani: bool, indicates whether the zoom should animate\n  // callback: function to execute when the zoom is done animating\n\n\n  function __adjustVisiblePages(ani, callback) {\n    var adjusts = 0;\n    var needToCallback = true; // adjusts const can be added and subtracted async\n    // nested callback function so we don't have to store given callback\n\n    var adjustsCompleted = function adjustsCompleted() {\n      adjusts--;\n\n      if (adjusts <= 0) {\n        if (_config.direction === ScrollDirection.Horizontal) {\n          var maxWidth = __getMaxDocumentSize().width;\n\n          if (!_dom.spacer) {\n            _dom.spacer = __createDiv(); //$('<span/>');\n\n            _dom.spacer.css({\n              position: 'absolute',\n              top: '-1px',\n              height: '1px'\n            });\n\n            _dom.viewport.append(_dom.spacer);\n          }\n\n          _dom.spacer.width(maxWidth);\n        } // only execute the callback if it exists\n\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n\n        __reflow();\n      }\n    };\n\n    for (var i = 0; i < _dom.pageDivs.length; i++) {\n      if (_dom.pageDivs[i]._img) {\n        var needsReload = _dom.pageDivs[i]._img.needsZoom() || _dom.pageDivs[i]._img.needsRotate();\n\n        if (needsReload) {\n          needToCallback = false;\n          adjusts++;\n\n          if (_dom.pageDivs[i]._img.needsRotate()) {\n            _dom.pageDivs[i]._img.rotate(adjustsCompleted);\n          } else if (_dom.pageDivs[i]._img.needsZoom()) {\n            _dom.pageDivs[i]._img.zoom(ani, adjustsCompleted);\n          }\n        }\n      }\n    } // call callback even if no adjustment was necessary\n\n\n    if (needToCallback) {\n      adjustsCompleted.call();\n    }\n  }\n  /**\r\n   * Asynchronously zooms the viewer to fit to a page.\r\n   * @param {Atalasoft.Utils.Fitting} fit - Type of fitting to fit the page to.\r\n   * @param {number} pageNumber - Page number to fit to.  Note, that it's 1-based.\r\n   * @param {NotificationCallback} callback - Function to execute after the fit is done animating.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function fit\r\n   */\n\n\n  function __fitAsync(fit, pageNumber, callback) {\n    if (pageNumber != null) {\n      if (typeof pageNumber === 'function') {\n        callback = pageNumber;\n        pageNumber = _page.number;\n      }\n    } else {\n      pageNumber = _page.number;\n    }\n\n    var docFit = __calculateDocumentFitting(fit, pageNumber - 1);\n\n    var nZ = docFit.zoom;\n    var nox = Fitting.Width === docFit.fit && ScrollDirection.Vertical === _config.direction;\n    var noy = Fitting.Height === docFit.height; // we fit to the width, so there shouldn't be any x scroll\n\n    if (nox) {\n      __setScrollPositionAsync(0, null, false);\n    } // we fit to the height, so there shouldn't be any y scroll\n\n\n    if (noy) {\n      __setScrollPositionAsync(null, 0, false);\n    }\n\n    __setZoomAsync(nZ, callback);\n  } // calculates document fit zoom for particular page: returns zoom value and fit describing which side this zoom will fit to(actual for best fit  option).\n\n\n  function __calculateDocumentFitting(fit, index) {\n    var viewportStripeSize = __getViewportGridStripeSize();\n\n    var size = __getClientPageSize(index, 1, false);\n\n    if (size.width === 0 || size.height === 0) {\n      fit = null;\n    }\n\n    var zoom = _config.zoom;\n\n    switch (fit) {\n      case Fitting.None:\n        break;\n\n      case Fitting.Best:\n        if (size.width / viewportStripeSize.width > size.height / viewportStripeSize.height) {\n          //size to the width\n          zoom = viewportStripeSize.width / size.width;\n          fit = Fitting.Width;\n        } else {\n          //size to the height\n          zoom = viewportStripeSize.height / size.height;\n          fit = Fitting.Height;\n        }\n\n        break;\n\n      case Fitting.Height:\n        zoom = viewportStripeSize.height / size.height;\n        break;\n\n      case Fitting.Width:\n        zoom = viewportStripeSize.width / size.width;\n        break;\n\n      default:\n        zoom = 1;\n        fit = Fitting.None;\n        break;\n    }\n\n    return {\n      zoom: zoom,\n      fit: fit\n    };\n  } // gets the individual scale for a page, whether it's been fit or not\n\n\n  function __getPageFitMultiplier(index) {\n    return _controllers.document.getPageFitMultiplier(index);\n  } // gets the individual scale for a page, whether it's been fit or not\n\n\n  function __getPageScale(index) {\n    return _config.zoom * _controllers.document.getPageFitMultiplier(index);\n  }\n\n  function __getPageRotation(index) {\n    return _controllers.document.getPageRotation(index);\n  }\n\n  function __getViewerTransform(pageindex, extraRotation) {\n    extraRotation = extraRotation || 0;\n\n    var viewAngle = __getPageRotation(pageindex);\n\n    var scale = __getPageScale(pageindex);\n\n    var size = __getServerPageSize(pageindex, extraRotation);\n\n    var m = atalaRaphael.matrix();\n    m.scale(scale, scale, 0, 0);\n    m.rotate(viewAngle + extraRotation, 0, 0);\n\n    var br = __transformPoint(m, {\n      x: size.width,\n      y: size.height\n    });\n\n    var dx = Math.min(0, br.x);\n    var dy = Math.min(0, br.y); // absolute translation of the upper left corner of the rotated rectangle to (0; 0)\n\n    var inver = m.invert();\n    var dxSrc = inver.x(-dx, -dy);\n    var dySrc = inver.y(-dx, -dy);\n    m.translate(dxSrc, dySrc);\n    return m;\n  }\n\n  function __transformPoint(matrix, p) {\n    return {\n      x: matrix.x(p.x, p.y),\n      y: matrix.y(p.x, p.y)\n    };\n  } // #endregion\n  // #region Annotations\n  // draws an annotation with the mouse\n\n\n  function __drawAnnotation(e) {\n    var btnConfig = atalaJquery.data(e.currentTarget, '_config');\n    var defaultAnno = atalaJquery.data(e.currentTarget, '_annoConfig'); // checks to see if the default annotation properties already exist\n\n    if (!defaultAnno && btnConfig) {\n      // no default, draw blank\n      defaultAnno = {\n        type: btnConfig.icon,\n        rotatable: _config.showrotatetools\n      };\n    }\n\n    if (defaultAnno) {\n      _controllers.mouseTool.setTool(MouseToolType.None, MouseToolType.None);\n\n      _controllers.annotations.drawAnnotation(defaultAnno, false, __onAnnotationDrawn, __onAnnotationCancelled);\n    }\n  } // event fired when an annotation draw was cancelled\n\n\n  function __onAnnotationCancelled() {\n    _controllers.mouseTool.setTool(MouseToolType.Pan, MouseToolType.None);\n  } // event fired when an annotation has been drawn on the drawing surface\n\n\n  function __onAnnotationDrawn() {\n    _controllers.mouseTool.setTool(MouseToolType.Pan, MouseToolType.None);\n  }\n  /**\r\n   * Checks whether annotations support is enabled.\r\n   * @private\r\n   */\n\n\n  function __annotationsAllowed() {\n    // this function to checks if annotations are allowed to be drawn\n    if (_config.allowannotations === false) {\n      __throwError('InitError', 'The \"allowannotations\" property in the WebDocumentViewer config is set to false.');\n    }\n\n    return _config.allowannotations;\n  } // elevates the z-index of the drawing surface, so that it can capture mouse events\n\n\n  function __raiseDrawLayer() {\n    for (var i = 0; i < _dom.pageDivs.length; i++) {\n      _dom.pageDivs[i]._draw.toFront();\n    }\n  } // resets the z-index of the drawing surface, so that it can capture mouse events\n\n\n  function __resetDrawLayer() {\n    for (var i = 0; i < _dom.pageDivs.length; i++) {\n      _dom.pageDivs[i]._draw.reset();\n    }\n  } // #endregion\n  // #region Document state switching\n\n\n  function __switchDocument(info, linker, config) {\n    if (info) {\n      _state.loading = true;\n\n      __emptyPages();\n\n      _page.size.width = info.pagewidth;\n      _page.size.height = info.pageheight;\n      _page.count = info.pagecount;\n      _page.buffer = _config.pagebuffersize;\n      _page.dpi = info.dpi;\n      _page.vector = info.vector === true;\n      _config.allowannotations = config.allowannotations;\n      _config.textAnnotationEditorIgnoredKeyCodes = config.textAnnotationEditorIgnoredKeyCodes;\n      _config.multiprocessing = config.multiprocessing;\n      _config.allowforms = config.allowforms;\n      _config.allowtext = config.allowtext;\n      _config.tiling = config.tiling;\n      _config.documenturl = config.documenturl;\n      _config.annotationsurl = config.annotationsurl;\n      _config.formsurl = config.formsurl;\n\n      _controllers.document.__linkChanges(linker);\n\n      if (_controllers.annotations) {\n        _controllers.annotations.clear();\n\n        _controllers.annotations.loadAnnotations(info);\n      }\n\n      if (_controllers.forms) {\n        _controllers.forms.clear();\n\n        if (info.forms) {\n          _controllers.forms.loadForms(info);\n        }\n      }\n\n      if (_controllers.text && _dom.search) {\n        // reset search if any.\n        _dom.search.ClearSearch();\n      }\n\n      if (config.showbookmarks) {\n        if (_controllers.document.getBookmarks().length > 0) {\n          atalaJquery('.' + domclasses.atala_tool_button_bookmarks).button('enable');\n        } else {\n          __disableBookmarkButton();\n        }\n\n        _bookmarkState = {\n          top: 0,\n          left: 0,\n          expanded: []\n        };\n      }\n\n      _state.scrollTarget.Page = 0;\n      _state.scrollTarget.dx = 0;\n      _state.scrollTarget.dy = 0;\n      _state.zooming = false;\n\n      if (info.zoom) {\n        _config.zoom = info.zoom;\n      } else {\n        var docFit = __calculateDocumentFitting(_config.fitting, 0);\n\n        _config.zoom = docFit.zoom;\n      }\n\n      __invalidateDocument(info.pagenumber || 0);\n\n      _controllers.mouseTool.setTool(_config.mousetool.type && !_isThumbnailer ? _config.mousetool.type : MouseToolType.Pan, MouseToolType.None);\n\n      __updateEdgeBackgroundPlaceholders();\n\n      _state.loading = false;\n\n      __adjustVisiblePages();\n\n      __getSelectedPagesIndices = linker.__getSelectedPagesIndices;\n\n      __triggerEvent({\n        type: 'activedocumentchanged'\n      });\n    }\n  }\n\n  function __closeDocument(thumbLink, closeView) {\n    if (closeView) {\n      __clearUI(true);\n    }\n\n    for (var i = 0; i < thumbLink._controllers.document.getPageCount(); ++i) {\n      var pageDef = thumbLink._controllers.document.getPageDefinition(i, _id);\n\n      if (pageDef && pageDef.cacheIndex >= 0) {\n        if (_dom.loadedImgs[pageDef.cacheIndex]) {\n          _controllers.memory.deallocate(_dom.loadedImgs[pageDef.cacheIndex]);\n\n          _dom.loadedImgs[pageDef.cacheIndex].dispose();\n\n          _dom.loadedImgs[pageDef.cacheIndex].remove();\n\n          _dom.loadedImgs[pageDef.cacheIndex] = undefined;\n        }\n      }\n    }\n  } // #endregion Document state switching\n  // #region Ajax Functions and Callbacks\n  // contacts the server for image info, JSON is returned to __onDocumentInfoLoaded\n  // kvp: object, key value pairs to pass to the request\n  // callback: function to execute after the request is done\n\n\n  function __loadDocumentInfoAsync(kvp, callback) {\n    _state.loading = true;\n    var params = {\n      atala_docurl: _config.documenturl,\n      atala_pagebuffer: _config.pagebuffersize,\n      atala_minwidth: _config.minwidth,\n      atala_tiling: _config.tiling,\n      atala_bookmarks: _config.showbookmarks\n    };\n\n    if (_isThumbnailer) {\n      params.atala_thumb = _isThumbnailer;\n      params.atala_capt_format = _config.thumbcaptionformat;\n    }\n\n    if (_config.tiling) {\n      //It is possible that info loading take a considerable amount of time - add spinner\n      _dom.scroller.addClass(domclasses.atala_page_loading);\n    }\n\n    if (kvp != null) {\n      if (typeof kvp === 'function') {\n        callback = kvp;\n        kvp = null;\n      }\n\n      atalaJquery.extend(params, kvp);\n    }\n\n    var hRequest = {\n      type: 'docinfo',\n      serverurl: _config.serverurl,\n      query: '?ataladocinfo=',\n      method: 'GET',\n      data: params,\n      cancel: false,\n      info: {\n        pagewidth: -1,\n        pageheight: -1,\n        pagecount: -1\n      }\n    }; // these are defined inline so we have a closure reference to callback\n\n    function __success(info) {\n      __onDocumentInfoLoaded(info, callback);\n    }\n\n    function __error(xhr, txtStatus, err) {\n      __onDocumentLoadError(xhr, txtStatus, err, callback);\n    }\n\n    __makeHandlerRequest(hRequest, __success, __error);\n  } // event fired when the document info is received from the server\n  // info: object, key value pairs\n  // callback: function to execute when finished\n\n\n  function __onDocumentInfoLoaded(info, callback) {\n    if (_config.tiling) {\n      _dom.scroller.removeClass(domclasses.atala_page_loading);\n    }\n\n    if (info && info.licensed !== false) {\n      _page.size.width = info.pagewidth;\n      _page.size.height = info.pageheight;\n      _page.count = info.pagecount;\n      _page.buffer = _config.pagebuffersize;\n      _page.dpi = info.dpi;\n      _page.vector = info.vector === true;\n      _page.caption = info.thumbcaptionformat || (_config.showthumbcaption ? '{0}' : '');\n\n      _maxDocSize.zero();\n\n      _controllers.memory.clearEntries();\n\n      _controllers.memory.colorDepth = info.colordepth;\n      _controllers.memory.pageSize = {\n        width: info.pagewidth,\n        height: info.pageheight\n      };\n\n      __triggerEvent({\n        type: 'documentinfochanged',\n        info: {\n          count: _page.count,\n          dpi: _page.dpi,\n          size: {\n            height: _page.size.height,\n            width: _page.size.width\n          },\n          vector: _page.vector,\n          pagesizes: info.pagesizes,\n          bookmarks: info.bookmarks\n        },\n        customData: info.customData\n      }); // load before page divs creations since it could trigger per-page load.\n\n\n      if (_controllers.text) {\n        _controllers.text.clear();\n\n        if (_dom.search) {\n          _dom.search.ClearSearch();\n        }\n\n        if (info.text) {\n          _controllers.text.loadText(info);\n        }\n      } // _state.loading == true represents the first pass, if it's false\n      // there are more page sizes loading from the server.\n\n\n      if (_state.loading) {\n        // reset previous zoom state to start from scratch.\n        _config.zoom = 1;\n\n        __createPageDivs();\n\n        __setScrollPositionAsync(0, 0);\n\n        if (_dom.scrollV) {\n          _dom.scrollV.pageNum(1);\n        }\n\n        __setPageNumber(1);\n\n        __fitAsync(_config.fitting, 1, function () {\n          __adjustEdgeWidths();\n\n          __adjustEdgeHeights(0, _dom.pageDivs.length - 1); // add the pages after we fit so they don't load twice\n\n\n          if (_isSinglePageMode) {\n            for (var i = 0; i < _dom.pageDivs.length && i < _page.count; i++) {\n              __insertPageContents(_dom.pageDivs[i], null, i);\n            }\n\n            _dom.content.append(_dom.pageDivs[0]);\n          } else {\n            for (var _i3 = 0; _i3 < _dom.pageDivs.length && _i3 < _page.count; _i3++) {\n              _dom.content.append(_dom.pageDivs[_i3]);\n\n              __insertPageContents(_dom.pageDivs[_i3], null, _i3);\n            }\n          }\n\n          if (_dom.pageDivs.length > 0) {\n            _dom.pageDivs[0].addClass(domclasses.atala_active_page);\n          } // were annotations included in this request?\n\n\n          if (info.layers && info.layers.length) {\n            _controllers.annotations.loadAnnotations(info);\n          } else if (_config.annotationsurl && _controllers.annotations) {\n            // we wanted to load annotations but something bad happened.\n            // so clear old annotations to not confuse client.\n            _controllers.annotations.clear();\n          } // forms included?\n\n\n          if (_controllers.forms) {\n            _controllers.forms.clear();\n\n            if (info.forms) {\n              _controllers.forms.loadForms(info);\n            }\n          }\n\n          _controllers.mouseTool.setTool(_config.mousetool.type && !_isThumbnailer ? _config.mousetool.type : MouseToolType.Pan, MouseToolType.None); // drop loading flag since if exception happens here, it will stuck. fitting could be synchronous.\n\n\n          _state.loading = false; // recalculate edges background(in case if no zoom were applied after load).\n\n          __updateEdgeBackgroundPlaceholders(); // only execute the callback if it exists\n\n\n          if (typeof callback === 'function') {\n            callback(info.error, info);\n          }\n\n          if (info.error) {\n            setTimeout(function () {\n              // if showerrors is set to true, this will break execution in the middle of initialization, especially if we are in viewer-thumbnailer chain.\n              // throw asynchronously to prevent that - we are already asynchronous anyway.\n              __throwError('DocumentLoadError', info.error);\n            }, 0);\n          }\n        });\n      }\n\n      _state.loading = false;\n    } else {\n      var errorType;\n      var msg;\n\n      if (info && info.licensed === false) {\n        errorType = 'LicenseException';\n        msg = info.error ? info.error : 'LicenseException: Handler was unable to find a valid license.';\n      } else {\n        errorType = 'DocumentLoadError';\n        msg = 'HandlerException: Handler did not return any data.';\n      }\n\n      _state.loading = false; // only execute the callback if it exists\n\n      if (typeof callback === 'function') {\n        callback.call(undefined, msg);\n      }\n\n      if (errorType && msg) {\n        __throwError(errorType, msg);\n      }\n    }\n  } // event fired when there was an error retrieving the document info\n  // xhr: XMLHttpRequest object\n  // txtStatus: string, status message\n  // err: string, error message\n  // callback: function to call after the error is handled\n\n\n  function __onDocumentLoadError(xhr, txtStatus, err, callback) {\n    if (_config.tiling) {\n      _dom.scroller.removeClass(domclasses.atala_page_loading);\n    }\n\n    if (xhr.responseText) {\n      var txt = xhr.responseText.substr(xhr.responseText.indexOf('</html>') + 7); // tries to find the normal .NET error text located after the html tag\n\n      if (txt.indexOf('<!--') >= 0) {\n        txt = txt.replace('<!--', '').replace('-->', '');\n\n        if (txt.length > 0) {\n          err = '<pre>' + txt + '</pre>';\n        }\n      } else {\n        if (xhr.responseText.indexOf('web.config') > 0 && xhr.responseText.indexOf('customErrors') > 0) {\n          err += ': web.config customErrors attribute has disabled remote error messages.';\n        }\n      }\n    }\n\n    __throwError('DocumentLoadError', err); // only execute the callback if it exists\n\n\n    if (typeof callback === 'function') {\n      callback.call(undefined, err);\n    }\n  }\n\n  function __onDocumentChanged() {\n    __invalidateDocument();\n  }\n\n  function __invalidateDocument(pageIndex) {\n    __createPageDivs();\n\n    if (_dom.pageDivs.length > 0) {\n      var pgcount = _controllers.document.getPageCount(); // if page was deleted or inserted we shift the indexes\n\n\n      var startPage = typeof pageIndex === 'number' ? pageIndex : _dom.pageDivs[0]._index;\n      startPage = startPage >= 0 ? Math.min(startPage, pgcount - _dom.pageDivs.length) : 0; // need to be careful with this method: if it's called during images loading, then loaded event won't be called in IE.\n\n      for (var i = 0; i < _dom.pageDivs.length && i < pgcount; i++) {\n        var idx = startPage + i;\n\n        __removePageContents(_dom.pageDivs[i]);\n\n        __insertPageContents(_dom.pageDivs[i], null, idx);\n\n        if (_isSinglePageMode && i > 0) {\n          continue;\n        }\n\n        _dom.content.append(_dom.pageDivs[i]);\n      }\n    } // need to recalculate pagedivs and edges\n\n\n    __adjustEdgeHeights(_dom.pageDivs.length > 0 ? _dom.pageDivs[0]._index : 0, null);\n\n    __adjustEdgeWidths();\n\n    __redrawVisiblePages();\n\n    __adjustScrollBars();\n\n    __recalculateMaxDocumentSize();\n\n    if (_isSinglePageMode) {\n      var nindx = _dom.pageDivs.length > 0 ? _dom.pageDivs[0]._index : 0;\n\n      __setPageNumber(nindx + 1);\n    } else {\n      var x = _dom.scroller[0].scrollLeft;\n      var y = _dom.scroller[0].scrollTop;\n\n      var visiblePage = __getUIIndexFromPos(x, y);\n\n      __setPageNumber(visiblePage + 1);\n\n      if (pageIndex >= 0 && visiblePage !== pageIndex) {\n        // we've created page divs, but if the page is within 'buffer size' range from the end of the doc,\n        // it's won't be in the first div and we have to shift it.\n        __showPageAtIndex(pageIndex);\n      }\n    }\n  }\n\n  function __startObserver() {\n    var _this12 = this;\n\n    if (Browser.Edge || Browser.Explorer) {\n      var observerTimeout = setInterval(function () {\n        WebDocumentViewer_newArrowCheck(this, _this12);\n\n        if (_dom.scroller.height() !== 0 && _dom.scroller.width() !== 0) {\n          clearInterval(observerTimeout);\n          _state.hidden = false;\n\n          __triggerEvent('viewportunhide');\n        }\n      }.bind(this), 500);\n    } else {\n      var observer = new ResizeObserver(function () {\n        WebDocumentViewer_newArrowCheck(this, _this12);\n\n        _state.hidden = false;\n\n        __triggerEvent('viewportunhide');\n\n        observer.unobserve(_dom.scroller[0]);\n      }.bind(this));\n      observer.observe(_dom.scroller[0]);\n    }\n  } // contacts the server to save changes, JSON is returned to __onDocumentSaved\n  // kvp: object, key value pairs to pass to the request\n  // callback: function to execute when finished\n\n\n  function __saveDocumentAsync(kvp, callback) {\n    var params = {\n      'atala_docurl': _config.documenturl,\n      'atala_spath': _config.savepath\n    };\n    atalaJquery.extend(params, kvp);\n    var hRequest = {\n      type: 'docsave',\n      serverurl: _config.serverurl,\n      query: '?ataladocsave=',\n      method: 'POST',\n      data: params,\n      cancel: false,\n      info: {\n        // response from server\n        success: undefined,\n        error: undefined\n      }\n    }; // defined inline so we have a closure reference to callback\n\n    function __complete(info) {\n      __onDocumentSaved(info); // only execute the callback if it exists\n\n\n      if (typeof callback === 'function') {\n        callback.call();\n      }\n    }\n\n    function __error(jqXHR) {\n      var info = [];\n      info.error = jqXHR.responseText;\n\n      __complete(info);\n    }\n\n    __makeHandlerRequest(hRequest, __complete, __error);\n  } // event fired after the document has been saved (regardless of errors)\n  // info: object, json returned from server\n\n\n  function __onDocumentSaved(info) {\n    if (info.error) {\n      __throwError('DocumentSaveError', info.error);\n    } else {\n      __status('DocumentSave: success=' + info.success);\n    }\n\n    __triggerEvent({\n      type: 'documentsaved',\n      success: info.success,\n      customData: info.customData,\n      fileName: info.fileName\n    });\n  }\n\n  function __processRequestUrl(rurl, docurl, controller) {\n    var request = null;\n\n    if (typeof rurl === 'string') {\n      // input is good\n      request = {};\n\n      if (_state.initialized && controller) {\n        if (rurl.length > 0) {\n          //clear\n          controller.clear(); // make request object\n\n          request = controller.createHandlerRequest(_config.serverurl, rurl, docurl);\n        } else if (rurl.length === 0) {\n          // clear\n          controller.clear();\n        }\n      }\n\n      request.url = rurl;\n    } else {\n      // input is not a string, since we do nothing when this is null/undefined, only error on bad type\n      if (rurl !== undefined && rurl != null) {\n        __throwError('openUrlError', 'string input expected for url.');\n      }\n    }\n\n    return request;\n  }\n\n  function __beforeAnnotationsDataRequest() {\n    __bindEvents({\n      annotationsloaded: __onAnnotationsLoaded\n    });\n  }\n\n  function __makeAnnotationsHandlerRequest(annRequest, callback) {\n    if (_controllers.annotations) {\n      __beforeAnnotationsDataRequest();\n\n      _controllers.annotations.makeHandlerRequest(annRequest, callback);\n    }\n  }\n\n  function __beforeFormsDataRequest() {\n    __bindEvents({\n      formsloaded: __onFormsLoaded\n    });\n  }\n\n  function __makeFormsHandlerRequest(formsRequest, callback) {\n    if (_controllers.forms) {\n      __beforeFormsDataRequest();\n\n      _controllers.forms.makeHandlerRequest(formsRequest, callback);\n    }\n  } // redraws the visible pages\n\n\n  function __redrawVisiblePages(force) {\n    if (_dom.pageDivs.length > 0 && _dom.pageDivs[0]._index === undefined) {\n      return;\n    } else {\n      for (var i = 0; i < _dom.pageDivs.length; i++) {\n        __redrawPage(_dom.pageDivs[i], force);\n      }\n    }\n  }\n\n  function __redrawPageFromIndex(i, force) {\n    var page = __findPageFromIndex(i);\n\n    if (page) {\n      __redrawPage(page, force);\n    }\n  }\n\n  function __redrawPage(pg, force) {\n    // if insertPageContents returns true, it needs other elements to redraw\n    if (__insertPageContents(pg, __requestPageAsync(pg._index), pg._index) || force) {\n      if (_controllers.annotations) {\n        _controllers.annotations.showLayer(pg._index, pg);\n      }\n\n      if (_controllers.forms && !_isThumbnailer) {\n        _controllers.forms.showLayer(pg._index, pg);\n      }\n\n      if (_controllers.text && !_isThumbnailer && _config.allowtext) {\n        _controllers.text.showLayer(pg._index, pg);\n      }\n    }\n  } // event fired when the annotation data is finished loading\n\n\n  function __onAnnotationsLoaded(e) {\n    if (e.error) {\n      __throwError('AnnotationsLoadError', e.error);\n\n      _config.annotationsurl = '';\n    }\n\n    if (_controllers.annotations) {\n      __unbindEvents({\n        annotationsloaded: __onAnnotationsLoaded\n      });\n    }\n  } // event fired when the forms data is finished loading\n\n\n  function __onFormsLoaded(e) {\n    if (e.error) {\n      __throwError('FormsLoadError', e.error);\n\n      _config.formsurl = '';\n    }\n\n    if (_controllers.forms) {\n      __unbindEvents({\n        formsloaded: __onFormsLoaded\n      });\n    }\n  } // fires an event before a request is sent to the handler\n  // hRequest: object, handler request object\n\n\n  function __beforeHandlerRequest(hRequest) {\n    __triggerEvent({\n      type: 'beforehandlerrequest',\n      request: hRequest\n    });\n  } // makes a request to the handler\n  // hRequest: object, handler request object\n  // success: function to execute when the request succeeded\n  // error: function to execute when an error occurs\n\n\n  function __makeHandlerRequest(hRequest, _success, _error, progress) {\n    var _this13 = this;\n\n    var handlerHook = __bindHandlerReturned(hRequest, function (e) {\n      _success(e.request.info);\n    });\n\n    __beforeHandlerRequest(hRequest);\n\n    if (!hRequest.cancel) {\n      // request wasn't cancelled, need to unbind handlerHook\n      __unbindEvents({\n        handlerreturned: handlerHook\n      });\n\n      if (hRequest.serverurl && !atalaJquery.isEmptyObject(hRequest.data)) {\n        if (hRequest.info instanceof atalaJquery && hRequest.type === 'docpage') {\n          // image request\n          hRequest.info.attr('src', hRequest.serverurl + hRequest.query + '&' + atalaJquery.param(hRequest.data));\n        } else if (hRequest.type === 'fileupload') {\n          // file upload\n          var requestData = '&' + atalaJquery.param(hRequest.data);\n          var formData = new FormData();\n          formData.append('file', hRequest.file, hRequest.file.name);\n          var jqxhr = atalaJquery.ajax({\n            type: hRequest.method,\n            url: hRequest.serverurl + hRequest.query + '??' + requestData,\n            dataType: 'json',\n            data: formData,\n            contentType: false,\n            processData: false,\n            success: function success(event) {\n              WebDocumentViewer_newArrowCheck(this, _this13);\n\n              if (event.success) {\n                event.success = JSON.parse(event.success);\n              }\n\n              if (event.canceled) {\n                event.canceled = JSON.parse(event.canceled);\n              }\n\n              _success(event, hRequest.file.name);\n            }.bind(this),\n            error: function error(err, status, message) {\n              WebDocumentViewer_newArrowCheck(this, _this13);\n\n              _error(status, message, hRequest.file.name);\n            }.bind(this),\n            crossDomain: typeof hRequest.method === 'string' && hRequest.method.toLowerCase() === 'post' ? false : undefined,\n            xhr: function xhr() {\n              var _this14 = this;\n\n              WebDocumentViewer_newArrowCheck(this, _this13);\n\n              var xhr = new XMLHttpRequest();\n              xhr.upload.addEventListener('progress', function (evt) {\n                WebDocumentViewer_newArrowCheck(this, _this14);\n\n                if (evt.lengthComputable) {\n                  if (!progress(hRequest.file.name, evt.loaded, evt.total)) jqxhr.abort();\n                }\n              }.bind(this), false);\n              return xhr;\n            }.bind(this)\n          });\n          return jqxhr;\n        } else {\n          return atalaJquery.ajax({\n            type: hRequest.method,\n            url: hRequest.serverurl + hRequest.query + '?',\n            dataType: 'json',\n            data: hRequest.data,\n            success: _success,\n            error: _error,\n            crossDomain: typeof hRequest.method === 'string' && hRequest.method.toLowerCase() === 'post' ? false : undefined\n          });\n        }\n      }\n    }\n  } // binds a return function to execute when a handler request is finished\n  // hRequest: object, handler request object\n  // fnc: function to execute when the handler has responded\n\n\n  function __bindHandlerReturned(hRequest, fnc) {\n    var anon = function anon(e) {\n      // need to make sure that we only respond to the request we were given\n      if (e.request === hRequest) {\n        __unbindEvents({\n          handlerreturned: anon\n        });\n\n        if (typeof fnc === 'function') {\n          fnc.call(this, e);\n        }\n      }\n    };\n\n    __bindEvents({\n      handlerreturned: anon\n    });\n\n    return anon;\n  } // #endregion\n  // #region Undocumented Public functions\n\n  /**\r\n   * [Internal] Gets debug info object\r\n   * @returns debug info object if available, otherwise null\r\n   */\n\n\n  _self.__getDebugInfo = __getDebugInfo;\n\n  function __getDebugInfo() {\n    var info = {\n      version: Version.join('.')\n    };\n\n    if (_config.debug) {\n      atalaJquery.extend(true, info, {\n        dom: _dom,\n        controllers: _controllers,\n        page: _page\n      });\n    }\n\n    return info;\n  }\n  /**\r\n   * [Internal] Gets the viewer linkage for controls that inherit this one\r\n   * @param viewer object of type WebDocumentViewer\r\n   * @returns linker object if possible, otherwise undefined\r\n   */\n\n\n  _self.__getViewerLink = __getViewerLink;\n\n  function __getViewerLink(viewer) {\n    function __LVlinker() {\n      this.typeOf = '__LVlinker';\n      this._id = _id; // objects that cannot be cloned (need reference)\n\n      this._config = _config;\n      this._controllers = _controllers;\n      this._dom = _dom;\n      this._page = _page;\n      this._state = _state;\n      this._annos = null;\n      this._fields = null;\n      this.stateManager = _stateManager;\n      this.__createDialog = __createDialog;\n      this.__createDiv = __createDiv;\n      this.__createDOM = __createDOM;\n      this.__createDropDownButton = __createDropDownButton;\n      this.__createDropDownMenu = __createDropDownMenu;\n      this.__createMenu = __createMenu;\n      this.__getPageSize = __getPageSize;\n      this.__getTabularIndexOffset = __getTabularIndexOffset;\n      this.__redrawVisiblePages = __redrawVisiblePages;\n      this.__adjustVisiblePages = __adjustVisiblePages;\n      this.__onDocumentChanged = __onDocumentChanged;\n      this.__startDomManipulation = __startDomManipulation;\n      this.__endDomManipulation = __endDomManipulation;\n      this.__status = __status;\n      this.__updatePageSize = __onSharedPageSizeChanged;\n      this.__silentReloadPage = __silentReloadPage;\n      this.__isObjectInRect = __isObjectInRect;\n      this.__getIndexFromPos = __getIndexFromPos;\n      this.__showNext = __showNext;\n      this.__showPrevious = __showPrevious;\n      this.__showPageAsync = __showPageAsync;\n      this.__adjustEdgeHeights = __adjustEdgeHeights;\n      this.__getSelectedPagesIndices = __getSelectedPagesIndices;\n    }\n\n    if (viewer) {\n      if (viewer.typeOf === 'Atalasoft.Controls.WebDocumentThumbnailer') {\n        //!!link everything to itself. data exchange will happen lated on document switching.\n        var lnk = new __LVlinker(); // not sure if this change should be applied to the annotations and the forms yet\n        // but the linker wasn't really doing anything besides providing references to data\n\n        _controllers.document.__linkChanges(lnk);\n\n        if (_config.allowannotations) {\n          // annotations are about to be linked to the thumbs, so we need to make sure they don't load\n          if (viewer !== _self && _config.annotationsurl.length > 0) {\n            _config.annotationsurl = '';\n          }\n\n          _controllers.annotations.__linkAnnotations(lnk);\n        }\n\n        if (_config.allowforms) {\n          // forms are about to be linked to the thumbs, so we need to make sure they don't load\n          if (viewer !== _self && _config.formurl.length > 0) {\n            _config.formurl = '';\n          }\n\n          _controllers.forms.__linkForms(lnk);\n        }\n\n        if (_config.allowtext) {\n          if (_controllers.text) {\n            _controllers.text.__linkText(lnk);\n          }\n        }\n\n        return lnk;\n      }\n    }\n  } // #endregion\n  // #region Public functions\n\n\n  _self.dispose = __dispose;\n  _self.empty = __emptyAsync;\n  _self.fit = __fitAsync;\n  _self.getZoom = __getZoom;\n  _self.isReady = __isReady;\n  _self.scrollTo = __scrollToAsync;\n  _self.scrollBy = __scrollByAsync;\n  _self.next = _isSinglePageMode ? __showNext : __scrollNextAsync;\n  _self.previous = _isSinglePageMode ? __showPrevious : __scrollPreviousAsync;\n  _self.zoom = __setZoomAsync;\n  _self.zoomIn = __zoomInAsync;\n  _self.zoomOut = __zoomOutAsync;\n  _self.openUrl = _self.OpenUrl = __openUrlAsync;\n  _self.save = __saveChanges;\n  _self.uploadFiles = __uploadFiles;\n  _self.uploadFile = __uploadFile;\n  _self.filterFilesForUpload = __filterFilesForUpload;\n  _self.getCurrentPageIndex = __getCurrIndex;\n  _self.bind = __bindEvents;\n  _self.unbind = __unbindEvents;\n  _self.trigger = __triggerEvent;\n  _self.getDocumentInfo = __getDocumentInfo;\n  _self.setMouseTool = __setMouseTool;\n  _self.isPageLoaded = __isPageLoaded;\n  _self.reloadPage = __reloadPage; // defined in scrolling region\n\n  _self.showPage = __showPageAtIndex;\n  _self.showPageNumber = __showPage; // need to pre-define exposed controller functions for intellisense\n\n  controller_AnnotationController();\n  DocumentController();\n  controller_FormController();\n  controller_TextController();\n  _self.annotations = controller_AnnotationController.__exposedApi;\n  _self.document = DocumentController.__exposedApi;\n  _self.forms = controller_FormController.__exposedApi;\n  _self.text = controller_TextController.__exposedApi;\n  /**\r\n   * Resets the viewer to its default state.\r\n   * @param {OpenUrlCallback} [callback]  - Function to execute when the empty process is finished\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function empty\r\n   */\n\n  function __emptyAsync(callback) {\n    _state.loading = true;\n\n    var unloadCompleted = function unloadCompleted() {\n      __adjustScrollBars();\n\n      __triggerEvent({\n        type: 'documentunloaded'\n      }); // only execute the callback if it exists\n\n\n      if (typeof callback === 'function') {\n        callback.call();\n      }\n    };\n\n    __clearUI();\n\n    __onDocumentInfoLoaded({\n      pagewidth: 0,\n      pageheight: 0,\n      pagecount: -1\n    }, unloadCompleted);\n  }\n\n  function __clearUI(preserveCache) {\n    if (_state.initialized) {\n      __emptyPages();\n\n      __createPageDivs(0);\n\n      if (!preserveCache) __emptyImages();\n\n      _dom.edges[0].width(0).height(0);\n\n      _dom.edges[1].width(0).height(0);\n\n      if (_dom.scrollH) {\n        _dom.scrollH.scrollSize(0);\n\n        __adjustScrollbarVisibility(_dom.scrollH);\n      }\n\n      if (_dom.scrollV) {\n        _dom.scrollV.scrollSize(0);\n\n        __adjustScrollbarVisibility(_dom.scrollV);\n      }\n\n      if (_isSinglePageMode) {\n        __setPageNumber(1);\n      }\n\n      __clearEdgesBackground();\n    }\n  }\n  /**\r\n   * Gets the current zoom level of the viewer.\r\n   * @returns {number}\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function getZoom\r\n   */\n\n\n  function __getZoom() {\n    return _config.zoom;\n  }\n  /**\r\n   * Indicates whether the viewer is ready to receive commands.\r\n   *\r\n   * If all dependent JavaScript libraries are included to the web page, control is initialized synchronously.\r\n   * Otherwise dependencies are asynchronously loaded automatically using {@link WebDocumentViewerConfig.scripturl|scripturl} parameter or from the same url where JQuery library is referenced.\r\n   * When all dependent JavaScript libraries are loaded, {@link Atalasoft.Controls.WebDocumentViewer#event:initialized|initialized} event is fired.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function isReady\r\n   * @returns {boolean}\r\n   */\n\n\n  function __isReady() {\n    return _state.initialized;\n  }\n  /**\r\n   * Scrolls to the given coordinates, does not account for zoom, i.e. `x` and `y` values are passed in window coordinate space.\r\n   * @param {number} x - Indicating the coordinate of the x axis.\r\n   * @param {number} y - Indicating the coordinate of the y axis.\r\n   * @param {boolean} [ani=false] - Indicating whether to animate this scroll.\r\n   * @param {NotificationCallback} [callback] - function to execute when the scroll operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function scrollTo\r\n   */\n\n\n  function __scrollToAsync(x, y, ani, callback) {\n    if (callback == null && typeof ani === 'function') {\n      callback = ani;\n      ani = false;\n    }\n\n    __setScrollPositionAsync(x, y, ani, null, callback);\n  }\n  /**\r\n   * Scrolls by the given deltas, does not account for zoom, i.e. `dx` and `dy` values are passed in window coordinate space.\r\n   * @param {number} dx - Indicating delta of the x axis.\r\n   * @param {number} dy - Indicating delta of the y axis .\r\n   * @param {boolean} [ani=false] - Indicating whether to animate this scroll.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the scroll operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function scrollBy\r\n   */\n\n\n  function __scrollByAsync(dx, dy, ani, callback) {\n    if (callback == null && typeof ani === 'function') {\n      callback = ani;\n      ani = false;\n    }\n\n    __setScrollPositionByAsync(dx, dy, ani, null, callback);\n  }\n  /**\r\n   * Scrolls to the next viewable page.\r\n   * @param {number} n - Number of pages to scroll forward.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the scroll operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function next\r\n   */\n\n\n  function __scrollNextAsync(n, callback) {\n    var inc = _config.direction === ScrollDirection.Vertical ? __getTabularIndexOffset() : 1;\n\n    if (callback == null && typeof n === 'function') {\n      callback = n;\n      n = inc;\n    }\n\n    if (!isFinite(n)) {\n      n = inc;\n    }\n\n    __scrollNextPrevAsync(n, callback);\n  }\n  /**\r\n   * Scrolls to the previous viewable page.\r\n   * @param {number} n - Number of pages to scroll backward.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the scroll operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function previous\r\n   */\n\n\n  function __scrollPreviousAsync(n, callback) {\n    var inc = _config.direction === ScrollDirection.Vertical ? __getTabularIndexOffset() : 1;\n\n    if (callback == null && typeof n === 'function') {\n      callback = n;\n      n = inc;\n    }\n\n    if (!isFinite(n)) {\n      n = inc;\n    }\n\n    __scrollNextPrevAsync(-n, callback);\n  }\n  /**\r\n   * Zooms in one level.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the zoom operation is finished\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function zoomIn\r\n   */\n\n\n  function __zoomInAsync(callback) {\n    __zoomAsync(false, callback);\n  }\n  /**\r\n   * Zooms out one level.\r\n   * @param  {NotificationCallback} [callback] - Function to execute when the zoom operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function zoomOut\r\n   */\n\n\n  function __zoomOutAsync(callback) {\n    __zoomAsync(true, callback);\n  }\n  /**\r\n   * Callback signature for {@link Atalasoft.Controls.WebDocumentViewer#openUrl | openUrl} method.\r\n   * @callback OpenUrlCallback\r\n   * @param {string} error - If present, provides error description. If `undefined`, operation were successful.\r\n   */\n\n  /**\r\n   * Opens the document at the given urls.\r\n   * It's possible to call this method multiple times for the same document to load document and the forms or annotations data separately.\r\n   *\r\n   * @param {string} [documenturl] - url of the document file with respect to the {@link WebDocumentViewerConfig.serverurl | config.serverurl}.\r\n   *\r\n   * If set to empty string, call is equivalent to {@link Atalasoft.Controls.WebDocumentViewer#empty|empty}.\r\n   *\r\n   * @param {string} [annotationsurl] - url of the annotation xmp file with respect to the {@link WebDocumentViewerConfig.serverurl| config.serverurl}.\r\n   *\r\n   * *Note*, If empty string is passed, annotations from the previous document are cleared. if not passed or `undefined`, annotations from the previously opened document are preserved.\r\n   * @param {string} [formurl] - url of the form file with respect to the {@link WebDocumentViewerConfig.serverurl| config.serverurl}.\r\n   * @param {OpenUrlCallback} [callback] - Function to execute when the open operation is finished.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function openUrl\r\n   */\n\n\n  function __openUrlAsync(documenturl, annotationsurl, formurl, callback) {\n    if (callback == null) {\n      if (typeof annotationsurl === 'function') {\n        callback = annotationsurl;\n        annotationsurl = null;\n      } else if (typeof formurl === 'function') {\n        callback = formurl;\n        formurl = null;\n      }\n    }\n\n    var requests = 0;\n    var infoRequested = false;\n\n    var annRequest = __processRequestUrl(annotationsurl, documenturl, _controllers.annotations);\n\n    var formRequest = __processRequestUrl(formurl || documenturl, documenturl, _controllers.forms);\n\n    _config.annotationsurl = annRequest ? annRequest.url : _config.annotationsurl;\n    _config.formsurl = formRequest ? formRequest.url : _config.formsurl; // nested callback function so we don't have to store given callback\n\n    var requestCompleted = function requestCompleted(error, info) {\n      requests--;\n\n      if (requests <= 0) {\n        __redrawVisiblePages(true);\n\n        __triggerEvent({\n          type: 'documentloaded',\n          customData: info === undefined || info === null ? undefined : info.customData\n        }); // only execute the callback if it exists\n\n\n        if (typeof callback === 'function') {\n          callback.call(undefined, error, info);\n        }\n      }\n    }; // load image info\n\n\n    if (typeof documenturl === 'string') {\n      if (documenturl.length === 0) {\n        __emptyAsync(requestCompleted);\n      } else {\n        _config.documenturl = documenturl;\n\n        if (_state.initialized) {\n          __clearUI();\n\n          __resetScrollbarTimeout(_dom.scrollH);\n\n          __resetScrollbarTimeout(_dom.scrollV);\n\n          requests++; // add annotations to this request if allowed\n\n          var params = {};\n\n          if (_config.allowannotations && annRequest && annRequest.data) {\n            __beforeAnnotationsDataRequest();\n\n            atalaJquery.extend(params, annRequest.data);\n          } // add forms to this request if allowed\n\n\n          if (_config.allowforms && formRequest && formRequest.data) {\n            __beforeFormsDataRequest();\n\n            atalaJquery.extend(params, formRequest.data);\n          } // let the rest of the function know that the main document info has been requested\n\n\n          infoRequested = true; // async call, do not do anything after this\n          // this will complete before the next condition, if data is immediately provided\n\n          __loadDocumentInfoAsync(params, requestCompleted);\n        }\n      }\n    } else {\n      // allow for opening or clearing annotations and forms if there is a document loaded already\n      var clearRequest = !!(!documenturl && _config.documenturl.length > 0 && (annotationsurl || annotationsurl === '' || formurl || formurl === ''));\n\n      if (!clearRequest) {\n        __throwError('openUrlError', 'string input expected for document url.');\n      }\n    } // make requests since the document wasn't requested\n\n\n    if (!infoRequested) {\n      if (annRequest) {\n        requests++; // async call, do not do anything after this\n\n        __makeAnnotationsHandlerRequest(annRequest, requestCompleted);\n      }\n\n      if (formRequest) {\n        requests++; // async call, do not do anything after this\n\n        __makeFormsHandlerRequest(formRequest, requestCompleted);\n      }\n    }\n  }\n  /**\r\n   * Saves the client changes in this document to the predefined save folder or to the given path.\r\n   * @param {string} [subpath] - Relative path to save to starting from {@link WebDocumentViewerConfig.savepath | savepath}. Must be writable.\r\n   * @param {string} [saveformat] - Save file format. If specified, the value overrides {@link WebDocumentViewerConfig.savefileformat | savefileformat} form config.\r\n   * @param {object} [params] - A plain object containing optional reload parameters that will be passed to server.\r\n   * @param {NotificationCallback} [callback]  to execute when the save has finished\r\n   * @instance\r\n   * @memberof Atalasoft.Controls.WebDocumentViewer\r\n   * @function save\r\n   *\r\n   * @example\r\n   * const _viewer = new Atalasoft.Controls.WebDocumentViewer({\r\n   * \t\tparent: atalaJquery('#atala-document-container-left'),\r\n   * \t\ttoolbarparent: atalaJquery('#atala-document-toolbar-left'),\r\n   *\t\tserverurl: 'WebDocumentHandler.ashx',\r\n   *\t\tsavepath: 'Save/',\r\n   *\t\tsavefileformat: 'pdf'\r\n   * });\r\n   *\r\n   * // document will be saved to the subpath subfolder. So if the savepath configuration\r\n   * // parameter was set to Save/ then the save path will be Save/subpath. The format to save the file to will\r\n   * // be taken from the configuration parameter savefileformat (in this example, 'pdf').\r\n   * // This means that the file in pdf format will be saved in Save/subpath folder.\r\n   *  _viewer.save(subpath) // saves to Save/subpath in pdf format\r\n   *\r\n   * // document will be saved to Save/ folder in tif format.\r\n   * _viewer.save(, tif)\r\n   */\n\n\n  function __saveChanges(subpath, saveformat, params, callback) {\n    if (typeof params === 'function') {\n      callback = params;\n      params = {};\n    }\n\n    if (typeof saveformat === 'function') {\n      callback = saveformat;\n      saveformat = _config.savefileformat;\n    }\n\n    if (typeof subpath === 'function') {\n      callback = subpath;\n      subpath = null;\n    }\n\n    if (saveformat === undefined) {\n      saveformat = _config.savefileformat;\n    }\n\n    var saveParams = atalaJquery.extend(true, params, {\n      'atala_subpath': subpath || '',\n      'atala_sformat': saveformat\n    });\n\n    if (_controllers.annotations) {\n      atalaJquery.extend(saveParams, {\n        'atala_iuname': _config.annotations.saveusername,\n        'atala_annos': _controllers.annotations.stringifyChanges()\n      });\n    }\n\n    if (_controllers.forms) {\n      atalaJquery.extend(saveParams, {\n        'atala_forms': _controllers.forms.stringifyChanges()\n      });\n    }\n\n    if (_controllers.document) {\n      atalaJquery.extend(saveParams, {\n        'atala_document': _controllers.document.stringifyChanges()\n      });\n    }\n\n    if (_config.savepreviouslysigneddocument) {\n      atalaJquery.extend(saveParams, {\n        'atala_savesigned': 'true'\n      });\n    } // async call, do not do anything after this\n\n\n    __saveDocumentAsync(saveParams, callback);\n  }\n\n  function __showUploadUi() {\n    var _this15 = this;\n\n    if (_isThumbnailer) return;\n\n    _controllers.upload.uploadWithUi(function (enable) {\n      WebDocumentViewer_newArrowCheck(this, _this15);\n\n      if (enable) {\n        _dom.toolbar.controlgroup('enable');\n\n        if (_config.allowannotations) {\n          _dom.toolbar.annoToolbar.controlgroup('enable');\n        }\n\n        _dom.toolbar.find('.atala_page_label, .atala_search_container').removeClass('ui-state-disabled');\n      } else {\n        _dom.toolbar.controlgroup('disable');\n\n        if (_dom.toolbar.annoToolbar) {\n          _dom.toolbar.annoToolbar.controlgroup('disable');\n        }\n\n        _dom.toolbar.find('.atala_page_label, .atala_search_container').addClass('ui-state-disabled');\n      }\n    }.bind(this));\n  }\n  /**\r\n   * Uploads several files on server to the predefined upload folder or to the given path.\r\n   * @param {Array<File>} files - Array of file objects that should be uploaded.\r\n   * @param {string} [uploadpath] - Relative path to upload to starting from {@link WebDocumentViewerConfig.upload.uploadpath | uploadpath}. Must be writable.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the upload has requested.\r\n   * @instance\r\n   * @memberof Atalasoft.Controls.WebDocumentViewer\r\n   * @function uploadFiles\r\n   *\r\n   */\n\n\n  function __uploadFiles(files, uploadpath, callback) {\n    if (_isThumbnailer) return;\n\n    _controllers.upload.uploadFiles(files, uploadpath, callback);\n  }\n  /**\r\n   * Uploads one file on server to the predefined upload folder or to the given path.\r\n   * @param {File} file - File object that should be uploaded.\r\n   * @param {string} [uploadpath] - Relative path to upload to starting from {@link WebDocumentViewerConfig.upload.uploadpath | uploadpath}. Must be writable.\r\n   * @param {NotificationCallback} [callback]  - Function to execute when the upload has requested.\r\n   * @instance\r\n   * @memberof Atalasoft.Controls.WebDocumentViewer\r\n   * @function uploadFile\r\n   *\r\n   * @example\r\n   * <caption>Assuming you have a {@link https://developer.mozilla.org/en-US/docs/Web/API/File | File } object in your script. It can be\r\n   * retrieved from a {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file | input} control or from server or any other way.</caption>\r\n   *\r\n   * let viewer = new Atalasoft.Controls.WebDocumentViewer({\r\n   *          ...\r\n   *          upload:{} //enable upload support with default parameters. Where uploadpath is the web-project root folder.\r\n   *          });\r\n   * let file = document.getElementById('fileInput'); //Retrieve File object\r\n   *\r\n   * viewer.uploadFile(file, 'uploadDirectory'); //Upload the file to the 'uploadDirectory' web-project root sub folder.\r\n   */\n\n\n  function __uploadFile(file, uploadpath, callback) {\n    if (_isThumbnailer) return;\n\n    _controllers.upload.uploadFile(file, uploadpath, callback);\n  }\n  /**\r\n   * Filters files that should be uploaded using the settings from config {@link WebDocumentViewerConfig.upload | upload} section.\r\n   * This includes filtering by size, by type and even by name in order to find out files for upload that have same names. It can be\r\n   * useful, because all events in WDV related to upload use filename as a key, thus you can find duplicates and upload\r\n   * such files in separate {@link Atalasoft.Controls.WebDocumentViewer#uploadFiles | uploadFiles} method calls.\r\n   *\r\n   * This method is fully optional and even if some files failed to pass this filtering, they still can be uploaded to server,\r\n   * @summary Filters files for upload using the settings from config {@link WebDocumentViewerConfig.upload | upload} section.\r\n   * @param {File[]} files - An array of file objects that can be used for upload.\r\n   * @param {string[]} [filteredFiles] - An array of filenames that previously were filtered. It's used for find duplicates in a new bunch of files.\r\n   * @param {NotificationCallback} [callback] - Function to execute when the filtering has finished.\r\n   * @returns {File[]} An array files that have passed the filtering.\r\n   * @instance\r\n   * @memberof Atalasoft.Controls.WebDocumentViewer\r\n   * @function filterFilesForUpload\r\n   */\n\n\n  function __filterFilesForUpload(files, filteredFiles, callback) {\n    if (_isThumbnailer) return;\n    return _controllers.upload.filterFilesPublic(files, filteredFiles, callback);\n  }\n  /**\r\n   * Gets the current page index\r\n   * @returns {number} Zero based index of the current page.\r\n   *\r\n   * Note, that current page index detection could be affected by {@link WebDocumentViewerConfig.pageselectlocation|pageselectlocation} configuration parameter.\r\n   * @instance\r\n   * @memberof Atalasoft.Controls.WebDocumentViewer\r\n   * @function getCurrentPageIndex\r\n   */\n\n\n  function __getCurrIndex() {\n    return _page.number - 1;\n  }\n  /**\r\n   * Sets the current mouse tool\r\n   * @param {Atalasoft.Utils.MouseToolType} tool - Type of the tool to set.\r\n   *\r\n   * Mouse tool configuration could be passed using {@link WebDocumentViewerConfig.mousetool| mousetool} configuration option.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function setMouseTool\r\n   */\n\n\n  function __setMouseTool(tool) {\n    for (var key in MouseToolType) {\n      if (MouseToolType.hasOwnProperty(key) && MouseToolType[key] === tool) {\n        _controllers.mouseTool.setTool(tool);\n\n        break;\n      }\n    }\n  }\n  /**\r\n   *  Attaches a handler to an event.\r\n   * @param {string} event - the name of the event to bind to.\r\n   * @param {function} handler - event handler.\r\n   * @returns {Atalasoft.Controls.WebDocumentViewer} reference to `this`.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function bind\r\n   */\n  // eslint-disable-next-line no-unused-vars\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  function __bindEvents(event, handler) {\n    __trackEventBinds(arguments, true);\n\n    _jqe.on.apply(_jqe, arguments);\n\n    return _self;\n  }\n  /**\r\n   * Detaches the handler from the event.\r\n   * @param {string} event - the name of the event to unbind.\r\n   * @param {function} [handler] -  the event handler to unbind. If not specified, all handlers are unbound.\r\n   * @returns {Atalasoft.Controls.WebDocumentViewer} reference to `this`.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function unbind\r\n   */\n  // eslint-disable-next-line no-unused-vars\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  function __unbindEvents(event, handler) {\n    __trackEventBinds(arguments, false);\n\n    _jqe.off.apply(_jqe, arguments);\n\n    return _self;\n  }\n  /**\r\n   * Triggers the event.\r\n   * @param {string} event - the name of the event to trigger.\r\n   * @param {Object} [parameters] - the event data.\r\n   * @returns {Atalasoft.Controls.WebDocumentViewer} reference to `this`.\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function trigger\r\n   */\n  // eslint-disable-next-line no-unused-vars\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  function __triggerEvent(event, parameters) {\n    _jqe.trigger.apply(_jqe, arguments);\n\n    return _self;\n  }\n  /**\r\n   * Gets the current document info\r\n   * @return {{count: *, dpi: number, size: {height: number, width: number}, vector: boolean}} object indicating document main page size, and number of pages\r\n   * @instance\r\n   * @memberOf Atalasoft.Controls.WebDocumentViewer\r\n   * @function getDocumentInfo\r\n   */\n\n\n  function __getDocumentInfo() {\n    return {\n      count: _controllers.document.getPageCount(),\n      dpi: _page.dpi,\n      size: {\n        height: _page.size.height,\n        width: _page.size.width\n      },\n      vector: _page.vector\n    };\n  }\n\n  var __bkm_index;\n\n  function __showBookmarksUI() {\n    var _this16 = this;\n\n    if (_isThumbnailer) return;\n    var bookmark_list_id = _id + '_' + domclasses.atala_bookmark_content;\n    var selector = '#' + bookmark_list_id; //Remove existing control if it exist\n\n    if (atalaJquery(selector).length > 0) {\n      __collectBookControlState();\n\n      atalaJquery(selector).remove();\n\n      __removeClickListener();\n\n      return;\n    }\n\n    var bookmarks = _controllers.document.getBookmarks();\n\n    if (bookmarks.length > 0) {\n      var maxHeight = 0.85 * _dom.main.height();\n\n      __bkm_index = 0; //We want to show the bookmark under the main toolbar\n      //If text is allowed the same element will be added by searchBox \n\n      if (!(_config.allowtext && _config.mousetool.text.allowsearch)) {\n        atalaJquery('<div/>').css('clear', 'both').appendTo(_dom.toolbar);\n      }\n\n      var bookmarklist = atalaJquery('<div/>').addClass('ui-widget').addClass(domclasses.atala_bookmark_content).css('max-height', maxHeight + 'px').attr('id', bookmark_list_id).appendTo(_dom.toolbar);\n      var main_ul = atalaJquery('<ul></ul>');\n      atalaJquery('<span id = \"atala_bkm_header\" class =\"' + domclasses.atala_bookmark_header + '\">Bookmarks</span>').appendTo(main_ul);\n\n      if (Browser.Chrome) {\n        main_ul.attr('aria-labelledby', 'atala_bkm_header');\n      }\n\n      main_ul.appendTo(bookmarklist);\n      bookmarks.forEach(function (bookmark) {\n        WebDocumentViewer_newArrowCheck(this, _this16);\n\n        return appendBookmarkItem(bookmark, main_ul);\n      }.bind(this));\n      bookmarklist.contextmenu(function () {\n        return false;\n      });\n      bookmarklist.show(); //Restore bookmark viewer state\n\n      __restoreBookControlState(); //Listeners to close the control\n      //create listener with some delay to avoid trigger it on the first click\n\n\n      setTimeout(function () {\n        document.addEventListener('click', __outsideClickListener);\n      }, 50);\n      atalaJquery(document).one('viewportclick', __viewPortClickListener);\n    }\n  }\n\n  function appendBookmarkItem(bookmark, ul) {\n    var _this17 = this;\n\n    if (bookmark.Children.length > 0) {\n      var li = atalaJquery('<li><span class=\"atala-bookmark-caret\"></span></li>');\n      var anchor = atalaJquery('<a>' + bookmark.Text + '</a>');\n\n      if (Browser.Chrome) {\n        var id = _generateID();\n\n        anchor.attr('id', id);\n        li.attr('aria-labelledby', id);\n      }\n\n      anchor.click(function () {\n        _controllers.document.scrollToBookmark(bookmark);\n      });\n      anchor.appendTo(li);\n      var nestedul = atalaJquery('<ul class = \"atala-bookmark-nested\"></ul>').attr('id', 'expandable_bookmark_' + bookmark.id);\n      nestedul.appendTo(li);\n      li.find('span').click(function () {\n        this.parentElement.querySelector('.atala-bookmark-nested').classList.toggle('atala-bookmark-active');\n        this.classList.toggle('atala-bookmark-caret-down');\n      });\n      li.appendTo(ul);\n\n      var children = _controllers.document.getChildBookmarks(bookmark);\n\n      children.forEach(function (childBookmark) {\n        WebDocumentViewer_newArrowCheck(this, _this17);\n\n        return appendBookmarkItem(childBookmark, nestedul);\n      }.bind(this));\n    } else {\n      var _li = atalaJquery('<li></li>');\n\n      var _anchor = atalaJquery('<a>' + bookmark.Text + '</a>');\n\n      if (Browser.Chrome) {\n        var _id2 = _generateID();\n\n        _anchor.attr('id', _id2);\n\n        _li.attr('aria-labelledby', _id2);\n      }\n\n      _anchor.click(function () {\n        _controllers.document.scrollToBookmark(bookmark);\n      });\n\n      _anchor.appendTo(_li);\n\n      _li.appendTo(ul);\n    }\n\n    function _generateID() {\n      ++__bkm_index;\n      return 'bkm_' + __bkm_index;\n    }\n  } //Close bookmark UI if user clicks outside of it\n\n\n  function __outsideClickListener(event) {\n    var selector = '#' + _id + '_' + domclasses.atala_bookmark_content;\n    var target = atalaJquery(event.target);\n\n    if (!target.closest(selector).length && atalaJquery(selector).is(':visible')) {\n      __collectBookControlState();\n\n      atalaJquery(selector).remove();\n\n      __removeClickListener();\n    }\n  }\n\n  function __viewPortClickListener() {\n    var selector = '#' + _id + '_' + domclasses.atala_bookmark_content;\n\n    if (atalaJquery(selector).is(':visible')) {\n      __collectBookControlState();\n\n      atalaJquery(selector).remove();\n\n      __removeClickListener();\n    }\n  }\n\n  function __removeClickListener() {\n    document.removeEventListener('click', __outsideClickListener);\n  }\n\n  function __collectBookControlState() {\n    var selector = '#' + _id + '_' + domclasses.atala_bookmark_content;\n    _bookmarkState.top = atalaJquery(selector).scrollTop();\n    _bookmarkState.left = atalaJquery(selector).scrollLeft();\n    _bookmarkState.expanded = [];\n    atalaJquery('ul.atala-bookmark-active').each(function () {\n      _bookmarkState.expanded.push(atalaJquery(this).attr('id'));\n    });\n  }\n\n  function __restoreBookControlState() {\n    var selector = '#' + domclasses.atala_bookmark_content + _id; //Expand nodes\n\n    _bookmarkState.expanded.forEach(function (id) {\n      var ulElem = atalaJquery('#' + id);\n      ulElem.toggleClass('atala-bookmark-active');\n      ulElem.parent().children('.atala-bookmark-caret').toggleClass('atala-bookmark-caret-down');\n    }); //Set scroll position\n\n\n    atalaJquery(selector).scrollTop(_bookmarkState.top);\n    atalaJquery(selector).scrollLeft(_bookmarkState.left);\n  }\n\n  function __disableBookmarkButton() {\n    var buttonId = _id + '_toolbar_' + 'Button_Bookmarks';\n    atalaJquery('#' + buttonId).button('disable');\n  } // #endregion\n\n\n  __preInit();\n\n  return _self;\n};\n\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.ends-with.js\nvar es_string_ends_with = __webpack_require__(123);\n\n// CONCATENATED MODULE: ./src/controls/Thumbnailer.js\n\n\n\n\n\n\n\nfunction Thumbnailer_newArrowCheck(innerThis, boundThis) { if (innerThis !== boundThis) { throw new TypeError(\"Cannot instantiate an arrow function\"); } }\n\n//\n//  WebDocumentViewer Thumbnailer extension\n//\n//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//  Permission for usage and modification of this code is only permitted \n//  with the purchase of a source code license.\n//\n//  Change History:\n//\t03-19-13\t*********\t\tFile Created.\n//\t08-30-13\tD. Cilley\t\tFB 14274: Added Thumbnailer functionality.\n//\t09-04-13\tD. Cilley\t\tFB 14274: Added touch support.\n//\t09-11-13\tD. Cilley\t\tFB 14303: Fixed size thumb divs too small after openurl.\n//\t09-11-13\tD. Cilley\t\tFB 14304: Fixed thumb div color staying on thumb recycle.\n//\t09-12-13\tD. Cilley\t\tFB 14305: Fixed overscroll and scrollbar size.\n//\t09-16-13\tD. Cilley\t\tFB 14333: Fixed annotation paper centering on thumbs.\n//\t09-17-13\tD. Cilley\t\tFB 14334: Exposed thumbnailer debug info.\n//\t10-03-13\tD. Cilley\t\tFB 14363: Fixed js error when documenturl is set in both viewer and thumbs. \n//\t10-07-13\tD. Cilley\t\tFB 14415: Fixed thumbnail zoom on second openUrl call.\n//\t12-03-13\tD. Cilley\t\tFB 14071: Removed jquery.browser dependency.\n//\t01-14-14\tD. Cilley\t\tBug 293828: Fixed openurl when not on first page.\n//\t01-16-14\tD. Cilley\t\tBug 293573: Fixed thumbnail select while zooming.\n//\t01-17-14\tD. Cilley\t\tBug 293575, 293574: Fixed scrollbar thumb tray sizing and overscroll.\n//\t02-06-14\tD. Cilley\t\tBug 309834: Fixed openUrl hang, and added public empty function.\n//\t08-14-14\tD. Cilley\t\tBug 345109: Added framework for horizontal scrolling and grid layout.\n//\t12-17-14\tD. Cilley\t\tBug 550581: Added locally scoped non-conflict jQuery.\n//\t01-16-15\tD. Cilley\t\tBug 556294: Added image dispose to help with mapsto exceptions.\n//\t02-19-15\tD. Cilley\t\tBug 560725: Fixed multiple bugs that caused thumbnails not to be displayed.\n//\t02-25-15\tD. Cilley\t\tBug 583364: Fixed another bugs that let the thumbnailer scroll past last page.\n//\t02-26-15\tD. Cilley\t\tBug 560686: Fixed multiple problems with navigation when scrolling.\n//\t02-27-15\tD. Cilley\t\tBug 560755: Re-scaled thumbs that were too big on multi-size documents.\n//\t03-02-15\tD. Cilley\t\tBug 560407: Added some specific handling for the columns and rows options.\n//\t03-30-15\tD. Cilley\t\tBug 592766: Fixed a bug that would cause thumbs to go off center.\n//\t04-10-15\tD. Cilley\t\tBug 596029: Fixed a sizing bug related to showPage() usage in a callback.\n//\t04-27-15\tD. Cilley\t\tBug 593012: Fixed a bug that would remove scroll thumb.\n//\t05-01-15\tD. Cilley\t\tBug 608515: Added vector flag for enabling zoom past 1.\n//\t09-15-15\tD. Cilley\t\tBug 627869: Added support for forcing all pages to be fit into the same size.\n//\t09-21-15\tD. Cilley\t\tBug 635949: Fixed multiple scroll related issues, and page number label location.\n//-------------------------------------------------------------------------------------------------\n\n\n\n\n\n/**\r\n * Control that shows thumbnails of document pages and annotations.\r\n * @param {WebThumbnailerConfig} [settings] Object of key value pairs representing initial settings\r\n * @param {OpenUrlCallback} [openCallback] callback that is called when document load complete(if {@link WebDocumentViewerConfig.documenturl| documenturl} is specified).\r\n * @class\r\n * @augments Atalasoft.Controls.WebDocumentViewer\r\n * @returns {WebDocumentThumbnailer} A new control with the given settings.\r\n * @memberof Atalasoft.Controls\r\n */\n\nvar Thumbnailer_WebDocumentThumbnailer = function WebDocumentThumbnailer(settings, openCallback) {\n  var _self = null;\n\n  var _viewer = settings.viewer || null;\n\n  var _cin = [];\n  var _cinDragDropTemp = [];\n  var _thumbEvents = null;\n  var _viewerLink = null;\n  var _thumbLink = null;\n  var dragdataKey = 'atala_dragdata';\n  var sortableWidgetFullName = 'ui-sortable';\n  var sortableWidgetDeprecatedName = 'sortable';\n  var draggableScrollParentWrapperKey = 'atala_scroll_parent'; // state manager for viewer communication.\n\n  var _stateManager = null; // page values\n\n  var _page = {\n    size: {\n      width: 0,\n      height: 0\n    },\n    sizes: [{\n      width: 0,\n      height: 0\n    }],\n    count: 0,\n    number: -1,\n    dpi: 96,\n    vector: false\n  }; // state values\n\n  var _state = {\n    base: null,\n    loading: false,\n    initialized: false,\n    scrolling: false,\n    dragdropping: false,\n    viewer: {\n      zoom: 0,\n      pagenumber: 0,\n      // when controlling viewer, some api is redirected to viewer. when not controlling it's restored, need to set viewer api back.\n      api: {}\n    },\n    // when controlling viewer, some api is redirected to viewer. when not controlling it's restored. this is for caching thumb api.\n    selfapi: {}\n  };\n  var _touch = {\n    moves: 0,\n    start: {\n      x: NaN,\n      y: NaN\n    }\n  };\n  var _thumb = {\n    divsize: -1,\n    // populated with thumb size + borders after the size is calculated\n    scale: 1,\n    // thumbs are actually scaled at a different rate than the viewer's zoom\n    size: 0,\n    // populated with calculated thumb size\n    zoom: 1,\n    // normalized zoom level with respect to zoomfull\n    zoomfull: 1 // populated with the thumbs starting scale\n\n  }; // config object\n\n  /**\r\n   * Represents {@link Atalasoft.Controls.WebDocumentThumbnailer|WebDocumentThumbnailer} configuration.\r\n   * @atalaconfig\r\n   * @alias WebThumbnailerConfig\r\n   * @example\r\n   * <caption>Set dragdelay for touch devices.</caption>\r\n   *  _thumbs = new Atalasoft.Controls.WebDocumentThumbnailer({\r\n   *    parent: $(\".atala-document-thumbs\"),\r\n   *    serverurl: _serverUrl, // server handler url to send image requests to\r\n   *    documenturl: _docUrl, // document url relative to the server handler url\r\n   *    allowannotations: true,\r\n   *    allowdragdrop: true,\r\n   *    dragdelay: Atalasoft.Utils.Browser.Mobile.Any() ? 750 : 250, // It's recommended to increase this value on touch device\r\n   *    viewer: _viewer\r\n   *  });\r\n   */\n\n  var _config = {\n    direction: ScrollDirection.Vertical,\n\n    /**\r\n     *  @property {number} [maxwidth=300] - Specifies the maximum amount of pixel width allowed for zooming in.\r\n     *\r\n     *  This property is intended to limit size of the images data transferred over the wire on big zoom values.\r\n     */\n    maxwidth: 300,\n\n    /**\r\n     *  @property {number} [minwidth=80] - Specifies the minimum amount of pixel width allowed for zooming out.\r\n     */\n    minwidth: 80,\n    pageborderwidth: 1,\n    pagespacing: 2,\n    parent: null,\n    showpagenumber: false,\n    toolbarparent: null,\n\n    /**\r\n     * @property {boolean} [showthumbcaption=false] - Specifies whether captions will be added to the each thumbnail page. */\n    showthumbcaption: false,\n\n    /**\r\n     * @property {string} [thumbcaptionformat] - Specifies default thumbnail caption format.\r\n     *\r\n     * {0} - will be substituted with page number.\r\n     * {1} - will be substituted with the document file name.\r\n     * Could also be set on server using DocumentInfoRequestedEventArgs arguments of DocumentInfoRequested event.\r\n     */\n    thumbcaptionformat: '',\n    // thumb specific properties that will be ignored by the base viewer\n\n    /**\r\n     * @property {boolean} [allowdragdrop=false] - Indicates whether drag&drop through UI is enabled.\r\n     */\n    allowdragdrop: false,\n\n    /**\r\n     * @property {number} [dragdelay=250] - Delay in milliseconds before drag&drop operation is started.\r\n     *\r\n     * This delay is intended to support \"pan\" behavior when UI drag&drop support is enabled.\r\n     *\r\n     */\n    dragdelay: 250,\n\n    /**\r\n     * @property {number} [selectedindex=0] - Index of the initially selected page. This page will be selected after each new document will be loaded.\r\n     */\n    selectedindex: 0,\n\n    /**\r\n     * @property {number} [thumbpadding=8] - Padding of the thumbnail image.\r\n     */\n    thumbpadding: 8,\n\n    /**\r\n     * @property {string} [backcolor='#DCDCDC'] - Thumbnail background color.\r\n     */\n    backcolor: '#DCDCDC',\n\n    /**\r\n     * @property {string} [hovercolor='#667F9F'] - Thumbnail :hover color.\r\n     */\n    hovercolor: '#667F9F',\n\n    /**\r\n     * @property {string} [selectedcolor='#E0872D'] - Selected thumbnail background color.\r\n     */\n    selectedcolor: '#E0872D',\n\n    /**\r\n     * @property {string} [selectedhovercolor='#FFC060'] - Selected thumbnail :hover background color.\r\n     */\n    selectedhovercolor: '#FFC060',\n\n    /**\r\n     * @property {Atalasoft.Utils.SelectionMode} [selectionmode=SingleSelect] - Defines the WDT selection mode.\r\n     */\n    selectionmode: SelectionMode.SingleSelect,\n\n    /**\r\n     * @property {Atalasoft.Utils.SelectedItemsOrder} [selecteditemsorder=ItemIndexOrder] - Defines the order in which selected pages are to be processed.\r\n     */\n    selecteditemsorder: SelectedItemsOrder.ItemIndexOrder\n  }; // these properties are necessary\n\n  var _thumbCfg = {\n    type: 'Atalasoft.Controls.WebDocumentThumbnailer',\n    debug: true,\n    // used to get internal objects\n    showpageborder: true,\n    forcepagefit: true,\n    toolbarparent: atalaJquery('<div/>') // we don't use the toolbar\n\n  };\n  /**\r\n   * @lends Atalasoft.Controls.WebDocumentThumbnailer\r\n   */\n\n  var _events = {\n    /**\r\n     * Triggers when thumbnail is selected.\r\n     * @event Atalasoft.Controls.WebDocumentThumbnailer#thumbselected\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the page that was selected.\r\n     */\n    thumbselected: null,\n\n    /**\r\n     * Triggers when thumbnail is deselected.\r\n     * @event Atalasoft.Controls.WebDocumentThumbnailer#thumbdeselected\r\n     * @param {Object} event - The event object.\r\n     * @param {number} event.index - Index of the page that was deselected.\r\n     */\n    thumbdeselected: null,\n\n    /**\r\n     *  Triggers when thumbnail drag & drop operation is started.\r\n     *  @event Atalasoft.Controls.WebDocumentThumbnailer#thumbdragstart\r\n     *  @param {Object} event - The event object.\r\n     *  @param {number} event.dragindex - Index of the page being dragged.\r\n     *  @param {number[]} event.dragindices - The indices of pages being dragged.\r\n     */\n    thumbdragstart: null,\n\n    /**\r\n     * Callback signature for {@link Atalasoft.Controls.WebDocumentThumbnailer#event:thumbdragend| WebDocumentThumbnailer.thumbdragend} event.\r\n     * @callback ThumbDragEndCallback\r\n     * @param {Object} event - The event object.\r\n     * @param {ThumbDragEndEventArgs} args - The event data.\r\n     */\n\n    /**\r\n     * @typedef {Object} ThumbDragEndEventArgs\r\n     * @property {number} dragindex - The index of the page being dragged.\r\n     * @property {number[]} dragindices - The indices of pages being dragged.\r\n     * @property {number} dropindex - The index where the page was dropped in the target document.\r\n     * @property {string} sourcedocument - The identifier of the source document. Corresponds to {@link WebDocumentViewerConfig.documenturl|config.documenturl}\r\n     * @property {Atalasoft.Controls.WebDocumentThumbnailer} source - The source thumbnailer control.\r\n     * @property {Atalasoft.Controls.WebDocumentThumbnailer} target - The target thumbnailer control.\r\n     * @property {boolean} external - Indicates whether page is being dropped into external document(not the one dragged page originally belong to).\r\n     *\r\n     * @property {DocumentPageReference} pageref - Reference to the page in the source document. See {@link Atalasoft.Controls.WebDocumentViewer~DocumentController#insertPage| document.insertPage} for usage sample.\r\n     * @property {DocumentPageReference[]} pagerefs - References to pages in the source document. See {@link Atalasoft.Controls.WebDocumentViewer~DocumentController#insertPage| document.insertPage} for usage sample.\r\n     *\r\n     * @property {boolean} [cancel=false] - Flag indicating whether default behavior should be cancelled. If set by the application, page want be moved to the new position by the  {@link Atalasoft.Controls.WebDocumentThumbnailer|WebDocumentThumbnailer}.\r\n     *\r\n     * @property {boolean} [copyannotations=true] - Flag indicating whether source page annotations should be copied to the inserted page.\r\n     * This could be used by the application to inject additional logic, for example used confirmation dialog and move the page using API after that.\r\n     */\n\n    /** Triggers before thumbnail drag & drop operation is complete. This event could be triggered for either case when thumb was dropped within same document where it belongs or when thumb was dropped to the external document.\r\n     * @event Atalasoft.Controls.WebDocumentThumbnailer#thumbdragend\r\n     * @type {ThumbDragEndCallback}\r\n     * @param {Object} event - The event object.\r\n     * @param {ThumbDragEndEventArgs} args - The event data.\r\n     *\r\n     * Note that args.cancel flag allows to prevent default drop handler behavior.\r\n     * If set by the application, page want be moved to the new position by the  {@link Atalasoft.Controls.WebDocumentThumbnailer|WebDocumentThumbnailer}.\r\n     * This could be used by the application to inject additional logic, for example used confirmation dialog and move the page using API after that.\r\n     **/\n    thumbdragend: null,\n\n    /**\r\n     * Callback signature for {@link Atalasoft.Controls.WebDocumentThumbnailer#event:thumbdragcomplete| WebDocumentThumbnailer.thumbdragcomplete} event.\r\n     * @param {Object} event - The event object.\r\n     * @param {ThumbDragCompleteEventArgs} args - The event data.\r\n     */\n\n    /**\r\n     * @typedef {Object} ThumbDragCompleteEventArgs\r\n     * @property {number} dragindex - The index of the page being dragged.\r\n     * @property {number[]} dragindices - The indices of pages being dragged.\r\n     * @property {number} dropindex - The index where the page was dropped in the target document.\r\n     * @property {Atalasoft.Controls.WebDocumentThumbnailer} source - The source thumbnailer control.\r\n     * @property {Atalasoft.Controls.WebDocumentThumbnailer} target - The target thumbnailer control.\r\n     */\n\n    /** Triggers after thumbnail drag & drop operation is complete.\r\n     * @event Atalasoft.Controls.WebDocumentThumbnailer#thumbdragcomplete\r\n     * @type {ThumbDragCompleteEventArgs}\r\n     *\r\n     * @param {Object} event - The event object.\r\n     * @param {ThumbDragCompleteEventArgs} args - The event data.\r\n     */\n    thumbdragcomplete: null\n  }; // #region variable functions\n\n  var __reloadPageViewer, __reloadPageBase; // #endregion variable functions\n  // map settings and thumb config onto main config\n\n\n  if (settings) {\n    // check if there is a defined thumb size\n    if ('thumbsize' in settings) {\n      if (isFinite(settings.thumbsize) && settings.thumbsize > 0) {\n        __setThumbSize(settings.thumbsize);\n\n        _thumbCfg.forcepagesize = {\n          width: settings.thumbsize,\n          height: settings.thumbsize\n        };\n      }\n    }\n\n    atalaJquery.extend(_config, settings);\n    atalaJquery.extend(_config, _thumbCfg); // not show page numbers as captions will be either same in default case or more advanced.\n\n    _config.showpagenumber = _config.showpagenumber && !_config.showthumbcaption; // if fitting wasn't set by user, set it automatically\n\n    if (!('fitting' in settings)) {\n      _config.fitting = _config.direction === ScrollDirection.Vertical ? Fitting.Width : Fitting.Height;\n    }\n\n    if (_viewer && _viewer.config) {\n      _config.allowtext = _viewer.config.allowtext;\n      _config.showbookmarks = _viewer.config.showbookmarks;\n      _config.tiling = _viewer.config.tiling;\n    }\n  } // create base WDV\n\n\n  _self = WebDocumentViewer_WebDocumentViewer.call(this, _config, function (error, info) {\n    __onThumbsLoaded(error, info, openCallback);\n  });\n  _thumbLink = _self.__getViewerLink(_self);\n  _config = _thumbLink._config;\n\n  __overrideInternal();\n\n  __validateConfig(); // #region Control Life cycle\n\n\n  function __getStateManagerApi() {\n    return {\n      get: function get() {\n        return _self;\n      },\n      detachViewer: __detachViewer,\n      activateViewer: __activateViewer\n    };\n  }\n\n  function __init() {\n    if (_viewer) {\n      //TODO: move this to separate public api like LinkViewer. make sure we can link to WDV controlled by other thumbnailer\n      _viewerLink = _viewer.__getViewerLink(_self, _thumbLink);\n      _stateManager = _viewerLink.stateManager;\n    }\n\n    _self.bind({\n      statusmessage: __onThumbsStatusMessage,\n      pagerotated: __onViewerDocumentChanged,\n      pageinserted: __onViewerDocumentChanged,\n      pageremoved: __onViewerDocumentChanged,\n      pagemoved: __onViewerDocumentChanged,\n      viewportunhide: __onThumbUnHide\n    }); // thumbnail WDV events\n\n\n    _self.bind({\n      annotationsloaded: __onThumbAnnosLoaded,\n      formsloaded: __onThumbFormsLoaded,\n      contextmenu: __onThumbContextMenu,\n      documentloaded: __onDocumentLoaded,\n      pageshown: __onThumbShown,\n      pageresize: __onThumbResize,\n      scroll: __onThumbScroll,\n      zoomchanged: __onThumbZoomChanged,\n      zoomstarted: __onThumbZoomStarted,\n      zoomfinished: __onThumbZoomFinished,\n      pagesizechanged: __onThumbPageSizeChanged\n    });\n\n    __overridePublic(); // thumbnail div events\n\n\n    _thumbEvents = {\n      click: __onThumbClicked,\n      touchstart: __onThumbTouchStart,\n      touchmove: __onThumbTouchMove,\n      touchend: __onThumbTouchEnd,\n      mouseenter: __onThumbHoverIn,\n      mouseleave: __onThumbHoverOut\n    };\n\n    __load();\n  }\n\n  function __load() {}\n\n  function __bindViewer(viewer, bind) {\n    if (viewer) {\n      var action = bind ? viewer.bind : viewer.unbind;\n      var reverseSelfAction = bind ? _self.unbind : _self.bind;\n      action.call(viewer, {\n        beforehandlerrequest: __onViewerRequest,\n        documentloaded: __onViewerLoaded,\n        scroll: __onViewerScroll,\n        pagerotated: __onViewerPageRotated,\n        pageinserted: __onViewerPageInserted,\n        pageremoved: __onViewerPageRemoved,\n        pagemoved: __onViewerPageMoved\n      });\n      reverseSelfAction.call(_self, {\n        pagerotated: __onViewerDocumentChanged,\n        pageinserted: __onViewerDocumentChanged,\n        pageremoved: __onViewerDocumentChanged,\n        pagemoved: __onViewerDocumentChanged\n      });\n\n      __subscribeEventsRetrigger(viewer, viewer.document.events, action);\n\n      if (_config.allowannotations) {\n        action.call(viewer, {\n          annotationresized: __onViewerAnnotationUpdated,\n          annotationmoved: __onViewerAnnotationUpdated,\n          annotationrotated: __onViewerAnnotationUpdated,\n          annotationchanged: __onViewerAnnotationUpdated,\n          annotationcreated: __onViewerAnnotationCreated,\n          annotationdeleted: __onViewerAnnotationDeleted\n        });\n\n        if (viewer.annotations) {\n          __subscribeEventsRetrigger(viewer, viewer.annotations.events, action);\n        }\n      }\n    }\n  }\n\n  function __subscribeEventsRetrigger(viewer, events, action) {\n    var bindConfig = {};\n\n    for (var e in events) {\n      if (events.hasOwnProperty(e)) {\n        bindConfig[e] = __retriggerEvent;\n      }\n    }\n\n    action.call(viewer, bindConfig);\n  }\n\n  function __retriggerEvent() {\n    _self.trigger.apply(_self, arguments);\n  }\n  /**\r\n   * Checks whether current thumbnailer is controlling referenced viewer.\r\n   *\r\n   * If viewer is linked only to the current thumbnailer, this method always return `true`.\r\n   *\r\n   * If thumbnailer is not linked to any viewer, this method always return `false`.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#isActive\r\n   * @returns {boolean} `true` if current thumbnailer instance is controlling referenced viewer; `false` otherwise.\r\n   */\n\n\n  function __isControllingViewer() {\n    return _viewer && (!_stateManager || _stateManager && _stateManager.isThumbnailerActive(__getStateManagerApi()));\n  }\n  /**\r\n   * Takes ownership over referenced viewer, i.e. if shared viewer is currently displaying other document, it's switched to display document from calling thumbnailer.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#activate\r\n   */\n\n\n  function __activate() {\n    __activateViewer(_viewer, _self.getDocumentInfo());\n  }\n\n  function __activateViewer(viewer, info, force) {\n    if (!_viewer && viewer) {\n      _viewer = viewer;\n      _viewerLink = _viewer.__getViewerLink(_self, _thumbLink);\n      _stateManager = _viewerLink.stateManager;\n    }\n\n    if (_viewer && _viewer.isReady() && (!__isControllingViewer() || force)) {\n      var needRebindViewer = _viewer && !__isControllingViewer();\n\n      var docStateInfo = __getDocumentStateInfo();\n\n      docStateInfo.customData = info === undefined || info === null ? undefined : info.customData;\n\n      _stateManager.activateThumbnailer(__getStateManagerApi(), docStateInfo, _thumbLink, _config, force);\n\n      if (needRebindViewer) {\n        __bindViewer(_viewer, true);\n\n        __attachOverriddenApi(_viewer);\n      }\n    }\n\n    repaintSelectionState(true);\n  }\n\n  function __detachViewer() {\n    if (_viewer && _viewer.isReady()) {\n      _state.viewer.zoom = _viewer.getZoom();\n      _state.viewer.pagenumber = _viewer.getCurrentPageIndex(); // transfer the fields runtime state to thumbnailer since filed changes are not synchronized between wdv/wdt\n\n      if (_config.allowforms && _state.base.controllers.forms && _viewerLink._fields) {\n        var formsData = {\n          forms: {\n            fields: __copyJsonDataToArray(_viewerLink._fields)\n          }\n        };\n\n        _state.base.controllers.forms.loadForms(formsData);\n      }\n    }\n\n    __bindViewer(_viewer, false);\n\n    __detachOverriddenApi(_viewer);\n\n    repaintSelectionState(false);\n  }\n\n  function __getDocumentStateInfo() {\n    var docInfo = {\n      pagewidth: _page.size.width,\n      pageheight: _page.size.height,\n      pagecount: _page.count,\n      dpi: _page.dpi,\n      colordepth: _state.base.controllers.memory.colorDepth,\n      vector: _page.vector,\n      pagenumber: _state.viewer.pagenumber,\n      zoom: _state.viewer.zoom\n    };\n\n    if (_config.allowannotations && _thumbLink._annos) {\n      docInfo.layers = __copyJsonDataToArray(_thumbLink._annos, 'items');\n    }\n\n    if (_config.allowforms && _thumbLink._fields) {\n      docInfo.forms = {\n        fields: __copyJsonDataToArray(_thumbLink._fields)\n      };\n    }\n\n    return docInfo;\n  } // #endregion\n  // #region Overrides\n  // overrides internal defined functions with functions from the base control\n\n\n  function __overrideInternal() {\n    // functions from the base control\n    __createDiv = _thumbLink.__createDiv;\n    _thumbLink.__getSelectedPagesIndices = __getSelectedPagesIndices;\n  }\n\n  function __getApiToOverride() {\n    return {\n      // functions that bypass the thumbnailer and talk to the WDV\n      thumb: {\n        'annotations': null,\n        'document': null,\n        'text': null,\n        'getCurrentPageIndex': null,\n        'getZoom': null,\n        'zoom': null,\n        'zoomIn': null,\n        'zoomOut': null,\n        'next': null,\n        'previous': null,\n        'save': null,\n        'showPage': null,\n        'setMouseTool': null\n      },\n      viewer: {\n        reloadPage: function reloadPage(vdw) {\n          __reloadPageViewer = vdw.reloadPage;\n          return __reloadPageWrapper;\n        }\n      }\n    };\n  }\n\n  function __attachOverriddenApi(viewer) {\n    var linkedApi = __getApiToOverride();\n\n    __replaceApi(linkedApi.viewer, viewer, _self, _state.viewer.api);\n\n    __replaceApi(linkedApi.thumb, _self, viewer, _state.selfapi);\n  }\n\n  function __detachOverriddenApi(viewer) {\n    var viewerapi = __extractObjectPropertyKeys(_state.viewer.api);\n\n    __replaceApi(viewerapi, viewer, _state.viewer.api, {});\n\n    var thumbapi = __extractObjectPropertyKeys(_state.selfapi);\n\n    __replaceApi(thumbapi, _self, _state.selfapi, {});\n  }\n\n  function __replaceApi(linkDescription, target, source, targetApiCache) {\n    for (var key in linkDescription) {\n      if (linkDescription.hasOwnProperty(key)) {\n        if (target.hasOwnProperty(key) && target[key]) {\n          targetApiCache[key] = target[key];\n        }\n\n        if (typeof linkDescription[key] === 'function') {\n          target[key] = linkDescription[key](target, source);\n        } else if (source.hasOwnProperty(key) && source[key]) {\n          target[key] = source[key];\n        }\n      }\n    }\n  }\n\n  function __extractObjectPropertyKeys(obj) {\n    var result = {};\n\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        result[key] = null;\n      }\n    }\n\n    return result;\n  } // overrides and removes public functions that are no longer useful\n\n\n  function __overridePublic() {\n    // save the original functions so we can use them\n    __emptyBase = _self.empty;\n    __disposeBase = _self.dispose;\n    __openUrlBase = _self.openUrl;\n    __getDebugInfoBase = _self.__getDebugInfo;\n    __scrollToThumb = _self.showPage; // overwrite the originals \n\n    _self.empty = __emptyAsync;\n    _self.dispose = __dispose;\n    _self.openUrl = _self.OpenUrl = __openUrlAsync;\n    _self.__getDebugInfo = __getDebugInfo; // add a public function for scrolling to a thumbnail\n\n    _self.scrollToThumb = __scrollToThumb; // pinch zoom uses the zoom function, so to disable it we use an empty function\n\n    _self.zoom = _self.zoomIn = _self.zoomOut = function () {};\n\n    __reloadPageBase = _self.reloadPage;\n    _self.reloadPage = __reloadPageWrapper; // linking fit doesn't really make sense in this context, so we remove it\t\t\n\n    delete _self.fit;\n    atalaJquery.extend(_self.events, _events);\n  } // p: jQuery parent object to append div to \n  // did: string representing the id of the div\n  // ihtml: string representing the inner html\n\n\n  var __createDiv = function __createDiv() {// intentionally left blank, this gets assigned by the base WDV __createDiv\n  };\n\n  var __getDebugInfoBase = function __getDebugInfoBase() {// intentionally left blank, this gets assigned to the base WDV __getDebugInfo\n  };\n\n  function __getDebugInfo() {\n    if (_config.debug) {\n      var info = __getDebugInfoBase();\n\n      var cin = __getSelectedPagesIndices();\n\n      atalaJquery.extend(true, info, {\n        thumbnailer: {\n          config: _config,\n          index: cin[0],\n          indices: cin,\n          links: {\n            viewer: _viewerLink,\n            self: _thumbLink\n          },\n          page: _page,\n          thumb: _thumb,\n          state: _state\n        }\n      });\n      return info;\n    }\n\n    return null;\n  }\n  /**\r\n   * Scrolls the viewer to the given page number and executes the callback when finished\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#scrollToThumb\r\n   * @param {number} index - Index of the page to scroll to.\r\n   * @param {NotificationCallback} [callback] - Function to execute after this operation is done.\r\n   */\n\n\n  var __scrollToThumb = function __scrollToThumb() {// intentionally left blank, this gets assigned to the base WDV showPage\n  }; // #endregion\n  // #region Public methods\n\n\n  _self.getSelectedPageIndex = __getSelectedPageIndex;\n  _self.getSelectedPagesIndices = __getSelectedPagesIndices;\n  _self.selectThumb = __selectThumb;\n  _self.deselectThumb = __deselectThumb;\n  _self.isActive = __isControllingViewer;\n  _self.activate = __activate;\n  /**\r\n   * @summary Gets the selected thumbnail index.\r\n   * @description Gets the selected thumbnail index when Web Document Thumbnailer (WDT) setup to use singleselect. When WDT setup to use multiselect, then this method returns the first element of the selected page indices, with respect of {@link WebDocumentViewerConfig.selecteditemsorder| selecteditemsorder} parameter value.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#getSelectedPageIndex\r\n   * @returns {number}\r\n   */\n\n  function __getSelectedPageIndex() {\n    return __getSelectedPagesIndices()[0];\n  }\n  /**\r\n   * @summary Gets the selected thumbnails indices.\r\n   * @description Gets the selected thumbnails indices with respect of {@link WebDocumentViewerConfig.selecteditemsorder| selecteditemsorder} parameter value.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#getSelectedPagesIndices\r\n   * @returns {number[]}\r\n   */\n\n\n  function __getSelectedPagesIndices() {\n    var _this = this;\n\n    var selectedPages = _cin.slice(0);\n\n    if (_config.selecteditemsorder === SelectedItemsOrder.ItemIndexOrder) selectedPages.sort(function (a, b) {\n      Thumbnailer_newArrowCheck(this, _this);\n\n      return a - b;\n    }.bind(this));\n    return selectedPages;\n  }\n\n  function __emptyAsync(callback) {\n    var requests = 1; // nested callback function so we don't have to store given callback\n\n    var requestCompleted = function requestCompleted() {\n      requests--;\n\n      if (requests <= 0) {\n        if (__isControllingViewer() && _stateManager && _viewer) {\n          __activateViewer(_viewer, _self.getDocumentInfo(), true);\n        } // only execute the callback if it exists\n\n\n        if (typeof callback === 'function') {\n          callback.call();\n        }\n      }\n    }; // unloads the document in the attached viewer\n\n\n    if (__isControllingViewer()) {\n      if (_stateManager) _stateManager.closeDocument(__getStateManagerApi(), _thumbLink);else if (_viewer.isReady()) {\n        requests++;\n\n        _viewer.empty(requestCompleted);\n      }\n    } // unloads the document from the base control thumbs inherit from\n\n\n    __emptyBase(requestCompleted);\n  }\n\n  var __emptyBase = function __emptyBase() {// intentionally left blank, this function gets overridden\n  };\n\n  function __dispose() {\n    if (__isControllingViewer()) {\n      if (_stateManager) {\n        _stateManager.closeDocument(__getStateManagerApi(), _thumbLink);\n      } else {\n        _viewer.empty();\n      }\n\n      __detachViewer();\n    }\n\n    __disposeBase();\n\n    _viewer = null;\n    _viewerLink = null;\n  }\n\n  var __disposeBase = function __disposeBase() {// intentionally left blank, this function gets overridden\n  };\n\n  function __openUrlAsync(surl, aurl, furl, callback) {\n    // don't want events to fire on objects that are getting recycled\n    __unbindPageEvents();\n\n    if (callback == null) {\n      if (typeof aurl === 'function') {\n        callback = aurl;\n        aurl = null;\n      } else if (typeof furl === 'function') {\n        callback = furl;\n        furl = null;\n      }\n    } // nested callback function so we don't have to store given callback\n\n\n    var requestCompleted = function requestCompleted(error, info) {\n      __openUrlCallback();\n\n      __onThumbsLoaded(error, info, callback);\n    };\n\n    if (typeof surl === 'string') {\n      _stateManager.closeDocument(__getStateManagerApi(), _thumbLink);\n\n      _state.viewer.pagenumber = 0;\n\n      if (_state.base) {\n        _state.base.state.scrollPos.x = 0;\n        _state.base.state.scrollPos.x = 0;\n      }\n    } // open in the thumbs first, and we'll skim the data for the viewer\n\n\n    __openUrlBase(surl, aurl, furl, requestCompleted);\n  }\n\n  var __openUrlBase = function __openUrlBase() {// intentionally left blank, this function gets overridden\n  };\n\n  function __openUrlCallback() {\n    _self.scrollTo(0, 0, false);\n  }\n\n  function repaintSelectionState(isControllingViewer) {\n    if (_state.base) {\n      if (_cin.length === 0) {\n        _cin.push(0);\n      }\n\n      for (var i = 0; i < _state.base.dom.pageDivs.length; i++) {\n        var jqoPrev = i > 0 ? _state.base.dom.pageDivs[i - 1] : null;\n        var jqo = _state.base.dom.pageDivs[i];\n        var select = false;\n\n        if (_cin.indexOf(jqo._index) > -1 && isControllingViewer) {\n          jqo.removeClass('atala_grouped_selection');\n          jqo.addClass(_self.domclasses.atala_active_thumb);\n          var ariaLabel = jqo.attr('aria-label');\n\n          if (!ariaLabel.endsWith(' Selected')) {\n            jqo.attr('aria-label', jqo.attr('aria-label') + ' Selected');\n          }\n\n          if (jqoPrev !== null && _cin.indexOf(jqoPrev._index) > -1) {\n            jqo.addClass('atala_grouped_selection');\n            jqoPrev.addClass('atala_grouped_selection');\n          }\n\n          select = true;\n        } else {\n          jqo.removeClass(_self.domclasses.atala_active_thumb);\n          jqo.removeClass('atala_grouped_selection');\n          jqo.attr('aria-label', jqo.attr('aria-label').replace(' Selected', ''));\n        }\n\n        __repaintThumbSelect(jqo, select);\n      }\n    }\n  }\n  /** \r\n   * Highlights the thumbnail at the given index, and scrolls to it in the linked viewer, if possible.\r\n   * @param {number|string} index - Index of the page to select. Can be passed as string representation of a number\r\n   * @param {boolean} [append] - Append index to the already selected thumbs or not. Its value ignores in single select mode.\r\n   * @param {NotificationCallback} [callback] - function that is called when thumbnail has been selected.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#selectThumb\r\n   */\n\n\n  function __selectThumb(index, append, callback) {\n    var _this2 = this;\n\n    if (_viewerLink._controllers.upload) {\n      _viewerLink._controllers.upload.abort();\n    }\n\n    index = ParseInt(index);\n    if (index === null || index < 0 || index >= _self.getDocumentInfo().count) return;\n    if (append !== undefined && typeof append !== 'boolean' && append !== null) return;\n    if (callback !== undefined && typeof callback !== 'function' && callback !== null) return;\n    append = !!append && _config.selectionmode !== SelectionMode.SingleSelect;\n\n    if (append) {\n      if (_cin.indexOf(index) > -1) return;\n\n      _cin.push(index);\n    } else {\n      __getSelectedPagesIndices().forEach(function (pageIdx) {\n        Thumbnailer_newArrowCheck(this, _this2);\n\n        _self.trigger({\n          type: 'thumbdeselected',\n          index: pageIdx\n        });\n      }.bind(this));\n\n      _cin.length = 0;\n\n      _cin.push(index);\n    }\n\n    __updateUIOnSelectOrDeselectThumb();\n\n    _self.trigger({\n      type: 'thumbselected',\n      index: index\n    });\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n  }\n  /** \r\n   * Resets the thumbnail highlight at the given index, and scrolls to the next selected thumbnail in the linked viewer, if possible.\r\n   *\r\n   * This function doesn't deselect the given index in the single select mode, and in multi select mode, if one page is selected.\r\n   * @param {number|string} index - Index of the page to deselect. Can be passed as string representation of a number\r\n   * @param {NotificationCallback} [callback] - function that is called when thumbnail has been deselected.\r\n   * @function Atalasoft.Controls.WebDocumentThumbnailer#deselectThumb\r\n   */\n\n\n  function __deselectThumb(index, callback) {\n    index = ParseInt(index);\n    if (index === null) return;\n    if (callback !== undefined && typeof callback !== 'function' && callback !== null) return;\n\n    var idx = _cin.indexOf(index);\n\n    if (idx === -1 || _cin.length === 1) return;\n\n    _cin.splice(idx, 1);\n\n    __updateUIOnSelectOrDeselectThumb();\n\n    _self.trigger({\n      type: 'thumbdeselected',\n      index: index\n    });\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n  }\n\n  function __updateUIOnSelectOrDeselectThumb() {\n    var cin = __getSelectedPagesIndices();\n\n    if (_stateManager) {\n      _state.viewer.pagenumber = cin[0];\n\n      __activateViewer(_viewer, _self.getDocumentInfo());\n    } else {\n      repaintSelectionState(true);\n    } // TODO: scroll to the selected thumb\n    // let scrollBy = __needsToScrollBy(_cin);\n    // _self.scrollBy(null, scrollBy * (_thumb.divsize + _config.pagespacing), true);\n    // Do not perform any viewer scrolling in case when several thumbnails selected.\n\n\n    if (_cin.length > 1) return;\n\n    if (_viewer) {\n      var vpin = _viewer.getCurrentPageIndex();\n\n      var cpin = cin[0];\n\n      if (vpin >= 0 && cpin !== vpin) {\n        _state.scrolling = true; //AB: I have commented this if else block because _viewer.showPage does the similar processing and call showPrevNextAsync() method\n        // if page difference is small enough.\n        // if (cpin === vpin - 1) {\n        //     _viewer.previous(1, __onViewerScrolled);\n        // } else if (cpin === vpin + 1) {\n        //     _viewer.next(1, __onViewerScrolled);\n        // } else {\n\n        _viewer.showPage(cpin, __onViewerScrolled); // }\n\n      }\n    }\n  } // #endregion\n  // #region linked viewer override\n\n  /**\r\n   * Reloads the specified page. If the thumbnailer is linked with viewer, viewer page is reloaded and callback is called when both viewer and thumbnailer completely reloaded, including image data itself.\r\n   *\r\n   * Viewer page won't be reloaded if the viewer is currently controller by other thumbnailer and requested page was not loaded in viewer before. In such case page will be lazy-loaded as usual. If special parameters should be passed, {@link Atalasoft.Controls.WebDocumentViewer#event:beforehandlerrequest| beforehandlerrequest} event to modify request parameters.\r\n   * @param {number} index - The index of the page to reload.\r\n   * @param {string|boolean} [annotations=false] - Url of the annotation xmp file or flag indicating whether to reload annotations of boolean flag indicating whether to load annotations data.\r\n   * @param {string|boolean} [forms] - Url of the form file or flag indicating whether to reload forms of boolean flag indicating whether to load forms data.\r\n   * @param {object} [params] - A plain object containing optional reload parameters that will be passed to server.\r\n   * @param {NotificationCallback} [callback] - function that is called when page have been loaded.\r\n   *\r\n   * This object will be available on the server side handler as an key-values collection. This allows to pass specific load options for individual pages.\r\n   * @function Atalasoft.Controls.WebDocumentViewer#reloadPage\r\n   */\n\n\n  function __reloadPageWrapper(index, annotations, forms, params, callback) {\n    if (__reloadPageBase) {\n      var thumbargs = Array.prototype.slice.call(arguments); // if function is called with callback parameter, remove this callback from thumbnail reload and pass to call after viewer complete.\n\n      if (_viewer && _viewer.isReady()) {\n        if (__isControllingViewer()) {\n          var viewerArgs = Array.prototype.slice.call(thumbargs);\n          callback = thumbargs.pop();\n\n          if (typeof callback !== 'function') {\n            thumbargs = Array.prototype.slice.call(viewerArgs);\n          }\n\n          __reloadPageBase.apply(this, thumbargs).then(function () {\n            if (__reloadPageViewer) {\n              __reloadPageViewer.apply(this, viewerArgs);\n            }\n          });\n        } else {\n          __reloadPageBase.apply(this, arguments); // document controller contains shared pages state, even thought viewer is not under our control.\n          //let viewerPageDefinition = _state.base.controllers.document.getPageDefinition(index, _viewerLink._id);\n          //_viewerLink.__silentReloadPage(viewerPageDefinition, params);\n\n        }\n      } else {\n        __reloadPageBase.apply(this, arguments);\n      }\n    }\n  } // #endregion\n  // #region Thumb Drawing\n\n\n  function __preparePageDivs() {\n    if (_state.base) {\n      if (_state.initialized && _state.base.dom.pageDivs.length > 0 && _state.base.dom.pageDivs[0]._img != null && !_state.base.dom.pageDivs[0]._img._size.isEmpty()) {\n        var size = _state.base.dom.pageDivs[0]._img._size;\n\n        if (size.width > size.height) {\n          //size to the width\n          _thumb.scale = _thumb.size / size.width;\n        } else {\n          //size to the height\n          _thumb.scale = _thumb.size / size.height;\n        }\n\n        if (_config.tabular && _config.columns > 1 && _config.direction === ScrollDirection.Vertical) {\n          // size available area to allow for number of columns\n          __fitContentToGrid();\n        }\n      } else {\n        var portrait = _state.base.page.size.width / _state.base.page.size.height < 1;\n        var imgHeight = Math.ceil(_state.base.page.size.height * _state.base.config.zoom);\n        var imgWidth = Math.ceil(_state.base.page.size.width * _state.base.config.zoom);\n        var thumbsize = _thumb.size;\n\n        if (_config.direction === ScrollDirection.Vertical) {\n          _thumb.divsize = Math.ceil(_state.base.page.size.width * _state.base.config.zoom);\n        } else if (_config.direction === ScrollDirection.Horizontal) {\n          _thumb.divsize = Math.ceil(_state.base.page.size.height * _state.base.config.zoom);\n        }\n\n        thumbsize = thumbsize <= 0 ? _thumb.divsize - _config.thumbpadding * 2 : thumbsize;\n\n        __setThumbSize(thumbsize);\n\n        if (_config.tabular && _config.columns > 1 && _config.direction === ScrollDirection.Vertical) {\n          // size available area to allow for number of columns\n          __fitContentToGrid();\n        }\n\n        var imgSide = portrait ? imgHeight : imgWidth;\n        _thumb.scale = imgSide ? _state.base.config.zoom * (_thumb.size / imgSide) : 1;\n        _thumb.zoomfull = _thumb.scale;\n\n        if (_config.minwidth > _state.base.page.size.width * _thumb.scale && _state.base.page.size.width) {\n          _config.minwidth = _state.base.page.size.width * _thumb.scale;\n        }\n\n        _state.initialized = true;\n      }\n\n      var bSize = _config.showpageborder ? _config.pageborderwidth * 2 : 0;\n      var pagedivsize = _thumb.size + _config.thumbpadding * 2 - bSize;\n\n      _self.trigger({\n        type: 'pagedivsresized',\n        height: pagedivsize,\n        width: pagedivsize,\n        fullzoom: _thumb.zoomfull,\n        minwidth: _config.minwidth\n      });\n\n      if (_config.allowdragdrop) {\n        _state.base.dom.content.addClass(_self.domclasses.atala_thumb_draggable);\n\n        _state.base.dom.content.css({\n          minWidth: pagedivsize,\n          minHeight: pagedivsize\n        });\n\n        var halfSize = Math.round(_thumb.size / 2);\n\n        _state.base.dom.content.sortable({\n          containment: 'window',\n          connectWith: '.' + _self.domclasses.atala_thumb_draggable,\n          appendTo: document.body,\n          placeholder: _self.domclasses.atala_drag_placeholder,\n          cursorAt: {\n            left: halfSize,\n            top: halfSize\n          },\n          delay: _config.dragdelay,\n          distance: 4,\n          helper: __thumbDragHelperFactory,\n          opacity: 0.65,\n          scroll: true,\n          scrollSensitivity: halfSize,\n          scrollSpeed: 10,\n          start: __onThumbDragStart,\n          receive: __onThumbExternalReceive,\n          stop: __onThumbDragEnd,\n          over: __onThumbDragOver,\n          change: __onThumbDragChange,\n          tolerance: 'pointer',\n          update: __onThumbsReordered,\n          zIndex: 100\n        });\n      }\n\n      atalaJquery.each(_state.base.dom.pageDivs, function (i, jqo) {\n        jqo.width(_thumb.size);\n        jqo.height(_thumb.size); // thumbs are square\n\n        if (!jqo.thumbInitialized) {\n          jqo.on(_thumbEvents);\n          jqo.css({\n            'padding': _config.thumbpadding,\n            'background-color': _config.backcolor,\n            'cursor': 'pointer',\n            'margin-bottom': _config.pagespacing + 'px',\n            'text-align': 'center',\n            'position': 'relative' // added to stop child divs from expanding outside this one\n\n          });\n\n          if (_config.tabular) {\n            jqo.css({\n              'margin-right': _config.pagespacing + 'px'\n            });\n          } else if (_config.direction === ScrollDirection.Horizontal) {\n            jqo.css({\n              'margin-right': _config.pagespacing + 'px',\n              'margin-bottom': '0px'\n            });\n          } // for some reason Raphael uses 0px in IE only\n\n\n          if (jqo._paper && Browser.Explorer) {\n            jqo._paper.canvas.style.top = '';\n            jqo._paper.canvas.style.width = '';\n            jqo._paper.canvas.style.height = '';\n          }\n\n          if (jqo._grips) {\n            jqo._grips.push = function () {}; // disables grips by disallowing addition of annos\n\n          }\n\n          jqo.thumbInitialized = true;\n        }\n\n        __scaleThumb(jqo._img, jqo._paper);\n      });\n\n      if (_state.base.dom.pageDivs.length > 0) {\n        _thumbLink.__adjustEdgeHeights(_state.base.dom.pageDivs[0]._index);\n      }\n    }\n  }\n\n  function __scaleThumb(img, paper, zoom, imgSize) {\n    if (_state.base) {\n      var sSize = imgSize || img && img.getScaledSize(zoom);\n\n      if (!sSize) {\n        return;\n      }\n\n      var sWidth = sSize.width;\n      var sHeight = sSize.height;\n      var thumbsize = _thumb.size * (_state.base.config.zoom / _thumb.zoomfull);\n\n      if (sWidth > thumbsize || sHeight > thumbsize) {\n        var portrait = sWidth / sHeight < 1;\n        var nz;\n\n        if (_config.tiling && img._size.width === 0 && img._size.height === 0) //In this case there is some info about image\n          {\n            zoom = img.getFitZoom();\n            nz = zoom * (thumbsize / (portrait ? sHeight : sWidth));\n            sWidth = Math.round(img.getSize().width * nz);\n            sHeight = Math.round(img.getSize().height * nz);\n          } else {\n          nz = zoom * (thumbsize / (portrait ? sHeight : sWidth));\n          sWidth = Math.round(img._size.width * nz);\n          sHeight = Math.round(img._size.height * nz);\n        }\n\n        zoom = nz;\n      }\n\n      img.width(sWidth);\n      img.height(sHeight);\n      var el = img.getDomElement();\n      el[0].style.left = '50%';\n      el[0].style.top = '50%';\n      el[0].style.position = 'absolute';\n      el[0].style.marginLeft = -Math.round(sWidth / 2) + 'px';\n      el[0].style.marginTop = -Math.round(sHeight / 2) + 'px'; // paper is a VML or SVG DOM object, and in some cases doesn't like to be centered\n\n      if (paper) {\n        paper.canvas.style.left = '50%';\n        paper.canvas.style.top = '50%';\n        paper.canvas.style.marginLeft = -Math.round(sWidth / 2) + 'px';\n        paper.canvas.style.marginTop = -Math.round(sHeight / 2) + 'px';\n        paper.canvas.style.zIndex = 1;\n      } // need to tell the anno controller that the page dimensions changed\n\n\n      img.trigger({\n        type: 'pagezoom',\n        index: img._page._index,\n        height: Math.round(sHeight),\n        width: Math.round(sWidth),\n        prevzoom: _state.base.config.zoom,\n        zoom: zoom\n      });\n    }\n  }\n\n  function __changeThumbColor(jqo, scolor, bcolor) {\n    var col = jqo.data('selected') ? scolor : bcolor;\n    jqo.css('background-color', col);\n  }\n\n  function __repaintThumbSelect(thumb, selected) {\n    var col = selected ? _config.selectedcolor : _config.backcolor;\n    thumb.data('selected', selected);\n    thumb.css('background-color', col);\n  } // #endregion\n  // #region Drag Drop\n  // thin wrapper on top of JQuery object instance to allow  \n  // changing actual underlying instance while wrapper reference is the same\n\n\n  function __JQueryObjectWrapper(initialParent) {\n    var me = this;\n    this._initial = initialParent;\n    this._actual = initialParent;\n\n    this.scrollTop = function () {\n      me._actual.scrollTop();\n    };\n\n    this.scrollLeft = function () {\n      me._actual.scrollTop();\n    };\n\n    this.setObject = function (parent) {\n      me._actual = parent;\n      this[0] = me._actual[0];\n    };\n\n    this.offset = function () {\n      return me._actual.offset();\n    };\n\n    this.setObject(initialParent);\n  }\n\n  function __getDraggedPageDivs(ui) {\n    var _this3 = this;\n\n    var result = [];\n\n    if (!ui.hasClass(_self.domclasses.atala_active_thumb) || !__isControllingViewer()) {\n      result.push(ui);\n    } else {\n      __getSelectedPagesIndices().forEach(function (pageIdx) {\n        Thumbnailer_newArrowCheck(this, _this3);\n\n        for (var i = 0; i < _state.base.dom.pageDivs.length; i++) {\n          if (_state.base.dom.pageDivs[i]._index === pageIdx) {\n            result.push(_state.base.dom.pageDivs[i]);\n            break;\n          }\n        }\n      }.bind(this));\n    }\n\n    return result;\n  }\n\n  function __thumbDragHelperFactory(e, ui) {\n    //Hack to append the element to the body (visible above others divs), \n    //but still belong to the scrollable container after method call complete, for correct widget initialization.\n    _state.dragdropping = true;\n    repaintSelectionState(__isControllingViewer());\n    var clone = atalaJquery('<div class=\"atala_drag_helper\"></div>');\n\n    var draggedItems = __getDraggedPageDivs(ui); //Prevent user's possibility to perform drop between sequentially selected pages\n\n\n    if (draggedItems.length > 1) {\n      atalaJquery(this).sortable('option', 'items', '> *:not(.' + 'atala_grouped_selection' + ')');\n      atalaJquery(this).sortable('refresh');\n    }\n\n    var stackSize = ui.hasClass(_self.domclasses.atala_active_thumb) && __isControllingViewer() ? Math.min(3, __getSelectedPagesIndices().length) : 1;\n\n    for (var i = 0; i < draggedItems.length || i < stackSize; i++) {\n      var draggedItem = i < draggedItems.length ? draggedItems[i] : draggedItems[0];\n\n      if (i < stackSize) {\n        var imageAnchor = draggedItem.find('.' + _self.domclasses.atala_page_image_anchor).first().clone();\n        imageAnchor.css({\n          'position': 'absolute',\n          'left': 10 * i + \"px\",\n          'top': -10 * i + \"px\",\n          'right': '0px',\n          'bottom': '0px',\n          'margin': '',\n          'z-index': -i\n        });\n        clone.append(imageAnchor);\n      }\n    }\n\n    _state.base.dom.content.append(clone);\n\n    var initialParent = clone.scrollParent(); // starting from jquery-ui 1.9 widget instance key format was changed - http://jqueryui.com/upgrade-guide/1.9/#changed-naming-convention-for-data-keys \n\n    var widgetInstance = _state.base.dom.content.data(sortableWidgetFullName) || _state.base.dom.content.data(sortableWidgetDeprecatedName);\n\n    clone.hide();\n    setTimeout(function () {\n      var _this4 = this;\n\n      if (widgetInstance) {\n        widgetInstance.scrollParent = new __JQueryObjectWrapper(initialParent);\n        draggedItems.forEach(function (item) {\n          Thumbnailer_newArrowCheck(this, _this4);\n\n          item.data(draggableScrollParentWrapperKey, widgetInstance.scrollParent);\n        }.bind(this));\n      }\n\n      clone.appendTo('body');\n      clone.show();\n    }, 1);\n    return clone;\n  }\n\n  function __onThumbDragStart(e, ui) {\n    var _this5 = this;\n\n    _viewerLink._controllers.upload.abort();\n\n    var pageIndices = __findPagesIndices(ui.item);\n\n    if (pageIndices !== null) {\n      var pageRefs = [];\n      pageIndices.forEach(function (idx) {\n        Thumbnailer_newArrowCheck(this, _this5);\n\n        pageRefs.push(_self.document.getPageReference(idx));\n      }.bind(this));\n      var dragData = {\n        start: pageIndices,\n        end: pageIndices[0],\n        updateHandled: false,\n        pageRefs: pageRefs,\n        documenturl: typeof pageRefs[0] === 'object' && pageRefs[0].uri ? pageRefs[0].uri : _state.base.config.documenturl,\n        thumbLink: _thumbLink,\n        thumb: _self,\n        thumbId: _thumbLink._id,\n        viewerId: _viewerLink._id,\n        state: _state,\n        externalDropIndex: null,\n        insertAfterSelf: false\n      };\n      ui.item.data(dragdataKey, dragData);\n\n      _state.base.controllers.mouseTool.pauseTool();\n\n      ui.placeholder.width(ui.item.width());\n      ui.placeholder.height(ui.item.height());\n      ui.placeholder.css({\n        'margin': ui.item.css('margin'),\n        'display': _state.base.config.tabular || _state.base.config.direction === ScrollDirection.Horizontal ? 'inline-block' : 'block',\n        padding: Math.max(0, _state.base.config.thumbpadding - 1)\n      });\n\n      _self.trigger({\n        type: 'thumbdragstart',\n        dragindex: dragData.start[0],\n        dragindices: dragData.start\n      });\n    }\n  }\n\n  function __onThumbDragOver(e, ui) {\n    // on mobile browsers we don't show scrollbars and not doing drag-scroll\n    if (!Browser.Mobile.Any()) {\n      var content = ui.placeholder.parents('.' + _self.domclasses.atala_scroller);\n      var scrollableWrapper = ui.item.data(draggableScrollParentWrapperKey);\n\n      if (content.length && scrollableWrapper && scrollableWrapper[0] !== content.first()[0]) {\n        // change the jquery UI scrollable object, to make it scroll WDT that we are dragging over now\n        scrollableWrapper.setObject(content.first());\n      }\n    }\n  }\n\n  function __onThumbDragChange(e, ui) {\n    var dragData = ui.item.data(dragdataKey);\n\n    if (dragData) {\n      var placeholderPredecessor = ui.placeholder.prev(); // when we start drag and drop on the same document, ui.item is the reference to one of pageDivs, which could \n      // have unpredictable position and page content because of recycling divs on scroll.\n      // when dropping jquery-ui sets ui.item before drop placeholder. but if we dropping right after div corresponding ui.item,\n      // there will be no ui.item reposition - thus, user saw that he drop page after PageN, but since PageN was same div as jquery thought we drag,\n      // our code can't distinguish whether user dropped after PageN or jquery already moved ui.item after PageN, i.e. we cant determine drop index\n\n      dragData.insertAfterSelf = placeholderPredecessor.length && ui.item[0] === placeholderPredecessor.first()[0];\n    }\n  }\n\n  function __onThumbDragEnd(e, ui) {\n    var _this6 = this;\n\n    var dragData = ui.item.data(dragdataKey);\n    var dropZone = {\n      left: _config.parent.offset().left,\n      right: _config.parent.offset().left + _config.parent.width(),\n      top: _config.parent.offset().top,\n      bottom: _config.parent.offset().top + _config.parent.height()\n    };\n    var itemPositionCenter = {\n      x: ui.position.left + ui.item.width() / 2,\n      y: ui.position.top + ui.item.height() / 2\n    };\n    var droppedInside = dropZone.left < itemPositionCenter.x && dropZone.right > itemPositionCenter.x && dropZone.top < itemPositionCenter.y && dropZone.bottom > itemPositionCenter.y;\n\n    if (dragData && droppedInside) {\n      // no data, rollback operation? shouldn't happen\n      _state.base.controllers.mouseTool.resumeTool();\n\n      if (!dragData.updateHandled) {\n        dragData.end = __getDropIndex(ui);\n        dragData.updateHandled = true;\n      }\n\n      if (dragData.insertAfterSelf) {\n        // see comment on __onThumbDragChange\n        ++dragData.end;\n      } // controllers.document.movePage will shift indexes down by removing page at sourceIndex first. need to adjust to that change.\n\n\n      dragData.end = dragData.start[0] < dragData.end ? dragData.end - 1 : dragData.end;\n      var eventArgs = {\n        type: 'thumbdragend',\n        dragindex: dragData.start[0],\n        dragindices: dragData.start,\n        dropindex: dragData.end,\n        source: dragData.thumb,\n        sourcedocument: dragData.documenturl,\n        target: _self,\n        external: false,\n        pageref: dragData.pageRefs[0],\n        pagerefs: dragData.pageRefs,\n        cancel: false\n      };\n\n      _self.trigger(eventArgs, eventArgs);\n\n      if (!eventArgs.cancel) {\n        if (_viewerLink && __isControllingViewer() && _viewer.isReady()) {\n          _viewerLink._controllers.document.movePages(dragData.start, dragData.end);\n        } else {\n          _state.base.controllers.document.movePages(dragData.start, dragData.end);\n        }\n\n        __ensureDragCompleteUI();\n\n        _cin.length = 0;\n\n        if (_cinDragDropTemp.length > 0) {\n          _cinDragDropTemp.sort(function (a, b) {\n            Thumbnailer_newArrowCheck(this, _this6);\n\n            return a - b;\n          }.bind(this)).forEach(function (idx) {\n            Thumbnailer_newArrowCheck(this, _this6);\n\n            __selectThumb(idx, true);\n          }.bind(this));\n\n          _cinDragDropTemp.length = 0;\n        } else {\n          __selectThumb(dragData.end, false);\n        }\n\n        eventArgs = {\n          type: 'thumbdragcomplete',\n          dragindex: dragData.start[0],\n          dragindices: dragData.start,\n          dropindex: dragData.end,\n          source: dragData.thumb,\n          target: _self\n        };\n        _state.dragdropping = false;\n\n        _self.trigger(eventArgs, eventArgs);\n      } else {\n        // cancel here conditionally only if drag data is set, since stop event is still triggered even if receive were cancelled.\n        // if we cancel one more time, page placeholder will be restored once again in _state.base.dom.content, although all dom changes were already done explicitly\n        atalaJquery(this).sortable('cancel');\n      }\n    } else if (dragData && !droppedInside) {\n      atalaJquery(this).sortable('cancel');\n    } //Reset filter for further D&D operations.\n\n\n    atalaJquery(this).sortable('option', 'items', '> *');\n    atalaJquery(this).sortable('refresh');\n    ui.item.data(dragdataKey, null);\n  }\n\n  function __onThumbExternalReceive(e, ui) {\n    var _this7 = this;\n\n    atalaJquery(ui.sender).sortable('cancel');\n    var dragData = ui.item.data(dragdataKey);\n\n    if (dragData) {\n      dragData.thumbLink._controllers.mouseTool.resumeTool();\n\n      var startDivIndex = _state.base.dom.pageDivs.length ? _state.base.dom.pageDivs[0]._index : 0;\n      dragData.end = dragData.externalDropIndex + startDivIndex || 0;\n      var eventArgs = {\n        type: 'thumbdragend',\n        dragindex: dragData.start[0],\n        dragindices: dragData.start,\n        dropindex: dragData.end,\n        source: dragData.thumb,\n        sourcedocument: dragData.documenturl,\n        target: _self,\n        pageref: dragData.pageRefs[0],\n        pagerefs: dragData.pageRefs,\n        external: true,\n        cancel: false,\n        copyannotations: true\n      };\n\n      _self.trigger(eventArgs.type, eventArgs);\n\n      if (!eventArgs.cancel) {\n        var annotations = [];\n\n        if (eventArgs.copyannotations && dragData.thumb.config.allowannotations && _self.config.allowannotations) {\n          dragData.start.forEach(function (idx) {\n            Thumbnailer_newArrowCheck(this, _this7);\n\n            annotations.push(dragData.thumb.annotations.getFromPage(idx));\n          }.bind(this));\n        }\n\n        if (dragData.viewerId !== _viewerLink._id) {\n          dragData.thumb.selectThumb(dragData.thumb.getCurrentPageIndex(), false);\n        }\n\n        _state.scrolling = true;\n        dragData.thumb.document.removePages(dragData.start);\n\n        _self.document.insertPages(null, dragData.pageRefs, dragData.end);\n\n        if (_viewer) {\n          _state.viewer.pagenumber = dragData.end;\n\n          __activateViewer(_viewer, _self.getDocumentInfo(), true); // need to forcibly reload viewer even if we own it.\n\n        }\n\n        __ensureDragCompleteUI();\n\n        _cin.length = 0;\n\n        if (_config.selectionmode === SelectionMode.SingleSelect) {\n          __selectThumb(dragData.end);\n        } else {\n          dragData.start.forEach(function (startNum, idx) {\n            __selectThumb(dragData.end + idx, true);\n          });\n        }\n\n        annotations.forEach(function (annos, idx) {\n          Thumbnailer_newArrowCheck(this, _this7);\n\n          if (annos) {\n            for (var i = 0; i < annos.length; i++) {\n              if (annos[i].update) {\n                delete annos[i].update;\n              }\n\n              if (annos[i].getPageIndex) {\n                delete annos[i].getPageIndex;\n              }\n\n              _self.annotations.createOnPage(annos[i], dragData.end + idx);\n            }\n          }\n        }.bind(this));\n\n        _self.trigger('thumbdragcomplete', {\n          type: 'thumbdragcomplete',\n          dragindex: dragData.start[0],\n          dragindices: dragData.start,\n          dropindex: dragData.end,\n          source: dragData.thumb,\n          target: _self\n        });\n\n        _state.dragdropping = false;\n        dragData.state.dragdropping = false;\n      }\n    }\n\n    ui.item.data(dragdataKey, null);\n  }\n\n  function __onThumbsReordered(e, ui) {\n    var dragData = ui.item.data(dragdataKey);\n\n    if (dragData) {\n      // this event fires BEFORE thumbdragend, so we need to set this here. \n      if (_state.base.dom.content.has(ui.item).length) {\n        // when we are dropped in the same document as drag started, pageDivs is available for us and we can exactly find out where we were dropped. \n        dragData.end = __getDropIndex(ui);\n\n        if (dragData.thumbId === _thumbLink._id) {\n          _self.trigger({\n            type: 'thumbsreordered',\n            dragindex: dragData.start[0],\n            dragindices: dragData.start,\n            dropindex: dragData.end\n          });\n        }\n      } else {\n        // only get insert index in the DOM, since we are called in the context of source WDT and don't have internal state.\n        dragData.externalDropIndex = ui.item.index();\n      }\n\n      dragData.updateHandled = true;\n    }\n  }\n\n  function __getDropIndex(dragState) {\n    var preDropPage = -1;\n    var divBeforeDrop = dragState.item.prev().length ? dragState.item.prev().first() : [null];\n\n    for (var i = 0; i < _state.base.dom.pageDivs.length; ++i) {\n      if (_state.base.dom.pageDivs[i][0] === divBeforeDrop[0]) {\n        preDropPage = _state.base.dom.pageDivs[i]._index;\n        break;\n      }\n    }\n\n    return preDropPage + 1;\n  }\n\n  function __ensureDragCompleteUI() {\n    var scroller = _state.base.dom.scroller[0]; // if bottom edge is in viewport\n\n    if (_thumbLink.__isObjectInRect(_state.base.dom.edges[1][0], scroller, scroller.scrollLeft, scroller.scrollTop, scroller.scrollLeft + scroller.clientWidth, scroller.scrollTop + scroller.clientHeight)) {\n      // during drag-drop jquery UI inserts page placeholder into dom.content. When drag causes scroll, and original page div is recycled\n      // because of additional div inserted, our code will incorrectly calculate recycling pages in virtual scrolling.\n      // when drag ends, jquery UI will remove drag-placeholder and bottom edge will brought into view. so we'll need to adjust edges.\n      var firstPage = _state.base.dom.pageDivs[0]._index;\n\n      var firstVisiblePage = _thumbLink.__getIndexFromPos(scroller.scrollLeft, scroller.scrollTop);\n\n      var delta = firstVisiblePage - firstPage;\n\n      if (delta < _state.base.dom.pageDivs.length && delta > 0) {\n        _thumbLink.__showNext(delta);\n      } else {\n        _thumbLink.__showPageAsync(firstVisiblePage, false);\n\n        _thumbLink.__redrawVisiblePages();\n      }\n    }\n  } // #endregion\n  // #region Helper Functions\n  // copy json data objects to new array\n\n\n  function __copyJsonDataToArray(data, itemkey) {\n    var mainArr = []; // makes a new array of direct object data references for easy updates\n\n    for (var key in data) {\n      if (data.hasOwnProperty(key)) {\n        var arr = [];\n        var obj = itemkey ? {} : arr;\n\n        if (itemkey) {\n          obj[itemkey] = arr;\n        }\n\n        for (var z in data[key]) {\n          if (data[key].hasOwnProperty(z)) {\n            arr[z] = data[key][z].get();\n            arr[z].multiview = true;\n          }\n        }\n\n        mainArr[key] = obj;\n      }\n    }\n\n    return mainArr;\n  } // jqdiv: jquery object representing div tag match\n\n\n  function __findPagesIndices(jqdiv) {\n    if (jqdiv.hasClass(_self.domclasses.atala_active_thumb) && __isControllingViewer()) return __getSelectedPagesIndices();\n\n    for (var n = 0; n < _state.base.dom.pageDivs.length; n++) {\n      if (_state.base.dom.pageDivs[n][0] === jqdiv[0]) {\n        return [_state.base.dom.pageDivs[n]._index];\n      }\n    }\n\n    return null;\n  }\n\n  function __fitContentToGrid() {\n    if (_config.tabular) {\n      var width;\n\n      if (_config.columns > 1) {\n        width = (_thumb.size + _config.thumbpadding * 2 + _config.pagespacing) * Math.min(_state.base.controllers.document.getPageCount(), _config.columns);\n      } else if (_config.rows > 1) {\n        var cols = Math.ceil(__getThumbCount() / _config.rows);\n        width = (_thumb.size + _config.thumbpadding * 2 + _config.pagespacing) * cols;\n      }\n\n      if (width) {\n        _state.base.dom.content.width(width);\n      }\n    }\n  }\n\n  function __getThumbCount() {\n    return _state.base.controllers.document.getPageCount();\n  } // returns a bool indicating if the thumbnail at the given index is currently in the pagedivs array\n\n\n  function __isThumbShown(i) {\n    for (var n = 0; n < _state.base.dom.pageDivs.length; n++) {\n      if (_state.base.dom.pageDivs[n]._index === i) {\n        return true;\n      }\n    }\n\n    return false;\n  } // orders the page divs array based on current dom position\n\n\n  function __reorderPageIndexes() {\n    var first = _state.base.dom.pageDivs[0]._index;\n\n    _state.base.dom.pageDivs.sort(function (a, b) {\n      return a.index() - b.index();\n    });\n\n    for (var n = 0; n < _state.base.dom.pageDivs.length; n++) {\n      var pg = _state.base.dom.pageDivs[n];\n      pg._index = first + n;\n\n      if (pg._num != null) {\n        pg._num.text(pg._index + 1);\n      }\n    }\n  } // provides a function for setting the size, so we can update config vars on the base control\n\n\n  function __setThumbSize(size) {\n    if (size <= 0) {\n      _self.trigger({\n        type: 'throwerror',\n        name: 'Invalid thumb size',\n        msg: 'Thumb size cannot be ' + size + '. Check configuration parameters \\'minwidth\\', \\'thumbpadding\\' and \\'thumbsize\\'.' + ' If \\'thumbsize\\' is not specified, then \\'minwidth\\' should be at least (2 * thumbpadding + 1).'\n      });\n    }\n\n    _thumb.size = size;\n\n    if (_state.base && _state.base.config.forcepagesize) {\n      _state.base.config.forcepagesize.width = size;\n      _state.base.config.forcepagesize.height = size;\n    }\n  } // validates (and fixes) the config so we don't have to check the inputs every time we need them\n\n\n  function __validateConfig() {\n    _config.allowdragdrop = _config.allowdragdrop ? true : false;\n    _config.selectedindex = __validateNumber(_config.selectedindex) ? parseInt(_config.selectedindex, 10) : 0;\n    _config.thumbpadding = __validateNumber(_config.thumbpadding) ? parseInt(_config.thumbpadding, 10) : 8;\n    _config.backcolor = __validateColor(_config.backcolor, '#DCDCDC');\n    _config.hovercolor = __validateColor(_config.hovercolor, '#667F9F');\n    _config.selectedcolor = __validateColor(_config.selectedcolor, '#E0872D');\n    _config.selectedhovercolor = __validateColor(_config.selectedhovercolor, '#FFC060');\n  } // validates a css color, sets it to validDefault if it's not valid\n  // color: string, CSS color to validate\n  // validDefault: string, CSS color to replace the invalid color with\n\n\n  function __validateColor(color, validDefault) {\n    // dummy color to test with\n    var dColor = {\n      hex: '#FFFFFF',\n      hexs: '#FFF',\n      name: 'white',\n      rgb: 'rgb(255, 255, 255)'\n    };\n\n    var dummy = __createDiv(null, 'dummy');\n\n    dummy.css('backgroundColor', dColor.name);\n    dummy.css('backgroundColor', color);\n\n    if (dummy.css('backgroundColor') === dColor.rgb) {\n      // color didn't change, is it white?\n      color = color.toLowerCase();\n\n      if (color !== dColor.name && color !== dColor.hex && color !== dColor.hexs && color !== dColor.rgb) {\n        // color isn't white, set it to valid one\n        color = validDefault;\n      }\n    }\n\n    return color;\n  } // checks a number\n  // n: value to check\n  // f: bool, indicates whether to check float\n\n\n  function __validateNumber(n, f) {\n    if (f) {\n      return isFinite(parseFloat(n));\n    } else {\n      return isFinite(parseInt(n, 10));\n    }\n  } // #endregion\n  // #region Events\n\n\n  function __unbindPageEvents() {\n    if (_state.base) {\n      atalaJquery.each(_state.base.dom.pageDivs, function (i, jqo) {\n        jqo.off(_thumbEvents);\n        jqo.thumbInitialized = false;\n      });\n    }\n  }\n\n  function __onViewerLoaded() {}\n\n  function __onViewerDocumentChanged(e, callback) {\n    if (_state.base.state.batchoperation > 0) {\n      return;\n    }\n\n    if (typeof e === 'function') {\n      callback = e;\n    }\n\n    __preparePageDivs();\n\n    _thumbLink.__redrawVisiblePages(true);\n\n    _thumbLink.__adjustVisiblePages();\n\n    if (_state.base && _viewerLink && __isControllingViewer() && _viewer.isReady()) {\n      _viewerLink.__redrawVisiblePages(true);\n\n      _viewerLink.__adjustVisiblePages(false, callback);\n    } else if (typeof callback === 'function') {\n      callback();\n    }\n  }\n\n  function __onViewerPageInserted(e) {\n    if (_state.base) {\n      if (_state.base.controllers.annotations) {\n        _state.base.controllers.annotations.insertLayer(null, null, e.destindex);\n      }\n\n      if (_state.base.controllers.forms) {\n        _state.base.controllers.forms.insertForm(null, null, e.destindex);\n      }\n\n      if (_viewerLink._state.batchoperation <= 0) {\n        __onViewerDocumentChanged();\n      }\n    }\n  }\n\n  function __onThumbUnHide() {\n    __onViewerDocumentChanged();\n\n    var vpin = _viewer.getCurrentPageIndex();\n\n    __scrollToThumb(vpin);\n  }\n\n  function __onViewerPageRemoved(e) {\n    if (_state.base) {\n      if (_state.base.controllers.annotations) {\n        _state.base.controllers.annotations.removeLayer(e.index);\n      }\n\n      if (_state.base.controllers.forms) {\n        _state.base.controllers.forms.removeForm(e.index);\n      }\n\n      if (_viewerLink._state.batchoperation <= 0) {\n        __onViewerDocumentChanged();\n      }\n    }\n  }\n\n  function __onViewerPageMoved(e) {\n    var _this8 = this;\n\n    if (_state.base) {\n      if (_state.base.controllers.annotations) {\n        _state.base.controllers.annotations.moveLayer(e.shiftedsrcindex, e.destindex);\n      }\n\n      if (_state.base.controllers.forms) {\n        _state.base.controllers.forms.moveForm(e.shiftedsrcindex, e.destindex);\n      }\n\n      __reorderPageIndexes();\n\n      if (_viewerLink._state.batchoperation <= 0) {\n        __onViewerDocumentChanged();\n      }\n\n      if (_state.dragdropping) {\n        var destIdx = e.destindex;\n\n        _cinDragDropTemp.sort(function (a, b) {\n          Thumbnailer_newArrowCheck(this, _this8);\n\n          return b - a;\n        }.bind(this)).forEach(function (idx) {\n          Thumbnailer_newArrowCheck(this, _this8);\n\n          if (idx === destIdx) {\n            destIdx--;\n          }\n        }.bind(this));\n\n        _cinDragDropTemp.push(destIdx);\n      }\n    }\n  }\n\n  function __onViewerScroll() {\n    var vpin = _viewer.getCurrentPageIndex();\n\n    var cin = __getSelectedPagesIndices();\n\n    if (cin.length <= 1 && cin[0] !== vpin && !_state.scrolling) {\n      __selectThumb(vpin);\n    }\n  }\n\n  function __onViewerScrolled() {\n    _state.scrolling = false;\n    _state.base.state.thumbTargetPage = -1;\n  }\n\n  function __onViewerAnnotationCreated(e) {\n    if (_state.base) {\n      var layer = _viewerLink._annos[e.page] || null;\n      var annData = null;\n\n      if (layer) {\n        var ann = layer[layer.length - 1];\n        annData = ann.get();\n      } //TODO: should compare all properties just to make sure \n\n\n      if (annData && annData.type === e.anno.type) {\n        annData.multiview = true;\n\n        _state.base.controllers.annotations.createAnnotation(annData, e.page);\n      }\n    }\n  }\n\n  function __onViewerAnnotationDeleted(e) {\n    if (_state.base) {\n      _state.base.controllers.annotations.deleteAnnoOnPage(e.page, e.index);\n    }\n  }\n\n  function __onViewerPageRotated() {\n    if (_state.base) {\n      if (_viewerLink._state.batchoperation <= 0) {\n        __onViewerDocumentChanged();\n      }\n    }\n  }\n\n  function __onViewerAnnotationUpdated(e) {\n    if (_state.base) {\n      var currentPage = e.anno.getPageIndex(); // only need to update thumb annotations if the thumb is shown \n\n      if (__isThumbShown(currentPage)) {\n        var thumbAnns = _state.base.controllers.annotations.getAnnosFromPage(currentPage);\n\n        for (var i = 0; i < thumbAnns.length; i++) {\n          if (thumbAnns[i].type === e.anno.type) {\n            thumbAnns[i].update(true);\n          }\n        }\n      }\n    }\n  } // we override viewer requests so we can save on requests\n\n\n  function __onViewerRequest(e) {\n    if (e.request.type === 'docinfo' || e.request.type === 'annodata' || e.request.type === 'formdata') {\n      if (_state.base) {\n        e.request.cancel = true;\n\n        if (e.request.type === 'docinfo') {\n          e.request.info.pagewidth = _page.size.width;\n          e.request.info.pageheight = _page.size.height;\n          e.request.info.pagecount = _page.count;\n          e.request.info.dpi = _page.dpi;\n          e.request.info.colordepth = _state.base.controllers.memory.colorDepth;\n          e.request.info.vector = _page.vector;\n        }\n\n        var start = e.request.info.docIndex !== undefined ? e.request.info.docIndex : e.request.info.offset || 0;\n        var end = e.request.info.length > -1 ? e.request.info.length + start : undefined;\n        e.request.info.offset = e.request.info.offset || 0;\n\n        if (_config.allowannotations && (e.request.type === 'annodata' || e.request.data.atala_annurl)) {\n          var adata = _state.base.controllers.annotations.__getDebugInfo().data;\n\n          e.request.info.layers = __copyJsonDataToArray(adata.annos.slice(start, end), 'items');\n        }\n\n        if (_config.allowforms && (e.request.type === 'formdata' || e.request.data.atala_formurl)) {\n          var fdata = _state.base.controllers.forms.__getDebugInfo().data;\n\n          e.request.info.forms = {\n            fields: __copyJsonDataToArray(fdata.fields.slice(start, end))\n          };\n        }\n\n        _viewer.trigger({\n          type: 'handlerreturned',\n          request: e.request\n        });\n      }\n    }\n  }\n\n  function __onThumbAnnosLoaded() {}\n\n  function __onThumbFormsLoaded() {}\n\n  function __onThumbContextMenu(e, annData, menuCfg) {\n    // delete annotation context menu options\n    for (var i in menuCfg) {\n      if (menuCfg.hasOwnProperty(i)) {\n        delete menuCfg[i];\n      }\n    }\n  }\n\n  function __onDocumentLoaded() {\n    _state.base = {\n      config: _thumbLink._config,\n      controllers: _thumbLink._controllers,\n      dom: _thumbLink._dom,\n      page: _thumbLink._page,\n      state: _thumbLink._state,\n      stateManager: _thumbLink.stateManager\n    };\n  } // this callback will be called from underlying viewer, when it's loaded.\n\n\n  function __onThumbsLoaded(error, info, viewerCallback) {\n    // turn off panning unless we're using touch\n    //\t\tif (!Atalasoft.Utils.Browser.Features.Touch){\n    //\t\t\t_state.base.controllers.mouseTool.setTool(_toolTypes.PassThrough, _toolTypes.PassThrough);\n    //\t\t}\n    _page.size.width = _state.base.page.size.width;\n    _page.size.height = _state.base.page.size.height;\n    _page.count = _state.base.page.count;\n    _page.dpi = _state.base.page.dpi;\n    _page.vector = _state.base.page.vector;\n\n    __preparePageDivs();\n\n    __adjustScrollbarVisibility(_state.base.dom.scrollH);\n\n    __adjustScrollbarVisibility(_state.base.dom.scrollV);\n\n    var callback = function callback() {\n      if (__isControllingViewer()) {\n        __selectThumb(_config.selectedindex);\n      }\n\n      if (viewerCallback && typeof viewerCallback === 'function') {\n        viewerCallback(error);\n      }\n    }; // reset the zoom so viewer will calculate it according initial fit settings.\n\n\n    _state.viewer.zoom = 0;\n\n    if (__isControllingViewer() || _stateManager && !_stateManager.isViewerActive()) {\n      __activateViewer(_viewer, info, true);\n\n      callback();\n    } else {\n      callback();\n    }\n  }\n\n  function __onThumbHoverIn() {\n    __changeThumbColor(atalaJquery(this), _config.selectedhovercolor, _config.hovercolor);\n  }\n\n  function __onThumbHoverOut() {\n    __changeThumbColor(atalaJquery(this), _config.selectedcolor, _config.backcolor);\n  }\n\n  function __onThumbClicked(e) {\n    if (e.button !== 0) // check that left button was clicked. Ignore all others buttons\n      return;\n    var clicked = e.currentTarget;\n    var clickedIdx = -1;\n\n    for (var i = 0; i < _state.base.dom.pageDivs.length; i++) {\n      if (_state.base.dom.pageDivs[i][0] === clicked) {\n        clickedIdx = _state.base.dom.pageDivs[i]._index;\n        break;\n      }\n    }\n\n    if (clickedIdx === -1) return;\n\n    if (_config.selectionmode === SelectionMode.MultiSelect) {\n      var shiftPressed = e.shiftKey;\n      var ctrlPressed = Browser.Platform !== BrowserPlatform.Mac ? e.ctrlKey : e.metaKey;\n\n      if (shiftPressed) {\n        var lastClicked = _cin[_cin.length - 1];\n        if (clickedIdx < lastClicked) for (var _i = lastClicked - 1; _i >= clickedIdx; _i--) {\n          __updateThumbnailSelection(_i, true);\n        } else for (var _i2 = lastClicked + 1; _i2 <= clickedIdx; _i2++) {\n          __updateThumbnailSelection(_i2, true);\n        }\n      } else {\n        __updateThumbnailSelection(clickedIdx, ctrlPressed);\n      }\n    } else {\n      __selectThumb(clickedIdx);\n    }\n  }\n\n  function __updateThumbnailSelection(index, append) {\n    append = append && __isControllingViewer();\n    if (_cin.indexOf(index) !== -1 && append) __deselectThumb(index);else __selectThumb(index, append);\n  }\n\n  function __fakeMouseEvent(e, eType, eButton) {\n    // Ignore multi-touch events\n    if (e.originalEvent.touches.length > 1) {\n      return;\n    }\n\n    e.preventDefault(); // grab touch event\n\n    var touch = e.originalEvent.changedTouches[0]; // create new mouse event\n\n    var mouse = document.createEvent('MouseEvents'); // copy properties from touch to new mouse event\n\n    mouse.initMouseEvent(eType, true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, eButton, null); // send the fake event to the target\n\n    e.target.dispatchEvent(mouse);\n  }\n\n  function __onThumbTouchStart(e) {\n    _touch.moves = 0;\n    _touch.start = {\n      x: NaN,\n      y: NaN\n    };\n\n    if (e.originalEvent.touches && e.originalEvent.touches.length === 1) {\n      var touch = e.originalEvent.touches[0];\n      _touch.start.x = touch.screenX;\n      _touch.start.y = touch.screenY;\n    }\n\n    __fakeMouseEvent(e, 'mouseover', 0);\n\n    __fakeMouseEvent(e, 'mousedown', 0);\n  }\n\n  function __onThumbTouchMove(e) {\n    if (e.originalEvent.touches && e.originalEvent.touches.length) {\n      var touch = e.originalEvent.touches[0];\n      var moveThreshold = 5;\n\n      if (e.originalEvent.touches.length > 1 || Math.abs(_touch.start.x - touch.screenX) > moveThreshold || Math.abs(_touch.start.y - touch.screenY) > moveThreshold) {\n        _touch.moves++;\n      }\n\n      __fakeMouseEvent(e, 'mousemove', 0);\n    }\n  }\n\n  function __onThumbTouchEnd(e) {\n    __fakeMouseEvent(e, 'mouseup', 0);\n\n    if (_touch.moves > 0) {\n      _touch.moves = 0;\n    } else {\n      __fakeMouseEvent(e, 'click', 0);\n    }\n\n    __fakeMouseEvent(e, 'mouseout', 0);\n  }\n\n  function __onThumbScroll() {\n    if (_state.dragdropping) {\n      repaintSelectionState(__isControllingViewer());\n\n      _state.base.dom.content.sortable('refresh');\n    }\n  }\n\n  function __onThumbShown(e) {\n    if (_config.showthumbcaption) {\n      if (!e.page._caption) {\n        var div = atalaJquery('<div/>');\n        div.css({\n          left: '3%',\n          bottom: '16px',\n          width: '94%',\n          position: 'absolute',\n          zIndex: 1,\n          textAlign: 'center',\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n          whiteSpace: 'nowrap'\n        });\n        div.addClass(_self.domclasses.atala_thumb_caption);\n        e.page._caption = div;\n        e.page.append(div);\n      }\n\n      var title = e.page._index + 1 + '';\n\n      if (_thumbLink._page.caption) {\n        title = _thumbLink._page.caption.replace('{0}', title);\n        e.page.attr('title', title);\n      }\n\n      e.page._caption.text(title);\n    }\n\n    if (e.page && e.page._img && !e.page._img._loaded) {\n      __scaleThumb(e.page._img, e.page._paper);\n    }\n\n    __repaintThumbSelect(e.page, _cin.indexOf(e.page._index) > -1 && __isControllingViewer());\n  }\n\n  function __onThumbResize(e) {\n    if (e.image) {\n      if (e.image._loaded) {\n        if (e.page) {\n          __scaleThumb(e.image, e.page._paper, _thumb.scale, {\n            width: e.width,\n            height: e.height\n          });\n        }\n      } else {\n        e.image.css({\n          position: 'absolute'\n        });\n      }\n    }\n  }\n\n  function __onThumbsStatusMessage(e) {\n    if (_viewerLink && _viewerLink.__status) {\n      _viewerLink.__status(e.message);\n    }\n  }\n\n  function __onThumbZoomChanged() {\n    if (_state.base) {\n      var portrait = _state.base.page.size.width / _state.base.page.size.height < 1;\n      var imgHeight = Math.ceil(_state.base.page.size.height * _state.base.config.zoom);\n      var imgWidth = Math.ceil(_state.base.page.size.width * _state.base.config.zoom);\n      var divsize = Math.max(imgHeight, imgWidth);\n      var thumbscale = _state.base.config.zoom * (divsize / (portrait ? imgHeight : imgWidth));\n      _thumb.zoom = _state.base.config.zoom / _thumb.zoomfull;\n      _thumb.scale = thumbscale;\n      atalaJquery.each(_state.base.dom.pageDivs, function (i, jqo) {\n        jqo.width(divsize);\n        jqo.height(divsize); // thumbs are square\n      });\n    }\n  }\n\n  function __onThumbZoomStarted() {}\n\n  function __onThumbZoomFinished() {}\n\n  function __onThumbPageSizeChanged(e) {\n    if (_viewerLink && _stateManager && _viewer && _viewer.isReady()) {\n      _viewerLink.__updatePageSize(e, _state.base.controllers.document, _state.base.page.size, _stateManager.isThumbnailerActive(__getStateManagerApi()));\n    }\n  }\n\n  function __adjustScrollbarVisibility(scrollbar) {\n    if (!scrollbar) {\n      return;\n    } // calculated size is just a little too much for fit\n\n\n    if (scrollbar._scrollSize <= 0) {\n      // hide the scroll tray\n      scrollbar._tray.hide();\n    } else {\n      scrollbar._tray.show();\n    }\n  } // #endregion\n\n\n  __init();\n\n  return _self;\n};\n\n\n// CONCATENATED MODULE: ./src/EntryPoint.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Utils\", function() { return Utils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Annotations\", function() { return Annotations; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Controls\", function() { return Controls; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Logger\", function() { return Logger; });\n\n\n\n\n\n\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { EntryPoint_defineProperty(target, key, source[key]); }); } return target; }\n\nfunction EntryPoint_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//-------------------------------------------------------------------------------------------------\n//\n//\tWeb Document Viewer object cross browser client-side script.\n//\tCopyright 2003-2020 Atalasoft Inc. All Rights Reserved.\n//\n//\tThis source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)\n//\tPermission for usage and modification of this code is only permitted\n//\twith the purchase of a source code license.\n//\n\n/* global define */\n\n/**\r\n * Main Atalasoft Namespace definition(s)\r\n * @namespace Atalasoft\r\n */\n\n\n\n\n\nvar wdvControls = {\n  WebDocumentThumbnailer: Thumbnailer_WebDocumentThumbnailer,\n  WebDocumentViewer: WebDocumentViewer_WebDocumentViewer,\n  Version: Version\n};\n\nfunction isCommonJS() {\n  return typeof exports === 'object' && typeof module === 'object';\n}\n\nfunction isAMD() {\n  return typeof define === 'function' && __webpack_require__(124);\n}\n\nfunction isAtalasoftGlobalExist() {\n  return !!self.Atalasoft;\n}\n\nfunction getAtalasoftControlsGlobal() {\n  return self.Atalasoft.Controls;\n}\n\nfunction getAtalasoftLoggerGlobal() {\n  return self.Atalasoft.Logger;\n}\n/**\r\n * @namespace Utils\r\n * @memberof Atalasoft\r\n */\n\n\nvar Utils = Enums;\n/**\r\n * @namespace Annotations\r\n * @memberof Atalasoft\r\n */\n\nvar Annotations = {\n  AnnotationTypes: annotations_AnnotationTypes\n};\n/**\r\n * Contains Atalasoft imaging controls\r\n * @namespace Controls\r\n * @memberof Atalasoft\r\n */\n\nvar Controls = isCommonJS() || isAMD() || !isAtalasoftGlobalExist() ? wdvControls : _objectSpread({}, getAtalasoftControlsGlobal(), wdvControls); //We should re-export Logger from WCS or create an empty object that WCS can fill with real object later.\n\nvar Logger = isCommonJS() || isAMD() || !isAtalasoftGlobalExist() ? {} : _objectSpread({}, getAtalasoftLoggerGlobal());\n\n/***/ })\n/******/ ]);\n});\n//# sourceMappingURL=atalaWebDocumentViewer.js.map"]}